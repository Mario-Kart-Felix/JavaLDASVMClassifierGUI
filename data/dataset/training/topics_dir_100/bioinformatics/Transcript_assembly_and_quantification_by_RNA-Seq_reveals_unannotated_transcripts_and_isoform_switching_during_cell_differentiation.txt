©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
nature biotechnology  advance online publication 
l e t t e r s
High-throughput mRNA sequencing (RNA-Seq) promises 
simultaneous transcript discovery and abundance estimation1–3. 
However, this would require algorithms that are not restricted 
by prior gene annotations and that account for alternative 
transcription and splicing. Here we introduce such algorithms 
in an open-source software program called Cufflinks. To test 
Cufflinks, we sequenced and analyzed >430 million paired 
75-bp RNA-Seq reads from a mouse myoblast cell line over 
a differentiation time series. We detected 13,692 known 
transcripts and 3,724 previously unannotated ones, 62% of 
which are supported by independent expression data or by 
homologous genes in other species. Over the time series, 330 
genes showed complete switches in the dominant transcription 
start site (TSS) or splice isoform, and we observed more 
subtle shifts in 1,304 other genes. These results suggest that 
Cufflinks can illuminate the substantial regulatory flexibility 
and complexity in even this well-studied model of muscle 
development and that it can improve transcriptome-based 
genome annotation.
Recently, RNA-Seq has revealed tissue-specific alternative splicing4, 
novel genes and transcripts5 and genomic structural variations6. 
Deeply sampled RNA-Seq permits measurement of differential gene 
expression with greater sensitivity than expression7 and tiling8 micro-
arrays. However, the analysis of RNA-Seq data presents major chal-
lenges in transcript assembly and abundance estimation, arising from 
the ambiguous assignment of reads to isoforms8–10.
In earlier RNA-Seq experiments conducted by some of us, we esti-
mated the relative expression for each gene as the fraction of reads 
mapping to its exons after normalizing for gene length11. We did not 
attempt to allocate reads to specific alternate isoforms, although we 
found ample evidence that multiple splice and promoter isoforms are 
often coexpressed in a given tissue2. This raised biological questions 
about how the different forms are distributed across cell types and 
physiological states. In addition, our prior methods relied on anno-
tated gene models that, even in mouse, are incomplete. Longer reads 
(75 bp in this work versus 25 bp in our previous work) and pairs of 
reads from both ends of each RNA fragment can reduce uncertainty 
in assigning reads to alternative splice variants12. To produce use-
ful transcript-level abundance estimates from paired-end RNA-Seq 
data, we developed a new algorithm that can identify complete novel 
transcripts and probabilistically assign reads to isoforms.
For our initial demonstration of Cufflinks, we performed a time 
course of paired-end 75-bp RNA-Seq on a well-studied model of 
skeletal muscle development, the C2C12 mouse myoblast cell line13 
(see Online Methods). Regulated RNA expression of key transcrip-
tion factors drives myogenesis, and the execution of the differentia-
tion process involves changes in expression of hundreds of genes14,15. 
Previous studies have not measured global transcript isoform expres-
sion; however, there are well-documented expression changes at the 
whole-gene level for a set of marker genes in this system. We aimed to 
establish the prevalence of differential promoter use and differential 
splicing, because such data could reveal much about the model sys-
tem’s regulatory behavior. A gene with isoforms that code for the 
same protein may be subject to complex regulation to maintain a 
certain level of output in the face of changes in expression of its 
transcription factors. Alternatively, genes with isoforms that encode 
different proteins could be functionally specialized for different cell 
types or states. By analyzing changes in the relative abundances of 
transcripts produced by the alternative splicing of a single primary 
transcript, we hoped to infer the effects of post-transcriptional 
processing (for example, splicing) on RNA output separately from 
rates of primary transcription. Such analysis could identify key 
genes in the system and suggest experiments to establish how they 
are regulated.
We first mapped sequenced fragments to the mouse genome using 
an improved version of TopHat16, which can align reads across splice 
junctions without relying on gene annotation (Supplementary 
Methods, section 2). A fragment corresponds to a single cDNA 
molecule, which can be represented by a pair of reads from each 
end. Out of 215 million fragments, 171 million (79%) mapped to 
the genome, and 46 million spanned at least one putative splice 
transcript assembly and quantification by rNA-seq 
reveals unannotated transcripts and isoform switching 
during cell differentiation
Cole Trapnell1–3, Brian A Williams4, Geo Pertea2, Ali Mortazavi4, Gordon Kwan4, Marijke J van Baren5,  
Steven L Salzberg1,2, Barbara J Wold4 & Lior Pachter3,6,7
1Department of Computer Science and 2Center for Bioinformatics and Computational Biology, University of Maryland, College Park, Maryland, USA. 3Department of 
Mathematics, University of California, Berkeley, California, USA. 4Division of Biology and Beckman Institute, California Institute of Technology, Pasadena, California, 
USA. 5Genome Sciences Center, Washington University in St. Louis, St. Louis, Missouri, USA. 6Department of Molecular and Cell Biology and 7Department of Computer 
Science, University of California, Berkeley, California, USA. Correspondence should be addressed to L.P. (lpachter@math.berkeley.edu).
Received 2 February; accepted 22 March; published online 2 May 2010; doi:10.1038/nbt.1621
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
  advance online publication nature biotechnology
l e t t e r s
junction (Supplementary Table 1). Of the splice junctions spanned 
by fragment alignments, 70% were present in transcripts annotated 
by the UCSC, Ensembl or VEGA groups (known genes).
To recover the minimal set of transcripts supported by our frag-
ment alignments, we designed a comparative transcriptome assem-
bly algorithm. Expressed sequence tag (EST) assemblers such as 
PASA introduced the idea of collapsing alignments to transcripts 
on the basis of splicing compatibility17, and Dilworth’s theorem18 
has been used to assemble a parsimonious set of haplotypes from 
virus population sequencing reads19. Cufflinks extends these ideas, 
reducing the transcript assembly problem to finding a maximum 
matching in a weighted4 bipartite graph that represents com-
patibilities17 among fragments (Fig. 1a–c and Supplementary 
Methods, section 4). Noncoding RNAs20 and microRNAs21 have 
been reported to regulate cell differentiation and development, and 
coding genes are known to produce noncoding isoforms as a means 
of regulating protein levels through nonsense-mediated decay22. 
For these biologically motivated reasons, the assembler does not 
require that assembled transcripts contain an open reading frame 
(ORF). As Cufflinks does not make use of existing gene annotations 
during assembly, we validated the transcripts by first comparing 
individual time point assemblies to existing annotations.
We recovered a total of 13,692 known isoforms and 12,712 new iso-
forms of known genes. We estimate that 77% of the reads originated 
from previously known transcripts (Supplementary Table 2). Of the 
new isoforms, 7,395 (58%) contain novel splice junctions, with the 
remainder being novel combinations of known splicing outcomes; 
11,712 (92%) have an ORF, 8,752 of which end at an annotated stop 
codon. Although we sequenced deeply by current standards, 73% of 
the moderately abundant transcripts (15–30 expected fragments per 
kilobase of transcript per million fragments mapped, abbreviated 
FPKM; see below for further explanation) detected at the 60-h time 
point with three lanes of GAII transcriptome sequencing were fully 
recovered with just a single lane. Because distinguishing a full-length 
transcript from a partially assembled fragment is difficult, we con-
servatively excluded from further analyses the novel isoforms that 
were unique to a single time point. Out of the new isoforms, 3,724 
were present in multiple time points, and 581 were present at all 
time points; 6,518 (51%) of the new isoforms and 2,316 (62%) of 
the multiple time point novel isoforms were tiled by high-identity 
a
c
db
e
Map paired cDNA
fragment sequences
to genome
TopHat
Cufflinks
Spliced fragment
alignments
Abundance estimationAssembly
Mutually
incompatible
fragments
Transcript coverage
and compatibility
Fragment
length
distribution
Overlap graph
Maximum likelihood
abundances
Log-likelihood
Minimum path cover
Transcripts
Transcripts
and their
abundances
γ3
γ3
γ1
γ1
γ2
γ2
Figure 1 Overview of Cufflinks. (a) The algorithm takes as input cDNA 
fragment sequences that have been aligned to the genome by software 
capable of producing spliced alignments, such as TopHat. (b–e) With 
paired-end RNA-Seq, Cufflinks treats each pair of fragment reads as 
a single alignment. The algorithm assembles overlapping ‘bundles’ of 
fragment alignments (b,c) separately, which reduces running time and 
memory use, because each bundle typically contains the fragments from 
no more than a few genes. Cufflinks then estimates the abundances of 
the assembled transcripts (d,e). The first step in fragment assembly is 
to identify pairs of ‘incompatible’ fragments that must have originated 
from distinct spliced mRNA isoforms (b). Fragments are connected in an 
‘overlap graph’ when they are compatible and their alignments overlap 
in the genome. Each fragment has one node in the graph, and an edge, 
directed from left to right along the genome, is placed between each 
pair of compatible fragments. In this example, the yellow, blue and red 
fragments must have originated from separate isoforms, but any other 
fragment could have come from the same transcript as one of these 
three. Isoforms are then assembled from the overlap graph (c). Paths 
through the graph correspond to sets of mutually compatible fragments 
that could be merged into complete isoforms. The overlap graph here can 
be minimally ‘covered’ by three paths (shaded in yellow, blue and red), 
each representing a different isoform. Dilworth’s Theorem states that 
the number of mutually incompatible reads is the same as the minimum 
number of transcripts needed to ‘explain’ all the fragments. Cufflinks 
implements a proof of Dilworth’s Theorem that produces a minimal set 
of paths that cover all the fragments in the overlap graph by finding the 
largest set of reads with the property that no two could have originated 
from the same isoform. Next, transcript abundance is estimated  
(d). Fragments are matched (denoted here using color) to the transcripts 
from which they could have originated. The violet fragment could have 
originated from the blue or red isoform. Gray fragments could have come 
from any of the three shown. Cufflinks estimates transcript abundances 
using a statistical model in which the probability of observing each 
fragment is a linear function of the abundances of the transcripts from 
which it could have originated. Because only the ends of each fragment 
are sequenced, the length of each may be unknown. Assigning a fragment 
to different isoforms often implies a different length for it. Cufflinks 
incorporates the distribution of fragment lengths to help assign fragments 
to isoforms. For example, the violet fragment would be much longer, and 
very improbable according to the Cufflinks model, if it were to come from 
the red isoform instead of the blue isoform. Last, the program numerically 
maximizes a function that assigns a likelihood to all possible sets of 
relative abundances of the yellow, red and blue isoforms (γ1,γ2,γ3)  
(e), producing the abundances that best explain the observed fragments, 
shown as a pie chart.
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
nature biotechnology  advance online publication 
l e t t e r s
EST alignments or matched RefSeq isoforms from other organisms, 
and end point RT-PCR experiments confirmed new isoforms in genes 
of interest (Supplementary Table 3). We concluded that most of the 
unannotated transcripts we found are in the myogenic transcriptome 
and that the mouse annotation remains incomplete.
To estimate transcript abundances, we first selected a set of 11,079 
genes containing 17,416 high-confidence isoforms (Supplementary 
Data 1). Of these, 13,692 (79%) were known, and the remaining 3,724 
(21%) were novel isoforms of known genes present in multiple time 
points. We then developed a statistical model specifying the probabil-
ity of observing an RNA-Seq fragment. The model is parameterized 
by the abundances of these transcripts (Fig. 1d–f and Supplementary 
Methods, section 3). Cufflinks’ model allows for the probabilistic 
deconvolution of RNA-Seq fragment densities to account for cases in 
which genome alignments of fragments do not uniquely correspond 
to source transcripts. The model incorporates minimal assumptions23 
about the sequencing experiment, and it extends the unpaired read 
model of Jiang and Wong8 to the paired-end case.
Abundances were reported in FPKM. In these units, the relative 
abundances of transcripts are described in terms of the expected bio-
logical objects (fragments) observed from an RNA-Seq experiment, 
which in the future may not be represented by single or paired reads. 
Confidence intervals for estimates were obtained using a Bayesian 
inference method based on importance sampling from the posterior 
distribution. Abundances of spiked control 
sequences (R2 = 0.99) and benchmarks with 
simulated data (R2 = 0.96) revealed that 
Cufflinks’ abundance estimates are highly 
accurate. The inclusion of novel isoforms 
of known genes during abundance estima-
tion had a strong impact on the estimates of 
known isoforms in many genes (R2 = 0.90), 
highlighting the importance of coupling 
transcript discovery together with abun-
dance estimation.
We identified 7,770 genes and 10,480 iso-
forms undergoing significant abundance 
changes between some successive pair of 
time points (expected false discovery rate, abbreviated FDR, of <5%). 
Many genes show substantial transcript-level dynamics that are not 
reflected in their overall expression patterns (Supplementary Data 2). 
For example, Myc (Fig. 2a), a proto-oncogene that is known to be 
transcriptionally and post-transcriptionally regulated during myo-
genesis24, is downregulated overall during the time course, and, 
although isoforms A and B follow this pattern, isoform C has a more 
complex expression pattern (Fig. 2b).
We noted that many genes showed switching between major and 
minor transcripts; furthermore, some contained isoforms with 
muscle-specific functions, such as tropomyosin I and II, which dis-
play a marked switch in isoform dominance upon differentiation 
(Supplementary Methods, appendix b). However, many genes fea-
tured dynamics involving several isoforms with behavior too complex 
to be deemed ‘switching’.
In light of these observations, we classified the patterns of expres-
sion dynamics for transcripts, assigning them one of four ‘trajectories’ 
based on their expression curves being flat, increasing, decreasing or 
mixed (see Online Methods). On the basis of this trajectory classifi-
cation, a total of 1,634 genes were found to have multiple isoforms 
with different trajectories in the time course, and we hypothesized 
that differential promoter preference and differential splicing were 
responsible for the divergent patterns.
To explore the impact of regulation on mRNA output and to check 
whether it could explain the variability of trajectories, we grouped 
transcripts by their TSS instead of just by gene. Changes in the relative 
abundances of mRNAs spliced from the same pre-mRNA transcript are 
by definition post-transcriptional, so this grouping effectively discrimi-
nated changes in mRNA output associated with differential transcription 
from changes associated with differential post-transcriptional 
processing. Of the 3,486 genes in our high-confidence set with iso-
forms that shared a common TSS, 41% had TSS groups containing 
different isoform trajectories. Summing the expressions of isoforms 
Time (h)
a
b c
TSS I
A
B
CTSS II
Myc A
0
0
10
20
30
40
–24
–24
100%
transcriptional
100% post-
transcriptional
6.9 × 10–3
18 60 90 144
60 120 168
5
10
15
20
25
30
F
P
K
M
R
at
io
s
F
P
K
M
Myc Transcriptional Post-
transcriptional
Relative isoform
abundances within
TSS
Relative TSS
abundances
A+B AB
C
Q T T TA M L V NP
M L V NP
M L V NP
Myc B
Myc C
Figure 2 Distinction of transcriptional and post-transcriptional regulatory 
effects on overall transcript output. (a) When abundances of isoforms A, 
B and C of Myc are grouped by TSS, changes in the relative abundances 
of the TSS groups indicate transcriptional regulation. Post-transcriptional 
effects are seen in changes in levels of isoforms of a single TSS group. 
(b) Isoforms of Myc have distinct expression dynamics. (c) Myc isoforms 
are downregulated as the time course proceeds. The width of the colored 
band is the measure of change in relative transcript abundance and 
the color is the log ratio of transcriptional and post-transcriptional 
contributions to change in relative abundances (plot construction detailed 
in Supplementary Methods, section 5.3). Changes in relative abundances 
of Myc isoforms suggest that transcriptional effects immediately following 
differentiation at 0 h give way to post-transcriptional effects later in the 
time course, as isoform A is eliminated.
a b2 kb FHL3
–24 60
Time (h)
F
P
K
M
0
20
40
60
120 168
Cufflinks
assembly
TAF1
RNA Polll
RefSeq
Figure 3 Excluding isoforms discovered by Cufflinks from the transcript abundance estimation 
affects the abundance estimates of known isoforms, in some cases by orders of magnitude. FHL3 
inhibits myogenesis by binding MyoD and attenuating its transcriptional activity. (a) The C2C12 
transcriptome contains a novel isoform that is dominant during proliferation. The new TSS for FHL3 
is supported by proximal TAF1 and RNA polymerase II ChIP-Seq peaks. (b) The known isoform (solid 
line) is preferred at time points following differentiation.
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
  advance online publication nature biotechnology
l e t t e r s
sharing a TSS produces the trajectory for their primary transcript, and 
we identified 401 (48%) genes with multiple distinct primary tran-
script trajectories. However, trajectory classification was not precise 
enough to prioritize further investigation into individual genes and 
could not form the basis for statistical significance testing.
We therefore formalized and quantified divergent expression pat-
terns of isoforms within and between TSS groups with an information- 
theoretic metric derived from the Jensen-Shannon divergence. With this 
metric, relative transcript abundances are represented as points along a 
logarithmic spiral in a real Hilbert space25, and as a result the distance 
between points measures the extent of change in relative expression. 
Quantification of expression change in this way revealed significant 
(FDR < 5%) differential transcriptional regulation and splicing in 882 
of 3,486 (25%) and 273 of 843 (32%) candidate genes, respectively, with 
70 genes showing both types of differential regulation (Supplementary 
Table 4). Myc (Fig. 2a,b) undergoes a shift in transcriptional regulation 
of transcript abundances to post-transcriptional control of abundances 
(Fig. 2c) between 60 h and 90 h, as myocytes are beginning to fuse 
into myotubes.
Focusing on the genes with significant promoter and isoform 
changes (FDR < 5%), we noted that in many cases changes in rela-
tive abundance reflected switch-like events in which there was an 
inversion of the dominant primary transcript. For example, in the 
gene encoding FHL3, a transcriptional regulator recently reported 
to inhibit myogenesis26, Cufflinks assembled the known isoform and 
another with a novel start site. We validated the 5′ exon of this isoform 
along with other novel start sites and splicing events by form-specific 
RT-PCR (Fig. 3a and Supplementary Methods, section 4). Limiting 
analysis to known isoforms would have produced an incorrect abun-
dance estimate for the known isoform of FHL3. Moreover, the novel 
isoform is dominant before differentiation, so this potentially impor-
tant differentiation-associated promoter switch would have been 
missed (Fig. 3b). In total, we tested and validated 153 of 185 puta-
tive novel TSSs by comparison against TAF1 and RNA polymerase II 
chromatin immunoprecipitation (ChIP)-Seq peaks.
We also observed switches in the major isoform of alternatively 
spliced genes. In total, 10% of multi-promoter genes featured a 
switch in major primary transcript, and 7% of alternatively spliced 
primary transcripts switched major isoforms. We concluded that not 
only does promoter switching have a substantial impact on mRNA 
output, but also many genes show evidence of post-transcriptionally 
induced expression changes, supporting a role for dynamic splicing 
regulation in myogenesis. A key question is whether genes that show 
divergent expression patterns of isoforms are differentially regulated 
in a particular system because they have isoforms that are functionally 
specialized for that system. Of the genes undergoing transcriptional 
or post-transcriptional isoform switches, 26% and 24%, respec-
tively, encode multiple distinct proteins according to annotation. 
We excluded genes with novel isoforms from the coding sequence 
analysis, so this fraction probably underestimates the impact of 
differential regulation on coding potential. We thus speculate that 
differential RNA level isoform regulation, whether transcriptional, 
post-transcriptional or mixed in underlying mechanism, suggests 
functional specialization of the isoforms in many genes.
Although Cufflinks was designed to investigate transcriptional and 
splicing regulation in this experiment, it is applicable to a broad range 
of RNA-Seq studies (Fig. 4). The open-source software runs on com-
monly available and inexpensive hardware, making it accessible to any 
researcher using RNA-Seq data. We are currently exploring the use 
of the Cufflinks assembler to annotate genomes of newly sequenced 
organisms and to quantify the effect of various mechanisms of gene 
regulation on expression. When coupled with assays of upstream 
regulatory activity, such as chromatin-state mapping or promoter 
occupancy, Cufflinks should help unveil the range of mechanisms 
governing RNA manufacture and processing.
MeTHOdS
Methods and any associated references are available in the online 
version of the paper at http://www.nature.com/naturebiotechnology/.
Accession code. NCBI Gene Expression Omnibus: The data dis-
cussed in this publication have been deposited with accession number 
GSE20846.
Note: Supplementary information is available on the Nature Biotechnology website.
ACKnoWLedGMenTS
This work was supported in part by the US National Institutes of Health (NIH) 
grants R01-LM006845 and ENCODE U54-HG004576, as well as the Beckman 
Foundation, the Bren Foundation, the Moore Foundation (Cell Center Program) 
and the Miller Research Institute. We thank I. Antosechken and L. Schaeffer of the 
Caltech Jacobs Genome Center for DNA sequencing, and D. Trout, B. King and 
H. Amrhein for data pipeline and database design, operation and display. We are 
grateful to R. K. Bradley, K. Datchev, I. Hallgrímsdóttir, J. Landolin, B. Langmead, 
A. Roberts, M. Schatz and D. Sturgill for helpful discussions.
AUTHoR ConTRIBUTIonS
C.T. and L.P. developed the mathematics and statistics and designed the  
algorithms; B.A.W. and G.K. performed the RNA-Seq and B.A.W. designed and 
executed experimental validations; C.T. implemented Cufflinks and Cuffdiff;  
G.P. implemented Cuffcompare; M.J.v.B. and A.M. tested the software; C.T., G.P. 
and A.M. performed the analysis; L.P., A.M. and B.J.W. conceived the project;  
C.T., L.P., A.M., B. J.W. and S.L.S. wrote the manuscript.
CoMPeTInG FInAnCIAL InTeReSTS
The authors declare no competing financial interests. 
Published online at http://www.nature.com/naturebiotechnology/.   
reprints and permissions information is available online at http://npg.nature.com/
reprintsandpermissions/.
a
100
80
60
40
20
0
P
er
ce
nt
 o
f f
in
al
 
tr
an
sc
rip
ts
 P
er
ce
nt
 o
f t
ra
ns
cr
ip
ts
 w
ith
in
 1
5%
 fi
na
l F
P
K
M
Reads (millions)
FPKM FPKM
0.01–3.74
3.75–7.49
7.5–14.99
15–29.99
30–59.99
60+
0.01–3.74
3.75–7.49
7.5–14.99
15–29.99
30–59.99
60+
Reads (millions)
0 40 80 100 120 1406020
b
100
80
60
40
20
0
0 40 80 1006020 120 140
Figure 4 Robustness of assembly and abundance estimation as a function 
of expression level and depth of sequencing. Subsets of the full 60-h 
read set were mapped and assembled with TopHat and Cufflinks, and 
the resulting assemblies were compared for structural and abundance 
agreement with the full 60-h assembly. Colored lines show the results 
obtained at different depths of sequencing in the full assembly; for 
example, the light blue line tracks the performance for transcripts with 
FPKM >60. (a) The fraction of transcript fragments fully recovered 
increases with additional sequencing data, although nearly 75% of 
moderately expressed transcripts (≥15 FPKM) are recovered with fewer 
than 40 million 75-bp paired-end reads (20 million fragments), a fraction 
of the data generated by a single run of the sequencer used in this experiment. (b) Abundance estimates are similarly robust. At 40 million reads, 
transcripts determined to be moderately expressed using all 60-h reads were estimated at within 15% of their final FPKM values.
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
nature biotechnology  advance online publication 
l e t t e r s
1. Cloonan, N. et al. Stem cell transcriptome profiling via massive-scale mRNA 
sequencing. Nat. Methods 5, 613–619 (2008).
2. Mortazavi, A., Williams, B.A., McCue, K., Schaeffer, L. & Wold, B. Mapping and 
quantifying mammalian transcriptomes by RNA-Seq. Nat. Methods 5, 621–628 
(2008).
3. Nagalakshmi, U., Wang, Z., Waern, K., Shou, C. & Raha, D. The transcriptional 
landscape of the yeast genome defined by RNA sequencing. Science 320, 
1344–1349 (2008).
4. Wang, E. et al. Alternative isoform regulation in human tissue transcriptomes. Nature 
456, 470–476 (2008).
5. Denoeud, F. et al. Annotating genomes with massive-scale RNA sequencing. Genome 
Biol. 9, R175 (2008).
6. Maher, C. et al. Transcriptome sequencing to detect gene fusions in cancer. Nature 
458, 97–101 (2009).
7. Marioni, J., Mason, C., Mane, S., Stephens, M. & Gilad, Y. RNA-seq: an assessment 
of technical reproducibility and comparison with gene expression arrays. Genome 
Res. 18, 1509–1517 (2008).
8. Hiller, D., Jiang, H., Xu, W. & Wong, W. Identifiability of isoform deconvolution from 
junction arrays and RNA-Seq. Bioinformatics 25, 3056–3059 (2009).
9. Jiang, H. & Wong, W.H. Statistical inferences for isoform expression in RNA-Seq. 
Bioinformatics 25, 1026–1032 (2009).
10. Li, B., Ruotti, V., Stewart, R.M., Thomson, J.A. & Dewey, C.N. RNA-Seq gene 
expression estimation with read mapping uncertainty. Bioinformatics 26, 493–500 
(2010).
11. Mortazavi, A., Williams, B., McCue, K., Schaeffer, L. & Wold, B. Mapping and 
quantifying mammalian transcriptomes by RNA-Seq. Nat. Methods 5, 621–628 
(2008).
12. Pepke, S., Wold, B. & Mortazavi, A. Computation for ChIP-Seq and RNA-Seq studies. 
Nat. Methods 6, S22–S32 (2009).
13. Yaffe, D. & Saxel, O. A myogenic cell line with altered serum requirements for 
differentiation. Differentiation 7, 159–166 (1977).
14. Yun, K. & Wold, B. Skeletal muscle determination and differentiation: story of a 
core regulatory network and its context. Curr. Opin. Cell Biol. 8, 877–889 
(1996).
15. Tapscott, S.J. The circuitry of a master switch: Myod and the regulation of skeletal 
muscle gene transcription. Development 132, 2685–2695 (2005).
16. Trapnell, C., Pachter, L. & Salzberg, S. TopHat: discovering splice junctions with 
RNA-Seq. Bioinformatics 25, 1105–1111 (2009).
17. Haas, B.J. et al. Improving the Arabidopsis genome annotation using maximal 
transcript alignment assemblies. Nucleic Acids Res. 31, 5654–5666 (2003).
18. Dilworth, R. A decomposition theorem for partially ordered sets. Ann. Math. 51, 
161–166 (1950).
19. Eriksson, N. et al. Viral population estimation using pyrosequencing. PLOS Comput. 
Biol. 4, e1000074 (2008).
20. Guttman, M. et al. Chromatin signature reveals over a thousand highly conserved 
large non-coding RNAs in mammals. Nature 458, 223–227 (2009).
21. Cordes, K.R. et al. miR-145 and miR-143 regulate smooth muscle cell fate and 
plasticity. Nature 460, 705–710 (2009).
22. Lareau, L.F., Inada, M., Green, R.E., Wengrod, J.C. & Brenner, S.E. Unproductive 
splicing of SR genes associated with highly conserved and ultraconserved DNA 
elements. Nature 446, 926–929 (2007).
23. Bullard, J., Purdom, E., Hansen, K., Durinck, S. & Dudoit, S. Evaluation of statistical 
methods for normalization and differential expression in mRNA-Seq experiments. 
BMC Bioinformatics 11, 94 (2010).
24. Endo, T. & Nadal-Ginard, B. Transcriptional and posttranscriptional control of c-myc 
during myogenesis: its mRNA remains inducible in differentiated cells and does 
not suppress the differentiated phenotype. Mol. Cell. Biol. 6, 1412–1421 
(1986).
25. Fuglede, B. & Topsøe, F. Jensen-Shannon divergence and Hilbert space embedding. in 
Proceedings of the IEEE International Symposium on Information Theory, 31 (2004).
26. Cottle, D.L., McGrath, M.J., Cowling, B.S. & Coghill, I.D. FHL3 binds MyoD and 
negatively regulates myotube formation. J. Cell Sci. 120, 1423–1435 (2007).
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
nature biotechnology doi:10.1038/nbt.1621
ONLINe MeTHOdS
RNA isolation. Mouse skeletal muscle C2C12 cells were initially plated on 
15-cm plates in DMEM with 20% FBS. At confluence, the cells were switched 
to low-serum medium to initiate myogenic differentiation. For extraction 
of total RNA, cells were first rinsed in PBS and then lysed in Trizol reagent 
(Invitrogen, catalog no. 15596-026), either during exponential growth in 
high-serum medium or at 60 h, 5 d and 7 d after medium shift. Residual 
contaminating genomic DNA was removed from the total RNA fraction using 
Turbo DNA-free (Ambion, catalog no. AM1907M). mRNA was isolated from 
DNA-free total RNA using the Dynabeads mRNA Purification Kit (Invitrogen, 
catalog no. 610-06).
Fragmentation and reverse transcription. Preparation of cDNA followed the 
procedure described previously2, with minor modifications as described below. 
Before fragmentation, a 7-µl aliquot (total mass ~500 pg) containing known 
concentrations of seven ‘spiked in’ control transcripts from Arabadopsis thaliana 
and the lambda phage genome were added to a 100-ng aliquot of mRNA from 
each time point. This mixture was then fragmented to an average length of 
200 nucleotides by metal-ion and heat-catalyzed hydrolysis. The hydrolysis 
was performed in a 25-µl volume at 94 °C for 90 s. The 5× hydrolyis buffer 
components were 200 mM Tris acetate, pH 8.2, 500 mM potassium acetate 
and 150 mM magnesium acetate. After removal of hydrolysis ions by G50 
Sephadex filtration (USA Scientific, catalog no. 1415-1602), the fragmented 
mRNA was randomly primed with hexamers and reverse-transcribed using 
the Super Script II cDNA synthesis kit (Invitrogen, catalog no. 11917010). 
After second-strand synthesis, the cDNA went through end-repair and ligation 
reactions according to the Illumina ChIP-Seq genomic DNA preparation kit 
protocol (Illumina, catalog no. IP102-1001), using the paired-end adapters 
and amplification primers (Illumina, catalog no. PE102-1004). Ligation of the 
adapters adds 94 bases to the length of the cDNA molecules.
Size selection. The cDNA library was size-fractionated on a 2% TAE low-melt 
agarose gel (Lonza, catalog no. 50080), with a 100-bp ladder (Roche, catalog 
no. 14703220) run in adjacent lanes. Before loading of the gel, the ligated 
cDNA library was taken over a G50 Sephadex column to remove excess salts 
that interfere with loading the sample in the wells. After staining of the gel in 
ethidium bromide, a narrow slice (~2 mm) of the cDNA lane centered at the 
300-bp marker was cut. The slice was extracted using the QiaEx II kit (Qiagen, 
catalog no. 20021), and the extract was filtered over a Microcon YM-100 
microconcentrator (Millipore, catalog no. 42409) to remove DNA fragments 
shorter than 100 bp. Filtration was performed by pipeting the extract into 
the upper chamber of a microconcentrator and adding ultra-pure water 
(Gibco, catalog no. 10977) to a final volume of 500 µl. The filter was spun at 
500g until only 50 µl remained in the upper chamber (about 20 min per spin) 
and then the upper chamber volume was replenished to 500 µl. This procedure 
was repeated six times. The filtered sample was then recovered from the filter 
chamber according to the manufacturer’s protocol. Fragment-length distribu-
tions obtained after size selection were estimated from the spike-in sequences 
and are shown in Supplementary Figure 1.
Amplification. One-sixth of the filtered sample volume was used as template 
for 15 cycles of amplification using the paired-end primers and amplification 
reagents supplied with the Illumina ChIP-Seq genomic DNA prep kit. The 
amplified product was cleaned up over a Qiaquick PCR column (Qiagen, cata-
log no. 28104), and then the filtration procedure using the Microcon YM-100 
microconcentrators described above was repeated, to remove both amplifica-
tion primers and amplification products shorter than 100 bp. A final pass over 
a G50 Sephadex column was performed, and the library was quantified using 
the Qubit fluorometer and PicoGreen quantification reagents (Invitrogen, cata-
log no. Q32853). The library was then used to build clusters on the Illumina 
flow cell according to protocol.
Mapping cDNA fragments to the genome. Fragments were mapped to build 
37.1 of the mouse genome using TopHat version 1.0.13. We extended our pre-
vious algorithms to exploit the longer paired reads used in the study. TopHat 
version 1.0.7 and later splits a read 75 bp or longer in three or more segments 
of approximately equal size (25 bp) and maps them independently. Reads with 
segments that can be mapped to the genome only noncontiguously are marked 
as possible intron-spanning reads. These ‘contiguously unmappable’ reads are 
used to build a set of possible introns in the transcriptome. TopHat accumu-
lates an index of potential splice junctions by examining segment mapping 
for all contiguously unmappable reads. For each junction, the program then 
concatenates 22 bp pairs upstream of the donor to 22 bp pairs downstream 
of the acceptor to form a synthetic spliced sequence around the junction. 
The segments of the contiguously unmappable reads are then aligned against 
these synthetic sequences with Bowtie. The resulting contiguous and spliced 
segment alignments for these reads are merged to form complete alignments 
to the genome, each spanning one or more splice junctions. Further details 
of how version 1.0.13 of TopHat differs from the published algorithm are 
provided in section 2 of the Supplementary Methods.
Transcript abundance estimation. We estimated transcript abundances using 
a generative statistical model of RNA-Seq experiments. The model was para-
meterized by the relative abundances of the set of all transcripts in a sample. 
For computational convenience, abundances of non-overlapping transcripts 
in disjoint genomic loci were calculated independently. The parameters of the 
model were the non-negative abundances ρt. Denoting the fragment distribu-
tion by F, we defined the effective length of a transcript to be:  
l t F i l t i
i
l t
( ) ( )( ( ) )
( )
= − +
=
∑ 1
1
where l(t) is the length of a transcript. The likelihood function for our model 
was then given by:  
L R
l t
l u
F I r
l t I r
t
u
u T
t Tr R
t
t
( | )
( )
( )
( ( ))
( ) ( )
r r
r
=
− +




∈
∈∈ ∑
∑∏
1
where the products were over all fragment alignments R and transcripts T in 
the transcriptome, and It(r) was the implied length of a fragment determined 
by a pair of reads assuming it originated from transcript t (Supplementary 
Fig. 2). This is the likelihood function for a non-negative linear model, and 
therefore, the likelihood function had a unique maximum, which our imple-
mentation calculated via a numerical optimization procedure. Rather than 
reporting this estimate, we instead found the maximum a posteriori (MAP) 
estimate using a Bayesian inference procedure based on importance sampling 
from the posterior distribution. The proposal distribution we used was multi-
variate normal, with a mean given by the maximum likelihood estimate 
discussed above, and the variance-covariance matrix given by the inverse of the 
observed Fisher information matrix. The samples were also used to compute 
95% confidence intervals for the MAP estimates. The MAP estimates and (and 
associated confidence intervals) were used for differential expression testing.
Abundances were reported in FPKM (expected fragments per kilobase of tran-
script per million fragments sequenced). This unit is a scalar multiple of the para-
meters ρt. FPKM is conceptually analogous to the reads per kilobase per million 
reads sequenced (RPKM) measure, but it explicitly accommodates sequencing 
data with one, two or—if needed for future sequencing platforms—higher 
numbers of reads from single source molecules.
Abundance estimates were validated using spike-in sequences 
(Supplementary Fig. 3) and simulations (Supplementary Fig. 4). To confirm 
that all transcripts of a gene are necessary for accurate abundance estimation, 
novel transcripts were removed from the analysis (Supplementary Fig. 5), 
showing that resulting estimates may be biased.
Transcript assembly. Transcripts were assembled from the mapped fragments 
sorted by reference position. Fragments were first divided into non-overlapping 
loci, and each locus was assembled independently of the others using the 
Cufflinks assembler. The assembler was designed to find the minimal number 
of transcripts that ‘explain’ the reads (that is, every read should be contained in 
some transcript). First, erroneous spliced alignments or reads from incompletely 
spliced RNAs were filtered out. The algorithm for assembly was based on a con-
structive proof of Dilworth’s Theorem (Supplementary Methods, appendix A, 
theorem 17). Each fragment alignment was assigned a node in an ‘overlap 
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
nature biotechnologydoi:10.1038/nbt.1621
graph’ G. A directed edge (x,y) was placed between nodes x and y when the 
alignment for x started at a lower coordinate than y, the alignments overlapped 
in the genome and the fragments were ‘compatible’ (Supplementary Fig. 6). 
Compatibility was defined for overlapping fragments for which every implied 
intron in one fragment matched an identical implied intron in the other frag-
ment. The resulting directed, acyclic graph was transitively reduced to produce G, 
to avoid including redundant path information. Cufflinks then found a mini-
mum path cover of G, meaning that every fragment node was contained in some 
path in the cover, and the cover contained as few paths as possible. Each path in 
the cover corresponded to a set of mutually compatible fragments overlapping 
each other on the left and right (except initial and terminal fragments on the 
path). Dilworth’s theorem implied that this path cover could be constructed by 
first finding the largest set of fragments with the property that no two are com-
patible. This set was determined by finding a maximum matching in a bipartite 
graph constructed from the transitive closure of G. The bipartite ‘reachability 
graph’ had a node in each partition for all fragments in G, and nodes were con-
nected if there was a path between them in G. Given a maximum cardinality 
matching M, any fragment without an incident edge in M was a member of an 
‘antichain’. Each member of this antichain could be extended to a path, and this 
extension was a minimum path cover of G.
The minimum cardinality chain decomposition computed using the 
approach described above was not guaranteed to be unique. To ‘phase’ distant 
exons, we leveraged the fact that abundance in homogeneities could link dis-
tant exons by their coverage. We therefore weighted the edges of the bipartite 
reachability graph on the basis of the percent-spliced-in metric introduced 
previously4. Cufflinks arbitrated between multiple parsimonious assemblies 
by choosing the minimum-cost maximum matching in the reachability graph. 
In our setting, the percent-spliced-in ψx for an alignment x was computed 
by counting the alignments overlapping x in the genome that were compat-
ible with x, dividing by the total number of alignments that overlap x, and 
then normalizing for the length of the x. The cost C(y, z) assigned to an edge 
between alignments y and z reflected the belief that they originated from dif-
ferent transcripts:  
C y z y z( , ) log( ).= − − −1 y y
A useful feature of the Cufflinks assemblies is that they resulted in provably iden-
tifiable models. Complete details of the Cufflinks assembler are provided in the 
Supplementary Methods (section 4), along with proofs of several key theorems.
Structural comparison of time point assemblies. To validate Cufflinks trans-
frags (assembled transcript fragments) against annotated transcriptomes, and 
also to find transfrags common to multiple assemblies, we developed a tool called 
‘Cuffcompare’ that builds structural equivalence classes of transcripts. We ran 
Cuffcompare on the assembly from each time point against the combined anno-
tated transcriptomes of UCSC, Ensembl and VEGA (Supplementary Fig. 7). 
Because of the stochastic nature of sequencing, assembly of the same transcript 
in two different samples may result in transfrags of slightly different lengths. 
A Cufflinks transfrag was considered a complete match when there was a tran-
script with an identical chain of introns in the combined annotation. When no 
complete match was found between a Cufflinks transfrag and the transcripts 
in the combined annotation, Cuffcompare determined and reported whether 
there was another potentially significant relationship with any of the annota-
tion transcripts that could be found in or around the same genomic locus.
Assembly and abundance robustness analysis. A total of 61,787,833 cDNA 
fragments were sequenced at 60 h. We mapped and assembled subsets of these 
fragments (at fractions 1/64, 1/32, 1/16, 1/8, 1/4 and 1/2 of the total) using 
TopHat and Cufflinks. Each assembly of parts of the data was compared to the 
assembly obtained with the full fragment set using Cuffcompare. We counted 
transcripts recovered in assemblies from partial data that structurally matched 
some transcripts in the assembly using all the reads. We assessed robustness 
of abundance estimation by counting the fraction of assembled transcripts 
that were assigned abundances within 15% of the FPKM value reported for 
the full fragment set transcript.
Simulation-based validation. To assess the accuracy of the Cufflinks esti-
mates, we simulated an RNA-Seq experiment using the FluxSimulator27, a 
freely available software package that models whole-transcriptome sequencing 
experiments with the Illumina Genome Analyzer. The software works by first 
randomly assigning expression values to the transcripts provided by the user, 
constructing an amplified, size-selected library, and then sequencing it. Mouse 
UCSC transcripts were supplied to the software, along with build 37.1 of the 
genome. FluxSimulator then randomly assigned expression levels to 18,935 
UCSC transcripts. From these relative expression levels, the software con-
structed an in silico RNA-Seq sample, with each transcript assigned a number 
of library molecules according to its abundance. FluxSimulator produced 
13,203,516 75-bp paired-end RNA-Seq reads from 6,601,805 library fragments, 
which were mapped with TopHat to the mouse genome using identical para-
meters to those used to map the C2C12 reads. A total of 6,176,961 fragments 
were mapped (93% of the library). These alignments were supplied along 
with the exact set of expressed transcripts to Cufflinks, to measure Cufflinks’ 
abundance estimation accuracy when working with a ‘perfect’ assembly.
Validation of novel transcription start sites. Transcripts with 5′ exons not 
in the UCSC, Ensembl or VEGA annotations were selected for validation. We 
excluded transcripts with estimated abundances of <5.0 FPKM at all time 
points, as well as those with a 5′ exon within 200 bp of an annotated exon. To 
validate our novel observed 5′ exons, we conducted ChIP-Seq experiments as 
described28 at −24 h and 60 h time points using an antibody to the unphospho-
rylated C-terminal domain repeat of RNA polymerase II (8WG16, Covance) 
as well as an antibody to TAF1 (SC-735, Santa Cruz), which marks promot-
ers. For each candidate 5′ end, we took the region ±200 bp and measured the 
normalized read density (RPKM) of each ChIP-Seq, requiring at ≥1.5 RPKM 
of ChIP-Seq signal for both polymerase and TAF1 at either time point.
End point RT-PCR validation of novel isoforms. Six genes with multiple 
assembled splice isoforms were chosen as cases for end point PCR valida-
tion, including three with novel isoforms (Supplementary Figs. 8 and 9). 
Amplification primers that cross the Cufflinks-predicted spliced-exon junc-
tions were purchased from Integrated DNA Technologies, Inc. For each time 
point, 5 µg of total RNA was primed with oligo(dT)20 (Invitrogen, catalog 
no. 18418020) and reverse transcribed at 50 °C using SuperScript III reverse 
transcriptase (Invitrogen, catalog no. 18080044) according to the manufac-
turer’s protocol. One-tenth of the cDNA reaction was used as template for 
35 rounds of PCR amplification with each pair of junction-crossing primers. 
The PCR reactions were cleaned up using the Qiaquick PCR cleanup kit 
(Qiagen, catalog no. 28104) and quantified using a Nanodrop spectrophoto-
meter. An equal mass (50 ng) of DNA from each reaction was then loaded 
in each lane of a 2.0% agarose gel, post-stained with Sybr Gold (Invitrogen, 
catalog no. S11494) and visualized on a UV transilluminator.
Analysis of gene expression and regulation dynamics. To test for divergent 
expression dynamics among isoforms, we tested all high-confidence isoforms 
for significant changes between each time point using the variance estimates 
produced by our statistical model (FDR < 5%). Trajectories were assigned to 
transcript expression curves on the basis of significant (FDR < 5%) increases 
or decreases in expression between consecutive time points. To be deemed 
significant, expression between consecutive time points also had to change 
by at least 25%. The possible trajectories were therefore reduced to 81 combi-
natorial possibilities (increasing, decreasing or flat between any of the three 
pairs of consecutive time points). Trajectories were then classified into four 
groups: increasing (three consecutive increases), decreasing (three consecu-
tive decreases), flat (no changes) and mixed (presence of both increases and 
decreases in expression along the time course). To test for significant changes 
in the relative abundance of a group of transcripts, we calculated the square 
root of the Jensen-Shannon divergence on the relative abundances in each of 
two time points. The variance of this metric under the null hypothesis of no 
change in relative abundance can be estimated using the delta method from 
the variance-covariance matrix on abundances estimates. Using the estimated 
variance of the Jensen-Shannon metric, we applied a one-sided t-test for sig-
nificant changes in relative abundance of transcripts grouped by TSS and also 
primary transcripts grouped by gene. Type I errors were controlled with the 
Benjamini-Hochberg correction for multiple testing of differential expression, 
splicing and promoter preference throughout the analysis. Supplementary 
©
20
10
 N
at
u
re
 A
m
er
ic
a,
 In
c.
  A
ll 
ri
g
h
ts
 r
es
er
ve
d
.
nature biotechnology doi:10.1038/nbt.1621
Figures 10 and 11 show examples of genes with significant changes in relative 
transcript abundances during the time course.
Software availability. TopHat (http://tophat.cbcb.umd.edu) is freely available 
as source code. It takes a reference genome (as a Bowtie29 index) and RNA-Seq 
reads as FASTA or FASTQ and produces alignments in SAM30 format. TopHat 
is distributed under the Artistic License and runs on Linux and Mac OS X.
The Cufflinks assembler and abundance estimation algorithms (http:// 
cufflinks.cbcb.umd.edu/) are open-source C++ programs and are freely available 
in both source and binary. The package includes the assembler along with utilities 
to structurally compare Cufflinks output between samples (Cuffcompare) and 
to perform differential expression testing (Cuffdiff). Cufflinks is distributed 
under the Boost License and runs on Linux and Mac OS X. The source code for 
Cufflinks version 0.8.0 is provided in Supplementary Data 3.
27. Sammeth, M., Lacroix, V., Ribeca, P. & Guigó, R. The FLUX Simulator. <http://flux.
sammeth.net>.
28. Johnson, D., Mortazavi, A., Myers, R. & Wold, B. Genome-wide mapping of in vivo 
protein-DNA interactions. Science 316, 1497–1502 (2007).
29. Langmead, B., Trapnell, C., Pop, M. & Salzberg, S. Ultrafast and memory-efficient 
alignment of short DNA sequences to the human genome. Genome Biol. 10, R25 
(2009).
30. Li, H. et al. The sequence alignment/map format and SAMtools. Bioinformatics 25, 
2078–2079 (2009).

