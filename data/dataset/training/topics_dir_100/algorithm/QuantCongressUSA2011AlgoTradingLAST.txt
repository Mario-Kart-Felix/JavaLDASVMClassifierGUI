Algorithmic and High-frequency 
trading: an overview 
Marco Avellaneda 
New York University & 
Finance Concepts LLC 
Quant Congress USA 2011  
0
10
20
30
40
50
60
70
80
90
2005 2006 2007 2008 2009 2010
P
er
ce
n
ta
g
e 
o
f 
E
q
u
it
y
 V
o
lu
m
e
High Touch Orders Algorithmic (Auto Trading) DMA
US Equities markets: percentage of 
orders generated by algorithms 
 US Equities volumes: 5 and 10 billion shares per day 
 
  1.2 – 2.5 Trillion shares per year 
 
 Annual volume: USD 30 – 70 trillion 
 
 At least 30% of the volume is algorithmic: 360 a 750 billion shares/year 
 
  Typical large ``sell side’’ broker trades between  1 and 5 USD Tri per year using algos 
 
 Each day,  between 15,000 and 3,000 orders are processed 
 
 An algorithmic execution strategy can be divided into 500 – 1,000 small daughter 
orders 
The market in numbers 
 Algorithmic trading: the use of programs and computers to generate and execute 
(large) orders in markets with electronic access. 
 
 Orders come from institutional investors, hedge funds and Wall Street trading desks 
 
 The main objective of algo trading is not necessarily to maximize profits but rather 
         to control execution costs and market risk.  
 
 Algorithms started as tools for institutional investors in the beginning of the 1990s. 
Decimalization,  direct market access (DMA), 100% electronic exchanges,  reduction 
of commissions and exchange fees, rebates, the creation of new markets aside from 
NYSE and  NASDAQ and Reg NMS led to an explosion of algorithmic trading and the 
beginning of the decade. 
         
        Today, brokers compete actively for the commission pool associated with 
algorithmic trading around the globe – a business estimated at USD 400 to 600 
million per year. 
  
Algorithmic trading 
 Institutional clients need to trade large amounts of stocks . These amounts are often 
larger than what the market can absorb without impacting the price. 
 
 The demand for a large amount of liquidity will typically affect the cost of the  trade 
in a negative fashion  (``slippage’’) 
 
 Large orders need to be split into smaller orders which will be executed  
electronically over the course of minutes, hours, day. 
 
 The procedure for executing this order will affect the average cost per share, 
according to which algorithm is used. 
 
 In order to evaluate an algorithm,  we should compare the average price obtained by 
         trading with a market benchmark  (``global average’’ of the daily price, closing price,  
         opening price, ``alpha decay’’ of a quant strategy, etc). 
 
Why Algorithms? 
 The decision of how to split the order in smaller pieces is just one of several issues. 
 
 
 Once an algo is chosen the smaller orders need to be executed electronically 
 
 
 Execution strategies interact with the market and decide how to place orders (Limit, 
Market,etc)  and at what prices 
 
 Objective: to achieve the ``best price’’ for each daughter order 
 
 Recent changes in the US equity market structure (in particular,  different liquidity sources)  
        make things more interesting and complicated 
 
 Dark Pools (liquidity pools that do  not show the order book), ECNs (electronic 
communications networks),  autonomous liquidity providers 
Main issues in Algorithmic Trading 
Broker 
 
Client 
1. ``Ancient’’ brokerage model 
Market 
Phone or internet 
 portal 
Order communicated 
 to the floor  Old way of doing business 
Broker 
 
Client 
2. Electronic market 
Market 
Telephone or  
 internet site 
 100% automatic 
 execution algo interacting 
 with order book 
Electronic order-management and execution 
system  (client-broker) 
Client builds an order ticket which is 
 communicated to the broker that executes it 
 accordingly 
Broker 
 
Client 
3. Electronic execution model with API 
Market 
 Program-generated 
 orders (API) 
 Algorithmic execution 
.placeOrder(1, IBM, BUY, $85.25, 200…) 
… 
… 
.placeOrder(2, IBM, SELL, $84.25, 100…) 
… 
 
 
Broker 
 
Client 
4. Direct Market Access (DMA) 
Market 
 Client sends orders 
 directly to the market 
 
 Client interacts directly 
 with the market order  
  book 
ECNs, Dark Pools, Multiple Execution 
Venues 
Brokerage 
 
Client 
NYSE NASDAQ BATS 
``Smart routing’’: algorithms 
 look for the best venue to 
 trade, in case more than   
 one venue is available 
A few trading venues for US equity markets  
• ARCA-NYSE:  electronic platform of  NYSE (ex- Archipelago) 
 
• BATS:  (Kansas) 
 
• BEX: Boston Equity Exchange 
 
• CBSX: CBOE Stock Exchange 
 
• CSXZ: Chicago Stock Exchange 
 
•DRCTEDGE: Direct Edge (Jersey City, NJ) 
 
• ISE: International Securities Exchange 
 
• ISLAND: Acquired by Nasdaq in 2003 
 
• LAVA: belongs to  Citigroup 
 
• NSX: National Stock Exchange (Chicago) 
 
• NYSE: New York Stock Exchange 
 
•TRACKECN: Track ECN 
Reg NMS (``National market system’’) 
 
 
Order Protection Rule (Trade-thru rule) - protects visible liquidity at the top of 
book of automated market centers (SROs + ADF participants) from being traded 
through by executions outside each market's BBO.  
 
Access Rule - caps access fees for top of book access at $.003  
 
Sub-Penny Rule - prohibits market centers from accepting quotes or orders in 
fractions under $.01 for any security priced greater than $1.00.  
 
Market Data Rule - changes the allocation of market data revenue to SROs for 
quotes and trades  
 SRO: NYSE, NASD, FINRA 
 ADF: Alternative Display Facility/ consolidation of NYSE/NASDAQ 
Algorithmic trading strategy 
(Macrotrader) 
Smart routing  in case of more than one available 
Trading venue 
Order placing algorithms 
(Microtrader) 
The three steps in algorithmic trading 
Time-weighted average price (TWAP) 
Equal amount of shares in each period of time. 
 
Example: 100,000 shares TWAP/all day   
1300 
500 
5-minute consecutive intervals 
Volume-weighted average price 
(VWAP) 
Volume is greater in the beginning and at the end of the day  
Volume-weighted average price 
(VWAP) 
 Volume changes in the course of the day (less volume in the middle). 
 
 VWAP: To execute a large order, the way in which we split it  
 depends on the time of day (minimize impact) 
 
 Objetive: obtain an average price ``weighted by volume’’  
 
 Algorithm:  
  1. estimate the average volume traded in every 5 minute interval 
  2. In each time-interval, execute an amount proportional to the normative volume  
   for that interval 
 
 Properties:  
 1.  the algorithm always concludes (trade sizes are known in advance) 
 2.  volume function is estimated using historical data. This may not correspond 
       exactly to ex-post VWAP. 
  
0.0%
0.5%
1.0%
1.5%
2.0%
2.5%
3.0%
0
500
1,000
1,500
2,000
2,500
3,000
9
:3
0
9
:4
5
1
0
:0
0
1
0
:1
5
1
0
:3
0
1
0
:4
5
1
1
:0
0
1
1
:1
5
1
1
:3
0
1
1
:4
5
1
2
:0
0
1
2
:1
5
1
2
:3
0
1
2
:4
5
1
3
:0
0
1
3
:1
5
1
3
:3
0
1
3
:4
5
1
4
:0
0
1
4
:1
5
1
4
:3
0
1
4
:4
5
1
5
:0
0
1
5
:1
5
1
5
:3
0
1
5
:4
5
%
 o
f 
D
a
y
 V
o
lu
m
e
S
h
a
re
s
Time
VWAP Trading
Volume Prof ile





2
1
2
1
)(
)()(
),( 21 t
tt
t
tt
tV
tPtV
ttVWAP


 The  PoV (Percentage of Volume) algorithm addresses the problem of  VWAP by using the 
actual traded volume of the day as benchmark. The idea is to have a contant percentage  
participation in the market along the trading period. 
 
 If the quantity that remains to be traded is  Q,  and the participation ratio is       , the algo 
algo computes the volume V traded in the period  (t- ΔT, t)  and executes a quantity 
          q = min(Q,V*  ) 
 
  
Percentage of Volume (POV) 


0
500
1000
1500
2000
2500
3000
9:30 10:05 10:40 11:15 11:50 12:25 13:00 13:35 14:10 14:45 15:20
S
h
a
re
s
Time
Pov Trading
Traded Volume
  
 
 
         
   
 
)( 
0
)(
                           
)( )(      )( )(
0       0         
0     ;         0
0  ;      
)(,)()(min)()(
quantity) initial  )0( (   traded.be remain to that shares ofnumber  )(
  time toupmarket  in the  traded volume total)(
00
00
TV
tp
dt
dV
Q
tp
dt
dQ
tp
dt
dV
tp
dt
dQ
tp
dt
dV
tp
dt
dQ
TVQTVQTQ
dt
dV
dt
dQ
t
dt
dV
tQ
dt
dQ
t
dt
dV
tQ
dt
dV
dt
dQ
tQttVtVtQttQ
QtQ
ttV
TT
TT




















 POV  is similar to 
 WVAP if ratio is small 
 
(Or is it? More later ) 
Almgren-Chriss (``Expected Shortfall’’) 
     
 
   
 
     
    
 VE
dttQQV
dt
dt
tdQ
b
dt
tdQ
tpdt
dt
tdQ
tpE
tvbtptp
dt
tdQ
tvtdZdttavtdp
Q
T
TTT






























min                                                 
0
)(
)(
        )(
0
22
2
000
EE
     Dynamic price model with  
      price impact (`permanent 
      impact’) 
Execution price (`temporary impact’) 
Expected execution 
 cost 
Execution risk 
Optimization problem 
Market impact combined  with ``urgency in execution’’ ( price risk) 
Analytic solution 
   
 
 
 
  
T
t
ba
T
Q
tQ
T
ba
tT
ba
QtQ






























    ,        ,
sinh
1sinh
0
                         
sinh
sinh
0
2
2
2
Omega: proportional to execution time, varies directly with risk-aversion and  
 volatility, inversely to market impact elasticities 
 
                                Omega = (price risk)/(impact risk) 
  Case   , TWAP (VWAP) 
Q
u
an
ti
ty
 t
h
at
 
 r
em
ai
n
s 
to
 t
ra
d
e
 
Time elapsed 
0
 Impact risk >> 
  price risk 
 
  
 
Algorithm= TWAP or 
 VWAP 
 
   
  
Case    
Sh
ar
es
 r
em
ai
n
in
g 
Time elapsed 
10
Significant market risk 
 
  
 Execution must be 
 faster 
                     Case   
Sh
ar
es
 r
em
ai
n
in
g 
Time elapsed 
20
Faster execution 
                     Case  
Sh
ar
es
 r
em
ai
n
in
g 
Time elapsed 
100
``Slam’’ the market! 
Generalizations of Almgren-Chriss 
order-splitting algorithm 
 Incorporate intraday volume in the impact model  (modification of VWAP) 
 
 Incorporate drift in the  price model (momentum) 
 
 Incorporate exchange fees, rebates and other costs 
 
 Almgren-Chriss & generalizations are now part of the standard toolkit that 
   execution brokers offer to clients 
Examples of quant strategies   
that make use of algorithms 
 
 Index and ETF arbitrage 
 
 Statistical arbitrage (``Stat Arb’’) 
 
  Liquidity providing  (``Market making’’) 
 
 Volume providing (``High-frequency, selective, market-making’’) 
 
 High frequency trading and price forecasting 
ETFs 
-- ETF: similar to mutual funds (holding vehicles) but which trade like stocks 
 
--  Short-selling, margin financing allowed. 
 
-- Began like equity index & basket  trackers, then generalized to currencies and  
    commodities  
 
-- Authorized participants may create or redeem ETF shares at NAV, enforcing the  
    theoretical relationship between the ETF and the underlying basket 
 
-- ``creation units’’: 25K to 100K shares 
 
-- Authorized participants are typically market-makers in the ETFs (but not always). 
 Arbitrage of  ETFs against the underlying basket 
Stock 1 
ETF 
Stock N 
Stock 3 
Stock 2 
* 
* 
* 
* 
  
  
1. Buy/sell ETF  
 against the underlying share holdings 
 
 2. Creation/redemption of ETFs 
     to close the trade 
 This requires high-frequency algorithmic 
 trading to lock-in arbitrage opportunities 
Statistical Arbitrage 
Long-short shares/etfs – market neutral 
Sector ETF Num of Stocks 
   Market Cap        unit: 1M/usd  
 Average   Max   Min  
Internet HHH 22                           10,350                   104,500                                 1,047  
Real Estate IYR 87                             4,789                      47,030                                 1,059  
Transportation IYT 46                             4,575                      49,910                                 1,089  
Oil Exploration OIH 42                             7,059                      71,660                                 1,010  
Regional Banks RKH 69                           23,080                   271,500                                 1,037  
Retail RTH 60                           13,290                   198,200                                 1,022  
Semiconductors SMH 55                             7,303                   117,300                                 1,033  
Utilities UTH 75                             7,320                      41,890                                 1,049  
Energy XLE 75                           17,800                   432,200                                 1,035  
Financial XLF 210                             9,960                   187,600                                 1,000  
Industrial XLI 141                           10,770                   391,400                                 1,034  
Technology XLK 158                           12,750                   293,500                                 1,008  
Consumer Staples XLP 61                           17,730                   204,500                                 1,016  
Healthcare XLV 109                           14,390                   192,500                                 1,025  
Consumer discretionary XLY 207                             8,204                   104,500                                 1,007  
Total   1417                           11,291                   432,200                                 1,000  
January, 2007 
 
 
 
 
 
   
      tdWdttXmtdX
tdXdtt
t
tI
tdI
tS
tdS
iiiiii
iii
ii
i
i






Statistical Arbitrage (II) 
Example of sampling window =3 months (~ 60 business days) 
 Stock return is compared to the return on 
 the corresponding sector ETF (regression,  
  co-integration) 
 Residuals: modeled as a mean-reverting 
 process 
Ornstein-Ulembeck 
 ( AR-1) 
 systematic 
 component 
  idiosyncratic 
  component 
 X(t) process for JPM/XLF (Financial sector ETF 
from State Street) 
-3
-2
-1
0
1
2
3
Constructing Stat Arb strategies  
 
-- Diversified universe of stocks, ``good choice ’’ of shares/ETF pairs 
 
-- Buy or sell the spread (pair) according to the statistical model 
 
-- Risk-management using real-time VaR 
 
-- Execution: VWAP  
 
-- Taking volume into account is important  to avoid ``adverse selection’’  
     (the reason for divergence of X(t) in practice) 
Example of Stat-Arb portfolio 
ETF 
Liquidity providing 
Strategic placing of limit/cancel orders (liquidity) in the order book  
l Liquidity providing (high frequency) 
HF Pairs trading?  Intraday evolution of FAZ & FAZ 
(inverse leveraged ETFs) 
  
Algorithmic trading and 
the ``flash crash’’ (May 6, 2010) 
5 de Maio 2010 
 The reasons behind the ``crash of 2:15’’ were studied in a joint CFTC/SEC report  
  available online. 
 Institutional trader sold 75,000 S&P E-mini contracts in 15 minutes PoV. 
 * Drop in S&P futures, SPY etf, etf components 
 * Withdrawal of autonomous MMs; ``stub quotes’’ 
 * HFTs provide a lot of volume but not a lot of liquidity (`hot potato trading’) 
Forecasting prices in  HF? 
• Models for the dynamics of order books 
 
• Modeling hidden liquidity in the market (not visible in the OB) 
 
• Computing the probabilities of price changes (up or down) 
   given liquidity on the bid side and ask-side 
   (Avellaneda, Stoikov, Reed, 2010: pre-published in SSRN, Oct-10) 
     
Bid Q(bid)=x Ask  Q(ask)=y 
100.01 527 100.03 31 
 
)(2 yxH
xH
P



 Simple formula that 
 we are testing with HF 
 data 
H= ``hidden liquidity’’ 
Price level 
Bid – 1 tick Best bid (Y) Best ask (X) Ask + 1 tick 
Price level 
New Bid 
- 1 tick 
New Bid (Y) New ask 
Price level 
Bid – 1 tick Best bid (Y) Best ask (X) Ask + 1 tick 
Level 1 Quotes 
Quote size depletion may be a precursor for a price move. 
Does imbalance predict prices? 
(-1,0) (+1,0) 
(0,+1) 
(0,-1) 
(0, 0) 
Bid size  increases 
Ask size  increases 
Mathematical framework: Diffusion  
Approximation for Quote Sizes (Level I) 
y 
x 
X= bid size 
Y = ask size 
  dtdZdWE
ZY
WX
tt
tt
tt






   
t=T_0 
t=T_1 
  A price change occurs when (i) one of the sizes vanishes and  
 (ii) either there is a new bid or a new ask level 
Probability that the Ask queue depletes before the Bid queue 
 
 
 
   HyHxuHyxp
yx
x
yxu
y
x
yxu
yx
xy
yxu


















































,,,
,            1
tan
2
,            0
1
1
tan
1
1
tan
1
2
1
,
1
1
1







 Probability 
 of an upward 
 price change. 
 
 H=`hidden liquidity’. 
Estimating hidden liquidity in different 
exchanges (ability to forecast price moves) 
symbol date time bid ask bsize asize exchange
QQQQ 1/4/2010 9:30:23 46.32 46.33 258 242 T
QQQQ 1/4/2010 9:30:23 46.32 46.33 260 242 T
QQQQ 1/4/2010 9:30:23 46.32 46.33 264 242 T
QQQQ 1/4/2010 9:30:24 46.32 46.33 210 271 P
QQQQ 1/4/2010 9:30:24 46.32 46.33 210 271 P
QQQQ 1/4/2010 9:30:24 46.32 46.33 161 271 P
Sample data 
Ticker NASDAQ NYSE BATS
XLF 0.15 0.17 0.17
QQQQ 0.21 0.04 0.18
JPM 0.17 0.17 0.11
AAPL (s=1) 0.16 0.9 0.65
AAPL (s=2) 0.31 0.6 0.64
AAPL (s=3) 0.31 0.69 0.63
Estimated H across markets 
Estimation Procedure 
• Separate the data by exchange 
 
• One trading day at a time 
 
• Bucket the quotes (bid size, ask size) by deciles 
 
• For each bucket (i,j) compute the frequency of price increases u_ij 
 
• Count the number of occurrences of each bucket d_ij 
 
• Perform a least-squares fit with the model 
 
2
10
1 1
1
,
1
1
tan
21
1
tan
1
2
1
min
 




















































ij
ijij
H
Hij
ij
ud





Empirical Probabilities for upward price move 
conditional on the quote (XLF) 
Fitted model (XLF)  
Difference between empirical and 
fitted probabilities 
Estimating hidden liquidity (H) across 
exchanges 
Ticker NASDAQ NYSE BATS 
XLF 0.15 0.17 0.17 
QQQQ 0.21 0.04 0.18 
JPM 0.17 0.17 0.11 
AAPL (s=1) 0.16 0.9 0.65 
AAPL  (s=2) 0.31 0.6 0.64 
AAPL (s=3) 0.31 0.69 0.63 
Is H stable? 
USD-BRL Futures (DOLc1) 
Bovespa Index Futures (INDc1) 
Mini Bovespa Index Futures (WINc1) 
Conclusions 
•   Over 50% of all trades in the US equity markets are algorithmic. Algorithmic execution of  
    block trades is an important tool allowing for systematic and disciplined execution of size 
 
• The main idea is to split large orders into smaller ones according to available market 
  liquidity, generally following volume (TWAP, VWAP, PoV) 
 
• Algorithmic trading is essential to implement quant strategies such as stat arb and 
   ETF arb 
 
• With DMA and low-latency trading, we see the emergence of autonomous market-makers 
 
• HFT traders provide volume but not necessarily liquidity when needed. Neither  
   do the autonomous MMs (flash crash).  Can we detect ``good liquidity’’ ? 
 
• Regulation on HFT and electronic market-making is being drafted and implemented as we 
  speak. Recently, stub quotes were forbidden by the SEC. Other measures to regulate  HF 
  trading will follow. 
 
•  Algorithmic trading, DMA, autonomous market-making and HFT are here to stay and are 
       rapidly expanding to new markets in Asia and Latin America. 

