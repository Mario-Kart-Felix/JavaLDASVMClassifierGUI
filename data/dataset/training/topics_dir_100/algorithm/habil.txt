Discrete Structures, Algorithms, and Applications
Sascha Kurz
Juli 2008

Habilitationsschrift
Discrete Structures, Algorithms, and Applications
Zur Erlangung der Lehrbefugnis im Fachgebiet Mathematik
der Fakultät Mathematik, Physik und Informatik
der Universität Bayreuth
vorgelegt von
Sascha Kurz
Bayreuth, Juli 2008

Contents
1 Introduction 5
1 Mathematics in the computer age . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2 Facing the discrete nature of some mathematical problem types . . . . . . . . . . . . . . . . . . . . . . . . . 6
3 Discrete Structures, Algorithms, and Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
4 Polyominoes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
5 Integral point sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
6 Extremal graph theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
7 Allocation optimization of a fashion discounter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
8 The bounded confidence model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
9 Place of publication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2 Counting polyominoes with minimum perimeter 13
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2 Proof of the main theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
3 Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
3 Convex hulls of polyominoes 19
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
2 The planar case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
3 Dimensions d > 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
4 Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
4 Enumeration of integral tetrahedra 27
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
2 Number of integral tetrahedra . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
3 Bounds for P3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
4 Orderly generation of integral tetrahedra . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
5 Canonicity check . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
6 Dimensionsm > 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
5 Integral point sets over Zmn 33
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
2 Integral point sets over Zmn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
3 Integral point sets over (R/Zn)2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
4 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
6 There are integral heptagons, no three points on a line, no four on a circle 43
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
2 Integral heptagons in general position . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
3 Open problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
1
7 Integral point sets over finite fields 47
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
2 Integral point sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
3 Automorphism group of the plane R2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
4 Maximal integral point sets in the plane F2q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
5 Maximal integral point sets in the plane Z2n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
6 Maximal integral point sets without three collinear points . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
7 Integral point sets in general position . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
8 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
8 Integral point sets in higher dimensional affine spaces over finite fields 61
1 Introduction and Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
2 Integral point sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
3 Automorphisms preserving integral distances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
4 Graph of integral distances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
5 Maximum cardinality of integral point sets in Fmq . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
6 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
9 Inclusion-maximal integral point sets over finite fields 75
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
2 The graph of integral distances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
3 Automorphism group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
4 Inclusion-maximal integral point sets over F2q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
5 Remarks on integral point sets over E2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
10 Maximal integral point sets over Z2 85
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
2 Basics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
3 Exhaustive generation of maximal integral point sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
4 Normal forms and automorphisms for integral point sets over Z2 . . . . . . . . . . . . . . . . . . . . . . . . 88
5 Maximal integral point sets with given cardinality and minimum diameter . . . . . . . . . . . . . . . . . . . 90
6 Constructions for maximal integral point sets over Z2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
7 Maximal integral point sets over Z2 with further conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
8 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
11 Bounds for the minimum oriented diameter 101
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
2 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
3 Reductions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
4 Proof of the main theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
5 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
12 Demand forecasting for companies with many branches, low sales numbers per product, and non-recurring
orderings 117
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
2 The real-world problem and an abstract problem formulation . . . . . . . . . . . . . . . . . . . . . . . . . . 118
3 Some real-data analysis evaluating an obvious approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
4 The Top-Dog-Index (TDI) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
5 The heuristic supply optimization procedure based on the TDI . . . . . . . . . . . . . . . . . . . . . . . . . 121
6 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
2
13 The Top-Dog index 123
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
2 The real-world problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
3 Some real-data analysis evaluating seemingly obvious approaches . . . . . . . . . . . . . . . . . . . . . . . 125
4 The Top-Dog-Index (TDI) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
5 The heuristic size optimization procedure based on the TDI . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
6 A real-world blind study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
7 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
14 Lotsize optimization leading to a p-median problem with cardinalities 135
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
2 The real world problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
3 Mathematical modeling of the problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
4 The cardinality constrained p-median problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
5 A practical heuristic for the cardinality constrained p-median problem . . . . . . . . . . . . . . . . . . . . . 140
6 Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
15 On the Hegselmann-Krause conjecture in opinion dynamics 145
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
2 The crucial objects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
3 Proof of the Hegselmann-Krause Conjecture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
4 Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152
Zusammenfassung 153
1 Polyominoes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
2 Ganzzahlige Punktmengen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
3 Minimale Orientierungen von Graphen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
4 Vektorapproximation bzw. Optimierung bei einem Textildiscounter . . . . . . . . . . . . . . . . . . . . . . . 157
5 Modellierung bzw. Optimierung von Meinungsbildungsdynamiken . . . . . . . . . . . . . . . . . . . . . . . 159
3
4
Chapter 1
Introduction
Continuous mathematics is a very powerful theory. Con-
sider for instance the (rather easy) problem of maximizing
the function f1 : [0, 10] → R, x 7→ 10x − x2. Since f1
is continuous and differentiable we know a simple calcula-
tion pattern to determine a value x̃ that maximizes f1 from
high school: choose x̃ from S = {x ∈ [0, 10] | f ′(x) =
0}∪ {0, 10}. In our case we have S = {0, 5, 10} and f(0) = 0,
f(5) = 25, f(10) = 0. Thus x̃ = 5 maximizes the function
f1.
The beauty of this is: We have started with an infi-
nite, even uncountable set [0, 10] and ask for an element
x̃ ∈ [0, 10] such that f1 (x̃) > f1(x) for all x ∈ [0, 10]. And
all we have to do is perform a simple algebraic calculation
and merely check three elements of the infinite set [0, 10] to
locate x̃.
Unfortunately in many applications the sets, which are
searched for optimal values, are not continuous but discrete.
This means that the objects can assume only distinct, sep-
arated values. By slightly changing our problem from the
beginning we obtain a discrete problem. So let us consider
the function f̂1 : {z ∈ Z | 0 6 z 6 10}→ Z, x 7→ 10x− x2.
Now we have to localize an optimal solution in the discrete
set {z ∈ Z | 0 6 z 6 10} = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}.
Since this is a finite set in principle we are able to simply
compare all f̂1-values
x 0 1 2 3 4 5 6 7 8 9 10
f̂1(x) 0 9 16 21 24 25 24 21 16 9 0
and determine x̃ = 5 to be the optimal value. This can even
be done in elementary school (if we use an appropriate for-
mulation and notation of the problem). So, conceptionally,
this approach is quite easy.
The big disadvantage of enumerating all possible values
for x is that there can be a huge number of values. The num-
ber of 11 possible values for x in our example is not that big,
but if we consider f̂2 :
{
z ∈ Z | −106 6 z 6 106
}
→ Z,
x 7→ 10x − x2 the situation is changed drastically. Check-
ing all 2000001 possible values for xmanually would take a
long time and is rather tedious.
In order to apply methods from continuous mathemat-
ics we may relax our problem and consider the func-
tion f2 :
[
−106, 106
]
→ R, x 7→ 10x − x2 in-
stead. Let x̃ be an optimal solution maximizing f2.
Since
{
z ∈ Z | −106 6 z 6 106
}
⊂
[
−106, 106
]
we have
f2 (x̃) > f2(x) for all x ∈
{
z ∈ Z | −106 6 z 6 106
}
. So
in general we obtain an upper bound by relaxing a maxi-
mization problem. In our case we have x̃ = 5 ∈ Z so that
the optimal solution for f2 is also optimal for the discrete
function f̂2.
That this coincidence does not occur in general can
be seen by considering the discrete function f̂3 :
{z ∈ Z | 0 6 z 6 10} → Z, x 7→ 9x − x2 and its relaxation
f3 : [0, 10] → R, x 7→ 9x − x2. The optimal solution for
the continuous problem is given by x̃ = 4.5 /∈ Z. Clearly
there is yet another clever workaround that enables us to
apply continuous optimization in this case. We may con-
sider the two subproblems of maximizing f3,1 : [0, 4]→ R,
x 7→ 9x−x2 and f3,2 : [5, 10]→ R, x 7→ 9x−x2. The opti-
mal solution of the first subproblem is given by x̃1 = 4 ∈ Z
with f3,1 (x̃1) = 20 and the optimal solution of the second
subproblem is given by x̃2 = 5 ∈ Z with f3,2 (x̃2) = 20.
Thus x̃1 = 4 and x̃2 = 5 are optimal solutions of our dis-
crete problem of maximizing f̂3 since f3 is concave.
The intention of the introductory example is to show that
discrete problems may in some sense be harder to solve
than continuous problems. Often the very powerful meth-
ods from mathematical analysis can not be applied directly.
In some cases there are workarounds to deal with discrete
problems using continuous techniques in several subprob-
lems. More examples can be found, e. g. in the theory of
integer linear programming.
1 Mathematics in the computer age
The invention of the computer continues to have a great im-
pact on the progression of mathematics. Calculation pat-
terns have to be reassessed from another point of view.
The continuous way of maximizing f̂2 is very clever and
few steps have to be performed by a human. Checking
2000001 cases is really simpleminded, lengthy, tedious, and
error-prone if it is performed by a human.
Since the invention of the computer or mechanical cal-
culating machines we can pass some calculations to ma-
chines. The following simple and short computer program
maximizes f̂2 in less than a second on a customary personal
computer:
champion = 0
for x = −1000000 to 1000000 do
if 9 · x− x2 > 9 · champion− champion2 then
5
champion = x
print champion
Clearly, in this case we can also perform the continuous
way of maximizing f̂2 on a computer by using a computer
algebra system. Nowadays, it is no problem for computer al-
gebra systems to differentiate functions and to perform alge-
braic and analytic transformations. However such a system
needs a lot of steps to perform an operation like “differenti-
ate a given function f” compared to the steps needed in the
above described simple enumeration scheme.
For practical applications it is not important how a prob-
lem is solved but how long it takes to solve it and how much
it costs. Clearly these aspects are not new. But the met-
ric changed from counting in human working days to some-
thing more intricate. Now we can buy ready-made devices
to complete a certain task or we invent specialized machines.
Some things can either be done by a computer or by a hu-
man. We can buy standard software or customized software.
There are endless alternatives how to solve a practical prob-
lem. And in most cases everything is measured in costs.
Concerning the alternative between customized machines
and standard computers we can state that the current trend
in (super-) computing is to use one standard machine for
allmost all types of problems due to cost reasons. For ev-
ery application there may be different software that solves
the problem on such a machine. So mathematicians, com-
puter scientists, and other scientists are asked to develop al-
gorithms to solve problems on given machines.
Today the most successful and reasonably priced calcu-
lating machines can only manipulate bits which mathemati-
cally means that only boolean functions {0, 1}n → {0, 1} can
be applied. So these are discrete machines which are sim-
pleminded but very fast. These facts imply that one has to
study discrete structures and algorithms.
2 Facing the discrete nature of some
mathematical problem types
In the previous section we have argued that many real-world
problems are nowadays solved using discrete machines. So,
at least in some cases, these machines have to approximate
continuous values by discrete values in order to solve con-
tinuous problems.
The more important reason to study discrete structures
and corresponding algorithms is that, undeniably, some
mathematical problems indeed have a discrete structure.
Working with continuous mathematics on discrete prob-
lems means to approximate discrete problems by continu-
ous problems. Due to the big potency of the methods from
continuous mathematics this indirect route was and in some
cases still is successful in applications.
During the last decades mathematicians have made great
progress in the development of algorithms based on discrete
structures. In combination with the present-day computers
the more direct route of solving discrete problems using dis-
crete techniques on discrete machines becomes more and
more successful in many applications.
In this context we would like to mention a recent result
in the theory of mixed-integer nonlinear programming [5].
Here the authors do not assume that the optimization prob-
lem is relaxable i. e. their algorithm only evaluates the in-
teger variables at integer points. The most surprising result
of this article is that the number of function evaluations1 is
less than the number of function calls needed for solving the
corresponding relaxed problem without integer variables.
3 Discrete Structures, Algorithms,
and Applications
The formal framework of this text is that of a cumulative
Habilitation Thesis. This means that the following chapters
are sparsely connected research articles. The key question
connecting all these is:
“How can discrete (optimization-) problems be solved?”
Clearly this question is rather vague and comprising so that
we can deal only with some aspects. Vague and comprising
as the title is, that is what this thesis is all about: discrete
structures, algorithms, and applications.
There exists a broad variety of discrete structures. In
this thesis we only deal with a few selected discrete struc-
tures, including polyominoes, integral point sets, and di-
rected graphs.
Optimizing over discrete structures can have several char-
acteristics. In some cases an optimum can be determined
analytically or we can derive some properties of the optimal
discrete structures. In other cases we can design algorithms
that determine optimal solutions in reasonable time or we
can design algorithms that locate good solutions including a
worst case guarantee.
Our research is motivated from applications of such dif-
ferent areas as social dynamics or allocation optimization of
a fashion discounter.
4 Polyominoes
A polyomino is a connected interior-disjoint union of axis-
aligned unit squares joined edge-to-edge. In other words, it
is an edge-connected union of cells in the planar square lat-
tice. There are at least three ways to define two polyominoes
as equivalent, namely factoring out just translations (fixed
polyominoes), rotations and translations (chiral polyomi-
noes), or reflections, rotations and translations (free poly-
ominoes). In literature polyominoes are sometimes named
animals or one speaks of the cell-growth problem [15, 36].
For the origin of polyominoes we quote Klarner [16]:
“Polyominoes have a long history, going back to the start
of the 20th century, but they were popularized in the present
era initially by Solomon Golomb, then by Martin Gardner
in his Scientific American columns.” To give an illustration
1In some applications functions are not given analytically but based on
a possible time-consuming simulation so that the number of function eval-
uations may dominate the overall runtime of the optimization algorithm.
6
of polyominoes Figure 1 depicts the free polyominoes con-
sisting of at most 5 unit squares.
Figure 1: Polyominoes with at most 5 squares.
We would like to mention a few applications and prob-
lems for polyominoes. The term cell-growth problem cer-
tainly suggests applications in medicine and biology. Poly-
ominoes are for instance used in the Ising Model [4] and
for modeling neural networks, flocking birds, beating heart
cells, atoms, protein folds, biological membrane, social be-
havior, etc. Further applications of polyominoes are in the
fields of chemistry and physics. For problems concern-
ing polyominoes one might mention counting polyominoes,
generating polyominoes, achievement games and extremal
animals. Since polyominoes are a very broad and still ac-
tive field of research we would like to refer the interested
reader to the MSC-code 05B50 instead of citing a large list
of articles.
There are several generalizations of polyominoes, e. g.
polyiamonds (edge-to-edge unions of unit equilateral tri-
angles), polyhexes (edge-to-edge unions of unit regular
hexagons), polyabolos (edge-to-edge unions of unit right
isosceles triangles), polycubes (face-to-face unions of unit
cubes), etc. One can also define polyominoes as connected
systems of cells on Archimedean tessellations. Besides tes-
sellations and higher dimensions the most natural general-
ization of polyominoes is to define k-polyominoes as non-
intersecting connected systems of regular unit k-gons [17].
Let us move over to concrete problems for polyominoes.
In [1] the authors consider three-dimensional polyominoes
of minimal surface area and of volume n. The minimal sur-
face area is explicitly computed and yields a discrete isoperi-
metric inequality. These variational problems are the key
to finding the path of escape from the metastable state for
the three-dimensional Ising model at very low temperatures.
The two-dimensional analogue are polyominoes with mini-
mum perimeter p(n) consisting of n unit squares. The ex-
act value of p(n) was determined in [8] to be 2
⌈
2
√
n
⌉
. We
describe and enumerate the complete set of polyominoes at-
taining this bound in Chapter 2 and [23].
Another discrete optimization problem is to ask for the
maximum area of the convex hull of a polyomino consist-
ing of n unit squares. Again the maximum value n +
⌊
n−1
2
⌋ ⌊
n
2
⌋
was already proved, see [3]. In Chapter 3 and
[22] we describe and enumerate the complete set of poly-
ominoes attaining this bound. Additionally we determine
the exact maximum value for the general d-dimensional
case to be ∑
I⊆{1,...,d}
1
|I|!
∏
i∈I
⌊
n− 2+ i
d
⌋
,
which was a conjecture of [3].
5 Integral point sets
Since the time of the Pythagoreans, mathematicians have
considered geometrical objects with integral sides. An in-
tegral point set P is a set of n points in the m-dimensional
Euclidean space Em where all pairwise distances are inte-
gral. If we denote the largest occurring distance of a point
set as its diameter then the question for the minimum possi-
ble diameter d(m,n) arises. For dimensionm = 2 we have
depicted the plane integral point sets with minimum diame-
ter up to n = 9 in Figure 2. In [9] some imaginable appli-
cations of integral point sets are summarized: radio astron-
omy (wave lengths), chemistry (molecules), physics (energy
quantums), robotics, and architecture.
s ss
1
1 1 s s ss
13
4 2 2 s ss s
4
2 2
3
4 4 s s s ss
1 33
4 42 2
sss s
s s
5
8
3
3 3
5 57 7
8 8
7 7 s s s s s
s s
5 3 5 3
8
11 9 911
13
17 13 11
9 9
s s s s
s s s
5 3 5
8 8
9 911 11
9 9
13 13
17 17
11 11 s s s s s s
s s
5 3 5 3 5
8
11 1117 1713 13
1111
99 99
s s s s s s s s
s
5 3 5 3 5 3 5
17 13 11 9 9 11 13 17
Figure 2: Integral point sets with minimum diameter for 3 6
n 6 9.
Here we will only detail the first mentioned application.
Consider a system of antennas like the VERY LARGE AR-
RAY (VLA) on the Plains of San Agustin fifty miles west
of Socorro, New Mexico, see Figure 3. If the distance be-
tween two such antennas is not an integral multiple of the
used wave lengths, interference occurs. Since the used wave
lengths at the VLA range from 0.7 cm to 400 cm, it is tech-
nically possible to place two antennas such that no interfer-
ence occurs. A complete configuration of antennas without
loses due to interference directly corresponds to an integral
point set. We would like to mention that in practice there
7
are a lot of other constraints and objectives beside the need
to minimize interference.
Figure 3: Very Large Array in New Mexico, USA (Image
courtesy of NRAO/AUI).
The exact values of the minimum possible diameter
d(2, n) for n 6 122 were determined in [26, 35]. It turned
out that the plain integral point sets which attain the lower
bound d(2, n) for 9 6 n 6 122 each consist of n−1 points
on a line and one point apart. There is a nice correspon-
dence between these integral point sets and factorizations of
a certain number, see [26, 35] for details.
Due to the Heron formula A∆(a, b, c) =√
(a+ b+ c)(a+ b− c)(a− b+ c)(−a+ b+ c)
4
for the area A∆ of a triangle with side lengths a, b, c we
can write the area of a non-degenerate triangle with integral
side lengths uniquely as A∆ = q
√
k with a rational number
q and a squarefree integer k. The number k is called the
characteristic char(∆) of the triangle. The following theo-
rem allows us to talk about the characteristic char (P) of a
point set P.
Theorem 5.1 Each non-degenerate triangle ∆ in a plane
integral point P set has the same characteristic char (P) =
char (∆).
A proof of Theorem 5.1 can for instance be found in [13].
It is essential for fast exhaustive generation of plane integral
point sets, see [26, 35]. In [27] Theorem 5.1 is generalized
to arbitrary dimensionm.
The inarguably simplestm-dimensional integral point set
is an m-dimensional simplex with integral side lengths. So
in order to generate m-dimensional integral points sets in
general one has to generate m-dimensional integral sim-
plices. In [7] a nice bijection between m-dimensional in-
tegral simplices with side lengths in {1, 2} and the partitions
of m + 1 turns up. In Chapter 4 and [24] we determine
the numbers of integral tetrahedra with diameter d up to
isomorphism for all d 6 1000 via computer enumeration.
Therefore we give an algorithm that enumerates theΩ
(
d6
)
integral tetrahedra with diameter at most d in O
(
d5
)
time
and an algorithm that can check the canonicity of a given
integral tetrahedron with at most 6 integer comparisons. For
results on m-dimensional integral point sets for m > 3 we
refer the interested reader to [26, 30]. If also the coordinates
of the points of an integral point set have to be integral then
all simplices of such a set must have characteristic one. A
fast generation algorithm for these simplices, especially for
dimensionm = 2, is given in [28].
Although integral point sets have been studied for a long
time very few rigorous results are known. A reason might
be that in this problem a lot of number theory and geom-
etry is involved. The usual way to deal with a difficult
(optimization-) problem is to relax it. So in Chapter 5 and
[19, 20] we relax the ring of integers Z to the finite ring
Zn = Z/Zn and consider integral point sets over Zmn . This
approach is continued in Chapter 7 and [25] where we spe-
cialize to n being a prime or more generally consider two-
dimensional integral point sets over finite fields. The higher-
dimensional case is treated in Chapter 8 and [31].
During the study of integral point sets over finite fields or
more generally over finite rings a lot of similarities to the
original problem turned up. Integral point sets with many
points seem to consist of large collinear subsets. If we for-
bid three points to be collinear, then integral point sets with
many points seem to be attracted by circles. If we further
forbid four points to be situated on a circle then we meet a
well known question from discrete geometry:
“Are there seven points in the plane, no three on a line, no
four on a circle with pairwise integral distances?”
In Chapter 7 and [25] we present such examples over Z250
and over Z261. These discoveries motivated us to search
more extensively for such an example in the Euclidean plane
E2, which leads to a discovery of two examples in the Eu-
clidean plane E2, see Chapter 6 and [21].
Beside integral point sets with maximum cardinality over
finite fields one is also interested in inclusion-maximal in-
tegral point sets. We give the related results in Chapter 9
and [14]. Again the results motivate some research on inte-
gral point sets in the Euclidean plane E2. Also in this space
there exist inclusion-maximal integral point sets. The small-
est inclusion-maximal integral triangle with integral coordi-
nates is determined in [18]. A more comprising exploration
of inclusion-maximal integral point sets over the integer grid
Z2 is outlined in Chapter 10 and [2].
6 Extremal graph theory
The mathematical branch of extremal graph theory studies
the graphs which are extremal among graphs with a certain
property. In Chapter 11 and [29] we consider orientations
of undirected graphs such that the resulting diameter of the
directed graph becomes minimal. An application is e. g.
gossiping and broadcasting in communication networks, see
[10].
7 Allocation optimization of a fashion
discounter
Although research in applied mathematics is not restricted
to real-world business cases our research in allocation op-
8
timization was initiated by a request of a current industry
partner. Consider a fashion discounter with many branches,
no replenishment of products, and very small sales numbers
per product. The first task is to estimate the future branch-
dependent demand from historic sales data. Demand fore-
casting for never-out-of-stock items is a well-studied topic
both in research and practice – the literature is overboard-
ing. For promotional items and other items with single, very
short life cycles, however, we did not find any suitable de-
mand forecasting methods.
In Chapter 12 and [32] we introduce a new index to ro-
bustly measure the deviation between historic supply and
demand for sparse data. The results of a field study apply-
ing this index in practice are outlined in Chapter 13 and [34]
branch S M L XL
1 1.23 2.32 3.21 0.71
2 3.71 6.52 7.79 2.50
3 0.38 1.47 1.63 0.41
4 1.73 3.18 3.08 1.68
5 0.81 1.94 4.32 1.13
6 1.57 3.08 2.94 1.45
7 1.21 2.31 3.22 0.72
8 1.25 2.27 3.35 0.83
9 3.41 5.79 6.37 3.21
Table 1: List of demand vectors.
Once we have good estimates for the future branch-
dependent demand at hand, see Table 1 for an example, we
have to face another task. Due to cost reasons the delivery
of branches is lot-based. This means that we have a finite
number of lot-types like e. g.
1
2
2
1
 ,

1
2
3
1
 ,

1
1
2
1
 ,

1
2
4
1
 ,
meaning that the first lot-type consists of 1 item of size S, 2
items of sizeM, 2 items of size L, and 1 item of size XL.
Every branch is delivered by an integral multiple of ex-
actly one lot-type. To reduce the complexity in storehouse
logistics the number of totally used lot-types per product is
bounded by a small number κ. In Table 2 we have given
an assignment and multiplicities of lot-types for κ = 2. To
measure the deviation between demand and planned supply
we have utilized the sum of absolute differences ‖ · ‖1.
So here we have a discrete optimization problem: select
a small number κ of lot-types out of a given list of useable
lot-types and assign to each branch lot-type and multiplicity
such that the sum of deviations between (fractional) demand
and planned supply is minimized. Additionally we have an-
other restriction from practice: the number of items which
are delivered in total has to be in a given interval
[
I, I
]
. If
we choose the interval [100, 120] in our example the assign-
ment of Table 2 does not remain valid. A valid assignment
is given in Table 3.
branch

1
2
2
1


1
2
3
1


1
1
2
1


1
2
4
1
 ‖ · ‖1
1 1 1.05
2 3 2.94
3 1 2.11
4 2 2.33
5 1 1.70
6 1 2.16
7 1 1.02
8 1 1.04
9 3 1.20∑
15.55
Table 2: Assignment and multiplicity of lot-types.
branch

1
2
3
1


1
2
2
1
 ‖ · ‖1
1 1 2.05
2 3 2.94
3 1 2.11
4 2 2.33
5 1 1.70
6 1 2.16
7 1 1.02
8 1 1.04
9 4 5.22∑
20.57
Table 3: Assignment and multiplicity of lot-types respecting
a cardinality condition.
In Chapter 14 and [6] we describe an exact algorithm and
a fast heuristic which is capable to solve this optimization
problem in practice.
8 The bounded confidence model
Another motivation for our studies comes from social sci-
ences. Here one e. g. is interested in the social evolu-
tion of opinions and therefore inspects opinion dynamics.
One model to formalize an opinion dynamic is the so called
bounded confidence model. In the one dimensional case ev-
ery individual i at time t has an opinion x(t)i . Other individu-
als do affect the opinion of individual i. The key assumption
is that we are only influenced by opinions which are in some
sense near to our opinion and ignore extreme opinions. One
way to formalize this is to introduce a confidence interval
I
(
x
(t)
i
)
=
[
x
(t)
i − ε, x
(t)
i + ε
]
for a constant ε ∈ R. With
this we can define the opinion x(t+1)i of individual i at time
t + 1 as the arithmetic mean of all opinions x(t)j which are
9
contained in the confidence interval I
(
x
(t)
i
)
of individual i.
In [12] it is shown that in such a model after a finite num-
ber of time steps we have a consensus of the individuals.
This means that there are some groups of individuals having
the same opinion which remains stable in the future time
steps.
A more philosophical question asks which premises are
sufficient that one can find the truth. In some sense scien-
tists are truth seekers. To analyze this question one can en-
hance the bounded confidence model of opinion dynamics
by introducing a truth h ∈ R. So far a consensus of our indi-
viduals is completely unrelated to the location of the truth h.
We may assume that there do exist some truth seekers which
are attracted by a positive factor α towards the truth. This
means that for a truth seeker i the truth influences his opin-
ion by a fixed weight α in the arithmetical mean update of
his new opinion. Hegselmann and Krause have conjectured
that in any such configuration the truth seekers converge to
the truth. In Chapter 4 and [33] we prove this conjecture.
Apart from social science there is another interest in opin-
ion dynamics coming from marketing. The key target of
marketing is to influence individuals in their opinion towards
a specific product or products of a specific company. To fac-
tor in an underlying opinion dynamics is a very natural step.
So now we enhance our basic bounded confidence model by
the possibility to place some opinions at various time steps.
This can be advertisements or in the context of an election
campaign communicators. So we obtain another optimiza-
tion problem which asks for an optimal control - where to
place advertisements or communicators in time and opinion
space.
This topic may become a new research field, see [11] for
an initial introduction.
9 Place of publication
For formal reasons in Table 4 we give an overview on the
place of publication of the research articles corresponding
to the chapters of this thesis. All chapters coincide besides
some minor corrections, reformulations, and changes in the
layout with the submissions of the corresponding research
articles.
Bibliography
[1] L. Alonso and R. Cerf, The three dimensional poly-
ominoes of minimal area, Electron. J. Combin. 3
(1996), 39 p.
[2] A. R. Antonov and S. Kurz, Maximal integral point
sets over Z2, (submitted).
[3] K. Bezdek, P. Braß, and H. Harborth, Maximum con-
vex hulls of connected systems of segments and of
polyominoes, Beiträge Algebra Geom. 35 (1994),
no. 1, 37–43, Festschrift on the occasion of the
65th birthday of Otto Krötenheerdt.
C. research article
2 S. Kurz. Counting polyominoes with minimum
perimeter. Ars Combin., 14 p., (to appear).
3 S. Kurz. Convex hulls of polyominoes.
Beiträge Algebra Geom., 49(1):125–136, 2008.
4 S. Kurz. Enumeration of integral tetrahedra.
J. Integer Seq., 10:Article 07.9.3, 12 p., 2007.
5 A. Kohnert and S. Kurz. Integral point sets over
Zmn . Discrete Appl. Math., 20 p., (to appear).
6 T. Kreisel and S. Kurz. There are integral hepta-
gons, no three points on a line, no four on a circle.
Discrete Comput. Geom., 4 p., (to appear).
7 S. Kurz. Integral point sets over finite fields,
22 p., (submitted).
8 S. Kurz and H. Meyer. Integral point sets in
higher dimensional affine spaces over finite fields,
22 p., (submitted).
9 M. Kiermaier and S. Kurz. Inclusion-maximal
integral point sets in affine planes over
finite fields, 15 p., (submitted).
10 A. R. Antonov and S. Kurz. Maximal integral
point sets over Z2, 25 p., (submitted).
11 S. Kurz and M. Lätsch. Bounds for the
minimum oriented diameter, 21 p., (submitted).
12 S. Kurz and J. Rambau. Demand forecasting for
for companies with many branches, low sales
numbers per product, and non-recurring orderings.
In Proceedings of the Seventh International
Conference on Intelligent Systems Design and
Applications, 22-24.10.2007, Rio de Janeiro,
Brazil, pages 196–201, 2007.
13 S. Kurz, J. Rambau, J. Schlüchtermann, and
R. Wolf. The top-dog index: A new
measurement for the demand consistency
of the size distribution in pre-pack
orders for a fashion discounter with many
small branches, 22 p., (submitted)
14 C. Gaul, S. Kurz, and J. Rambau. Lotsize
optimization leading to a p-median problem
with cardinalities, 14 p., (submitted)
15 S. Kurz and J. Rambau. On the Hegselmann-
Krause conjecture in opinion dynamics,
13 p., (in preparation).
Table 4: Chapter and place of publication.
[4] B. A. Cibra, An introduction to the ising model, Amer.
Math. Monthly 94 (1987), 937–957.
[5] O. Exler and K. Schittkowksi, A trust region SQP al-
gorithm for mixed-integer nonlinear programming,
Optimization Letters 1, no. 3, 269–280.
[6] C. Gaul, S. Kurz, and J. Rambau, Lotsize optimization
leading to a p-median problem with cardinalities,
(submitted).
[7] C. Haase and S. Kurz, A bijection between the d-
dimensional simplices with distances in {1, 2} and
10
the partitions of d + 1, J. Combin. Theory Ser. A
113 (2006), no. 4, 736–738.
[8] F. Harary and H. Harborth, Extremal animals, J. Com-
bin. Inform. System Sci. 1 (1976), 1–8.
[9] H. Harborth, Integral distances in point sets, Butzer,
P. L. (ed.) et al., Karl der Grosse und sein Nach-
wirken. 1200 Jahre Kultur und Wissenschaft in Eu-
ropa. Band 2: Mathematisches Wissen. Turnhout:
Brepols, 1998, 213–224.
[10] S. M. Hedetniemi, S. T. Hedetniemi, and A. L. Li-
estman, Survey of Gossiping and Broadcasting in
Communication Networks, Networks 18 (1988),
319–349.
[11] R. Hegselmann, S. König, S. Kurz, C. Niemann, and
J. Rambau, Optimal Control in Opinion Dynam-
ics: Concepts, Structures, Pitfalls, Algorithms, (in
preparation).
[12] R. Hegselmann and U. Krause, Opinion dynamics and
bounded confidence: models, analysis and simula-
tion, Journal of Artificial Societies and Social Sim-
ulation (JASSS) 5 (2002), no. 3.
[13] A. Kemnitz, Punktmengen mit ganzzahligen Ab-
ständen, Habilitationsschrift, TU Braunschweig,
1988.
[14] M. Kiermaier and S. Kurz, Inclusion-maximal integral
point sets in affine planes over finite fields, (sub-
mitted).
[15] D. A. Klarner, Cell growth problems, Canad. J. Math.
19 (1967), 851–863.
[16] D. A. Klarner, Polyominoes, Handbook of Discrete and
Computational Geometry (Jacob E. Goodman and
Joseph O’Rourke, eds.), CRC Press LLC, 1997,
225–242.
[17] M. Koch and S. Kurz, Enumeration of generalized
polyominoes, (submitted).
[18] A. Kohnert and S. Kurz, A note on Erdös-Diophantine
graphs and Diophantine carpets, Math. Balkanica
(N.S.) 21 2007, no. 1-2, 1–5.
[19] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Discrete Appl. Math., (to appear).
[20] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Electron. Notes Discrete Math. 27 (2006), 65–66.
[21] T. Kreisel and S. Kurz, There are integral heptagons,
no three points on a line, no four on a circle, Dis-
crete Comput. Geom., (to appear).
[22] S. Kurz, Convex hulls of polyominoes, Beiträge Alge-
bra Geom. 49 (2008), no. 1, 125–136.
[23] S. Kurz, Counting polyominoes with minimum perime-
ter, Ars Combin., (to appear).
[24] S. Kurz, Enumeration of integral tetrahedra, J. Integer
Seq. 10 (2007), Article 07.9.3.
[25] S. Kurz, Integral point sets over finite fields, (submit-
ted).
[26] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[27] S. Kurz, On the characteristic of integral point sets in
Em, Australas. J. Combin. 36 (2006), 241–248.
[28] S. Kurz, On the generation of Heronian triangles,
Serdica Journal of Computing, (to appear).
[29] S. Kurz and M. Lätsch, Bounds for the minimum ori-
ented diameter, (submitted).
[30] S. Kurz and R. Laue, Bounds for the minimum diame-
ter of integral point sets, Australas. J. Combin. 39
(2007), 233–240.
[31] S. Kurz and H. Meyer, Integral point sets in higher di-
mensional affine spaces over finite fields, (submit-
ted).
[32] S. Kurz and J. Rambau, Demand forecasting for com-
panies with many branches, low sales numbers per
product, and non-recurring orderings, Proceedings
of the Seventh International Conference on Intelli-
gent Systems Design and Applications, 2007, 196–
201.
[33] S. Kurz and J. Rambau, On the Hegselmann-Krause
conjecture in opinion dynamics, (in preparation).
[34] S. Kurz, J. Rambau, J. Schlüchtermann, and R. Wolf,
The top-dog index: A new measurement for the de-
mand consistency of the size distribution in pre-
pack orders for a fashion discounter with many
small branches, (submitted).
[35] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin., (to
appear).
[36] R. C. Read, Contributions to the cell growth problem,
Canad. J. Math. 14 (1962), 1–20.
11
12
Chapter 2
Counting polyominoes with minimum
perimeter
SASCHA KURZ1
ABSTRACT. The number of essentially different square polyomi-
noes of order n and minimum perimeter p(n) is enumerated.
2000 MSC: 05B50; 05C30.
Key words and phrases: polyominoes, enumeration.
1 Introduction
Suppose we are given n unit squares. What is the best way
to arrange them side by side to gain the minimum perime-
ter p(n)? In [4] F. Harary and H. Harborth proved that
p(n) = 2
⌈
2
√
n
⌉
. They constructed an example where the
cells grow up cell by cell like spirals for these extremal poly-
ominoes (see Figure 1). In general, this is not the only pos-
sibility to reach the minimum perimeter.
?
Figure 1: Spiral construction.
Thus the question arises to determine the number e(n) of
different square polyominoes of order n and with minimum
perimeter p(n) where we regard two polyominoes as equal
if they can be mapped onto each other by translations, rota-
tions, and reflections.
We will show that these extremal polyominoes can be
obtained by deleting squares at the corners of rectangular
polyominoes with the minimum perimeter p(n) and with at
least n squares. The process of deletion of squares ends if n
squares remain forming a desired extremal polyomino. This
process leads to an enumeration of the polyominoes with
minimum perimeter p(n).
1Sascha Kurz, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
Figure 2: e(n) for n 6 100.
Theorem 1.1 The number e(n) of polyominoes with n
squares and minimum perimeter p(n) is given by e(n) =
1 if n = s2,
b− 12+ 12
√
1+4s−4tc∑
c=0
rs−c−c2−t if n = s
2 + t,
0 < t < s,
1 if n = s2 + s,
qs+1−t +
b√s+1−tc∑
c=1
rs+1−c2−t if n = s
2 + s+ t,
0 < t 6 s,
with s = b
√
nc, and with rk, qk being the coefficient of xk
in the following generating function r(x) and q(x), respec-
tively. The two generating functions
s(x) = 1+
∞∑
k=1
xk
2
k∏
j=1
1
1− x2j
and
a(x) =
∞∏
j=1
1
1− xj
13
are used in the definition of
r(x) =
1
4
(
a(x)4 + 3a
(
x2
)2)
and
q(x) =
1
8
(
a(x)4 + 3a
(
x2
)2
+ 2s(x)2a
(
x2
)
+ 2a
(
x4
))
.
The behavior of e(n) is illustrated in Figure 2. It has
a local maximum at n = s2 + 1 and n = s2 + s + 1 for
s > 1. Then e(n) decreases to e(n) = 1 at n = s2 and
s = s2 + s. In the following we give lists of the values of
e(n) for n 6 144 and of the two maximum cases e(s2 + 1)
and e(s2 + s+ 1) for s 6 49,
e(n) = 1, 1, 2, 1, 1, 1, 4, 2, 1, 6, 1, 1, 11, 4, 2, 1, 11, 6, 1,
1, 28, 11, 4, 2, 1, 35, 11, 6, 1, 1, 65, 28, 11, 4, 2, 1, 73, 35,
11, 6, 1, 1, 147, 65, 28, 11, 4, 2, 1, 182, 73, 35, 11, 6, 1, 1,
321, 147, 65, 28, 11, 4, 2, 1, 374, 182, 73, 35, 11, 6, 1, 1,
678, 321, 147, 65, 28, 11, 4, 2, 1, 816, 374, 182, 73, 35, 11,
6, 1, 1, 1382, 678, 321, 147, 65, 28, 11, 4, 2, 1, 1615, 816,
374, 182, 73, 35, 11, 6, 1, 1, 2738, 1382, 678, 321, 147, 65,
28, 11, 4, 2, 1, 3244, 1615, 816, 374, 182, 73, 35, 11, 6, 1,
1, 5289, 2738, 1382, 678, 321, 147, 65, 28, 11, 4, 2, 1,
e(s2 + 1) = 1, 1, 6, 11, 35, 73, 182, 374, 816, 1615,
3244, 6160, 11678, 21353, 38742, 68541, 120082, 206448,
351386, 589237, 978626, 1605582, 2610694, 4201319,
6705559, 10607058, 16652362, 25937765, 40122446,
61629301, 94066442, 142668403, 215124896, 322514429,
480921808, 713356789, 1052884464, 1546475040,
2261006940, 3290837242, 4769203920, 6882855246,
9893497078, 14165630358, 20206501603, 28718344953,
40672085930, 57404156326, 80751193346,
e(s2 + s + 1) = 2, 4, 11, 28, 65, 147, 321, 678,
1382, 2738, 5289, 9985, 18452, 33455, 59616, 104556,
180690, 308058, 518648, 863037, 1420480, 2314170,
3734063, 5970888, 9466452, 14887746, 23235296,
36000876, 55395893, 84680624, 128636339, 194239572,
291620864, 435422540, 646713658, 955680734,
1405394420, 2057063947, 2997341230, 4348440733,
6282115350, 9038897722, 12954509822, 18496005656,
26311093101, 37295254695, 52682844248, 74170401088,
104083151128.
2 Proof of the main theorem
The perimeter cannot be a minimum if the polyomino is dis-
connected or if it has holes. For connected polyominoes
without holes the property of having the minimum perimeter
is equivalent to the property of having the maximum num-
ber of common edges since an edge which does not belong
to two squares is part of the perimeter. The maximum num-
ber of common edges B(n) is determined in [4] to be
B(n) = 2n−
⌈
2
√
n
⌉
. (1)
Figure 3: An example of a circle.
Denote the degree of a square by the number of its edge-
to-edge neighbors. There is a closed walk trough all edge-
to-edge neighboring squares of the perimeter. Now we use
the terms of graph theory [3] and consider the squares as
vertices. So we can define H to be the cycle x1x2 . . . xkx1
where the xi are the squares of the above defined closed
walk. For short we will set |H| = k in the following lem-
mas. We would like to mention that xi = xj with i 6= j is
possible in this definition. An example is depicted in Figure
3 together with the corresponding graph of H. Let further-
more hi denote the number of squares xj inH having degree
i in the given polyomino. So
|H| = h1 + h2 + h3 + h4.
If a polyomino with minimum perimeter p(n) contains a
square of degree 1 (i. e. h1 > 0) then B(n)−B(n−1) = 1.
Considering Equation (1) for B(n), this is equivalent to n =
s2 + 1 or n = s2 + s + 1 so that we can assume h1 = 0 in
general. In the following two lemmas we prove a connection
between the number of common edges of a polyomino and
|H|.
Lemma 2.1 If h1 = 0 then h2 = h4 + 4.
PROOF. Consider the polygon connecting the centers of the
squares of H. For 2 6 i 6 4 there is an inner angle of
(i−1)π
2 in a square of degree i. The sum of the angles of an
|H|-gon is (|H| − 2)π. Thus
(h2 + h3 + h4 − 2)π = h2
π
2
+ h3π+ h4
3π
2
implies the desired equation. 
Lemma 2.2 If h1 = 0 then the numberm of common edges
of squares of the polyomino is
m = 2n−
|H|
2
− 2.
PROOF. Every inner square of the polyomino has four
neighbors. Counting the common edges twice yields
2m = 4(n− |H|) + 2h2 + 3h3 + 4h4.
From Lemma 2.1 we obtain
2m = 4n− 4|H| + 3(h2 + h3 + h4) − 4 = 4n− |H| − 4.

14
In the next lemma we use the knowledge of |H| to bound
the number of squares n of a polyomino.
Lemma 2.3 For the maximum area A(|H|) of a polyomino
with boundary H and h1 = 0 we have
A(|H|) =

(
|H|+4
4
)2
if |H| ≡ 0 (mod4),(
|H|+4
4
)2
− 14 if |H| ≡ 2 (mod4).
PROOF. Because of Lemma 2.2 the integer |H| has to be an
even number. Consider the smallest rectangle surrounding a
polyomino and denote the side lengths by a and b. Using the
fact that the cardinality of the boundary H of a polyomino
is at least the cardinality of the boundary of its smallest sur-
rounding rectangle we conclude |H| > 2a + 2b − 4. The
maximum area of the rectangle with given perimeter is ob-
tained if the integers a and b are as equal as possible. Thus
a =
⌈
|H|+4
4
⌉
and b =
⌊
|H|+4
4
⌋
. The product yields the
asserted formula. 
Now we use the fact that we deal with polyominoes with
minimum perimeter p(n) and compute |H| as a function of
n.
Lemma 2.4 For a polyomino with h1 = 0 and with mini-
mum perimeter p(n) we have |H| = 2
⌈
2
√
n
⌉
− 4.
PROOF. Since for connected polyominoes without holes the
property of having minimum perimeter p(n) is equivalent to
the property of having the maximum number B(n) of com-
mon edges, we can use B(n) = 2n −
⌈
2
√
n
⌉
and Lemma
2.2. 
After providing those technical lemmas we give a strategy
to construct all polyominoes with minimum perimeter.
Lemma 2.5 Each polyomino with h1 = 0 and minimum
perimeter p(n) can be obtained by deleting squares of a
rectangular polyomino with perimeter p(n) consisting of at
least n squares.
PROOF. Consider a polyomino P with boundaryH and min-
imum perimeter p(n). Denote its smallest surrounding rect-
angle by R. If the cardinality of the boundary of R is less
than |H| then P does not have the minimum perimeter due
to Lemma 2.2 and due to the fact that m = B(n) is increas-
ing. Thus |H| equals the cardinality of the boundary of R
and P can be obtained by deleting squares from a rectangu-
lar polyomino with perimeter p(n) and with an area at least
n. Only squares of degree two can be deleted successively
if the perimeter does not change. 
For the following classes of n with s = b
√
nc we now
characterize all rectangles being appropriate for a deletion
process to obtain P with minimum perimeter p(n).
(i) n = s2.
From Lemmas 2.3 and 2.4 we know that the unique
polyomino with minimum perimeter p(n) is indeed the
s× s square.
(ii) n = s2 + t, 0 < t < s.
Since
s2 < n <
(
s+
1
2
)2
= s2 + s+
1
4
Lemma 2.4 yields |H| = 4s−2. Denote the side lengths
of the surrounding rectangle by a and b. With 2a +
2b − 4 = |H| = 4s − 2 we let a = s + 1 + c and b =
s − c with an integer c > 0. Since at least n squares
are needed for the deletion process we have ab > n,
yielding
0 6 c 6
⌊
−
1
2
+
1
2
√
1+ 4s− 4t
⌋
.
(iii) n = s2 + s.
The s× (s+ 1) rectangle is the unique polyomino with
minimum perimeter p(n) due to Lemmas 2.3 and 2.4.
(iv) n = s2 + s+ t, 0 < t 6 s.
Since(
s+
1
2
)2
= s2+s+
1
4
< n < (s+1)2 = s2+2s+1
Lemma 2.4 yields |H| = 4s. Again a and b denote
the side lengths of the surrounding rectangle and we let
a = s+ 1+ c and b = s+ 1− c with an integer c > 0.
The condition ab > n now yields
0 6 c 6
⌊√
1+ s− t
⌋
.
We remark that the deletion process does not change the
smallest surrounding rectangle since ab−n < b, that is the
number of deleted squares is less than the number of squares
of the smallest side of this rectangle.
In Lemmas 2.1, 2.2, 2.4, and 2.5 we have required h1 =
0. We now argue that all polyominoes with h1 > 0 and
with minimum perimeter p(n) are covered by the deletion
process described above ((i)-(iv)).
Lemma 2.6 The construction of Lemma 2.5 also yields all
polyominoes with minimum perimeter p(n) when h1 > 0.
PROOF. Any square of degree one determines two cases,
n = s2 + 1 or n = s2 + s + 1. (See the remark preceding
Lemma 2.1.) The deletion of this square leaves a polyomino
P with minimum perimeter p(n− 1).
In the first case P has the shape of the s × s square as in
(i). Thus we get the original polyomino by deleting s − 1
squares from the s× (s+ 1) rectangle and this is covered in
(ii).
In the second case P has the shape of the s × (s + 1)
rectangle as in (iii). Thus we get the original polyomino by
deleting s − 1 squares from the s × (s + 2) rectangle or by
deleting s squares from the (s+1)× (s+1) square, and this
is covered in (iv). 
15
So far we have described those rectangles from which
squares of degree two are removed. Now we examine the
process of deleting squares from a rectangular polyomino.
Squares of degree two can only be located in the corners of
the polyomino. What shape has the set of deleted squares at
any corner? There is a maximum square of squares at the
corner, the so called “Durfee square”, together with squares
in rows and columns of decreasing length from outside to
the interior part of the polyomino, see Figure 4.
Figure 4: Shape of the deleted squares at the corners.
To count the different possibilities of the sets of deleted
squares with respect to the number of the deleted squares we
use the concept of a generating function f(x) =
∑∞
i=0 fix
i.
Here the coefficient fi gives the number of different ways to
use i squares. Since the rows and columns are ordered by
their lengths they form Ferrer’s diagrams with generating
function
∏∞
j=1
1
1−xj
each [2]. So the generating function
for the sets of deleted squares in a single corner is given by
a(x) =
∞∏
j=1
1
1− xj
.
Later we will also need the generating function s(x) for the
sets of deleted squares being symmetric with respect to the
diagonal of the corner square. Since such a symmetric set
of deleted squares consists of a square of k2 squares and
the two mirror images of a Ferrer’s diagrams with height or
width at most k we get
s(x) = 1+
∞∑
k=1
xk
2
k∏
j=1
1
1− x2j
.
We now consider the whole rectangle. Because of different
sets of symmetry axes we distinguish between squares and
rectangles. We define generating functions q(x) and r(x) so
that the coefficient of xk in q(x) and r(x) is the number of
ways to remove k squares from all four corners of a square
or a rectangle, respectively. We mention that the coefficient
of xk gives the desired number only if k is smaller than the
small side of the rectangle.
Since we want to count polyominoes with minimum
perimeter up to translation, rotation, and reflection, we have
to factor out these symmetries. Here the general tool is the
lemma of Cauchy-Frobenius, see e. g. [5]. We remark that
we do not have to consider translations because we describe
the polyominoes without coordinates.
Lemma 2.7 (Cauchy-Frobenius, weighted form)
Given a group action of a finite groupG on a set S and a map
w : S −→ R from S into a commutative ring R containing Q
as a subring. If w is constant on the orbits of G on S, then
we have, for any transversal T of the orbits:∑
t∈T
w(t) =
1
|G|
∑
g∈G
∑
s∈Sg
w(s)
where Sg denotes the elements of S being fixed by g, i. e.
Sg = {s ∈ S|s = gs}.
4 3
1 2
4 3
1 2
Figure 5: Labeling of the corners.
ForGwe take the symmetry group of a square or a rectan-
gle, respectively, for S we take the sets of deleted squares on
all four corners, and for the weight w(s) we take xk, where
k is the number of squares in s. Here we will only describe
in detail the application of this lemma for a determination of
q(x). We label the four corners of the square by 1, 2, 3, and
4, see Figure 5. In Table 1 we list the 8 permutations g of
the symmetry group of a square, the dihedral group on four
points, together with the corresponding generating functions
for the sets Sg being fixed by g.
(1)(2)(3)(4) a(x)4
(1, 2, 3, 4) a
(
x4
)
(1, 3)(2, 4) a
(
x2
)2
(1, 4, 3, 2) a
(
x4
)
(1, 2)(3, 4) a
(
x2
)2
(1, 4)(2, 3) a
(
x2
)2
(1, 3)(2)(4) s(x)2a
(
x2
)
(1)(2, 4)(3) s(x)2a
(
x2
)
Table 1: Permutations of the symmetry group of a square
together with the corresponding generating functions of Sg.
The generating function of the set of deleted squares on a
corner is a(x). If we consider the configurations being fixed
by the identity element (1)(2)(3)(4) we see that the sets of
deleted squares at the four corners are independent and so∣∣S(1)(2)(3)(4)∣∣ = a(x)4. In the case when g = (1, 2, 3, 4)
the sets of deleted squares have to be the same for all 4 cor-
ners and we have
∣∣S(1,2,3,4)∣∣ = a (x4). For the double
transposition (1, 2)(3, 4) the sets of deleted squares at cor-
ners 1 and 2, and the sets of deleted squares at corners 3 and
4 have to be equal. Because the sets of deleted squares at
corner points 1 and 3 are independent we get
∣∣S(1,2)(3,4)∣∣ =
a
(
x2
)2. Next we consider g = (1)(2, 4)(3). The sets of
deleted squares at corners 2 and 4 have to be equal. If we
apply g on the polyomino of the left hand side of Figure 5
we receive the polyomino on the right hand side and we see
16
that in general the sets of deleted squares at corners 1 and 3
have to be symmetric. Thus
∣∣S(1)(2,4)(3)∣∣ = s(x)2a (x2).
The other cases are left to the reader. Summing up and a
division by 8 yields
q(x) =
1
8
(
a(x)4 + 3a
(
x2
)2
+ 2s(x)2a
(
x2
)
+ 2a
(
x4
))
.
For the symmetry group of a rectangle we analogously ob-
tain
r(x) =
1
4
(
a(x)4 + 3a
(
x2
)2)
.
With Lemma 2.6, the preceding characterization of rect-
angles being appropriate for a deletion process and the for-
mulas for a(x), s(x), q(x), and r(x) we have the proof of
Theorem 1.1 at hand.
We would like to close with the first entries of a complete
list of polyominoes with minimum perimeter p(n), see Fig-
ure 6.
Figure 6: Polyominoes with minimum perimeter p(n) for
n 6 11.
3 Acknowledgments
I thank Ralf Gugisch, Heiko Harborth, Adalbert Kerber, and
Axel Kohnert for many fruitful discussions during the prepa-
ration of this article.
Bibliography
[1] L. Alonso and R. Cerf, The three dimensional polyomi-
noes of minimal area, Electron. J. Combin. 3 (1996),
39p.
[2] G. E. Andrews, The theory of partitions, Encyclopedia
of Mathematics and its Applications, vol. 2, Cam-
bridge University Press, 1984.
[3] R. Diestel, Graph theory, 2nd. ed., Graduate Texts in
Mathematics. 173, Springer, 2000.
[4] F. Harary and H. Harborth, Extremal animals, J. Com-
bin. Inform. System Sci. 1 (1976), 1–8.
[5] A. Kerber, Applied finite group actions, 2nd ed., Algo-
rithms and Combinatorics, vol. 19, Springer, Berlin,
1999.
17
18
Chapter 3
Convex hulls of polyominoes
SASCHA KURZ1
ABSTRACT. In this article we prove a conjecture of Bezdek, Braß,
and Harborth concerning the maximum volume of the convex hull
of any facet-to-facet connected system of n unit hypercubes in Rd
[4]. For d = 2 we enumerate the extremal polyominoes and deter-
mine the set of possible areas of the convex hull for each n.
2000 MSC: 05B50; 05D99, 52C99.
Key words and phrases: polyominoes, convex hull, dido-type
problem, isoperimetric inequality.
1 Introduction
In the legend [1] of the founding of Carthage, Queen Dido
purchased the right to get as much land as she could enclose
with the skin of an ox. She splitted the skin into thin stripes
and tied them together. Using the natural boundary of the
sea and by constructing a giant semicircle she enclosed more
land than the seller could have ever imagined.
Dido-type problems have been treated by many authors
e. g. [2, 4, 5, 6, 9], here we consider the maximum volume
of a union of unit hypercubes. A d-dimensional polyomino
is a facet-to-facet connected system of d-dimensional unit
hypercubes. Examples for 2-dimensional polyominoes are
the pieces of the computer game Tetris.
In 1994 Bezdek, Braß, and Harborth conjectured that the
maximum volume of the convex hull of a d-dimensional
polyomino consisting of n hypercubes is given by
∑
I⊆{1,...,d}
1
|I|!
∏
i∈I
⌊
n− 2+ i
d
⌋
,
but were only able to prove it for d = 2. In Section 3 we
prove this conjecture. They also asked for the number c2(n)
of different polyominoes with n cells and maximum area
n+
⌊
n−1
2
⌋ ⌊
n
2
⌋
. In Section 2 we prove
1Sascha Kurz, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
Theorem 1.1
c2(n) =

n3−2n2+4n
16 if n ≡ 0 mod 4,
n3−2n2+13n+20
32 if n ≡ 1 mod 4,
n3−2n2+4n+8
16 if n ≡ 2 mod 4,
n3−2n2+5n+8
32 if n ≡ 3 mod 4.
Besides the maximum area n+
⌊
n−1
2
⌋ ⌊
n
2
⌋
and the min-
imum area n of the convex hull of polyominoes with n cells
several other values may be attained. For each n we charac-
terize the corresponding sets.
Theorem 1.2 A polyomino consisting of n cells with area
α = n + m2 of the convex hull exists if and only if m ∈ N0,
0 6 m 6
⌊
n−1
2
⌋ ⌊
n
2
⌋
, andm 6= 1 if n+ 1 is a prime.
2 The planar case
An example which attains the upper bound n +
1
2
⌊
n−1
2
⌋ ⌊
n
2
⌋
for the area of the convex hull of a polyomino
with n cells is quite obvious, see Figure 1. Instead of prov-
ing this upper bound by induction over n we specify poly-
ominoes by further parameters and then apply an induction
argument.
. . .
...
@
@
@
@
@
⌊
n+2
2
⌋
⌊
n+1
2
⌋
Figure 1: 2-dimensional polyomino with maximum area of
the convex hull.
We describe these parameters for the more general d-
dimensional case and therefore denote the standard coordi-
nate axes of Rd by 1, . . . , d. Every d-dimensional poly-
omino has a smallest surrounding box with side lengths
l1, . . . , ld, where li is the length in direction i. If we
build up a polyomino cell by cell then after adding a cell
one of the li will increase by 1 or none of the li will in-
crease. In the second case we increase vi by 1, where the
19
new hypercube has a facet-neighbor in direction of axis i.
If M is the set of axis-directions of facet-neighbors of the
new hypercube, then we will increase vi by 1 for only one
i ∈ M. Since at this position there is the possibility to
choose, we must face the fact that there might be different
tuples (l1, . . . , ld, v1, . . . , vd) for the same polyomino. We
define v1 = · · · = vd = 0 for the polyomino consisting of a
single hypercube. This definition of the li and the vi leads
to
n = 1+
d∑
i=1
(li − 1) +
d∑
i=1
vi. (1)
Example 2.1 The possible tuples describing a rectangular
2× 3-polyomino are (2, 3, 2, 0), (2, 3, 1, 1), and (2, 3, 0, 2).
Definition 2.2
f2 (l1, l2, v1, v2) = 1+ (l1−1) + (l2−1)
+
(l1−1) (l2−1)
2
+ v1 + v2
+
v1 (l2−1)
2
+
v2 (l1−1)
2
+
v1v2
2
.






@
@
@
@
Q
Q
Q
Q
Q
QQ
 
  
  6 l2
Figure 2: Increasing l1.
Lemma 2.3 The area of the convex hull of a 2-
dimensional polyomino with tuple (l1, l2, v1, v2) is at most
f2 (l1, l2, v1, v2).
PROOF. We prove the statement by induction on n, using
Equation (1). For n = 1 only l1 = l2 = 1, v1 = v2 = 0 is
possible. With f2(1, 1, 0, 0) = 1 the induction base is done.
Now we assume that the statement is true for all possible
tuples (l1, l2, v1, v2) with
1+
2∑
i=1
(li − 1) +
d∑
i=1
vi = n− 1.
Due to symmetry we consider only the growth of l1 or v1,
and the area a of the convex hull by adding the n-th square.
(i) l1 increases by one: We depict (see Figure 2) the new
square by 3 diagonal lines. Since l1 increases the new
square must have a left or a right neighbor. Without
loss of generality we assume that it has a left neighbor.
The new square contributes at most 2 (thick) lines to the
convex hull of the polyomino. By drawing lines from
the neighbor square to the endpoints of the new lines
we see that the growth is at most 1 + l2−12 , a growth
of 1 for the new square and the rest for the triangles.
Since f2 (l1 + 1, l2, v1, v2) − f2 (l1, l2, v1, v2) = 1+
l2−1
2 +
v2
2 the induction step follows.
(ii) v1 increases by one: In Figure 3 we depict the new
square by 3 diagonal lines. Without loss of general-
ity we assume that the new square has a left neighbor,
and contributes at most 2 lines to the convex hull of
the polyomino. As l1 is not increased there must be a
square in the same column as the new square. Simi-
lar to (i) we draw lines from the neighbor square to the
endpoints of the new lines and see that the growth of
the area of the convex hull is less than 1+ l2−12 .

@
@
@
@
@
@@
J
J
J
J
J
JJ
@
@
@
@
Q
Q
Q
Q
Q
QQ
 
  
  6 l2
. . .
Figure 3: Increasing v1.
Theorem 2.4 The area of the convex hull of a 2-
dimensional polyomino with n unit squares is at most n +
1
2
⌊
n−1
2
⌋ ⌊
n
2
⌋
.
PROOF. For given n we determine the maximum
of f2 (l1, l2, v1, v2). Since f2 (l1 + 1, l2, v1 − 1, v2) −
f2 (l1, l2, v1, v2) = 0 and due to symmetry we assume
v1 = v2 = 0 and l1 6 l2. With
f2 (l1 + 1, l2 − 1, 0, 0)−f2 (l1, l2, 0, 0) =
l2 − l1 − 1
2
> 0
we conclude 0 6 l2−l1 6 1. Using Equation (1) gives l1 =⌊
n+1
2
⌋
and l2 =
⌊
n+2
2
⌋
. Inserting in Lemma 2.3 yields
f2 (l1, l2, v1, v2) 6 n + 12
⌊
n−1
2
⌋ ⌊
n
2
⌋
. This maximum is
attained for example by the polyomino in Figure 1. 
In the next lemma we describe the shape of the 2-
dimensional polyominoes with maximum area of the convex
hull in order to determine their number c2(n).
Lemma 2.5 Every 2-dimensional polyomino with param-
eters l1, l2, v1, v2, and with the maximum area n +
1
2
⌊
n−1
2
⌋ ⌊
n
2
⌋
of the convex hull consists of a linear strip
20
 -
?
6
 -
6
?
. . .
...
. . .
Figure 4: The two shapes of polyominoes with maximum
area of the convex hull and a forbidden sub-polyomino.
with at most one orthogonal linear strip on each side (see
the upper two pictures in Figure 4). Additionally we have
v1 = v2 = 0 and the area of the convex hull is given by
f2 (l1, l2, v1, v2).
PROOF. From the proof of Lemma 2.3 we deduce v1 =
v2 = 0 and that every sub-polyomino has also the maxi-
mum area of the convex hull. Since the area of the poly-
omino on the lower side of Figure 4 has an area of the con-
vex hull which is less than f2 (l1, l2, 0, 0) it is a forbidden
sub-polyomino and only the described shapes remain. All
these polyominoes attain the maximum f2 (l1, l2, 0, 0). 
Figure 5: Complete set of extremal polyominoes with n 6 6
cells.
Theorem 1.1
c2(n) =

n3−2n2+4n
16 if n ≡ 0 mod 4,
n3−2n2+13n+20
32 if n ≡ 1 mod 4,
n3−2n2+4n+8
16 if n ≡ 2 mod 4,
n3−2n2+5n+8
32 if n ≡ 3 mod 4.
PROOF OF THEOREM 1.1. (Formula for c2(n).)
We use Lemma 2.5 and do a short calculation applying the
lemma of Cauchy-Frobenius. 
Corollary 2.6 The ordinary generating function for c2(n)
is given by
1+x−x2−x3+2x5+8x6+2x7+4x8+2x9−x10+x12
(1− x2)
2
(1− x4)
2
.
We have depicted the polyominoes with at most 6 cells
and maximum area of the convex hull in Figure 5. For more
cells we give only a few concrete numbers:
(c2(n))n=1,... = 1, 1, 1, 3, 5, 11, 9, 26, 22, 53, 36, 93, 64,
151, 94, 228, 143, 329, 195, 455, 271, 611, 351, 798, 460,
1021, 574, 1281, 722, 1583, 876, 1928, 1069, 2321, 1269,
2763, 1513, 3259, 1765, 3810, 2066, 4421, 2376, 5093, . . .
This is sequence A122133 in the Online-Encyclopedia of
Integer Sequences [10].
Besides the maximum area n + 12
⌊
n−1
2
⌋ ⌊
n
2
⌋
and the
minimum area n of the convex hull of polyominoes with
n cells several other values may be attained. In Theorem
1.2 we have completely characterized the set of areas of the
convex hull of polyominoes with n cells.
PROOF OF THEOREM 1.2. Since the vertex points of the
convex hull of a polyomino are lattice points on an integer
grid the area of the convex hull is an integral multiple of
1
2 . Using Theorem 2.4 we conclude that the desired set is a
subset of
S =
{
n+
m
2
| m 6
⌊
n− 1
2
⌋⌊n
2
⌋
, m ∈ N0
}
.
A polyomino P consisting of n cells with area n + 12 of
the convex hull must contain a triangle of area 12 . If we
extend the triangle to a square we get a convex polyomino
P ′ consisting of n+ 1 cells. Thus P ′ is an rectangular s× t-
polyomino with s · t = n + 1 and s, t ∈ N. If n + 1 is a
prime there exists only the 1 × (n + 1)-polyomino where
deleting a square yields an area of n for the convex hull. So
we have to exclude this case in the above set S and receive
the proposed set.
a
↔
b 1
l
Figure 6: Construction 1: 2 6 m 6 2n− 8.
For the other direction we give some constructions. For
m = 0we have the rectangular 1×n-polyomino as an exam-
ple. The above considerationm = 1 yields a construction if
n + 1 is a composite number. Now we consider Construc-
tion 1 depicted in Figure 6. We choose n = a + b + 1,⌈
n
2
⌉
6 a 6 n− 2, and 0 6 l 6 a− b− 1 = 2a− n. Thus
21
a > b+ 1 and Construction 1 is possible. If we run through
the possible values of a and l we obtain examples for
m ∈ {0}, {2, 3, 4}, . . . , {2a− n, . . . , 4a− 2n},
. . . , {n− 4, . . . , 2n− 8}
= {0, 2, 3, . . . , 2n− 8}
if n ≡ 0 mod 2 and for
m ∈ {1, 2}, {3, 4, 5, 6}, . . . , {2a− n, . . . , 4a− 2n},
. . . , {n− 4, . . . , 2n− 8}
= {1, 2, . . . , 2n− 8}
if n ≡ 1 mod 2.
. . .
Figure 7: Construction 2: m = 2n− 7.
In Figure 7 we give a construction for m = 2n − 7 and
in Figure 8 we give by the upper picture a construction for
2n − 6 6 m 6
⌈
n2−4n
4
⌉
with parameters k1, k2, and
b. The conditions for these parameters are 0 6 k1, k2 6
n− 2b− 2 and n− 2b− 2 > b. With given k1, k2, b, n we
havem = bn−2b2−2b+k1+k2(b−1). Since we can vary
k1 at least between 0 and b−1we can produce for a fix b all
values between b(n−2b−2) and 2b(n−2b−2) by varying
k1 and k2. Now we want to combine those intervals for
successive values for b. The assumption that the intervals
leave a gap is equivalent to 2(b − 1)(n − 2(b − 1) − 2) <
b(n−2b−2), that is, n < 2bb−3b−2 . We choose 2 6 b 6
⌊
n
4
⌋
and receive constructions for
m ∈
{
2n− 6, 2n− 5, . . . ,
⌈
n2 − 4n
4
⌉}
.
The lower picture of Figure 8 gives a construction for n >
5 and
m ∈
{⌊
n2 − 4n
4
⌋
, . . . ,
⌊
n2 − 2n− 8
4
⌋}
.

3 Dimensions d > 3
To prove the conjecture of Bezdek, Braß, and Harborth for
dimensions d > 3 we proceed similar as in Section 2.
k2
k1
l
l
b+ 1
1
l
⌊
n−1
2
⌋
⌊
n
2
⌋
Figure 8: Construction 3 and Construction 4.
Definition 3.1
fd(l1, . . . , ld, v1, . . . , vd) =∑
I⊆{1,...,d}
1
|I|!2d−|I|
2d−1∑
b=0
∏
i∈I
qb,i
with d > 1 and b =
d∑
j=1
bj2
j−1, bj ∈ {0, 1}, qb,i ={
li − 1 for bi = 0 ,
vi for bi = 1 .
Example 3.2
f3 (l1, l2, l3, v1, v2, v3) = 1+ l1 + l2 + l3 +
l1l2
2
+
l1l3
2
+
l2l3
2
+
l1l2l3
6
+
v1l2
2
+
v1l3
2
+
v2l1
2
+
v2l3
2
+
v3l1
2
+
v3l2
2
+
v1l2l3
6
+
v2l1l3
6
+
v3l1l2
6
+
v1v2l3
6
+
v1v3l2
6
+
v2v3l1
6
+ v1 + v2 + v3 +
v1v2
2
+
v1v3
2
+
v2v3
2
+
v1v2v3
6
with li = li − 1.
Lemma 3.3 The d-dimensional volume of the convex hull
of a polyomino with n unit hypercubes is at most
fd (l1, . . . , ld, v1, . . . , vd).
PROOF. We prove the statement by double induction on d
and n, using Equation (1). Since the case d = 2 is already
done in Theorem 2.4 we assume that the lemma is proven
for the d < d. Since for n = 1 only li = 1, vi = 0, i ∈
22
. . .
...
. . .
...
. . .
...
Figure 9: Construction 5:
⌊
n2−2n−6
4
⌋
6 m 6⌊
n2−2n+2
4
⌋
.
Constructions for the remaining values
m ∈
{⌊
n2 − 2n− 6
4
⌋
,
⌊
n2 − 2n− 2
4
⌋
,⌊
n2 − 2n+ 2
4
⌋
=
⌊
n− 1
2
⌋⌊n
2
⌋}
are given in Figure 9.
{1, . . . , d} is possible and fd (1, . . . , 1, 0, . . . , 0) = 1 the in-
duction base for n is done. Now we assume that the lemma
is proven for all possible tuples (l1, . . . , ld, v1, . . . , vd) with
1 +
∑d
i=1 (li − 1) +
∑d
i=1 vi = n − 1. Due to symmetry
we consider only the growth of l1 or v1, and the volume of
the convex hull by adding the n-th hypercube.(i) l1 increases by one:
As in the proof of Lemma 2.3 we draw lines of the con-
vex hull of the n-th cube and its neighbor cube N, see
Figure 10 for a 3-dimensional example. To be more
precisely each line of the new convex hull has a corner
point X of the upper face of the n-th cube as an end-
point. We will denote the second endpoint of this line
by Y. In direction of axis 1 there is a corner point X of
the bottom face of the n-th cube. Since X is also a cor-
ner point ofN the line XY is part of the old convex hull
if Y is part of the old convex hull. In this case we draw
the line XY. In the other case Y is also a corner point
of the upper face of the new cube and we draw the line
XY where Y is similar defined as X. Additionally we
draw all lines XY and XX.
Doing this we have constructed a geometrical body
which contains the increase of the convex hull and is
subdivided into nice geometrical objects Oi with vol-
ume base× heightki , for some ki ∈ {1, . . . , d} each. For
dimension d = 3 the cases ki = 1, ki = 2, or ki = 3
correspond to a box, a prism, or a tetrahedron.
We project the convex hull of the whole polyomino
into the hyperplane orthogonal to axis direction 1 and










   
  
   
  
   
  
 
 
 
l3 →
l2 ↑ A    
 
PP
P
PP
P










B
B
BB
B
B
BB
 
  
 
"
"
"
"
""
"
"
"
"




   
  
 
 
 
l3 →
l2 ↑
Figure 10: Increasing l1 in the 3-dimensional case.
receive a hypervolume A. This is the convex hull
of a (d − 1)-dimensional polyomino with parame-
ters l2, . . . , ld, v2, . . . , vd where li 6 li and vi 6
vi. From the induction hypothesis we know A 6
fd−1 (l2, . . . , ld, v2, . . . , vd). We apply the same pro-
jection to the Oi and objects Ai. Due to the construc-
tion the Ai are non overlapping and we have
∑
Ai 6
A. Using Cavalieri’s theorem we determine the volume
of Oi to be Ai×1ki . More precisely, we choose lines of
the form XX as height and lift the old base up until it is
orthogonal to axis direction 1. Thus we may assign a
factor 1k to each piece of A to bound the growth of the
volume of the convex hull. We estimate the parts in a
way that the parts with the higher factors are as big as
theoretical possible.
For every 0 6 r 6 d − 1 we consider the sets
{i1, i2, . . . , ir} with 1 6= ia 6= ib for a 6= b.
Let Z be such a set. Define Z = {j1, . . . , jd−r−1}
by Z ∩ Z = {} and Z ∪ Z = {2, . . . , d}. So
the vector space spanned by the axis directions of
Z and the vector space spanned by the axis direc-
tions of Z are orthogonal. If we project the con-
vex hull in the vector space spanned by Z the result-
ing volume is at mostfd−r−1 (lj1 , . . . , ljd−r−1 , vj1 ,
. . . , vjd−r−1) since it is the convex hull of a (d −
r − 1)-dimensional polyomino. Since Z has cardi-
nality d − r − 1 the set Z yields a contribution of
1
d−rfd−r−1 (lj1 , . . . , ljd−r−1 , vj1 , . . . , vjd−r−1) to the
volume of the convex hull. With the notations from
Definition 3.1 this is
1
d− r
∑
I⊆{j1,...,jr−d−1}
1
|I|!2d−r−1−|I|
2d−r−1−1∑
b=0
∏
i∈I
qb,i .
Our aim is to assign the maximum possible factor to
23
each part of A. For that reason we count for Z a maxi-
mum contribution of
1
d− r
1
|d− r− 1|!
2d−r−1−1∑
b=0
∏
i∈Y
qb,i
to the volume of the convex hull.
If we do so for all possible sets Z we have as-
signed a factor between 1 and 1d to every summand
of fd−1 (l2, . . . , ld, v2, . . . , vd). To get the induc-
tion step now we have to remark that the above
described sum with its factors is exactly the dif-
ference between fd (l1 + 1, . . . , ld, v1, . . . , vd) and
fd (l1, . . . , ld, v1, . . . , vd).
(ii) v1 increases by one:
Due to symmetry of the li and vi in Definition 3.1 this
is similar to case (i). Additionally we remark that the
maximum cannot be achieved in this case since we dou-
ble count a part of the contribution of the new cube to
the volume of the convex hull in our estimations.

Theorem 3.4 The d-dimensional volume of the convex hull
of any facet-to-facet connected system of n unit hypercubes
is at most ∑
I⊆{1,...,d}
1
|I|!
∏
i∈I
⌊
n− 2+ i
d
⌋
.
PROOF. For given n we determine the maximum of
fd (l1, . . . , fd, v1, . . . , vd). Due to
fd (l1 + 1, l2, . . . , ld, v1 − 1, v2, . . . , vd) −
fd (l1, l2, . . . , ld, v1, v2, . . . , vd) = 0
and due to symmetry we assume v1 = · · · = vd = 0 and
l1 6 l2 6 · · · 6 ld. Since for ld − l1 > 2
fd (l1 + 1, l2, . . . , ld−1, ld − 1, 0, 0, . . . , 0) −
fd (l1, l2, . . . , ld, 0, 0, . . . , 0) > 0 (2)
holds, we have 0 6 ld − l1 6 1. Inequality (2) is
valid due to the following consideration. If a summand
of fd(. . . ) contains the term l1 and does not contain ld
then there will be a corresponding summand with l1 re-
placed by ld, so those terms equalize each other in the above
difference. Clearly the summands containing none of the
terms l1 or ld equalize each other in the difference. So
there are left only the summands with both terms l1 and
ld. Since (l1 + 1− 1) (ld − 1− 1) − (l1 − 1) (ld − 1) =
ld − l1 − 1 > 0 Inequality (2) is valid.
Combining Equation (1) with 0 6 ld − l1 6 1 and
l1 6 l2 6 · · · 6 ld gives li =
⌊
n−2+i+d
d
⌋
. Thus by
inserting in Lemma 3.3 we receive the upper bound. The
maximum is attained for example by a polyomino consisting
of d pairwise orthogonal linear arms with
⌊
n−2+i
d
⌋
cubes
(i = 1 . . . d) joined to a central cube. 
Conjecture 3.5 Every d-dimensional polyomino P with pa-
rameters l1, . . . , ld, v1, . . . , vd and maximum volume of the
convex hull fulfills v1 = · · · = vd = 0 and contains a sub
polyomino P ′ fulfilling:
(i) P ′ has height 1 in direction of axis i,
(ii) the projection of P ′ along i has also maxi-
mal volume of the convex hull and parameters
l1, . . . , li−1, li+1, . . . , ld,
(iii) P can be decomposed into P ′ and up to two orthogonal
linear arms.
We remark that v1 = · · · = vd = 0 and the maximality of
the volume of the convex hull of sub polyominoes and pro-
jections of P can be concluded from the proof of Theorem
3.4.
Lemma 3.6 If there exists a d-dimensional polyomino with
n cells and volume v of the convex hull, then v ∈ Vd,n with
Vd,n=
n+md! ∣∣∣m 6∑
I⊆{1,...,d}
d!
|I|!
∏
i∈I
⌊
n−2+i
d
⌋
m∈N0
 .
PROOF. For the determination of the volume of the convex
hull of a d-dimensional polyomino we only have to consider
the set of S corner points of its hypercubes which lie on
an integer grid. We can decompose the convex hull into d-
dimensional simplices with the volume
1
d!
∣∣∣∣∣∣∣
x1,1 . . . x1,d 1
...
. . .
...
...
xd+1,1 . . . xd+1,d 1
∣∣∣∣∣∣∣
where the coordinates of the d + 1 points are given by
(xi,1, . . . , xi,d) ∈ Zd. Thus the volume of the convex hull
is an integer multiple of 1d! . The lower bound n 6 v is
obvious and the upper bound is given by Theorem 3.4. 
4 Remarks
We leave the description and the enumeration of the poly-
ominoes with maximum convex hull for dimension d > 3
as a task for the interested reader. It would also be nice to
see a version of Theorem 1.2 for higher dimensions.
The authors of [4] mention another class of problems
which are related to the problems in [3] and [11]: What is
the maximum area of the convex hull of all connected edge-
to-edge packing’s of n congruent regular k-gons (also de-
noted as k-polyominoes, see [7]) in the plane. The methods
of Section 2 might be applicable for these problems.
Conjecture 4.1 The area of the convex hull of any edge-to-
edge connected system of regular unit hexagons is at most
1
6
⌊
n2 + 143 n+ 1
⌋
.
24
Bibliography
[1] http://en.wikipedia.org/wiki/Byrsa.
[2] A. Bezdek and K. Bezdek, On a discrete Dido-type
question, Elem. Math. 44 (1989), no. 4, 92–100.
[3] K. Bezdek, Connected arrangements of finitely many
circles, Mitt. Math. Sem. Giessen (to appear).
[4] K. Bezdek, P. Braß, and H. Harborth, Maximum con-
vex hulls of connected systems of segments and of
polyominoes, Beiträge Algebra Geom. 35 (1994),
no. 1, 37–43, Festschrift on the occasion of the
65th birthday of Otto Krötenheerdt.
[5] L. Fejes Tóth, Über das Didosche Problem, Elem.
Math. 23 (1968), 97–101.
[6] L. Fejes Tóth, Research Problem No. 6, Period. Math.
Hungar. 4 (1973), 231–232.
[7] M. Koch and S. Kurz, Enumeration of generalized
polyominoes, (submitted).
[8] S. Kurz, Polyominoes with maximum convex hull, Mas-
ter’s thesis, Bayreuth, 2004.
[9] A. Siegel, A Dido problem as modernized by Fejes
Tóth, Discrete Comput. Geom. 27 (2002), no. 2,
227–238.
[10] N. J. A. Sloane, The on-line encyclopedia of inte-
ger sequences, published electronically at http://
www.research.att.com/ njas/sequences/, 2006.
[11] H. Harborth und S. Jäger, Konvexe Hüllen von
kantenbenachbarten regulären Vielecken, Math.
Semesterber. 38 (1991), 126–134.
25
26
Chapter 4
Enumeration of integral tetrahedra
SASCHA KURZ1
ABSTRACT. We determine the numbers of integral tetrahedra with
diameter d up to isomorphism for all d 6 1000 via computer enu-
meration. Therefore we give an algorithm that enumerates the in-
tegral tetrahedra with diameter at most d in O
(
d5
)
time and an
algorithm that can check the canonicity of a given integral tetra-
hedron with at most 6 integer comparisons. For the number of
isomorphism classes of integral 4 × 4 matrices with diameter d
fulfilling the triangle inequalities we derive an exact formula.
2000 MSC: 33F05; 05A15.
Key words and phrases: implicit enumeration, integral tetrahedra,
geometric probability, Euclidean metric, orderly generation,
canonicity check.
1 Introduction
Geometrical objects with integral side lengths have fasci-
nated mathematicians for ages. A very simple geometric
object is an m-dimensional simplex. Recently an intrigu-
ing bijection between m-dimensional simplices with edge
lengths in {1, 2} and the partitions of m + 1 was discovered
[2]. So far, for m-dimensional simplices with edge lengths
in {1, 2, 3} no formula is known and exact numbers are ob-
tained only up to m = 13 [9]. Let us more generally denote
by α(m,d) the number of non-isomorphic m-dimensional
simplices with edge lengths in {1, . . . , d} where at least one
edge has length d. We also call d the diameter of the sim-
plex. The known results, see e. g. [9], are, besides some
exact numbers,
α(1, d) = 1,
α(2, d) =
⌊
d+ 1
2
⌋⌊
d+ 2
2
⌋
=
⌊
(d+ 1)2
4
⌋
,
α(m, 1) = 1,
α(m, 2) = p(m+ 1) − 1,
where p(m+ 1) denotes the number of partitions ofm+ 1.
The aim of this article is the determination of the number of
non-isomorphic integral tetrahedra α(3, d).
1Sascha Kurz, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
Besides an intrinsic interest in integral simplices their
study is useful in field of integral point sets. These are sets
of n points in the m-dimensional Euclidean space Em with
pairwise integral distances. Applications for this combina-
torial structure involving geometry and number theory are
imaginable in radio astronomy (wave lengths), chemistry
(molecules), physics (energy quantum’s), robotics, architec-
ture, and other fields, see [3] for an overview. We define
the largest occurring distance of an integral point set P as
its diameter. From the combinatorial point of view there
is a natural interest in the determination of the minimum
possible diameter d(m,n) for given parameters m and n
[3, 4, 5, 7, 9, 10, 11, 12, 14, 16]. In most cases exact val-
ues of d(m,n) are obtained by an exhaustive enumeration
of integral point sets with diameter d 6 d(m,n). A nec-
essary first step for the enumeration of m-dimensional inte-
gral point sets is the enumeration ofm-dimensional integral
simplices. Hence there is a need for an efficient enumeration
algorithm.
Another application of integral tetrahedra concerns geo-
metric probabilities. Suppose you are given a symmetric
3× 3 matrix ∆2 with entries being equi-distributed in [0, 1]
and zeros on the main diagonal. The probability P2 that
∆2 is the distance matrix of a triangle in the Euclidean met-
ric can be easily determined to be P2 = 12 . As a general-
ization we ask for the probability Pm of a similar defined
(m + 1) × (m + 1) matrix ∆m being the distance matrix
of an m-dimensional simplex in the Euclidean metric. To
analyze the question form = 3 we consider a discretization
and obtain P3 = lim
d→∞ 4·α(3,d)d5 .
Our main results are the determination of α(3, d) for d 6
1000,
Theorem 1.1 The number α̂6(d, 3) of symmetric 4×4 ma-
trices with entries in {1, . . . , d} fulfilling the triangle in-
equalities is given by α̂6(d, 3) ={
17d6+425d4+1628d2
2880 for d ≡ 0 mod 2,
17d6+425d4+1763d2+675
2880 for d ≡ 1 mod 2.
If we additionally request a diameter of exactly d we have
α̂(d, 3) ={
34d5−85d4+680d3−962d2+1776d−960
960 for d ≡ 0 mod 2,
34d5−85d4+680d3−908d2+1722d−483
960 for d ≡ 1 mod 2,
27
Theorem 1.2
0.090 6 P3 6 0.111,
and the enumeration algorithms of Section 4 and Section 5,
which allow us to enumerate integral tetrahedra with diame-
ter at most d in timeO
(
d5
)
and to check a 4× 4-matrix for
canonicity using at most 6 integer comparisons.
2 Number of integral tetrahedra
Because a symmetric 4 × 4-matrix with zeros on the main
diagonal has six independent non-zero values there are d6
labeled integral such matrices with diameter at most d. To
obtain the number α6(d, 3) of unlabeled matrices we need
to apply the following well known Lemma:
Lemma 2.1 (Cauchy-Frobenius, weighted form)
Given a group action of a finite group G on a set S and a
mapw : S −→ R from S into a commutative ring R contain-
ing Q as a subring. If w is constant on the orbits of G on S,
then we have, for any transversal T of the orbits:∑
t∈T
w(t) =
1
|G|
∑
g∈G
∑
s∈Sg
w(s)
where Sg denotes the elements of S being fixed by g, i. e.
Sg = {s ∈ S|s = gs} .
For a proof, notation and some background we refer to
[6]. Applying the lemma yields:
Lemma 2.2
α6(d, 3) =
d6 + 9d4 + 14d2
24
and
α(d, 3) = α6(d, 3) − α6(d− 1, 3)
=
6d5 − 15d4 + 56d3 − 69d2 + 70d− 24
24
.
As geometry is involved in our problem we have to take
into account some properties of Euclidean spaces. In the
Euclidean plane E2 the possible occurring triples of dis-
tances of triangles are completely characterized by the tri-
angle inequalities. In general there is a set of inequalities
using the so called Cayley-Menger determinant to charac-
terize whether a given symmetric (m+ 1)× (m+ 1) matrix
with zeros on the main diagonal is a distance matrix of anm-
dimensional simplex [13]. For a tetrahedron with distances
δi,j, 0 6 i 6 j < 4, the inequality
CMD3 =
∣∣∣∣∣∣∣∣∣∣
0 δ20,1 δ
2
0,2 δ
2
0,3 1
δ21,0 0 δ
2
1,2 δ
2
1,3 1
δ22,0 δ
2
2,1 0 δ
2
2,3 1
δ23,0 δ
2
3,1 δ
2
3,2 0 1
1 1 1 1 0
∣∣∣∣∣∣∣∣∣∣
> 0 (1)
has to be fulfilled besides the triangle inequalities.
In a first step we exclusively consider the triangle in-
equalities for m = 3 and count the number α̂6(d, 3) of
non-isomorphic symmetric 4 × 4 matrices with entries in
{1, . . . , d} fulfilling the triangle inequalities.
d α(d, 3) d α(d, 3) d α(d, 3)
1 1 51 8854161 120 639349793
2 4 52 9756921 140 1382200653
3 16 53 10732329 160 2695280888
4 45 54 11783530 180 4857645442
5 116 55 12916059 200 8227353208
6 254 56 14133630 220 13251404399
7 516 57 15442004 240 20475584436
8 956 58 16845331 260 30554402290
9 1669 59 18349153 280 44260846692
10 2760 60 19957007 300 62496428392
11 4379 61 21678067 320 86300970558
12 6676 62 23514174 340 116862463817
13 9888 63 25473207 360 155526991341
14 14219 64 27560402 380 203808692441
15 19956 65 29783292 400 263399396125
16 27421 66 32145746 420 336178761892
17 37062 67 34657375 440 424224122232
18 49143 68 37322859 460 529820175414
19 64272 69 40149983 480 655468974700
20 82888 70 43145566 500 803900006590
21 105629 71 46318399 520 978079728301
22 133132 72 49673679 540 1181221582297
23 166090 73 53222896 560 1416796092768
24 205223 74 56969822 580 1688540496999
25 251624 75 60926247 600 2000468396580
26 305861 76 65098817 620 2356880503873
27 369247 77 69497725 640 2762373382787
28 442695 78 74130849 660 3221850132593
29 527417 79 79008179 680 3740530243895
30 624483 80 84138170 700 4323958989350
31 735777 81 89532591 720 4978017317882
32 861885 82 95198909 740 5708932993276
33 1005214 83 101149823 760 6523288334629
34 1166797 84 107392867 780 7428031732465
35 1348609 85 113942655 800 8430487428682
36 1552398 86 120807154 820 9538364312059
37 1780198 87 127997826 840 10759766492473
38 2033970 88 135527578 860 12103204603044
39 2315942 89 143409248 880 13577602128303
40 2628138 90 151649489 900 15192308794063
41 2973433 91 160268457 920 16957109053082
42 3353922 92 169272471 940 18882231158104
43 3773027 93 178678811 960 20978358597822
44 4232254 94 188496776 980 23256639532080
45 4735254 95 198743717 1000 25728695195597
46 5285404 96 209427375
47 5885587 97 220570260
48 6538543 98 232180129
49 7249029 99 244275592
50 8019420 100 256866619
Table 1: Number α(d, 3) of integral tetrahedra with diame-
ter d.
28
Proof of Theorem 1.1.
Counting labeled symmetric 4 × 4 matrices with entries in
{1, . . . , d} fulfilling the triangle inequalities is equivalent to
determining integral points in a six-dimensional polyhedron.
Prescribing the complete automorphism group results in
some further equalities and an application of the inclusion-
exclusion principle. Thus, after a lengthy but rather easy
computation we can apply Lemma 2.1 and obtain
24α̂6(d, 3) = 3 ·
⌈
4d4+5d2
12
⌉
+8 ·
(
d2−d
⌈
d
2
⌉
+
⌈
d
2
⌉2)
+6 ·
37d4 − 18d3 + 20d2 − 21d+
(
36d2 + 42
) ⌈
d
2
⌉
96
+
⌈
34d6 + 55d4 + 136d2
240
⌉
+ 6 ·
(
d2−d
⌈
d
2
⌉
+
⌈
d
2
⌉2)
,
which can be modified to the stated formulas. 
In addition to this proof we have verified the stated for-
mula for d 6 500 via a computer enumeration. We re-
mark that α̂6(d,3)α6(d,3) and
α̂(d,3)
α(d,3) tend to
17
120 = 0.1416 if
d→∞. Moreover we were able to obtain an exact formula
for α̂(d, 3) because the Cayley-Menger determinant
CMD2 =
∣∣∣∣∣∣∣∣
0 δ20,1 δ
2
0,2 1
δ21,0 0 δ
2
1,2 1
δ22,0 δ
2
2,1 0 1
1 1 1 0
∣∣∣∣∣∣∣∣
for dimensionm = 2 can be written as
CMD2 = −(δ0,1 + δ0,2 + δ1,2) (δ0,1 + δ0,2 − δ1,2)
· (δ0,1 − δ0,2 + δ1,2) (−δ0,1 + δ0,2 + δ1,2) .
Thus CMD2 < 0 is equivalent to the well known linear tri-
angle inequalities δ0,1 + δ0,2 > δ1,2, δ0,1 + δ1,2 > δ0,2
and δ0,2 + δ1,2 > δ0,1. Unfortunately for m > 3 the
Cayley-Menger determinant is irreducible [1] and one can-
not simplify (−1)m+1CMDm > 0 into a set of inequalities
of lower degree. So we are unable to apply the same method
to derive an analytic formula for α(d, 3).
Lemma 2.3 We have α(3, d) ∈ Θ
(
d5
)
and α6(3, d) ∈
Θ
(
d6
)
, where f ∈ Θ(g) iff f ∈ O(g) and f ∈ Ω(g).
PROOF. The upper bounds are trivial since they also hold for
symmetric matrices with integer values at most d and zeros
on the main diagonal. For the lower bounds we consider six-
tuples δ0,1 ∈ [d, d(1 − ε)), δ0,2 ∈ [d(1 − ε), d(1 − 2ε)),
δ1,2 ∈ [d(1−2ε), d(1−3ε)), δ0,3 ∈ [d(1−3ε), d(1−4ε)),
δ1,3 ∈ [d(1−4ε), d(1−5ε)), and δ2,3 ∈ [d(1−5ε), d(1−
6ε)). For each ε there areΩ
(
d6
)
non-isomorphic matrices.
If ε is suitable small then all these matrices fulfill the triangle
conditions and Inequality (1). 
In general we have α6(m,d) ∈ Θ
(
dm(m+1)/2
)
and
α(m,d) ∈ Θ
(
dm(m+1)/2−1
)
.
In Section 4 and Section 5 we give an algorithm to obtain
α(d, 3) via implicit computer enumeration. Some of these
computed values are given in Table 1. For a complete list of
α(d, 3) for d 6 1000 we refer to [8]. This amounts to
α6(1000, 3) = 4299974867606266 ≈ 4.3 · 1015.
3 Bounds for P3
In this section we give bounds for the probability P3 that ∆3
is the distance matrix of a tetrahedron in the 3-dimensional
Euclidean space E3, where ∆3 is a symmetric 4 × 4 matrix
with zeros on the main diagonal and the remaining entries
being equi-distributed in [0, 1]. Therefore we consider a dis-
cretization. Let d be a fixed number. We consider the d6 six-
dimensional cubes Ci1,...,i6 := ×6j=1
[
ij
d ,
ij+1
d
]
⊆ [0, 1]6.
For every cube C it is easy to decide whether every point
of C fulfills the triangle conditions, no points of C fulfill the
triangle conditions, or both cases occur. For Inequality (1)
we have no explicit test but we are able to compute a lower
bound CMD3 (C) and an upper bound CMD3 (C), so that
we have
CMD3 (C) 6 CMD3(x) 6 CMD3 (C) for all x ∈ C.
Thus for some cubes C we can decide that all x ∈ C corre-
spond to a tetrahedron. We denote this case by Ξ (C) = 1. If
no x ∈ C corresponds to a tetrahedron we set Ξ (C) = −1.
In all other cases we define Ξ (C) = 0. With this we obtain
for all d ∈ N the following bounds:
Lemma 3.1∑
C :Ξ(C)=1
1
d6
6 P3 6 1−
∑
C :Ξ(C)=−1
1
d6
.
Thus we have a method to obtain bounds on P3 using
computer calculations. For the actual computation we use
two further speed ups. We can take advantage of symmetries
and use an adaptive strategy: We start with a small value of
d and subdivide cubes C with Ξ (C) = 0 recursively into 8
smaller cubes. After a computer calculation we obtain
0.090 6 P3 6 0.111,
which proves Theorem 1.2. Clearly Theorem 1.2 can be im-
proved by simply letting the computers work for a longer
time or by using a computing cluster, but the convergence of
our approach seems to be rather slow. An enhanced check
whether a cube C fulfills Inequality (1) would be very use-
ful.
Good estimates for P3 can be obtained by considering
the values α(3, d) in the following way. At first we consider
the probability P̃3 being defined as P3 where additionally
δ0,1 = 1.
Lemma 3.2
P̃3 = P3.
PROOF. The problem of determining P3 or P̃3 is an inte-
gration problem. Due to symmetry we only need to con-
sider the domain where δ0,1 is the maximum of the six
side lengths. For every δ0,1 ∈ (0, 1] there is a probabil-
ity p (δ0,1) that δ0,1, . . . , δ2,3 are distances of a tetrahedron
where δ0,2, . . . , δ2,3 ∈ (0, δ0,1] are equi-distributed ran-
dom variables. Since p (δ0,1) is constant we can conclude
the stated equation. 
29
Lemma 3.3
P3 = lim
d→∞
4 · α(d, 3)
d5
.
PROOF. We consider a modified version of the algorithm
described above to obtain exact bounds on P̃3. As al-
ready mentioned, the triangle inequalities alone define a
five-dimensional polyhedron. Since determinants are con-
tinuous CMD3 = 0 defines a smooth surface and so the
volume of all cubes C with Ξ (C) = 0 converges to zero.
Thus substituting Ξ (C) by the evaluation of Ξ in an arbitrary
corner of C yields the correct value for P̃3 = P3 for d→∞.
Since there are at most O
(
d4
)
six-tuples (d, i2, . . . , i6),
ij ∈ {1, . . . , d} with non-trivial automorphism group we can
factor out symmetry and conclude the stated result. 
Using Lemma 2.2 and Theorem 1.1 we can modify this to
P3 = lim
d→∞
α(d, 3)
α(d, 3)
6 lim
d→∞
α̂(d, 3)
α(d, 3)
=
17
120
= 0.1416.
Heuristically we observe that the finite sequence(
α(d,3)
α(d,3)
)
16d61000
is strictly decreasing. So the fol-
lowing values might be seen as a good estimate for
P3:
α(600, 3)
α(600, 3)
=
2000468396580
19359502966749
≈ 0.103333,
α(800, 3)
α(800, 3)
=
8430487428682
81665192828999
≈ 0.103232, and
α(1000, 3)
α(1000, 3)
=
25728695195597
249377330461249
≈ 0.103172.
4 Orderly generation of integral
tetrahedra
Our strategy to enumerate integral tetrahedra is to merge two
triangles along a common side. In Figure 1 we have de-
picted the two possibilities in the plane to join two triangles
(0, 1, 2) and (0, 1, 3) along the side 01. If we rotate the tri-
angle (0, 1, 3) in the 3-dimensional space from the position
on the left in Figure 1 to the position on the right we obtain
tetrahedra and the distance δ2,3 forms an interval [l, u]. The
restriction to integral tetrahedra is fairly easy.
@
@
 
 ""
"
"
"
```
`` u0
u1u3u2
"
"
"
"
"
```
``
 
 
@
@u
0
u1 u3u2
Figure 1: Joining two triangles.
Let us consider the example δ0,1 = 6, δ0,2 = δ1,2 = 5,
δ0,3 = 4, and δ1,3 = 3. Solving CMD3 = 0 over
the positive real numbers yields that the configuration is a
tetrahedron iff δ2,3 ∈
(√
702−24
√
455
6 ,
√
702+24
√
455
6
)
≈
(2.297719304, 5.806934304). Thus there are integral tetra-
hedra for δ2,3 ∈ {3, 4, 5}. In general we denote such a set of
tetrahedra by
δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3 ∈ [l, r].
This notation permits to implicitly listΩ
(
d6
)
integral tetra-
hedra in O
(
d5
)
time.
All integral tetrahedra can be obtained in this manner. So
an enumeration method is to loop over all suitable pairs of
integral triangles and to combine them. We will go into de-
tail in a while. Before that we have to face the fact that
our enumeration method may construct pairs of isomorphic
tetrahedra. Looking at Table 1 we see that storing all along
the way constructed non-isomorphic integral tetrahedra in a
hash table is infeasible. Here we use the concept of orderly
generation [15] which allows us to decide independently for
each single constructed discrete structure if we have to take
or to reject it. Therefore we have to define a canonical form
of an integral tetrahedron. Here we say that a tetrahedron
T with side lengths δi,j is canonical if for the lexicographic
ordering of vectors ,
(δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3) (
δτ(0),τ(1), . . . , δτ(2),τ(3)
)
holds for all permutation τ of the points 0, 1, 2, 3. We de-
scribe the algorithmic treatment of a canonicity function
χ (T) 7→ {true, false} which decides whether a given in-
tegral tetrahedron T is canonical in Section 5. We have the
following obvious lemma:
Lemma 4.1 If χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3) = true
and χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3 + 1) = false then
χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3 + n) = false for all
n > 1. If χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3) = true
and χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3 − 1) = false then
χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3 − n) = false for all 1 6
n 6 δ2,3.
Thus for given δ0,1, δ0,2, δ1,2, δ0,3, and δ1,3 the
possible values for δ2,3 which correspond to a canon-
ical tetrahedron form an interval
[
l̂, û
]
. Clearly, the
value of χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3) has to be eval-
uated for δ2,3 ∈
{
δi,j − 1, δi,j, δi,j + 1 | (i, j) ∈
{(0, 1), (0, 2), (1, 2), (0, 3), (1, 3)}
}
only. Thus we can de-
termine the interval
[
l̂, û
]
using O(1) evaluations of χ (T).
Algorithm 4.2 Orderly generation of integral tetrahedra
Input: Diameter d
Output: A complete list of canonical integral tetrahedra
with diameter d
begin
δ0,1 = d
for δ0,2 from
⌊
d+2
2
⌋
to d do
for δ1,2 from d+ 1− δ0,2 to δ0,2 do
for δ0,3 from d+ 1− δ0,2 to δ0,2 do
30
for δ1,3 from d+ 1− δ0,3 to δ0,2 do
Determine the interval
[
l̂, û
]
for δ2,3
print δ0,1, δ0,2, δ1,2, δ0,3, δ1,3,
[
l̂, û
]
end
end
end
end
end
We leave it as an exercise for the reader to prove the correct-
ness of Algorithm 4.2 (see [15] for the necessary and suffi-
cient conditions of an orderly generation algorithm). Since
we will see in the next section that we can perform χ (T)
in O(1) the runtime of Algorithm 4.2 is O
(
d4
)
. By an ob-
vious modification Algorithm 4.2 returns a complete list of
all canonical integral tetrahedra with diameter at most d in
O
(
d5
)
time.
We remark that we have implemented Algorithm 4.2 us-
ing Algorithm 5.1 for the canonicity check. For the compu-
tation of α(800, 3) our computer needs only 3.3 hours which
is really fast compared to the nearly 3 hours needed for a
simple loop from 1 to α(800, 3) on the same machine. Due
to the complexity of O
(
d4
)
for suitable large d the deter-
mination of α(d, 3) will need less time than the simple loop
from 1 to α(d, 3) on every machine.
5 Canonicity check
In the previous section we have used the canonicity check
χ (T) as a black box. The straight forward approach to
implement it as an algorithm is to run over all permuta-
tions τ ∈ S4 and to check whether (δ0,1, . . . , δ2,3) (
δτ(0),τ(1), . . . , δτ(2),τ(3)
)
. This clearly leads to running
time O(1) but is too slow for our purpose. It may be imple-
mented using 24·6 = 144 integer comparisons. Here we can
use the fact that the tetrahedra are generated by Algorithm
4.2. So if we arrange the comparisons as in Algorithm 5.1
at most 6 integer comparisons suffice.
Algorithm 5.1 Canonicity check for integral tetrahedra
generated by Algorithm 4.2
Input: δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3
Output: χ (δ0,1, δ0,2, δ1,2, δ0,3, δ1,3, δ2,3)
begin
if δ0,1 = δ0,2 then
if δ0,2 = δ1,2 then
if δ0,3 < δ1,3 then return false
else
if δ1,3 < δ2,3 then return false
else return true end
end
else
if δ1,3 < δ2,3 then return false
else
if δ0,1 = δ0,3 then
if δ1,2 < δ1,3 then return false
else return true end
else
if δ0,1 > δ1,3 then return true
else
if δ1,2 < δ0,3 then return false
else return true end
end
end
end
end
else
if δ0,2 = δ1,2 then
if δ0,1 < δ2,3 or δ0,3 < δ1,3 then return false
else return true end
else
if δ0,2 = δ1,3 then
if δ0,3 > δ1,2 or δ0,1 < δ2,3 then return false
else return true end
else
if δ0,2 = δ0,3 then
if δ1,2 < δ1,3 or δ0,1 6 δ2,3
then return false
else return true end
else
if δ0,3 > δ1,2 then
if δ0,1 6 δ2,3 then return true
else return false end
else
if δ0,1 < δ2,3 then return true
else return false end
end
end
end
end
end
end
To prove the correctness of Algorithm 5.1 we consider
all vectors (δ0,1, . . . , δ2,3) with δi,j ∈ {0, . . . , 5}, δ0,1 >
δ0,2 > δ1,2, δ0,2 > δ0,3, and δ0,2 > δ1,3. It suffices to
show that Algorithm 5.1 returns the correct value for this
finite set of vectors since these inequalities are fulfilled by
Algorithm 4.2 and also necessary for χ (T) = true. Al-
gorithm 5.1 can be considered as a binary decision tree. It
might be a task to optimize this type of binary decision tree
in the worst or in the average case.
6 Dimensions m > 4
Clearly the question for bounds for Pm arises also for m >
4. But non-trivial answers seem out of reach by our ap-
proach. So far we have no efficient equivalent of Algo-
rithm 5.1 at hand and the number α(4, d) of integral 4-
dimensional simplices with diameter d is Ω
(
d9
)
. We give
the known values of α(4, d) in Table 6.
Bibliography
[1] C. d’Andrea and M. Sombra, The Cayley-Menger de-
terminant is irreducible for n > 3, Siberian Math.
31
d α(d, 4) d α(d, 4)
1 1 27 4716186332
2 6 28 6541418450
3 56 29 8970194384
4 336 30 12168243592
5 1840 31 16344856064
6 7925 32 21748894367
7 29183 33 28688094208
8 91621 34 37529184064
9 256546 35 48713293955
10 648697 36 62769489452
11 1508107 37 80321260053
12 3267671 38 102108730634
13 6679409 39 128999562925
14 12957976 40 162007000505
15 24015317 41 202323976907
16 42810244 42 251321436143
17 73793984 43 310607982160
18 123240964 44 382002253424
19 200260099 45 467627887530
20 317487746 46 569910996879
21 492199068 47 691631229557
22 747720800 48 835911697430
23 1115115145 49 1006370948735
24 1634875673 50 1207047969441
25 2360312092 51 1442539675756
26 3358519981 52 1718015775541
Table 2: Number α(d, 4) of integral 4-dimensional sim-
plices with diameter 1 6 d 6 52.
J. 46 (2005), 90–97.
[2] C. Haase and S. Kurz, A bijection between the d-
dimensional simplices with distances in {1, 2} and
the partitions of d+1, J. Combin. Theory Ser. A
113 (2006), no. 4, 736–738.
[3] H. Harborth, Integral distances in point sets, Karl der
Grosse und sein Nachwirken. 1200 Jahre Kultur
und Wissenschaft in Europa. Band 2: Mathematis-
ches Wissen. Turnhout: Brepols (P. L. Butzer et al.,
eds.), 1998, 213–224.
[4] H. Harborth, A. Kemnitz, and M. Möller, An upper
bound for the minimum diameter of integral point
sets, Discrete Comput. Geom. 9 (1993), no. 4, 427–
432.
[5] A. Kemnitz, Punktmengen mit ganzzahligen Ab-
ständen, Habilitationsschrift, TU Braunschweig,
1988.
[6] A. Kerber, Applied finite group actions. 2nd, rev.
and exp. ed., Algorithms and Combinatorics. 19.
Berlin: Springer. xxvi, 454 p., 1999.
[7] A. Kohnert and S. Kurz, A note on Erdös-Diophantine
graphs and Diophantine carpets, Math. Balkanica
(N.S.) 21 (2007), no. 1-2, 1–5.
[8] S. Kurz, http://www.wm.uni-bayreuth.de/
index.php?id=252.
[9] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[10] S. Kurz, On the characteristic of integral point sets in
Em, Australas. J. Combin. 36 (2006), 241–248.
[11] S. Kurz and R. Laue, Bounds for the minimum diame-
ter of integral point sets, Australas. J. Combin. 39
(2007), 233–240.
[12] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin., (to
appear).
[13] K. Menger, Untersuchungen über allgemeine Metrik,
Math. Ann. 100 (1928), 75–163.
[14] L. Piepmeyer, Räumliche ganzzahlige Punktmengen,
Master’s thesis, TU Braunschweig, 1988.
[15] R. C. Read, Every one a winner or how to avoid
isomorphism search when cataloguing combinato-
rial configurations, Ann. Discrete Math. 2 (1978),
107–120.
[16] J. Solymosi, Note on integral distances, Discrete Com-
put. Geom. 30 (2003), no. 2, 337–342.
32
Chapter 5
Integral point sets over Zmn
AXEL KOHNERT1 AND SASCHA KURZ2
ABSTRACT. There are many papers studying properties of point
sets in the Euclidean space Em or on integer grids Zm, with pair-
wise integral or rational distances. In this article we consider the
distances or coordinates of the point sets which instead of being
integers are elements of Z/Zn, and study the properties of the re-
sulting combinatorial structures.
2000 MSC: 52C10; 51E99.
Key words and phrases: integral distances, exhaustive search,
finite rings, orderly generation.
1 Introduction
There are many papers studying properties of point sets in
the Euclidean space Em, with pairwise integral or rational
distances (for short integral point sets or rational point sets,
respectively), see [17] for an overview and applications. A
recent collection of some classical open problems is given in
[6, Section 5.11]. Some authors also require that the points
are located on an integer grid Zm [11, 31]. In this paper we
modify the underlying space and study instead of Z the inte-
gers modulo n, which we denote by Zn or Z/Zn. This was
a suggestion of S. Dimiev. Our motivation was to gain some
insight for the original problem in Zm and Em. In the next
subsection we shortly repeat the basic facts and questions
about integral point sets in Zm and Em.
1.1 Integral point sets in Zm and Em
So let us now consider integral point sets in Em. If we de-
note the largest distance of an integral point set, consisting
of n points, as its diameter, the natural question for the min-
imum possible diameter d(n,m) arises, see Figure 1 for an
example. Obviously we have d(n, 1) = n− 1. To avoid the
corresponding trivial 1-dimensional configuration in higher
dimensions, it is common to request that an m-dimensional
1Axel Kohnert, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: axel.kohnert@uni-bayreuth.de
2Sascha Kurz, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
integral point set is not contained in a hyperplane of Em.
We call a set of m + 1 points in Zm or Em degenerated, if
the points are indeed contained in a hyperplane. There are
quite a lot of constructions which show that d(n,m) exists
for n + 1 > m, see e. g. [18]. Some exact values are
determined in [21, 24, 27, 28, 33]. The best known upper
bound d(n,m) ∈ O
(
ec log(n−m) log log(n−m)
)
is given in
[18]. For m = 2 Solymosi [36] gives the best known lower
bound d(n, 2) > cn. Form = 2 and n > 9 the shape of the
examples with minimum diameter is conjectured to consist
of n − 1 collinear points and one point apart [28], see Fig-
ure 1 for an example with n = 9. We would like to remark
that this conjecture is confirmed for n 6 122 by an exhaus-
tive search [28]. If for a fix ρ > 0, we have a sequence of
plane integral point set Pi, each containing a collinear sub-
set of cardinality least nρ, then the diameters of the Pi are in
Ω
(
ec logn log logn
)
[24, 28]. Form > 3 we refer to [24, 27],
where some bounds and exact numbers are given.
t t t t t t t t
t
5 3 5 3 5 3 5
17 13 11 9 9 11 13 17
Figure 1: A 2-dimensional integral point set with n = 9 and
diameter 29.
Some authors require integral point sets to fulfill certain
further conditions. The two classical conditions are, that no
m+1 points are contained in an (m−1)-dimensional hyper-
plane, and that no m + 2 points are located on an (m − 1)-
dimensional hypersphere. For ease of notation we speak of
semi-general position in the first case and of general posi-
tion if both conditions are fulfilled. We denote the minimum
diameter of integral point sets in semi-general position by
d(n,m) and of integral point sets in general position by
ḋ(n,m). For some small parameters the exact values have
been determined in [21, 23, 24, 28, 33]. We would like to re-
mark that for dimension m = 2 and 3 6 n 6 36 points, the
examples with minimum possible diameter d(n, 2), consist
of points on a circle [24, 28].
A famous question of Erdős asks for point sets in the
plane with seven points in general position (e. g. no three
33
on a line and no four on a circle) with pairwise integral dis-
tances. Actually he first asked for such a set with five points,
which was answered by Harborth [15, 16], then for a set with
six points, which was answered by Kemnitz [21]. Kemnitz
even gives a construction for infinitely many such sets with
coprime distances. For a long time no example consisting
of seven points was known. Very recently one of the authors
has discovered two such examples with diameters 22270 and
66810 [23]. For dimensionsm > 3 we refer to [17, 24].
As a specialization, integral point sets in general position,
with all n points on an integer grid Zm, are called nm-
clusters. Noll and Bell have found nm-clusters for m 6 5
and n 6 m + 4 but have no example for n > m + 5 [31].
For m > 3 even no integral point set in semi-general posi-
tion with at leastm+ 5 points is known.
Conjecture 1.1 (Erdős and Noll) For any m > 1, n >
1, there exists either none or an infinite number of non-
isomorphic nm-clusters.
An important invariant of an integral point set is its char-
acteristic, which is defined as follows:
Definition 1.2 Let S be a non-degenerated integral point set
ofm+ 1 points in them-dimensional Euclidean space Em.
By Vm we denote the m-dimensional volume of the simplex
being formed by the convex hull of S. Since the pairwise
distances of S are integral and S is not degenerated we have
(Vm)
2 ∈ N\{0}. Thus Vm can be uniquely written as Vm =
q
√
c with q ∈ Q and a squarefree integer c. This integer
c is called the characteristic char (S) of an integral simplex
S.
The following theorem allows us to define the character-
istic of an integral point set.
Theorem 1.3 In an m-dimensional integral point set P
each non-degenerate integral simplex S has the same char-
acteristic char (S).
Definition 1.4 Let P be anm-dimensional integral point set
and S ⊆ P be an arbitrary m-dimensional non-degenerate
integral sub-simplex of P. The characteristic char (P) of P
is given by char (P) = char (S).
For dimension m = 2 Theorem 1.3 can be traced back at
least to Kummer [21], form > 3we refer to [25]. We would
like to remark that if we are in the special case, where also
the coordinates of anm-dimensional integral point set P are
integral, every subset S of P, consisting of m + 1 points,
has an integral volume. In our notation this means, that for
an integral point set P in Zm we have char (P) = 1. So all
nm-clusters have characteristic one.
From [13, 25] we know, that if P is anm-dimensional in-
tegral point set in Em with characteristic char (P) = 1, then
there exists an embedding of P in Em using only rational
coordinates. The existence of an embedding using only in-
tegral coordinates is an interesting open conjecture of [13].
2 Integral point sets over Zmn
In the previous section we have seen, that almost certainly
there is a lot of hidden structure in the set of integral point
sets which attain the minimum possible diameter and fulfill
certain further conditions. Although the problem of inte-
gral point sets is a very classical one, not much progress has
been achieved towards structure results or tight bounds on
the minimum diameter. The idea of this paper is to study
similar problems, which might be easier to handle, but may
give some insight in the original problem. At first we want
to consider the study of integral point sets in Zm as our orig-
inal problem and relate it to some problem of point sets in
Zmn .
So let P ′ be an integral point set over Zm. To relate P ′ to
a set P of points in Zmn we consider the canonical mapping
φn : Z→ Zn, x 7→ x+Zn = x, which maps coordinates in
Zm to coordinates in Zmn . Ifn is suitably large no two points
of P ′ will be mapped onto the same point in P. To be able
to translate results in Zmn back to Zm, we define the inverse
mapping Ψn : Zn → {0, . . . , n− 1} by Ψ (φn(x)) = x for
x ∈ {0, . . . , n − 1}. As an abbreviation we set Ψn(x) = x̂
and φn(x) = x, whenever the value of n is clear from the
context. Since points in P ′ have integral distances in Zm we
need a similar definition of integral distances in Zmn . The
most natural way to define an integral distance over Zmn is:
Definition 2.1 Two points (u1, . . . , um) , (v1, . . . , vm) ∈
Zmn are at integral distance, if there exists a number d ∈ Zn
with
m∑
i=1
(ui − vi)
2
= d2.
With this definition an integral point set P ′ over Zm is
mapped via φn onto an integral point set P over Zmn . Since
φn may map some point set P ′ over Zm, which is not con-
tained in a hyperplane of Zm, onto a point set P ′, where all
points are contained in a hyperplane of Zmn , we do not make
any requirements on the distribution of the points in an inte-
gral point set over Zmn in the first run. The next definition to
translate from Zm or Em to Zmn is the minimum diameter.
In Zm and Em we need the concept of a minimum diameter
to get a finite space, whereas Zmn is finite for itself. So we
find it natural to consider the maximum number of integral
points.
Definition 2.2 By I(n,m) we denote the maximum number
of points in Zmn with pairwise integral distances.
Theorem 2.3 I(n, 1) = n, I(1,m) = 1, and I(2,m) =
2m.
PROOF. Because there are only nm different elements in
Zmn we have the trivial upper bound I(n,m) 6 nm. This
upper bound is only attained if m = 1 or n 6 2, since Zn
has at least one quadratic non residue for n > 3. 
For n > 3 we so far were not able to derive explicit for-
mulas for I(n,m) and so we give in Table 1 some values
34
m\n 3 4 5 7 8 9
2 3 8 5 7 16 27
3 4 16 25 8 64 81
4 9 32 25 49 512 324
5 27 128 125 343 2048 > 893
6 33 256 > 125 > 15296
7 > 35 1024 > 81792
m\n 11 13 16 17
2 11 13 64 17
3 11 169 256 289
4 121 > 169 1024
5 > 1331 > 2197
Table 1: Values of I(n,m) for small parameters n andm.
for small parameters n and m, obtained by exhaustive enu-
meration via clique search, which we will describe in the
next subsection. Further exact values or lower bounds can
be determined using Theorem 2.3 and 2.7 of Subsection 2.2.
2.1 Exhaustive enumeration of integral point
sets over Zmn via clique search
In this subsection we describe how the exact values I(n,m)
of Table 1 were obtained. We model our problem as a
graph G, so that the cliques (e. g. complete subgraphs) of
G are in bijection to integral point sets over Zmn . There-
fore we choose the elements of Zmn as vertices and connect
x, y ∈ Zmn via an edge, if and only if x and y are at integral
distance.
To determine I(n,m), we only have to determine the
maximum cardinality of a clique of G. Unfortunately this
is an NP-hard problem in general, but practically this ap-
proach was also successful in the case of integral point sets
over Em [24, 28], due to good heuristic maximum-clique al-
gorithms. Besides an implementation of the Bron-Kerbosch
algorithm [7] written by ourself we use the software package
CLIQUER [30, 32] of Niskanen and Östergård.
By prescribing points or distances of an integral point set
P, it is possible to reduce the complexity for the clique-
search algorithm. The first variant is, that due to symmetry
we can assume that the point 0 =
(
0, . . . , 0
)
∈ Zmn is part of
P. As vertices of G we choose the points in Zmn \{0}, which
have an integral distance to 0. Again two vertices x, y ∈ G
are joined by an edge, if the corresponding points are at in-
tegral distance.
For the second variant we consider the set Dn,m of all
points d = (d1, . . . , dm) ∈ Zmn , which have an integral
distance to 0 and which fulfill d̂i 6
⌊
n
2
⌋
, for all 1 6 i 6
m. So for every two points u = (u1, . . . , um) 6= v =
(v1, . . . , vd) ∈ Zmn , having an integral distance, the tuple
δn(u, v) =
(
min (|û1 − v̂1| , n− |û1 − v̂1|), . . . ,
min (|ûm − v̂m| , n− |ûm − v̂m|)
)
is an element of Dn,m. Actually we consider the vector
of the Lee weights [34] of the coordinates of the difference
u − v. Now we choose an arbitrary numbering of this set
Dn,m\{0} =
{
e0, . . . , e|Dn,m|−2
}
and consider the graphs
Gi, which consist of the points of Zmn \ {0, ei}, with integral
distances to 0 and ei, as vertices. Two vertices x 6= y ∈ G
are joined by an edge if and only if the corresponding points
fullfill δn(x, y) = ej with i 6 j. Again one can show,
that an integral point set in Zmn corresponds to a clique in
some graph Gi and vice versa. For some values of n and
m it is worth to put some effort in a suitable choice of the
numbering of Dn,m\{0}.
2.2 Hamming spaces and homomorphisms
In this subsection we want to relate the problem of inte-
gral point sets over Zmn to problems in Hamming spaces.
In coding theory the Hamming distance h(u, v) of two vec-
tors u = (u1, . . . , um), v = (v1, . . . , vm) ∈ Zmn is the
number of positions i where ui and vi differ. Normally one
is interested in large subsets of Zmn where all the Hamming
distances are either 0 or larger than a given constant c. In
our subject, we are interested in large subsets of Zmn , where
all the Hamming distances are taken from a specific proper
subset of {0, 1, . . . ,m}. This point of view has been proven
useful e. g. also in the 0/1-Borsuk problem in low dimen-
sions, see [37]. Here we also want to mention the study of
two-weight codes, see e. g. [9, 22].
So let us go back to the determinantion of I(n,m). As
there are trivial formulas for I(1,m) and I(2,m), the next
open case for fixed ring order n is the determination of
I(3,m). Due to 12 ≡ 22 ≡ 1 mod 3, integral point sets
over Zm3 correspond to sets of Zm3 with Hamming distances
h(u, v) 6≡ 2 mod 3. So this is our first example of a selec-
tion problem in a Hamming space.
For the determination of I(2n,m) we can utilize homo-
morphisms to make the problem easier. Therefore we need
some definitions.
Definition 2.4 For an integer n we define the mapping
ϕ̃2n : Z2n → Zn, x 7→ x̂ + Zn, and by ϕ2n,m we de-
note its extensions to Zm2n.
Definition 2.5 The weight function w̃2n : Z2n → Z2n is
defined by (ui, vi) 7→ (ûi − v̂i)2 + Z · 2n.
Hm2n :=
{
S⊆Zmn | ∀s1, s2∈S : ∃d∈Z2n : d2=w (s1, s2)
}
,
where w2n,m : (Zmn )
2 → Z2n is given by
((u1, . . . , um) , (v1, . . . , vm)) 7→
m∑
i=1
w̃2n (ui, vi). By Imn
we denote the set of integral point sets in Zmn .
Lemma 2.6
2m | I(2n,m).
PROOF. We consider the ring homomorphism ϕ2n,m and
restrict it toϕ ′2n,m : Im2n → Hm2n. If P is an element of Hm2n
then the preimage ϕ−12n,m (P) is an integral point set, due to
(x+ n)2 ≡ x2 + n mod 2n for odd n and (x+ n)2 ≡ x2
mod 2n for even n. For all x ∈ Zmn we have
∣∣ϕ−12n,m(x)∣∣ =
2m. 
35
So for the determination of I(2n,m), it suffices to de-
termine the maximum cardinality of the elements of Hm2n,
which actually are subsets of Zmn .
I(2n,m) = 2m · max
S∈Hm2n
|S|
As an example we want to apply this result for n = 2. Here
w4,m is exactly the Hamming distance in Zm2 . Since the
squares of Z4 are given by {0, 1}, we conclude that Hm4 is the
set of all subsets of Zm2 , with Hamming distance congruent
to 0 or 1modulo 4. With the mappingϕ ′4,m at hand, we can
exhaustively generate the maximal sets in Hm4 , via a clique
search, to extend Table 1:
(I(4,m))m612 = 4, 8, 16, 32, 128, 256, 1024, 4096,
16384, 32768, 65536, 131072.
The next theorem shows, that it suffices to determine
I(a,m) for prime powers a = pr.
Theorem 2.7 For two coprime integers a and b we have
I (a · b,m) = I (a,m) · I (b,m).
PROOF. Since a and b are coprime we have Zab ' Za ×
Zb. If P is an integral point set in Za×Zb, then the projec-
tions into Za and Zb are also integral point sets. If on the
other hand, P1 and P2 are integral point sets over Za and
Zb, respectively, then P := P1 × P2 is an integral point set
over Za × Zb, due to a straight forward calculation. 
If we drop the condition that a and b are coprime Theo-
rem 2.7 does not remain valid in general. One can see this
by looking at the example I(2, 3) · I(4, 3) > I(8, 3) in table
1. Also I(a,m) | I(a · b,m) does not hold in general, as on
can see by a look at the example I(3, 3) - I(9, 3). We would
like to mention, that in a recent preprint [26] the exact values
of I(p, 2) and I
(
p2, 2
)
have been determined.
Theorem 2.8 For a prime p > 3 we have
I(p, 2) = p and I
(
p2, 2
)
= p3.
2.3 Integral point sets over the plane Z2n
In Theorem 2.3 we have given an exact formula for I(n, 1).
So, if we fix the dimension m, the next case is the deter-
mination of I(n, 2). At first we give two constructions to
obtain lower bounds for I(n, 2).
Lemma 2.9 If the prime factorization of n is given by n =
s∏
i=1
prii , with pairwise different primes pi, we have
I(n, 2) > n ·
s∏
i=1
p
b ri2 c
i .
PROOF. We choose the points
(
ui, vjk
)
, where ui, vj ∈ Zn
and k =
s∏
i=1
p
d ri2 e
i . Due to
(ui1 − ui2)
2
+
(
vj1k− vj2k
)2
= (ui1 − ui2)
2
,
all occurring distances are integral. 
An example of the construction of Lemma 2.9 is given in
Figure 2, for n = 12 = 22 · 3.
w w w w w w w w w w w w
w w w w w w w w w w w w
0 1 2 3 4 5 6 7 8 9 10 11
0
1
2
3
4
5
6
7
8
9
10
11
Figure 2: An integral pointset over Z212 constructed via
Lemma 2.9.
In the case of n = 2 mod 4 we can improve the above
lemma:
Lemma 2.10 If the prime factorization of n is given by n =
2 ·
s∏
i=2
prii , with pairwise different primes pi 6= 2 we have
I(n, 2) > 2n ·
s∏
i=2
p
b ri2 c
i .
PROOF. We choose the points
(
ui, vjk
)
, where ui, vj ∈ Zn
and k =
s∏
i=2
p
d ri2 e
i . Since 2k
2 ≡ 0 mod n and
(ui1 − ui2)
2
+
(
vj1k− vj2k
)2
= (ui1 − ui2)
2
+
(
v2j1 + v
2
j2
)
k2
either
(ui1 − ui2)
2
+
(
vj1k− vj2k
)2
= (ui1 − ui2)
2
or
(ui1 − ui2)
2
+
(
vj1k− vj2k
)2
=
(
ui1 − ui2 + k
2
)2
holds. 
Conjecture 2.11 For all n ∈ N either the lower bound of
Lemma 2.9 or the lower bound of Lemma 2.10 is tight.
Remark 2.12 By Theorem 2.7 and an exhaustive enumer-
ation of integral point sets over Z2n, via clique search, we
have verified Conjecture 2.11 up to n = 307.
If n is squarefree and 2 does not divide n, then our con-
structions from Lemma 2.9 and Lemma 2.10 yield point sets
of the form P = {(u, 0) | u ∈ Zn}. This is somewhat simi-
lar to the situation in E2, where integral collinear point sets
with small diameter can consist of many points. Since we
also want to speak of collinear point sets in Z2n we give:
36
Definition 2.13 A set of r points (ui, vi) ∈ Z2n is collinear,
if there are a, b, t1, t2, wi ∈ Zn with
a+wit1 = ui and b+wit2 = vi.
Let us first look at collinearity from the algorithmic point
of view. Checking three points for being collinear, by run-
ning through the possible values of a, b, t1, t2, wi ∈ Zn,
would cost O
(
n7
)
time. Setting, w.l.o.g., a = u1, b = v1,
w1 = 0 reduces this to O
(
n4
)
. If n is prime, then we are
working in a field, and there is an easy and well known way
to check, whether three points are collinear, in O(1) time:
Lemma 2.14 For a prime n the points
(u1, v1) , (u2, v2) , (u3, v3) ∈ Z2n are collinear, if
and only if ∣∣∣∣∣∣
u1 v1 1
u2 v2 1
u3 v3 1
∣∣∣∣∣∣ = 0. (1)
We remark that in Z8 the points
(
0, 0
)
,
(
2, 4
)
,
(
4, 4
)
ful-
fill Equation (1), but are not collinear with respect to Defi-
nition 2.13. So in general Equation (1) is necessary but not
sufficient for three points to be collinear. We would like to
remark that there exists a fast algorithm, which checks three
points in Z2n for being collinear, in O
(
logn
log logn
)
time. We
do not go into detail here, since in practice one simply de-
termines for each pair x, y ∈ Z2n, whether the triple 0, x, y
is collinear or not, in a precalculation.
The study of collinear point sets is motivated by the situa-
tion in the case of non-modular point sets. Due to a theorem
of Erdős each integral point set in E2, with infinitely many
points, is located on a line [1, 12]. And, as already men-
tioned in the introduction the, non-collinear integral point
sets in E2 with minimum diameter, are conjectured to con-
sist of n− 1 collinear points and one point apart.
In this context we would like to mention a theorem, which
was recently proven in [26].
Theorem 2.15 For p being a prime, with p ≡ 3 mod 4,
each integral point set over Z2p, consisting of p points, is
collinear.
For primes p, of the form p ≡ 1 mod 4, also a different
type of integral point sets occurs. To describe these sets,
we need some new notation. For a prime p ≡ 1 mod 4,
there is a unique element ω(p) ∈ N, with ω(p) < p2 and
ω2(p) ≡ −1 mod p. By n =
{
i2 | i ∈ Zn
}
we denote
the set of squares in Zn.
Lemma 2.16 For a prime p > 3, the set P = (1,±ω(p)) ·
p is a non-collinear integral point set over Z2p with cardi-
nality p.
PROOF. For an odd prime p we have exactly p+12 squares in
Zp. Since (0, 0), (1,ω(p)), and (1,−ω(p)) are elements
of P, the point set is clearly non-collinear. For the prop-
erty of pairwise integral distances we consider two arbitrary
elements q, q ′ ∈ p and the corresponding distances
(q− q ′)
2
+ω2(p) (q− q ′)
2
= 0,
(q− q ′)
2
+ω2(p) (q+ q ′)
2
= (2ω(p))
2
qq ′,
(q+ q ′)
2
+ω2(p) (q− q ′)
2
= 22qq ′,
(q+ q ′)
2
+ω2(p) (q+ q ′)
2
= 0.

w w
w w
w w
ww
w w
w w
w
0 1 2 3 4 5 6 7 8 9 10 11 12
0
1
2
3
4
5
6
7
8
9
10
11
12
Figure 3: The integral point set P = (1,ω(p)) · p for
p = 13.
In Figure 3 we have depicted an integral point set, being
constructed as described in Lemma 2.16 for p = 13. We
remark that recently in [26] it was proven, that integral point
sets P over Z2p, with cardinality p > 3, are either collinear
or a translated version of the integral point set constructed
in Lemma 2.16.
2.4 Integral point sets over Z2n with further
conditions
In the last subsection we have recognized, that integral point
sets over Z2n are, similar to integral point sets over E2, some-
what attracted by collinear sets. So we investigate in this
subsection integral point sets P over Z2n, where no three
points are collinear.
Definition 2.17 By I(n,m) we denote the maximum num-
ber of points in semi-general position over Zmn , where all
pairwise distances are integral.
If we drop the condition of pairwise integral distances, our
studied objects become very familiar discrete structures. In
the case of affine finite geometries (classical [19] in the
case of Zn with n a prime, Hjelmslev geometries [8] in the
other cases) point sets in semi-general position, with arbi-
trary pairwise distances, are called arcs in the case of planes
or caps [3] in the three dimensional case. With the results
37
from Subsection 2.2 in mind, we would like to mention the
connection of these objects to linear coding theory, see e. g.
[4] for the details.
In Table 2 we give some values of I(n, 2) for small n, ob-
tained by Algorithm 2.22 described later on.
n I(n, 2) n I(n, 2) n I(n, 2)
1 1 21 4 41 20
2 4 22 8 42 6
3 2 23 12 43 22
4 4 24 6 44 10
5 4 25 10 45 11
6 4 26 10 46 14
7 4 27 10 47 24
8 6 28 8 48 8
9 6 29 14 49 > 18
10 6 30 6 50 > 17
11 6 31 16 51 8
12 4 32 14 52 12
13 6 33 6 53 26
14 6 34 10 54 > 13
15 4 35 6 55 8
16 8 36 12 56 10
17 8 37 18 57 10
18 10 38 12 58 > 16
19 10 39 6 59 30
20 8 40 10 60 8
Table 2: Values of I(n, 2) for small parameters n.
Now we want to derive an upper bound for I(n, 2), by
relaxing the condition of pairwise integral distances. Let P
be a point set over Z2n in semi-general position. We consider
the lines {(i, j) | j ∈ Zn} for i ∈ Zn. Since these n lines
form a partition of Z2n and each line can contain at most
two points of P, we obtain the trivial upper bound I(n, 2) 6
2n. This is connected to a famous open problem in number
theory [14, sec. F4], where people work on an upper bound
for the no-three-in-a-line problem. Considering all lines in
Z2n we receive
I(p, 2) 6 p+ 1
for odd primes p [5] and
I(n, 2) 6 n ·
(
1+ p−d
a+1
2 e + p−a
)
where pa | n and pa+1 - n for a prime p [20].
Very recently for the case of odd primes p, tight bounds
on I(p, 2) are proven [26]:
Theorem 2.18 For p ≡ 3 mod 4 we have
I(2, p) =
p+ 1
2
and for p ≡ 1 mod 4 we have
p− 1
2
6 I(2, p) 6
p+ 3
2
.
We would like to remark that the known con-
struction uses half of the points of the circle{
(a, b) ∈ Z2p | a2 + b2 = 1
}
, see [26] for the details.
For p ≡ 1 mod 4, p 6= 5 we conjecture I(p, 2) = p−12 .
By a look at the situation in E2 and with the famous question
of Erdős in mind. it seems interesting to investigate integral
point sets over Z2n, where no three points are collinear and
no four points are situated on a circle.
Definition 2.19 Four points pi = (xi, yi) in Z2n are said to
be situated on a circle if there exist a, b ∈ Zn, r ∈ Zn\
{
0
}
with
(xi − a)
2
+ (yi − b)
2
= r2
for all i.
We have the following necessary condition:
Lemma 2.20 Four points pi = (xi, yi) in Z2n being situ-
ated on a circle fulfill∣∣∣∣∣∣∣∣
x21 + y
2
1 x1 y1 1
x22 + y
2
2 x2 y2 1
x23 + y
2
3 x3 y3 1
x24 + y
2
4 x4 y4 1
∣∣∣∣∣∣∣∣ = 0. (2)
Definition 2.21 By İ(n,m) we denote the maximum num-
ber of points in Zmn with pairwise integral distances, where
no three points are collinear and no four points are situated
on a circle. Here we also talk of general position.
n İ(n, 2) n İ(n, 2) n İ(n, 2) n İ(n, 2)
1 1 21 4 41 9 61 > 9
2 4 22 8 42 6 62 > 11
3 2 23 5 43 8 63 8
4 4 24 4 44 8 64 > 10
5 4 25 6 45 8 65 7
6 4 26 8 46 10 66 8
7 3 27 7 47 7 67 > 9
8 4 28 6 48 8 68 > 10
9 4 29 7 49 > 11 69 7
10 6 30 6 50 > 12 70 > 9
11 4 31 6 51 7
12 4 32 8 52 > 9
13 5 33 4 53 > 9
14 6 34 10 54 > 11
15 4 35 5 55 6
16 6 36 > 10 56 6
17 5 37 7 57 6
18 8 38 8 58 > 11
19 5 39 6 59 > 9
20 6 40 6 60 8
Table 3: Values of İ(n, 2) for small parameters n.
Trivially we have İ(n, 2) 6 I(n, 2). In Table 3 we give
some exact values of İ(n, 2), obtained by Algorithm 2.22
38
described later on. One might conjecture that İ(n, 2) is un-
bounded.
Because semi-general position or general position is a
property of three or four points, respectively, we cannot ap-
ply our approach via clique search for the determination of
I(n, 2) and İ(n, 2) directly. Instead of going over to hyper-
graphs we use a variant of orderly generation [35], which
glues two integral point sets consisting of r points, having
r− 1 points in common, to obtain recursively integral point
sets of r + 1 points. The used variant of orderly genera-
tion was introduced, and applied for the determination of the
minimum distance ḋ(n, 2) of integral point sets in general
position in E2, in [24, 28].
Now we go into detail. To describe integral point sets
over Z2n, we utilize the set Dn,2, where the coordinates of
the points are reduced with respect to the Lee weight via
δn ((x1, y1) , (x2, y2)) =
(
min (|x̂1−x̂2| , n−|x̂1−x̂2|) ,
min (|ŷ1−ŷ2| , n−|ŷ1−ŷ2|)
)
.
By B = {b0, b1, . . . , bt} we denote the subset of Dn,2 ={
δn(0, x) | x ∈ Z2n
}
, where the points x are at integral dis-
tance to 0. We define b0 =
(
0, 0
)
. The numbering of the
remaining bi is arbitrary but fix. Each integral point set
P = {p1, . . . , pr} over Z2n is, up to translations and reflec-
tions, completely described by a matrix
∆n (P) =
(
ι (δn (pi, pj))
)
i,j
,
where we set δn (pi, pi) = b0 and ι : B → N, bi 7→ i.
We use these matrices as a data structure for integral point
sets over Z2n. Next we extend the natural order 6 on N to
 for symmetric matrices, with zeros on the main diago-
nal as ∆n, by using a column-lexicographical order of the
upper right matrix. A matrix ∆n is said to be canonical if
∆n > π (∆n) for every permutation π ∈ Sr acting on the
rows and columns of ∆n. If ↓∆n denotes the removal of the
last column and last row of a matrix ∆n, then ∆n is said to
be semi-canonical if ↓∆n >↓π (∆n) for every permutation
π ∈ Sr. The function Γr does the glueing of two integral
point sets over Z2n consisting of r points having r− 1 points
in common. The result of the function Γr is an, with re-
spect to , ordered list of integral point sets consisting of
r + 1 points. By Lr we denote the ordered list of all semi-
canonical matrices ∆n, with respect to, which correspond
to integral point sets over Z2n. It can be figured out easily
that Γr produces a list with at most two integral point sets.
With these definitions we can state:
Algorithm 2.22
Input: Lr
Output: Lr+1
begin
Lr+1 = ∅
loop over x1 ∈ Lr, x1 is canonical do
loop over x2 ∈ Lr, x2  x1, ↓x1 =↓x2 do
loop over y ∈ Γr (x1, x2)
if y is semi-canonical then add y to Lr+1 end
end
end
end
end
A starting list L3 of the integral triangles can be generated
by a nested loop. In order to apply Algorithm 2.22 for the
determination of I(n, 2) or İ(n, 2), we only have to modify
it in that way, that it only accepts integral point sets in semi-
general or general position, respectively, for the lists Lr.
3 Integral point sets over (R/Zn)2
In the previous section we have required also the coordinates
of the point sets to be integral. This corresponds somewhat
to integral point sets in Zm. In this section we try to develop
a setting for an analogous treatment of integral point sets in
Em over the ring Zn instead of Z for the distances. We start
with n = p being an odd prime.
Let p be an odd prime, then Zp is a finite field. Given
three elements a, b, c ∈ Zp\
{
0
}
, which we consider as
edge lengths of a triangle. Then we can determine a coordi-
nate represention, given by three points (x1, y1), (x2, y2),
(x3, y3) in (R/Zp)2, as follows. Due to translations, rota-
tions and reflections we can assume (x1, y1) =
(
0, 0
)
and
(x2, y2) =
(
a, 0
)
. For the third point (x3, y3) we get the
system of equations
x23 + y
2
3 = b
2,
(x3 − a)
2
+ y23 = c
2.
Solving this system yields
x3 =
b2 − c2 + a2
2a
,
y23 =
(a+b+c) (a+b−c) (a−b+c) (−a+b+c)
(2a)2
,
which is defined in Zp because of 2a 6= 0. By α(p) we
denote the smallest quadratic non-residue in Zp. With the
above system of equations it can be seen that x3 ∈ Zp and
y3 is either also in Zp or in Zp ·
√
α(p). Since this is similar
to the case in Em, see [24, 25], we define the characteristic
of an integral triangle similarly.
Definition 3.1 For an odd prime p the characteristic
of three side lengths a, b, c ∈ Zp with V2 =
(a+b+c) (a+b−c) (a−b+c) (−a+b+c) 6= 0 is defined
as 1 if V2 is a quadratic residue in Zp and as α(p) other-
wise.
For the ease of notation we associate Emp with (R/Zp)
m.
We remark that the three points are collinear exactly if V2
equals 0. So, similarly to the case in E2 [29], we have the
following lemma, where the determinant equals V2, if we
associate a = δ (v1, v2), b = δ (v1, v3), and c = δ (v2, v3).
39
Lemma 3.2 Points v1, v2, v3 ∈ E2p are collinear if and only
if their Euclidean distances δ (vi, vj) fulfill∣∣∣∣∣∣∣∣
δ2 (v1, v1) δ
2 (v1, v2) δ
2 (v1, v3) 1
δ2 (v2, v1) δ
2 (v2, v2) δ
2 (v2, v3) 1
δ2 (v3, v1) δ
2 (v3, v2) δ
2 (v3, v3) 1
1 1 1 0
∣∣∣∣∣∣∣∣ = 0.
Our definition of the characteristic of an integral triangle
in Zp is properly chosen in the sense that we have the fol-
lowing theorem.
Theorem 3.3 In an integral point set over E2p where p is an
odd prime the characteristic of each non-degenerated trian-
gle is equal.
PROOF. Without loss of generality we assume that the
two triangles have two points in common and the points
are given by the coordinates
(
0, 0
)
,
(
0, a
)
,
(
x, y
√
c
)
,(
x ′, y ′
√
c ′
)
, where a, x, x ′, y, y ′ are elements of Zp and
c, c ′ are the characteristics. The squared distance of the last
two points is given by
(x− x ′)
2
+
(
y
√
c− y ′
√
c ′
)2
= (x− x ′)
2
+ y2c− 2yy ′
√
cc ′ + y ′
2
c ′.
Because this number must be an element of Zp we have that
cc ′ is a quadratic residue in Zp yielding c = c ′. 
As we have proceeded completely analogous to the case
in Em we can generalize Definition 3.1 and Theorem 3.3.
Definition 3.4 For an odd prime p the characteristic of an
integral point set with m + 1 points in Emp given by its dis-
tances δi,j is 1 if V2m is a quadratic residue in Zp and α(p)
otherwise, where
V2m =
∣∣∣∣∣∣∣∣∣
δ21,1 . . . δ
2
1,m+1 1
...
. . .
. . .
...
δ2m+1,1 . . . δ
2
m+1,m+1 1
1 . . . 1 0
∣∣∣∣∣∣∣∣∣ .
Theorem 3.5 In an integral pointset over Emp where p is an
odd prime the characteristic of each non-degenerated sim-
plex is the same.
PROOF. We do the corresponding calculations as in [25]
over Zp instead of Q. 
For completeness we give a necessary coordinatefree cri-
terion form+ 2 points being situated on anm-dimensional
sphere.
Lemma 3.6 If m + 2 points in Emn described by their dis-
tances δi,j are situated on anm-dimensional sphere then∣∣∣∣∣∣∣
δ21,1 . . . δ
2
1,m+1
...
. . .
...
δ2m+1,1 . . . δ
2
m+1,m+1
∣∣∣∣∣∣∣ = 0.
So far we have transferred the theory of integral point sets
in Em to integral point sets over Emp for odd primes p. For
general n instead of p there are some twists if we use co-
ordinates. The most natural approach to settle these would
be, with respect to the situation in Em, to leave out coor-
dinates and use Mengers characterization of embedable dis-
tance matrices [29] and replace the conditions over Z by
conditions over Zn.
Definition 3.7 An integral point set P over Emn is a set of
r > m + 1 points with distances δi,j ∈ Zn\
{
0
}
for 1 6
i 6= j 6 r which fulfill
V2t−1 ({i1, . . . , it}) =
∣∣∣∣∣∣∣∣∣
δ2i1,i1 . . . δ
2
i1,it
1
...
. . .
. . .
...
δ2it,i1 . . . δ
2
it,it
1
1 . . . 1 0
∣∣∣∣∣∣∣∣∣ = 0
for each subset of points {i1, . . . , it} of cardinality t = m+2
and t = m + 3, and there exists a subset {̃ı1, . . . , ı̃t} of
cardinality t = m+ 1 with V2t−1 ({̃ı1, . . . , ı̃t}) 6= 0.
To model the extra conditions we could define that P
is in semi-general position if for every m + 1 points
{i1, . . . , im+1} we have V2m+1 ({i1, . . . , im+1}) 6= 0 and
that P is in general position if the condition of Lemma 3.6
is fulfilled. We remark that for m = 2 the determinant of
Lemma 3.6 can be factorized to
−(δ1,2δ3,4 + δ1,3δ2,4 + δ1,4δ2,3)
· (δ1,2δ3,4 + δ1,3δ2,4 − δ1,4δ2,3)
· (δ1,2δ3,4 − δ1,3δ2,4 + δ1,4δ2,3)
· (−δ1,2δ3,4 + δ1,3δ2,4 + δ1,4δ2,3) .
Form = 2 we also have
V22 ({1, 2, 3}) = (δ1,2+δ1,3+δ2,3) (δ1,2+δ1,3−δ2,3) ·
(δ1,2−δ1,3+δ2,3) (−δ1,2+δ1,3+δ2,3) .
So one may leave out the first factor and request that one
of the remaining factors equals 0 instead of the condition
in Definition 3.7 and the condition in Lemma 3.6, respec-
tively. For m > 3 the two corresponding determinants are
irreducible [10].
Another way to generalize integral point sets is to consider
the edge lengths and coordinates as elements in a finite field
Fpk or a commutative ring R instead of Fp = Zp. For some
results we refer to [2, 26]. Here we only give a very general
definition of an integral point set over an commutative ring
R:
Definition 3.8 For a commutative ring R a set P of n
points in Rm is called an integral point set if for each
(x1, . . . , xm) , (y1, . . . , ym) ∈ Rm there exists an element
d ∈ R fulfilling
m∑
i=1
(xi − yi)
2
= d2.
40
4 Conclusion
We have generalized the theory of integral point sets over
Zm to integral point sets over Zmn . Some exact values
I(n,m) of the maximal cardinality of a set with pairwise
integral distances in Zmn with or without further conditions
on the position are given together with algorithms to deter-
mine them.
There are two connections to coding theory, first via the
special case of arcs and caps, secondly by the observation
that I(n,m) leads to a class of codes where the Hamming
distances of the codewords have to fulfill certain modular
restrictions.
For odd primes p the theory of integral point sets in Em
is transferred to a theory of integral point sets over Emp in-
cluding the fundamental theorem about the characteristic of
an integral simplex.
There are some open questions left and the given results
motivate for further research on integral point sets over Zmn
and Emn , as they seem to be interesting combinatorial struc-
tures.
Bibliography
[1] N. H. Anning and P. Erdős, Integral distances, Bull.
Amer. Math. Soc. 51 (1945), 598–600.
[2] A. Antonov and M. Brancheva, Algorithm for finding
maximal Diophantine figures, Spring Conference
2007 of the Union of Bulgarian Mathematicians,
2007.
[3] J. Bierbrauer, Large caps, J. Geom. 76 (2003), no. 1-2,
16–51.
[4] J. Bierbrauer, Introduction to coding theory, Discrete
Mathematics and its Applications. Boca Raton, FL:
Chapman & Hall/CRC. xxiii, 390 p., 2005.
[5] J. Bierbrauer and Y. Edel, Bounds on affine caps, J.
Combin. Des. 10 (2002), no. 2, 115–115.
[6] P. Brass, W. Moser, and J. Pach, Research problems in
discrete geometry, New York, NY: Springer, 2005.
[7] C. Bron and J. Kerbosch, Finding all cliques of an
undirected graph, Commun. ACM 16 (1973), 575–
577.
[8] F. (ed.) Buekenhout, Handbook of incidence geometry:
buildings and foundations, Amsterdam: North-
Holland. xi, 1420 p., 1995.
[9] R. Calderbank and W. M. Kantor, The geometry of two-
weight codes, Bull. Lond. Math. Soc. 18 (1986),
97–122.
[10] C. d’Andrea and M. Sombra, The Cayley-Menger de-
terminant is irreducible for n > 3, Siberian Math.
J. 46 (2005), 90–97.
[11] S. Dimiev, A setting for a Diophantine distance geom-
etry, Tensor (N.S.) 66 (2005), no. 3, 275–283. MR
MR2189847
[12] P. Erdős, Integral distances, Bull. Amer. Math. Soc. 51
(1945), 996.
[13] J. Fricke, On Heron simplices and integer embeding,
preprint (2002).
[14] R. K. Guy, Unsolved problems in number theory. 3rd
ed., Problem Books in Mathematics. New York,
NY: Springer-Verlag., 2004.
[15] H. Harborth, On the problem of P. Erdös concern-
ing points with integral distances, Ann. New York
Acad. Sci. 175 (1970), 206–207.
[16] H. Harborth, Antwort auf eine Frage von P. Erdös nach
fünf Punkten mit ganzzahligen Abständen. (Answer
to a question of P. Erdös for five points with integer
distances), Elem. Math. 26 (1971), 112–113.
[17] H. Harborth, Integral distances in point sets, Butzer,
P. L. (ed.) et al., Karl der Grosse und sein Nach-
wirken. 1200 Jahre Kultur und Wissenschaft in Eu-
ropa. Band 2: Mathematisches Wissen. Turnhout:
Brepols, 1998, 213–224.
[18] H. Harborth, A. Kemnitz, and M. Möller, An upper
bound for the minimum diameter of integral point
sets, Discrete Comput. Geom. 9 (1993), no. 4, 427–
432.
[19] J. W. P. Hirschfeld, Projective geometries over finite
fields. 2nd ed., Oxford Mathematical Monographs.
Oxford: Clarendon Press, 1998.
[20] J. Huizenga, The maximum size of caps in (Z/nZ)2,
preprint (2005).
[21] A. Kemnitz, Punktmengen mit ganzzahligen Ab-
ständen, Habilitationsschrift, TU Braunschweig,
1988.
[22] A. Kohnert, Constructing two-weight codes with pre-
scribed groups of automorphisms, Discrete Appl.
Math. 155 (2007), no. 11, 1451–1457.
[23] T. Kreisel and S. Kurz, There are integral heptagons,
no three points on a line, no four on a circle, Dis-
crete Comput. Geom. (to appear).
[24] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[25] S. Kurz, On the characteristic of integral point sets in
Em, Australas. J. Combin. 36 (2006), 241–248.
[26] S. Kurz, Integral point sets over finite fields, (submit-
ted).
[27] S. Kurz and R. Laue, Bounds for the minimum diame-
ter of integral point sets, Australas. J. Combin. 39
(2007), 233–240.
[28] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin. (to
appear).
[29] K. Menger, Untersuchungen über allgemeine Metrik,
Math. Ann. 100 (1928), 75–163.
41
[30] S. Niskanen and P. R. J. Östergård, Cliquer user’s
guide, version 1.0, Tech. Report T48, Communica-
tions Laboratory, Helsinki University of Technol-
ogy, Espoo, Finland, 2003.
[31] L. C. Noll and D. I. Bell, n-clusters for 1 < n < 7,
Math. Comp. 53 (1989), no. 187, 439–444.
[32] P. R. J. Östergård, A fast algorithm for the maximum
clique problem, Discrete Appl. Math. 120 (2002),
no. 1-3, 197–207.
[33] L. Piepmeyer, Räumliche ganzzahlige Punktmengen,
Master’s thesis, TU Braunschweig, 1988.
[34] V. S. (ed.) Pless and W. C. (ed.) Huffman, Handbook
of coding theory. Vol. 1. Part 1: Algebraic coding.
Vol. 2. Part 2: Connections, Part 3: Applications,
Amsterdam: Elsevier. 2169 p., 1998.
[35] R. C. Read, Every one a winner or how to avoid
isomorphism search when cataloguing combinato-
rial configurations, Ann. Discrete Math. 2 (1978),
107–120.
[36] J. Solymosi, Note on integral distances, Discrete Com-
put. Geom. 30 (2003), no. 2, 337–342.
[37] G. M. Ziegler, Coloring Hamming graphs, optimal
binary codes, and the 0/1-Borsuk problem in
low dimensions, Alt, Helmut (ed.), Computational
discrete mathematics. Advanced lectures. Berlin:
Springer. Lect. Notes Comput. Sci. 2122, 159-171
(2001), 2001.
42
Chapter 6
There are integral heptagons, no three points
on a line, no four on a circle
TOBIAS KREISEL1 AND SASCHA KURZ2
ABSTRACT. We give two configurations of seven points in the
plane, no three points on a line, no four points on a circle with
pairwise integral distances. This answers a famous question of Paul
Erdős.
2000 MSC: 52C10; 52C35, 52-04, 52A99, 51K99.
Key words and phrases: integral distances, exhaustive search,
orderly generation, solution to an Erdős problem.
1 Introduction
A famous open problem of P. Erdős asks for seven points in
the plane, no three on a line, no four on a circle with pairwise
rational or integral distances [1, 3]. For six points parameter
solutions for infinite families of such point sets are known,
see e. g. [6]. Since for finite point sets we can multiply
the occurring distances with their denominators’ smallest
common multiple we confine ourselves to considering in-
tegral distances only. From the combinatorial point of view
the question for the smallest possible diameter ḋ(2, n) of
n points arises, where the diameter is the largest occurring
distance in a point set. So far(
ḋ(2, n)
)
n=3,...,6
= 1, 8, 73, 174
are known [4]. By exhaustive search the bound ḋ(2, 7) >
20000 could be determined [10, 11]. Up to diameter 20000
there are only few integral point sets consisting of 6 points,
no three on a line, no four on a circle with pairwise inte-
gral distances, see [8] for a complete list. Some attempts to
show that no integral point set in general position consisting
of more than six points can exist are known [5], but the sug-
gested proofs turned out to be incorrect. So there was little
hope to discover such a point set. But then by a suggestion
1Tobias Kreisel, Fakultät für Mathematik, Physik und Informatik, Uni-
versität Bayreuth, Germany.
E-mail adress: tobias.kreisel@uni-bayreuth.de
2Sascha Kurz, Fakultät für Mathematik, Physik und Informatik, Univer-
sität Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
of S. Dimiev [2] we considered integral point sets over Z2n
[7].
Definition 1.1 Two points (u1, . . . , um) , (v1, . . . , vm) ∈
Zmn := (Z\Zn)
m are at integral distance if there exists a
number d ∈ Zn with
m∑
i=1
(ui − vi)
2
= d2.
So, an integral point set in Z2n is defined as a subset of Z2n
where all pairs of points are at integral distance. To have an
analogue to the “no three on a line and no four on a circle”
restriction we need two further definitions.
Definition 1.2 A set of r points (ui, vi) ∈ Z2n is collinear if
there are a, b, t1, t2, wi ∈ Zn with a+wit1 = ui and b+
wit2 = vi.
Definition 1.3 Four points pi = (xi, yi) in Z2n are said to
be situated on a circle if there exist a, b ∈ Zn, r ∈ Zn\
{
0
}
with (xi − a)
2
+ (yi − b)
2
= r2 ∀i.
By İ(n, 2) we denote the maximum number of points in Z2n
with pairwise integral distances where no three are collinear
and no four points are situated on a circle. By combinatorial
search techniques—see [7] for the details—we found two
point sets proving İ(50, 2) > 12 and İ(61, 2) > 9. Surely
this does not imply the existence of an integral point set over
the real plane in general position, i. e. no three points on a
line, no four points on a circle, however it did give us a fresh
impetus to continue our search.
2 Integral heptagons in general posi-
tion
The results for the “relaxed” problem over Z2n motivated
us to maintain our approach of exhaustive generation of all
plane integral point sets in general position up to a given
diameter by a variant of orderly generation, see [10, 11]
for details. Also, without changing our approach but sim-
ply by harnessing more computational power we were lucky
43
enough to discover the following distance matrix
0 22270 22098 16637 9248 8908 8636
22270 0 21488 11397 15138 20698 13746
22098 21488 0 10795 14450 13430 20066
16637 11397 10795 0 7395 11135 11049
9248 15138 14450 7395 0 5780 5916
8908 20698 13430 11135 5780 0 10744
8636 13746 20066 11049 5916 10744 0

(1)
corresponding to a plane integral point set in general posi-
tion with diameter 22270 consisting of seven points. So this
answers Erdős’s question positively. Since we applied an
exhaustive search we receive:
Theorem 2.1 ḋ(2, 7) = 22270.
To avoid duplicated listings of isomorphic point sets we give
all point sets in the following canonical form. Consider the
vector v(∆) formed by the columns of the upper right trian-
gle of a distance matrix ∆. A certain distance matrix ∆ of a
point set P (induced by a labeling of the points) is said to be
canonical or maximal if its vector v(∆) is the largest one in
the set of all vectors of distance matrices of P with respect
to the lexicographic order.
t t
t
t
t
t
t
(0
1
,
0
1
√
2002
)
(22270
1
,
0
1
√
2002
)
(26127018
2227
,
932064
2227
√
2002
)
(245363
17
,
3144
17
√
2002
)
(17615968
2227
,
238464
2227
√
2002
)
(56068
17
,
3144
17
√
2002
)
(19079044
2227
,−
54168
2227
√
2002
)
Figure 1: First example of an integral heptagon in general
position.
In Figure 1 we give an embedding of distance matrix (1) in
the plane and an exact coordinate representation. Discov-
ering this point set clearly motivates to search for further
examples to get ideas how to construct an infinite family of
examples. Unfortunately this point set is the only exam-
ple with at most 30000 in diameter. For diameters greater
than 30000 our approach of exhaustive search requires too
much computational power so that we decided to skip to a
restricted search. To describe the details of our restriction of
the search space we need:
Definition 2.2 The characteristic of an integral triangle
with side lengths a, b, c ∈ Z is the square free part of
(a+ b+ c)(a+ b− c)(a− b+ c)(−a+ b+ c).
Theorem 2.3 Each non degenerated triangle in a plane in-
tegral point set has equal characteristic.
In point set (1) the characteristic is given by 2002 = 2 · 7 ·
11 · 13 which explains the shape of the y-coordinates, see
Figure 1 and [9]. We notice that the characteristic of point
set (1) is composed of relatively small prime factors. By
a look at our list of integral hexagons in general position
[8] we see that this seems to be a phenomenon that holds
for a great part of the known examples. This phenomenon
seems to hold for similar problems also. By determing the
minimum diameter d(2, n) of plane integral point sets with-
out further restrictions up to n = 122 points [11] we could
check that the known minimal examples also have a charac-
teristic composed of small prime factors. If additionally no
three points are allowed to be collinear we denote the corre-
sponding minimum diameter by d(n, 2). By determing all
those minimal integral point sets with up to n = 36 points
[10, 11] we could check that the same phenomenon also oc-
curs in this case. So it seemed worth a try to exhaustively
construct all plane integral point sets in general position with
given diameter of at most 70000 and the characteristic being
a divisor of 6469693230 = 2 ·3 ·5 ·7 ·11 ·13 ·17 ·19 ·23 ·29.
The outcome was yet another example:

0 66810 66555 66294 49928 41238 40290
66810 0 32385 64464 32258 25908 52020
66555 32385 0 34191 16637 33147 33405
66294 64464 34191 0 34322 53244 26724
49928 32258 16637 34322 0 20066 20698
41238 25908 33147 53244 20066 0 32232
40290 52020 33405 26724 20698 32232 0

(2)
Unfortunately the discovery of further examples is currently
beyond our means since the algorithm we use is of running
time Ω
(
d3
)
for the search for plane integral point sets in
general position with diameter at most d. Though the re-
striction on the characteristic did accelerate computations
significantly the theoretic lower bound for the complexity
remains. (There are O
(
d3
)
integral triangles with diameter
at most d.)
44
3 Open problems
Clearly, one can ask for further examples or an infinite fam-
ily of integral heptagons in general position. Since our two
given examples are in non convex position it would be in-
teresting to see a convex example. As a further restriction
Bell and Noll [12] also required the coordinates of the point
sets to be integral. Such point sets are commonly called
nm-clusters, where n is the number of points andm the di-
mension. In general the set of n2-cluster equals the set of
plane integral point sets in general position with character-
istic 1. So far no 72-cluster is known and even its existence
is unclear. The smallest 62-cluster has diameter 1886. At
first sight it seems that we have answered Erdős question
completely, but from a realistic point of view we have only
pushed the frontier a step further. Originally P. Erdős asked
for five points in the plain, no three on a line, no for on a
circle with pairwise integral distances. When such a set was
found he asked for 6-set then for a seven set. So now we ask
as a substitute:
”Are there eight points in the plane, no three on a line, no
four on a circle with pairwise integral distances?“
Bibliography
[1] P. Brass, W. Moser, and J. Pach, Research problems in
discrete geometry, Springer, 2005.
[2] S. Dimiev, A setting for a Diophantine distance geom-
etry, Tensor (N.S.) 66 (2005), no. 3, 275–283. MR
MR2189847
[3] R. K. Guy, Unsolved problems in number theory. 2nd
ed., Springer, 1994.
[4] H. Harborth, Integral distances in point sets, Butzer,
P. L. (ed.) et al., Karl der Grosse und sein Nach-
wirken. 1200 Jahre Kultur und Wissenschaft in Eu-
ropa. Band 2: Mathematisches Wissen. Turnhout:
Brepols, 1998, 213–224.
[5] H. Harborth, 2005, personal communication.
[6] A. Kemnitz, Punktmengen mit ganzzahligen Ab-
ständen, Habilitationsschrift, TU Braunschweig,
1988.
[7] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Discrete Appl. Math., (to appear).
[8] T. Kreisel and S. Kurz, List of integral hexagons
in general position, 2006, http://www.wm.uni-
bayreuth.de/index.php?id=erdoes.
[9] S. Kurz, On the characteristic of integral point sets in
Em, Australas. J. Combin. 36 (2006), 241–248.
[10] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76, Universität Bayreuth, 2006.
[11] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin., (to
appear).
[12] L. C. Noll and D. I. Bell, n-clusters for 1 < n < 7,
Math. Comp. 53 (1989), no. 187, 439–444.
45
46
Chapter 7
Integral point sets over finite fields
SASCHA KURZ1
ABSTRACT. We consider point sets in the affine plane F2q where
each Euclidean distance of two points is an element of Fq. These
sets are called integral point sets and were originally defined inm-
dimensional Euclidean spaces Em. We determine their maximal
cardinality I (Fq, 2). For arbitrary commutative rings R instead of
Fq or for further restrictions as no three points on a line or no four
points on a circle we give partial results. Additionally we study the
geometric structure of the examples with maximum cardinality.
2000 MSC: 51E20; 05B25.
Key words and phrases: finite geometry, point configurations,
integral point sets, universal geometry.
1 Introduction
Originally integral point sets were defined inm-dimensional
Euclidean spaces Em as a set of n points with pairwise in-
tegral distances in the Euclidean metric, see [10, 14, 16, 17]
for a overview on the most recent results. Here we transfer
the concept of an integral point set to modules Rm of a com-
mutative ring with 1. We equip those spaces with a squared
distance
d2(u, v) :=
m∑
i=1
(ui − vi)
2 ∈ R.
for any two points u = (u1, . . . , um), v = (v1, . . . , vm) in
Rm and say that they are at integral distance if d2(u, v) is
contained in the set R :=
{
r2 | r ∈ R
}
consisting of the
squares in R. A set of points P is called an integral point set
if every pair of points is at integral distance.
The concept of integral point sets over finite fields is not
brand-new. There are some recent papers and preprints
[27, 28, 29, 30] by L. A. Vinh dealing with quadrance
graphs. These are in the authors definition point sets in the
affine plane F2q where the squared distances, there called
quadrances, are elements of Fq\{0}. So for q ≡ 3 mod 4
quadrance graphs coincide with integral point sets over F2q.
1Sascha Kurz, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
For q ≡ 1 mod 4 we have the small difference that 0 = 02
is not considered as an integral distance. So e. g. the points
(0, 0) and (2, 3) in F13 are not considered to be at an inte-
gral distance since d2((0, 0), (2, 3)) = 22 + 32 = 0. We
would like to mention that quadrance graphs and so integral
point sets over finite fields are isomorphic to strongly regular
graphs and that there are some connections to other branches
of Combinatorics including Ramsey theory and association
schemes [23, 24, 31]. The origin of quadrance graphs lies
in the more general concept of rational trigonometry and
universal geometry by N. J. Wildberger, see [32] for more
background.
Some related results on integral point sets over commuta-
tive rings can be found in [1, 8, 13].
A somewhat older topic of the literature is also strongly
connected to integral point sets over finite fields. The Pa-
ley graph PGq has the elements of the finite field Fq as its
vertices. Two vertices u and v are connected via an edge
if and only if their difference is a non-zero square in Fq.
For q = q ′2 with q ′ ≡ 3 mod 4 we have a coincidence be-
tween the Paley graph PGq and integral point sets over PG2q′
or quadrance graphs. It is somewhat interesting that these
one-dimensional and two-dimensional geometrical objects
are so strongly connected. See e. g. [2, 28] for a detailed
description and proof of this connection. Actually one uses
the natural embedding of Fq2 in F2q.
So what are the interesting questions about integral point
sets over finite fields? From the combinatorial point of view
one could ask for the maximum cardinality I (R,m) of those
point sets in Rm. For R = Fq with q ≡ 3 mod 4 and
m = 2 this is a classical question about maximum cliques
of Paley graphs of square order, where the complete answer
is given in [3]. See also [26] for some generalizations. A
geometer might ask for the geometric structure of the maxi-
mal examples. Clearly the case where R is a finite field Fq
is the most interesting one.
1.1 Our contribution
For primes p we completely classify maximal integral point
sets in the affine planes F2p and for prime powers q = pr
we give partial results. Since in an integral point set not all
directions can occur we can apply some Rédei-type results
in this context. Although these results are not at hand in
general we can derive some results for arbitrary rings R and
47
special cases like R = Zp2 or rings with characteristic two.
It will turn out that most maximal examples or construc-
tions in the plane consist of only very few lines. So it is
interesting to consider the case where we forbid three points
to be collinear. This means that we look at 2-arcs with the
additional integrality condition. Here we denote the maxi-
mal cardinality by I (R,m) where we in general forbid that
m+ 1 points are contained in a hyperplane. We give a con-
struction and a conjecture for the case R = Fq, 2 - q, and
m = 2 using point sets on circles.
Being even more restrictive we also forbid m + 2 points
to be situated on a hypersphere and denote the correspond-
ing maximal cardinality by İ (R,m). Although in this case
we have almost no theoretical insight so far, this is the most
interesting situation when we look from the viewpoint of in-
tegral point sets in Em. As a motivation for further research
the following open problem of P. Erdős and C. Noll [20]
may serve:
Are there seven points in the plane, no three on a
line, no four on a circle with integral coordinates
and pairwise integral distances?
If we drop the condition of integral coordinates the prob-
lem was recently solved in [14]. As a connection to our
problem one may use the ring homomorphism Zm → Zmn ,
x 7→ x+(nZ)m, which preserves integral distances and co-
ordinates. For lines and circles the situation is a bit more
complicated. We give some examples for various primes p
showing İ (Zp, 2) > 7 and determine some exact numbers.
Perhaps in the future an application of the Chinese remain-
der theorem helps to construct the desired example in Z2.
1.2 Organization of the paper
The paper is arranged as follows. In Section 2 we give the
basic definitions and facts on integral point sets over com-
mutative rings R. In Section 3 we determine the automor-
phism group of the affine plane F2q with respect to ∆. For
q ≡ 3 mod 4 it is the well known automorphism group of
the Paley graph PGq2 which is isomorphic to a subgroup of
PGΓ
(
1, q2
)
of index 2, see e. g. [6, 12, 25]. For q ≡ 1
mod 4 the automorphism group was not known. We give
a proof for both cases and prove some lemmas on integral
point sets over finite fields which will be useful in the fol-
lowing sections. Most of the automorphisms also exist in
some sense for arbitrary commutative rings R. In Section
4 we determine the maximum cardinality I (Fq, 2) of an in-
tegral point set over F2q and classify the maximal examples
up to isomorphism in some cases. Here we use a result of
Blokhuis et al. on point sets with a restricted number of di-
rections. In Section 5 we give some results on I (Zn, 2) and
give some constructions which reach this upper bound. In
Section 6 we determine the maximum cardinality I (Fq, 2)
of integral point sets over Fq where no three points are
collinear for q ≡ 3 mod 4. For q ≡ 1 mod 4 we give
lower and upper bounds which are only two apart. In Section
7 we consider the maximum cardinality İ (Fq, 2) of integral
point sets over F2q where no three points are collinear and
no four points are situated on a circle. We determine some
exact values via an exhaustive combinatorial search and list
some maximum examples.
2 Integral point sets
If not stated otherwise we assume that R is a commutative
ring with 1 and consider sets of elements of the R-module
Rm. We speak of these elements as points with a geometric
interpretation in mind. For our purpose we equip the module
Rm with something similar to an Euclidean metric:
Definition 2.1 For two points u = (u1, . . . , um), v =
(v1, . . . , vm) in Rm we define the squared distance as
d2(u, v) :=
m∑
i=1
(ui − vi)
2 ∈ R.
We are interested in those cases where d2(u, v) is con-
tained in the set R :=
{
r2 | r ∈ R
}
of squares of R.
Definition 2.2 Two points u = (u1, . . . , um), v =
(v1, . . . , vm) in Rm are at integral distance if there exists
an element r in R with d2(u, v) = r2. As a shorthand we
define ∆ : Rm × Rm → {0, 1},
(u, v) 7→
{
1 if u and v are at integral distance,
0 otherwise.
A set P of points in Rm is called an integral point set if all
pairs of points are at integral distance.
If R is a finite ring it makes sense to ask for the maximum
cardinality of an integral point set in Rm.
Definition 2.3 By I (R,m) we denote the maximum cardi-
nality of an integral point set in Rm.
Lemma 2.4
|R| 6 I (R,m) 6 |R|m .
PROOF. For the lower bound we consider the line P =
{(r, 0, . . . , 0) | r ∈ R}. 
Lemma 2.5 If R has characteristic 2, meaning that 1+1 =
0 holds, then we have I (R,m) = |R|m.
PROOF. For two points u = (u1, . . . , um), v =
(v1, . . . , vm) in Rm we have
d2(u, v) =
m∑
i=1
(ui − vi)
2
=
(
r∑
i=1
ui + vi
)
︸ ︷︷ ︸
∈R
2
.

So in the remaining part of this article we consider only
rings with characteristic not equal to two. If a ring R is
the Cartesian product of two rings R1, R2, where we define
the operations componentwise, then we have the following
theorem:
48
Theorem 2.6
I (R1 × R2,m) = I (R1,m) · I (R2,m) .
PROOF. If P is an integral point set in R1 × R2 then the
projections into R1 and R2 are also integral point sets. If on
the other hand P1 and P2 are integral point sets over R1 and
R2, respectively, then P := P1 × P2 is an integral point set
over R1 × R2. 
Lemma 2.7 If N is an additive subgroup of{
n ∈ R | n2 = 0
}
or
{
n ∈ R | 2n2 = 0 ∧ n2 = n4
}
then we have form > 2
|N|m−1 · |R| 6 I (R,m) 6 |R|m .
PROOF. We can take the integral point set
P = {(r, n1, . . . , nm−1) | r ∈ R, ni ∈ N} and have
r2 +
m−1∑
i=1
n2i = r
2 or r2 +
m−1∑
i=1
n2i =
(
r+
m−1∑
i=1
n2i
)2
. 
If we specialize these general results to rings of the from
R = Z/Zn =: Zn then we have the following corollaries:
Corollary 2.8
I (Zn, 1) = n and I (Z2,m) = 2m.
Corollary 2.9 For coprime integers a and b we have
I (Zab,m) = I (Za,m) · I (Zb,m).
Corollary 2.10 For a prime p > 2 we have
I (Zpr ,m) > pr · pm−1b
r
2c.
To be able to do some algebraic calculations later on we
denote the set of invertible elements of R by R∗ and derive
a ring R ′ from the module R2.
Definition 2.11
R ′ := R[x]/
(
x2 + 1
)
.
With i being a root of x2+1 we have the following bijec-
tion
ρ : R2 → R ′, (a, b) 7→ a+ bi.
The big advantage of the ring R ′ is that we naturally have an
addition and multiplication. The construction of the ring is
somewhat a reverse engineering of the connection between
Paley graphs of square order and integral point sets over the
affine plane F2q for q ≡ 3 mod 4. With the similar con-
struction of the complex numbers in mind we define:
Definition 2.12
a+ bi = a− bi.
Lemma 2.13 For p, p1, p2 ∈ R ′ we have
1. d2 (p1, p2) = (p1 − p2) · (p1 − p2),
2. pp ∈ R,
3. p1 + p2 = p1 + p2,
4. p1 · p2 = p1 · p2, and
5. p = p.
3 Automorphism group of the plane
R2
Since we want to classify maximal integral point sets up to
isomorphism we have to define what we consider as an au-
tomorphism.
Definition 3.1 An automorphism of R ′ with respect to ∆ is
a bijective mapping ϕ of R ′ with
(1) ∆ (a+ bi, c+ di) = ∆ (ϕ(a+ bi), ϕ(c+ di)) and
(2) there exist a ′, b ′, c ′, d ′ ∈ R such that
{ϕ (a+ bi+ r(c+ di)) | r ∈ R} =
{a ′ + b ′i+ r (c ′ + d ′i) | r ∈ R}
for all a, b, c, d in R.
In words this definition says that ϕ has to map points to
points, lines to lines, and has to preserve the integral distance
property. There is a natural similar definition for R2 instead
of R ′.
Lemma 3.2 We have the following examples of automor-
phisms:
(1) ϕs(r) = r+ s for s ∈ R ′,
(2) ϕ̃(a+ bi) = b+ ai,
(3) ϕ̃y(r) = ry for y ∈ R ′∗ with ∃r ′ ∈ R∗ : yy = r ′2,
and
(4) ϕ̂j(a + bi) = ap
j
+ bp
j
i for j ∈ N and p being the
characteristic of a field R.
PROOF. The first two cases are easy to check. For the third
case we consider
d2 (r1y, r2y) = (r1y− r2y) · (r1y− r2y),
= (r1 − r2) · (r1 − r2)yy,
= d2 (r1, r2) · yy.
For the fourth case we have
d2 (ϕ̂j(a1 + b1i), ϕ̂j(a2 + b2i))
=
(
a
pj
1 − a
pj
2
)2
+
(
b
pj
1 − b
pj
2
)2
,
= (a1 − a2)
pj·2
+ (b1 − b2)
pj·2
,
=
(
(a1 − a2)
2
+ (b1 − b2)
2
)pj
,
= d2 (a1 + b1i, a2 + b2i)
pj
Thus integral point sets are mapped onto integral point sets.
That lines are mapped onto lines can be checked immedi-
ately. Since we have requested that R is a field in the forth
case the mappings are injective. 
49
After this general definition of automorphisms we spe-
cialize to the case R = Fq with 2 - q. As a shorthand we
use q := Fq . We remark that the case (4) of Lemma 3.2
is the set of Frobenius automorphisms of the field Fq which
is a cyclic group of order r for q = pr.
Theorem 3.3 For q = pr, p 6= 2, q 6= 5, 9 the automor-
phisms of F ′q with respect to ∆ are completely described in
Lemma 3.2.
For q ≡ 3 mod 4 this is a well known result on the au-
tomorphism group of Paley graphs as mentioned in the in-
troduction. If we consider the set of automorphisms from
Lemma 3.2 in F2q instead of F ′q then they form a group with
its elements being compositions of the following four map-
pings:
1.
(
x
y
)
7→
(
x
y
)
+
(
a
b
)
where a, b ∈ Fq,
2.
(
x
y
)
7→
(
a b
−b a
)
·
(
x
y
)
where a, b ∈ Fq,
a2 + b2 ∈ q\{0},
3.
(
x
y
)
7→
(
0 1
1 0
)
·
(
x
y
)
, and
4.
(
x
y
)
7→
(
xp
yp
)
.
In the remaining part of this section we will prove The-
orem 3.3. For the sake of completeness we also give the
proof for q ≡ 3 mod 4. If we forget about respecting ∆
then the automorphism group of F2q is the well known group
AΓL (2,Fq). It is a semi-direct product of the translation
group, the Frobenius group Aut (Fq), and GL (2,Fq), the
group of multiplications with invertible 2× 2 matrices over
Fq. So if G ′ is the automorphism group of F2q with respect
to ∆ it suffices to determine the groupG := G ′∩GL (2,Fq)
because every translation and every element in Aut (Fq) re-
spects ∆. So all elements of G can be written as
(
x
y
)
7→(
x y
)
·M with M being an invertible 2 × 2-matrix. As a
shorthand we say thatM is an element of the automorphism
group G.
Lemma 3.4 If M =
(
a b
c d
)
is an element of the auto-
morphism group G then we have ad−bc 6= 0 and a2+b2,
a2 + c2, b2 + d2, c2 + d2 ∈ q.
PROOF. Since M is also an element of GL (2,Fq) its de-
terminant does not vanish. By considering the points (0, 0)
and (0, y) which are at an integral distance we obtain that
b2 + d2 must be a square in Fq. Similarly we obtain that
a2 + c2, a2 + b2, and c2 + d2 must be squares in Fq. 
To go on we need some facts about roots in Fq and the set
of solutions of quadratic equations in Fq.
Definition 3.5 For pr ≡ 1 mod 4 we denote by ωq an el-
ement withω2q = −1.
Lemma 3.6 For a finite field Fq with q = pr and p 6= 2
we have −1 ∈ q iff q ≡ 1 mod 4, ωq ∈ q iff q ≡ 1
mod 8, and 2 ∈ q iff q ≡ ±1 mod 8.
PROOF. The multiplicative group of the units F∗q is cyclic of
order q−1. Elements of order 4 are exactly those elements x
with x2 = −1. A similar argument holds for the fourth roots
of −1. The last statement is the second Ergänzungssatz of
the quadratic reciprocity law generalized to Fq. For a proof
we may consider the situation in Fp and adjungate xmodulo
the ideal
(
x2 − 2
)
. 
Lemma 3.7 For a fix c 6= 0 and 2 - q the equation a2 +
b2 = c2 in Fq has exactly q + 1 different solutions if −1 6∈
q and exactly q− 1 different solutions if −1 ∈ q.
PROOF. If b = 0 then we have a = ±c. Otherwise
a2 + b2 = c2 ⇔ a− c
b
· a+ c
b
= −1.
Here we set t := a+cb ∈ F
∗
q (t = 0 corresponds to b = 0).
We obtain
2
a
b
= t− t−1, 2
c
b
= t+ t−1 6= 0,
yielding
t2 6= −1, b = 2c
t+ t−1
, and a = c · t− t
−1
t+ t−1
.
If t and t ′ yield an equal b then we have t ′ = t−1. For t 6=
t−1 we have different values for a in these cases. Summing
up the different solutions proves the stated result. 
Lemma 3.8 In F ′q the set C =
{
z ∈ F ′q | zz = 1
}
forms a
cyclic multiplicative group.
PROOF. If −1 6∈ q then F ′q is a field and thus C must be
cyclic. For the case −1 ∈ q we utilize the bijection
ρq : F∗q → G, t 7→
1+ t2
2t
+ωq
1− t2
2t
x.
Now we only have to check that the mapping is a group
isomorphism, namely
ρq(i · j) = ρq(i) · ρq(j).

Our next ingredient is a classification of the subgroups of
the projective special linear group PSL(2, q).
Theorem 3.9 (Dickson [7]) The subgroups of PSL (2, pr)
are isomorphic to one of the following families of groups:
(1) elementary abelian p-groups,
(2) cyclic groups of order z, where z is a divisor of p
r±1
k
and k = gcd (pr − 1, 2),
50
(3) dihedral groups of order 2z, where z is defined as in
(2),
(4) alternating group A4 (this can occur only for p > 2 or
when p = 2 and r ≡ 0 mod 12),
(5) symmetric group S4 (this can only occur if p2r ≡ 1
mod 16),
(6) alternating group A5 (for p = 5 or p2r ≡ 1 mod 5),
(7) a semidirect product of an elementary abelian group of
order pm with a cyclic group of order t, where t is a
divisor of pm − 1 and of pr − 1, or
(8) the group PSL (2, pm) for m a divisor of r, or the
group PGL (2, pm) for 2m a divisor of r.
By Z := ±E we denote the center of SL(2, q), where
E is the identity matrix. Our strategy is to consider H :=
(G ∩ SL(2, q)) /Z = G ∩ PSL(2, q) and to prove H ' H ′
for q > 13 where H ′ is the group of those automorphisms
of Lemma 3.2 which are also elements of PSL(2, q). For
−1 6∈ q we set H̃ :=
{(
a b
−b a
)
| a2 + b2 = 1
}
and
for −1 ∈ q we set H̃ :=
{(
a b
−b a
)
| a2 + b2 = 1
}
∪{(
−b a
a b
)
| a2 + b2 = −1
}
.
Lemma 3.10 For q ≡ 3 mod 4 we have H̃ ' Zq+1 and
for q ≡ 1 mod 4 we have H̃ ' Dq−1, where Dq−1 is the
dihedral group of order 2(q− 1).
PROOF. Utilizing Lemma 3.7 and checking that both sets
are groups we get
∣∣∣H̃∣∣∣ = { q+ 1 if q ≡ 3 mod 4,
2(q− 1) if q ≡ 1 mod 4.
In the first case the group is cyclic due to Lemma 3.8. In the
second case it contains a cyclic subgroup of order q− 1. By
checking the defining relations of a dihedral group we can
conclude H̃ ' Dq−1 for q ≡ 1 mod 4. 
Now we define H ′ := H̃/Z.
Lemma 3.11 For q > 13, q ≡ 3 mod 4 we have H ′ '
Zq+1
2
and for q > 13, q ≡ 1 mod 4 we have H ′ ' Dq−1
2
.
PROOF. We have |H ′| = |
H̃|
2 . It remains to show that H
′ is
not abelian for q ≡ 1 mod 4. Therefore we may consider
the sets {±M1} and {±M2} where a, b, c, d are elements of
F∗q with a2 + b2 = 1, c2 + d2 = −1 and where
M1 =
(
a b
−b a
)
and M2 =
(
−d c
c d
)
.

Lemma 3.12 For q > 13 we have H ' H ′.
PROOF. Since H is a subgroup of PSL(2, q) we can utilize
Theorem 3.9. We run through the subgroups of PSL(2, q),
identify H ′ and show that H is none of the subgroups of
PSL(2, q) containing H ′ as a proper subgroup. With the
numbering from the theorem we have the following case dis-
tinctions. We remark that for q ≡ 1 mod 4 the group H ′ is
the group of case (3) and for q ≡ 3 mod 4 the group H ′ is
the group of case (2)
(1) H is not an elementary abelian p-group since |H ′| is not
a p-power.
(2) For q ≡ 1 mod 4 the order of H ′ is larger than p
r±1
2
and for q ≡ 3 mod 4 the characterized group must be
H ′ itself.
(3) For q ≡ 1 mod 4 the characterized group must be
H ′ itself due to the order of the groups. For q ≡ 3
mod 4 we must have a look at the elements of or-
der 2 in PSL(2, q). These are elements M · Z where
M =
(
a b
c b
)
with ad − bc = 1 and M2 = E
or M2 = −E. Solving this equation system yields
M = ±E which corresponds to an element of H ′
and M =
(
a b
−a
2+1
b −a
)
where a ∈ Fq and b ∈
F∗q. Now we choose a matrix N =
(
u v
−v u
)
with
u2 + v2 = 1 and u, v 6= 0. So N · Z = {±N} ∈ H ′
and since 〈H ′, N〉 would be a dihedral group we have
the following relation
MZ ·NZ ·MZ = N−1Z
⇔ {±M}·{±N}·{±M} =
{
±N−1
}
=
{
±
(
u −v
v u
)}
⇔
{
±
(
−ab2v−a3v−av−bu
b −v
(
a2 + b2
)
v(a2b2+a4+2a2+1)
b2
−bu+ab2v+a3v+av
b
)}
=
{
±
(
u −v
v u
)}
.
By comparing the diagonal elements we get
av
(
a2 + b2 + 1
)
= 0 and v
(
b4 − a4 − 2a2 − 1
)
=
0. Due to v 6= 0 this is equivalent to
a
(
a2 + b2 + 1
)
= 0 and
(
a2 + b2 + 1
)
·(
a2 − b2 + 1
)
= 0. Together with a2 + b2 ∈ q we
conclude a = 0 and b = ±1. Since these solutions
correspond to an element of H ′ we derive that case (3)
is not possible for q ≡ 3 mod 4.
(4) If H ′ < H 6 A4 then H ′ must be contained in a max-
imal subgroup of A4. Since the order of a maximal
subgroup of A4 is at most 4 and q > 13 this case can
not occur.
(5) Since we have q > 13 and the maximal subgroups of
the S4 are isomorphic to A4, D4, and S3, this case can
not occur.
51
(6) The maximal subgroups of A5 are isomorphic to D5,
S3, and A4. So this case can not occur for q > 13.
(7) We have that |H| divides (q − 1) · pm. Since
gcd
(
q+1
2 , (q− 1) · p
m
)
6 2 and |H ′| divides |H|,
only q ≡ 1 mod 4, |H ′| = q − 1, t = q − 1, and
r|m is possible. If m > 2r then |H| > q2(q − 1) >
|PSL(2, q)| = 12
(
q2 − 1
)
q, which is a contradiction.
So only m = r is possible and H must be a semidi-
rect product of an abelian group of order q and a cyclic
group of order q − 1. Using Zassenhaus’ theorem [11,
I.18.3] we can deduce that all subgroups of order q− 1
ofH are conjugates and so isomorphic. SinceH ′ is not
abelian (for q ≡ 1 mod 4) it is not cyclic and so at the
end case (7) of Theorem 3.9 is impossible.
(8) Clearly H 6' PSL(2, q). Since |H ′| does not divide
|PSL (2, pm)| = (
p2m−1)pm
2 only the second pos-
sibility is left. Since |H ′| divides |PGL (2, pm)| =(
p2m − 1
) (
p2m − pm
)
we have 2m = r, pm =
√
q,
and q ≡ 1 mod 4. But for q > 13 we have Dq−1
2
6
PGL
(
2,
√
q
)
, see e. g. [5], thus case (8) is also not
possible.

To finish the proof of the characterization of the automor-
phisms of F2q with respect to ∆ we need as a last ingredient
a result on the number of solutions of an elliptic curve in Fq.
Theorem 3.13 (Hasse, e. g. [22]) Let f be a polynomial of
degree 3 in Fq without repeated factors then we have for
the number N of different solutions of f(t) = s2 in F2q the
inequality |N− q− 1| 6 2
√
q.
PROOF OF THEOREM 3.3. For the cases q = 3, 7, 11 we
utilize a computer to check that there are no other automor-
phisms. So we can assume q > 13.
If M ∈ G is an automorphism for q ≡ 3 mod 4 then
there exists an element x ∈ F∗q so that either x · M or
x · M ·
(
0 1
1 0
)
has determinant 1. Thus with the help
of Lemma 3.12 and Lemma 3.2 the theorem is proven for
q ≡ 3 mod 4. With the same argument we can show that
for q ≡ 1 mod 4 any possible further automorphism which
is not contained in the list of Lemma 3.2 must have a deter-
minant which is a non-square in Fq. Let M =
(
a b
c d
)
be an element of G with det(M) = ad − bc 6∈ q.
So M2 =
(
a2 + bc b(a+ d)
c(a+ d) bc+ d2
)
is also an element of
G. Since we have det
(
M2
)
= det(M)2 ∈ q we have
a2 + bc = bc+ d2, b(a+ d) = −c(a+ d) or a2 + bc =
−
(
bc+ d2
)
, b(a + d) = c(a + d) due to Lemma 3.12.
This leads to the four cases
(1) a = d, b = −c,
(2) a = d = 0,
(3) a = −d, and
(4) b = c, a2 + d2 = −2b2.
Now we consider the derived matrixM ′ := M ·
(
0 1
1 0
)
=(
b a
d c
)
with det (M ′) 6∈ q which must be also an auto-
morphism. So each of the matrices M and M ′ must be in
one of the four cases. From this we can conclude some equa-
tions and derive a contradiction for each possibility. W.l.o.g.
we assume that the number of the case of M ′ is at least the
number of the case ofM.
(1) M as in (1): With the help of Lemma 3.4 we get
det(M) = a2 + b2 ∈ q, which is a contradiction.
(2) M as in (2): Since det(M) 6∈ q the only possibility
for M ′ is case (4). Thus we have b2 + c2 = 0 ⇔
b = ±ωqc, where we can assume c = 1 and b =
ωq without loss of generality. Since det (M ′) must
be a non-square in Fq we have q ≡ 5 mod 8. If we
apply M ′ onto the points (0, 0) and (1, 1) then we can
conclude that 2 must be a square in Fq, which is not
the case if q ≡ 5 mod 8.
(3) M as in (3): Due to det(M) 6∈ q the matrixM ′ must
be in case (4). So we have a = d = 0, a situation
already treated in case (2).
(4) M as in (4): Thus also M ′ has to be in case (4).
Here we have a = d, b = c, 2a2 = −2b2. With-
out loss of generality we can assume a = 1 and
b = ωq. Due to det(M) = 2 6∈ q we have q ≡ 5
mod 8. For two elements x, y ∈ Fq with x2 + y2 be-
ing a square we have that also M̃ :=
(
1 ωq
ωq 1
)
·(
x y
−y x
)
=
(
x−ωqx xωq + y
xωq − y x+ yωq
)
is an au-
tomorphism. Thus with Lemma 3.4 we get that
(xωq + y)
2
+ (x+ yωq)
2
= 22xyωq must be a
square in Fq for all possible values x, y 6= 0. So for
q ≡ 5 mod 8 for all possible x, y the product xy 6= 0
must be a non-square. We specialize to x2 + y2 = 12
and so can get with the help of Lemma 3.7 that x =
2
t+t−1 and y =
t−t−1
t+t−1 with t
2 6= −1, t 6= 0. If we re-
quire t4 6= 1 instead of t2 6= −1 we get x, y 6= 0. Thus
xy =
2(t−t−1)
(t+t−1)
2 must be a non-square for all t ∈ F∗q
with t4 6= 1. Since 2 is a non-square we have that
t− t−1 and so also t3 − t = t(t− 1)(t+ 1) must be a
square for all t ∈ F∗q with t4 6= 1. By checking the five
excluded values we see that f(t) := t(t−1)(t+1) must
be a square for all t ∈ Fq. So f(t) = s2 has exactly
N := 2q − 3 solutions in Fq. Since f has not repeated
factors and degree 3 we can apply Theorem 3.13 to get
a contradiction to q > 13.

52
Lemma 3.14 For two points p1 6= p2 ∈ F ′q at integral
distance there exists an isomorphismϕwith eitherϕ (p1) =
0, ϕ (p2) = 1 or ϕ (p1) = 0, ϕ (p2) = 1+ωqi.
PROOF. Without loss of generality we assume p1 = 0.
Since the points p1 and p2 are at integral distance there ex-
ists an element r ∈ Fq with p2p2 = r2 and since p2 6= p1
we have p2 ∈ F ′q
∗. If p2p2 6= 0 we choose ·p−12 as the
isomorphism ϕ. Otherwise we have p2 = a + bi with
a2 + b2 = 0 where a, b 6= 0. Thus
(
b
a
)2
= −1 and
ϕ = ·a−1. 
We remark that Lemma 3.14 can be sharpened a bit. For
three pairwise different non-collinear points p1, p2, p3 ∈
F ′q with pairwise integral distances there exists an isomor-
phism ϕ with {0, 1} ⊂ {ϕ (p1) , ϕ (p2) , ϕ (p3)}.
Via a computer calculation we can determine the auto-
morphism groups of the missing cases q = 5, 9.
Lemma 3.15 For q = 5 the group G 6 GL (2,F5) is given
by {
M =
(
a b
±b ±a
) ∣∣∣a, b ∈ F5,
a2 + b2 ∈ 5, det(M) 6= 0
}
where the two signs can be chosen independently.
Lemma 3.16 For q = 9 the group G 6 GL (2,F9) is given
by 〈(
1 0
0 y2
)
,
{
M =
(
a b
±b ±a
) ∣∣∣
a, b ∈ F9, a2 + b2 ∈ 9, det(M) 6= 0
}〉
where the two signs can be chosen independently and where
y is a primitive root in F∗9.
For q = 5 there are exactly 32 such matrices and for q =
9 there are exactly 192 such matrices. For q = 5, 9 Lemma
3.14 can be sharpend. Here the automorphism group acts
transitively on the pairs of points with integral distance, as
for q ≡ 3 mod 4.
We would like to remark that also for q ≡ 3 mod 4 the
automorphism group of F2q with respect to ∆ is isomorphic
to the automorphism group of the quadrance graph over F2q.
This can easily be verified be going over the proof of Theo-
rem 3.3 again and by checking the small cases using a com-
puter.
4 Maximal integral point sets in the
plane F2q
Very nice rings are those which are integral domains. These
are in the case of finite commutative rings exactly the finite
fields Fq where q = pr is a prime power. So far we only
have the lower bound I (Fq, 2) > q. In this section we
will prove I (Fq, 2) = q for q > 2. In the case of Fp
we will even classify the maximum integral point sets up to
isomorphism. One way to prove I (Fq, 2) = q for 2 - q
is to consider the graph Gq with the elements of Fq as its
vertices and pairs of points at integral distance as edges. For
q ≡ 3 mod 4 the graph Gq is isomorphic to the Paley graph
of order q2. From [3] we know that in this case a maximum
clique of Gq has size q and is isomorphic to a line. Also for
q ≡ 1 mod 4 the graph Gq is a strongly regular graph. So
we can apply a result from [18, 19] on cliques of strongly
regular graphs. It turns out that a maximum clique has size
q and that every clique C of size q is regular, in the sense
of [18, 19], this means in our special case that every point
not in C is adjacent to q+12 points in C. To start with our
classification of maximum integral point sets over Fq we
need the concept of directions.
Definition 4.1 For a point p = a + bi ∈ F ′q the quotient
b
a ∈ Fq ∪ {∞} is called the direction of p. For two points
p1 = a1 + b1i, p2 = a2 + b2i the direction is defined as
b1−b2
a1−a2
∈ Fq ∪ {∞}. We call an direction d integral if two
points p1, p2 with direction d have an integral distance.
Point sets of cardinality q in F2q with at most
q+3
2 direc-
tions are more or less completely classified:
Theorem 4.2 (Ball, Blokhuis, Brouwer, Storme, Szőnyi,
[4]) Let f : Fq → Fq, where q = pn, p prime, f(0) = 0.
Let N = |Df|, where Df is the set of directions determined
by the function f. Let e (with 0 6 e 6 n) be the largest
integer such that each line with slope inDf meets the graph
of f in a multiple of pe points. Then we have the following:
1. e = 0 and q+32 6 N 6 q+ 1,
2. e = 1, p = 2, and q+53 6 N 6 q− 1,
3. pe > 2, e|n, and qpe + 1 6 N 6
q−1
pe−1 ,
4. e = n and N = 1.
Moreover, if pe > 3 or ( pe = 3 and N = q3 + 1), then f is
a linear map on Fq viewed as a vector space over Fpe . (All
possibilities for N can be determined in principle.)
Here a function f : Fq → Fq determines a point set P =
{(x, f(x)) | x ∈ Fq} of cardinality q. In the case N = 1
the point set is a line. In the case e = 0 and N = q+32
then P is affine equivalent to the point set corresponding to
x 7→ xq+12 .
We remark that affine equivalence is a bit more than our
equivalence because we have to respect ∆. The next thing to
prove is that integral point sets can not determine too many
directions.
Lemma 4.3 For 2 - q an integral point set over F2q deter-
mines at most q+32 different directions if −1 ∈ q and at
most q+12 different directions if −1 6∈ q.
53
PROOF. We consider the points p = a + bi at inte-
gral distance to 0. There exists an element c ′ ∈ Fq with
a2 + b2 = c ′2. In the case a = 0 we obtain the direc-
tion ∞. Otherwise we set d := ba and c := c′a , yielding
1 = c2 − d2 = (c − d)(c + d), where d is the direction of
the point. Now we set c+d =: t ∈ F∗q yielding c = t+t
−1
2 ,
d = t−t
−1
2 . The two values t and −t
−1 produce an equal
direction. Since t = −t−1 ⇔ t2 = −1 we get the desired
bounds. 
We need a further lemma on the number of points on a
line in a non-collinear integral point set:
Lemma 4.4 If 2 - q and P is a non-collinear integral point
set over F2q, then each line l contains at most
q−1
2 points for
−1 /∈ q and at most q+12 points for −1 ∈ q.
PROOF. If l is a line with an integral pair of points on it,
then its slope is an integral direction. Now we consider the
intersections of lines with integral directions containing a
point p /∈ l, with l. 
We remark that there would be only q−12 integral direc-
tions for q ≡ 1 mod 4 if we would not consider 0 as a
square as for quadrance graphs. In this case there could be
at most q−32 points on l for q ≡ 1 mod 4 in Lemma 4.4.
To completely classify maximum integral point sets over
F ′q we need the point set Pq := (1±ωqi)q.
Lemma 4.5 Pq is an integral point set of cardinality q.
PROOF.
d2
(
r21 + r
2
1ωqi, r
2
2 + r
2
2ωqi
)
= 02,
d2
(
r21 + r
2
1ωqi, r
2
2 − r
2
2ωqi
)
= (2ωqr1r2)
2
,
d2
(
r21 − r
2
1ωqi, r
2
2 − r
2
2ωqi
)
= 02.

•
•
•
•
•
•
•
•
•
•
•
•
•
•
••
•
•
•
•
•
•
•
•
•
•
•
•
Figure 1: The maximum integral point set P29.
In Figure 1 we have depicted P29 as an example. By
construction the points of Pq are located on the two lines
(1,ωq) ·Fq and (1,−ωq) ·Fq which intersect in (0, 0) with
an angle of 90 degree, but this fact seems not that obvious by
looking at Figure 1. We remark that this construction of Pq
works in any commutative ring R where −1 ∈ R and that
none of these point sets corresponds to a quadrance graph.
If we apply this construction on R = Zpr we obtain an inte-
gral point set of cardinality φ (pr)+1 = (p−1) ·pr−1+1,
where φ is the Euler-function defined by φ(n) = |Z∗n|.
Lemma 4.6 For 2 | r the point set
P :=
{
(a, b) | a, b ∈ F√q
}
is an integral point set.
PROOF. We have F√q ⊂ q. 
We remark that for
√
q ≡ 1 mod 4 also the point set
P :=
{
(a,ωqb) | a, b ∈ F√q
}
is integral.
We say that an integral point set is maximal if we can not
add a further point without destroying the property integral
point set. All given examples of integral point sets of size
q are maximal. This could be proved be applying results on
cliques of strongly regular graphs or in the following way.
Lemma 4.7 The lines 1 · Fq and (1+ωqi) · Fq are maxi-
mal.
PROOF. We apply Lemma 4.4. 
Lemma 4.8 The integral point set P = (1±ωqi) · q is
maximal.
PROOF. Let us assume there is a further point (a+ bi) 6∈ P
with a, b ∈ Fq such that P ∪ {(a+ bi)} is also an integral
point set. We know that (a + bi) can not lie on one of the
lines (1+ωqi) · Fq or (1−ωqi) · Fq. Thus a2 + b2 6= 0.
The points of P are given by (1+ωqi) r21 and (1−ωqi) r
2
2
for arbitrary r1, r2 ∈ Fq. We define functions f1, f2 : Fq →
Fq via
f1 (r1) =
(
a− r21
)2
+
(
b− r21ωq
)2
= a2 + b2 − 2r21 (a+ bωq) ,
f2 (r2) =
(
a− r22
)2
+
(
b+ r22ωq
)2
= a2 + b2 − 2r22 (a− bωq) .
Since these are exactly the squared distances of the points
of P to the point (a + bi) we have Bi (f1) ,Bi (f2) ⊆ q.
Using a counting argument we have Bi (f1) ,Bi (f2) = q.
The term −2 (a+ bωq) is a fix number. Let us assume
that it is a square. Then for each square r2 and c = a2 +
b2 6= 0 the difference r2 − c must be a square. But the
equation r2 − c = h2 has q+12 < q solutions for r, which
is a contradiction. Thus −2 (a+ bωq) and −2 (a− bωq)
are non-squares. But r2 − c 6∈ q has q−12 solutions, thus
we have a contradiction 
54
Theorem 4.9 For q = pr > 9 with p 6= 2, r = 1 or q ≡ 3
mod 4 an integral point set of cardinality q is isomorphic to
one of the stated examples.
PROOF. We consider a point set P of Fq of cardinality q
with at most q+32 directions and utilize Theorem 4.2. If
e = r and N = 1 then P is a line. If e = 1 then P is
affine equivalent to X :=
{(
x, x
q+1
2
)
| x ∈ Fq
}
. This is
only possible for q ≡ 1 mod 4. The set X consists of two
orthogonal lines. Since there are only two types of non-
isomorphic integral lines in F2q and each point p not on a
line l is at integral distance to q+12 points on l we have two
unique candidates of integral point sets of this type. One
is given by (1±ωqi) · q. For the other possibility we
may assume that (0, 0), (1, 0) ∈ P. Thus (0,±ωq) ∈ P,
(−1, 0), (±ωq, 0) , (0,±1) ∈ P. So P must be symmetric
in the following sense: There exists a set S ⊂ F∗q such that
P = (0, 0) ∪ {(0, a), (a, 0) | a ∈ S}. The elements s of S
must fullfill s ∈ F∗q, s2 + 1 ∈ q and s2 − 1 ∈ q. Each
condition alone has only q−12 solutions. Fulfilling both con-
ditions, meaning |S| = q−12 is possible only for q 6 9. For
q = 5, 9 there are such examples. For q ≡ 3 mod 4 we
refer to [3]. 
We remark that there may be further examples of integral
point sets of cardinality q for q = pr ≡ 1 mod 4 and r >
1. Those examples would correspond to case (3) of Theorem
4.2.
Theorem 4.10 For q = pr with p 6= 2 we have I (Fq, 2) =
q.
PROOF. Let P be an arbitrary integral point set of cardinality
q. Now we show that P is maximal. If we assume that there
is another integral point set P ′ with P ⊂ P ′ and |P ′| = q+1
then we can delete a point of P ′ in such a way that we obtain
an integral point set P ′′ with e = 1 in the notation of 4.2.
Thus P ′′ ' (1±ωqi) · q. Since P ′′ is maximal due to
Lemma 4 we have a contradiction. 
5 Maximal integral point sets in the
plane Z2n
Due to Theorem 2.6 for the determination of I (Zn, 2) we
only need to consider the cases n = pr.
Lemma 5.1
I
(
Zpr+1 , 2
)
6 p2 · I (Zpr , 2) .
PROOF. We consider the natural ring epimorphism ν :
Zpr+1 → Zpr . If P is an integral point set in Z2pr+1 then
ν (P) is an integral point set in Z2pr . 
For p > 3 we have the following examples of integral
point sets in Z2pr with big cardinality (with some abuse of
notation in the third case).{(
i, j · pd
r
2e
)
| i, j ∈ Zpr
}
,{(
i, iωZpr + j · pd
r
2e
)
| i, j ∈ Zpr
}
, and(
1,±ωZp
)
·Zp + {(p · a, p · b) | a, b ∈ Zpr } for r = 2.
Each of these examples has cardinality pr · pb
r
2c.
• • • • • • • • • • • • • • • • • • • • • • • • •
• • • • • • • • • • • • • • • • • • • • • • • • •
• • • • • • • • • • • • • • • • • • • • • • • • •
• • • • • • • • • • • • • • • • • • • • • • • • •
• • • • • • • • • • • • • • • • • • • • • • • • •
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
Figure 2: Three maximal integral point sets over Z225 of car-
dinality 125.
Conjecture 5.2 The above list is the complete list of maxi-
mum integral point sets in Z2pr up to isomorphism.
So far we do not even know the automorphism group of
Z2n with respect to∆. But with Definition 3.1 Conjecture 5.2
is well defined. Using Lemma 3.2 we know at least a sub-
group of the automorphism group. If there are any further
55
automorphisms is an open question which has to be analyzed
in the future.
Theorem 5.3 For p > 3 we have I
(
Zp2 , 2
)
= p3 and the
above list of extremal examples is complete.
PROOF. With I (Zp, 2) = p, Lemma 5.1 and the examples
we get I
(
Zp2 , 2
)
= p3. Let P be a maximum integral point
set in Zp2 . By S denote the lower left p× p-square of Zp2
S :=
{
(i, j) + Z2p2 | 0 6 i, j 6 p− 1, i, j ∈ Z
}
.
Using Theorem 4.10 and Lemma 5.1 we can deduce that for
each (u, v) ∈ Z2p2 we have
|P ∩ ((u, v) + S)| 6 p.
Since we can tile Zp2 with p2 such sets (including S +
(u, v)) equality must hold. After a transformation we can
assume that P ∩ S equals one of the three following possi-
bilities
1. {(i, 0) | 0 6 i 6 p− 1},
2.
{(
i,ωZpi
)
| 0 6 i 6 p− 1
}
, or
3.
(
1,±ωZp
)
·Zp .
In the first case we consider P ∩ (S+ (1, 0)). With Lemma
4.4 we get (p, 0) ∈ P and iteratively we get (i, 0) ∈ P
for all i ∈ Zp2 . Now we consider P ∩ (S+ (0, 1)) and
conclude P =
{
(i, j · p) | i, j ∈ Zp2
}
. With the same argu-
ment we can derive P =
{(
i, iωZp + j · p
)
| i, j ∈ Zp2
}
in the second case and P =
(
1,±ωZp
)
· Zp +
{(p · a, p · b) | a, b ∈ Zpr } in the third case. 
6 Maximal integral point sets without
three collinear points
In this and the next section we study the interplay between
the integrality condition for a point set and further common
restrictions for lines and circles.
Definition 6.1 A set of r points (ui, vi) ∈ R2 is said to be
collinear if there are a, b, t1, t2, wi ∈ R with
a+wit1 = ui and b+wit2 = vi.
There is an easy necessary criterion to decide whether
three points are collinear.
Lemma 6.2 If three points (u1, v1), (u2, v2), and
(u3, v3) ∈ R2 are collinear then it holds∣∣∣∣∣∣
u1 v1 1u2 v2 1
u3 v3 1
∣∣∣∣∣∣ = 0.
If R is an integral domain the above criterion is also suf-
ficient. The proof is easy and left to the reader.
Definition 6.3 By I (R, 2) we denote the maximum cardi-
nality of an integral point set with no three collinear points.
Lemma 6.4
I (R, 2) 6 2 · |R| .
PROOF. We ignore the integrality condition and consider the
lines li = {(i, r) | r ∈ R} for all i ∈ R. 
Lemma 6.5 If −1 ∈ q we have I (Fq, 2) 6 q+32 and for
−1 6∈ q we have I (Fq, 2) 6 q+12 .
PROOF. Let P be an integral point set over Fq without a
collinear triple. We choose a point p ∈ P. The directions
of p to the other points p ′ of P are pairwise different. Since
there are at most q+32 or
q+1
2 different directions in an in-
tegral point set over Fq (Lemma 4.3), we obtain |P| 6 q+52
for −1 ∈ q and |P| 6 q+32 for −1 6∈ q. Suppose that
this upper bound is achieved. So all points must have ex-
actly one neighbor in direction 0 and one in direction ∞.
Thus |P| must be even in this case, which is a contradiction
due to Lemma 3.6. 
Using an element z ∈ R ′ with zz = 1 we can describe
a good construction for lower bounds. Actually this equa-
tion describes something like a circle with radius one. An
example for q = 31 is depicted in Figure 3.
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
Figure 3: Integral point set corresponding to the construc-
tion from Lemma 6.6 for q = 31.
Lemma 6.6 For z ∈ R ′ with zz = 1 the set P ={
z2i | i ∈ N
}
is an integral point set.
PROOF. With c := a− b we have
d
(
z2a, z2b
)
=
(
z2a − z2b
)
· (z2a − z2b)
=
(
z2c − 1
)
· z2c − 1
= 2− z2c2− z2c
=
zci− zci︸ ︷︷ ︸
∈R
2 .

56
We remark that the set P ′ =
{
z2i+1 | i ∈ N
}
is an iso-
morphic integral point set. The set of solutions of zz = 1
forms a cyclic multiplicative group G due to Lemma 3.8.
From Lemma 3.7 we know that G has size q + 1 for −1 6∈
q and size q − 1 if −1 ∈ q. So by Lemma 6.6 we get a
construction of an integral point set in Fq which is near the
upper bound of Lemma 6.5. We only have to prove that our
construction does not produce three collinear points in Fq.
Lemma 6.7 For R = Fq with 2 - q the point set from
Lemma 6.6 contains no collinear triple.
PROOF. We assume that we have three pairwise different
points p1, p2, p3 in R ′ which are collinear. So there exist
a, b, c, d, t1, t2, and t3 in R fullfilling
p1 = a+ bt1 + (c+ dt1) i,
p2 = a+ bt2 + (c+ dt2) i,
p3 = a+ bt3 + (c+ dt3) i,
and ti 6= tj for i 6= j. Since pipi = 1 we have
a2 + 2abt1 + b
2t21 + c
2 + 2cdt1 + d
2t21 = 1,
a2 + 2abt2 + b
2t22 + c
2 + 2cdt2 + d
2t22 = 1,
a2 + 2abt3 + b
2t23 + c
2 + 2cdt3 + d
2t23 = 1.
Subtracting the first two and the last two equations yields
2ab (t1 − t2) + b
2 (t1 − t2) (t1 + t2)
+2cd (t1 − t2) + d
2 (t1 − t2) (t1 + t2) = 0,
2ab (t2 − t3) + b
2 (t2 − t3) (t2 + t3)
+2cd (t2 − t3) + d
2 (t2 − t3) (t2 + t3) = 0.
Because t1 6= t2, t2 6= t3 and R is an integral domain we
obtain
2ab+ b2 (t1 + t2) + 2cd+ d
2 (t1 + t2) = 0,
2ab+ b2 (t2 + t3) + 2cd+ d
2 (t2 + t3) = 0.
Another subtraction yields
b2 (t1 − t3) + d
2 (t1 − t3) = 0 ⇒ b2 + d2 = 0.
Inserting yields
2ab+ 2cd = 0 ⇔ 2ab = −2cd
and
a2 + c2 = 1.
Thus
4a2b2 = 4c2d2 ⇔
(
a2 + c2
)
4b2 = 0 ⇔ b = 0.
In the same way we obtain d = 0 and so p1 = p2 = p3,
which is a contradiction. 
Corollary 6.8 For −1 6∈ q we have I (Fq, 2) = q+12 and
for −1 ∈ q we have q−12 6 I (Fq, 2) 6
q+3
2 .
Conjecture 6.9 For −1 ∈ q we have I (Fq, 2) = q−12 .
We remark that Conjecture 6.9 would be true for quad-
rance graphs. Following the proof of Lemma 6.5 we would
get q−12 as an upper bound for q ≡ 1 mod 4. Since
zc − zc = 0 would imply 2c = q− 1 the construction from
Lemma 6.6 does not contain a pair of points with squared
distance 0.
7 Integral point sets in general posi-
tion
Our best construction for integral point sets where no three
points are collinear consists of points on a circle. So it is
interesting to study integral point sets where additionally no
4 points are allowed to be situated on a circle.
Definition 7.1 Points pi = (xi, yi) in R2 are said to be sit-
uated on a circle if there exist a, b, r ∈ R with (xi − a)2 +
(yi − b)
2
= r for all i.
We have the following condition:
Lemma 7.2 Four distinct points pi = (xi, yi) in F2q which
contain no collinear triple are situated on a circle if and
only if ∣∣∣∣∣∣∣∣

x1 y1 x
2
1 + y
2
1 1
x2 y2 x
2
2 + y
2
2 1
x3 y3 x
2
3 + y
2
3 1
x4 y4 x
2
4 + y
2
4 1

∣∣∣∣∣∣∣∣ = 0.
PROOF. If there exist a, b, r ∈ Fq with (xi − a)2 +
(yi − b)
2
= r for all 1 6 i 6 4 then the determinant clearly
vanishes since r = (xi − a)
2
+ (yi − b)
2
=
(
x2i + y
2
i
)
−
2a · xi − 2b · yi +
(
a2 + b2
)
. For the other direction we
consider the unique circle C through the points (x1, y1),
(x2, y2), (x3, y3) described by the parameters a, b, r ∈ Fq.
With the same idea as before we get∣∣∣∣∣∣∣∣

x1 y1 0 1
x2 y2 0 1
x3 y3 0 1
x4 y4 (x4 − a)
2
+ (y4 − b)
2
− r 1

∣∣∣∣∣∣∣∣ = 0.
If (x4, y4) is not on the circle C then we can develop the
determinant after the third column and obtain∣∣∣∣∣∣
x1 y1 1x2 y2 1
x3 y3 1
∣∣∣∣∣∣ = 0.
which is a contradiction to the fact that (x1, y1), (x2, y2),
and (x3, y3) are not collinear, see Lemma 6.2. 
We remark that for arbitrary commutative rings R the de-
terminant criterion from Lemma 7.2 is a necessary condi-
tion.
57
•
•
•
•
•
•
•
Figure 4: A maximum integral point set in general position
over F229.
Definition 7.3 By İ (R, 2) we denote the maximum cardi-
nality of an integral point set in R2 which is in general po-
sition, this means that it contains no collinear triple and no
four points on a circle.
As a shorthand for the conditions of Definition 7.3 we
also say that the points are in general position. An example
of seven points over F229 in general position which pairwise
integral distances is depicted in Figure 4. As trivial upper
bound we have İ (R, 2) 6 I (R, 2). By applying the auto-
morphisms of F2q with respect to∆we see that they conserve
circles.
p İ p İ p İ p İ p İ
2 4 17 5 41 9 67 9 97 11
3 2 19 5 43 8 71 11 101 13
5 4 23 5 47 7 73 10 103 11
7 3 29 7 53 9 79 11 107 11
11 4 31 6 59 9 83 11 109 12
13 5 37 7 61 10 89 11 113 12
Table 1: Values of İ (Fp, 2) = İ (Zp, 2) for small primes p.
Via an exhaustive combinatorial search we have deter-
mined İ (Fp, 2) for small values of p, see Table 1. Since
it is a non-trivial task to determine these numbers exactly, at
least for p > 100, we give an outline of our used algorithm.
Algorithm 7.4 (Generation of integral point sets in gen-
eral position over Fq)
Input: q
Output: Integral point sets P ⊂ Fq in general position
begin
P = [(0, 0), (0, 1)]
blocked [(0, 0)] = blocked [(0, 1)] = true
loop over d ∈ Fq Ld = [] end
loop over x ∈ F2q\ {(0, 0), (0, 1)}
blocked[x] = false
if ∆((0, 0), x) = 0 or ∆((0, 1), x) = 0
then blocked[x] = true end
if collinear((0, 0), (0, 1), x)
then blocked[x] = true end
if blocked[x] = true
then Lget direction(x).append(x) end
end
add point (P, 0)
end
So far almost nothing is done. We restrict our search to
integral point sets P of cardinality at least 3. So we may
assume that P contains the points (0, 0) and (0, 1). For each
x ∈ F2q the variable blocked[x] says whether x can be ap-
pended to P without destroying the property integral point
set or general position. The lists Ld cluster the points of
F2q according to their direction. The fact that P can contain
besides (0, 0) and (0, 1) at most one member from each Ld
can be used to prune the search tree if one searches only for
integral point sets with maximum cardinality.
Algorithm 7.5 (add point)
Input: Lower bound l on the direction and an integral point
set P
Output: Integral point sets P ⊂ Fq in general position
begin
loop over d ∈ Fq with d > l
loop over x ∈ Ld with blocked[x] = false
if canon check (P, x) = true then
P.append(x)
block all y ∈ F2q where ∆(y, x) = 0
or collinear (p1, x, y) = true
or on circle (p1, p2, x, y) = true
for p1, p2 ∈ P
output P
add point (P, d+ 1)
unblock
P.remove(x)
end
end
end
end
The subroutine add point simply adds another point to
the point set P and maintains the set of further candidates for
adding a further point. Some lookahead is possible to imple-
ment. Since the automorphism group of F2q with respect to
∆ is very large we would obtain lots of isomorphic integral
point sets if we do without isomorphism pruning. With the
framework of orderly generation, see e. g. [21], it is possible
to write a subroutine canon check that let our algorithm
output a complete list of pairwise non-isomorphic integral
point sets in general position. For our purpose it suffices to
have a subroutine canon check that rejects the majority of
isomorphic copies but as a return has a good performance.
Let m : F2q → F2q, (x, y) 7→ (−x, y) the automorphism
that mirrors at the y-axis and let be a total ordering on the
points of F2q if u ≺ v for direction(u) < direction(v).
For the latter comparison we use an arbitrary but fix total
ordering of Fq, where 0 is the smallest element and which
58
is also used for the looping over Fq. By P[2] we denote the
third point of a list P.
Algorithm 7.6 (canon check)
Input: An integral point set P
Output: Returns false if P should be rejected due to isomor-
phism pruning
begin
loop over some disjoint triples (u, v,w) ∈ P× P× P
with δ2(u, v) 6= 0
determine an automorphism α with α(u) = (0, 0)
and α(v) = (0, 1)
if α(w) ≺ P[2] or m (α(w)) ≺ P[2]
then return false end
end
return true
end
For further examples we refer to [15] where we list the
coordinates of one extremal example for p 6 113.
A formal proof of the correctness of the proposed algo-
rithm is not difficult but a bit technical and so left to the
reader. We remark that there are several non-isomorphic in-
tegral point sets in general position which achieve the upper
bound İ (Zn, 2). So far we have no insight in their structure
or in the asymptotic behavior of İ (Zn, 2). It seems that we
have İ (Zp, 2) > 7 for all sufficiently large primes p. This
is interesting because the question whether İ (Z, 2) > 7 is
unsolved so far. In other words, there is no known 72-cluster
[9]. This is a set of seven points in the plane, no three points
on a line, no four points on a circle, where the coordinates
and the pairwise distances are integral.
Conjecture 7.7 For each l there is a p ′ so that for all p >
p ′ we have İ (Zp, 2) > l.
8 Conclusion and outlook
In this paper we have considered sets of points P in the
affine plane AG(2, q) with pairwise integral distances. We
have presented several connections to other discrete struc-
tures and problems. Some questions concerning maximum
cardinalities and complete classifications of extremal exam-
ples remain open. Clearly similar questions could be asked
in AG(3, q) or higher dimensional spaces.
Acknowledgment
I am thankful to Aart Blokhuis, Stancho Diemiev, Michael
Kiermaier, Harald Meyer, and Ivo Radloff whose comments
were very helpful during the preparation of this article.
Bibliography
[1] A. Antonov and M. Brancheva, Algorithm for finding
maximal Diophantine figures, Spring Conference
2007 of the Union of Bulgarian Mathematicians,
2007.
[2] R. D. Baker, G. L. Ebert, J. Hemmeter, and A. Woldar,
Maximal cliques in the Paley graph of square or-
der, J. Statist. Plann. Inference 56 (1996), no. 1,
33–38.
[3] A. Blokhuis, On subsets of GF(q2) with square differ-
ences, Indag. Math. 46 (1984), 369–372.
[4] A. Blokhuis, S. Ball, A. E. Brouwer, L. Storme, and
T. Szőnyi, On the number of slopes of the graph
of a function defined on a finite field, J. Combin.
Theory Ser. A 86 (1999), no. 1, 187–196.
[5] P. J. Cameron, G. R. Omidi, and B. Tayfeh-Rezaie, 3-
designs from PGL(2, q), Electron. J. Combin. 13
(2006), no. 1.
[6] L. Carlitz, A theorem on permutations in a finite field,
Proc. Amer. Math. Soc. 11 (1960), 456–459. MR
MR0117223 (22 #8005)
[7] L. E. Dickson, Linear groups. With an exposition of the
Galois field theory. With an introduction by Wil-
helm Magnus. Unabridged and unaltered republ.
of the first ed., New York: Dover Publications, Inc.
XVI, 312 p., 1958.
[8] S. Dimiev, A setting for a Diophantine distance geom-
etry, Tensor (N.S.) 66 (2005), no. 3, 275–283. MR
MR2189847
[9] R. K. Guy, Unsolved problems in number theory. 2nd
ed., Unsolved Problems in Intuitive Mathematics.
1. New York, NY: Springer- Verlag. xvi, 285 p.,
1994.
[10] H. Harborth, Integral distances in point sets, Butzer,
P. L. (ed.) et al., Karl der Grosse und sein Nach-
wirken. 1200 Jahre Kultur und Wissenschaft in Eu-
ropa. Band 2: Mathematisches Wissen. Turnhout:
Brepols, 1998, 213–224.
[11] B. Huppert, Endliche Gruppen. I, Die Grundlehren
der mathematischen Wissenschaften in Einzel-
darstellungen. 134. Berlin-Heidelberg-New York:
Springer-Verlag. XII, 793 S. mit 15 Abb., 1967.
[12] T. Khoon Lim and C. E. Praeger, On generalised Paley
graphs and their automorphism groups, Michigan
Math. J. (to appear).
[13] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Electron. Notes Discrete Math. 27 (2006), 65–66.
[14] T. Kreisel and S. Kurz, There are integral heptagons,
no three points on a line, no four on a circle, Dis-
crete Comput. Geom., (to appear).
[15] S. Kurz, Coordinates of maximal integral point sets
over F2q in general position, http://www.wm.uni-
bayreuth.de/index.php?id=322.
[16] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[17] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin, (to
appear).
59
[18] A. Neumaier, Cliques and claws in edge-transitive
strongly regular graphs, Math. Z. 174 (1980), 197–
202.
[19] A. Neumaier, Regular cliques in graphs and special
1,5-designs, Finite geometries and designs, Proc.
2nd Isle of Thorns Conf. 1980, Lond. Math. Soc.
Lect. Note Ser. 49, 244–259, 1981.
[20] L. C. Noll and D. I. Bell, n-clusters for 1 < n < 7,
Math. Comp. 53 (1989), no. 187, 439–444.
[21] R. C. Read, Every one a winner or how to avoid
isomorphism search when cataloguing combinato-
rial configurations, Ann. Discrete Math. 2 (1978),
107–120.
[22] W. M. Schmidt, Equations over finite fields. An el-
ementary approach. 2nd ed., Heber City, UT:
Kendrick Press. x, 333 p., 2004.
[23] J. Sheehan, Finite Ramsey theory is hard, Combinato-
rial mathematics VIII, Proc. 8th Aust. Conf., Gee-
long/ Aust. 1980, Lect. Notes Math. 884, 99-106
(1981).
[24] S. Y. Song, Commutative association schemes whose
symmetrizations have two classes, J. Algebraic
Combin. 5 (1996), no. 1, 47–55.
[25] D. B. Surowski, Automorphism groups of certain un-
stable graphs, Math. Slovaca 53 (2003), no. 3,
215–232.
[26] P. Sziklai, On subsets of GF(q2) with dth power differ-
ences, Discrete Math. 208-209 (1999), 547–555.
[27] L. A. Vinh, On chromatic number of unit-quadrance
graphs (finite euclidean graphs), ArXiv Mathemat-
ics math/0510092 (2005).
[28] L. A. Vinh, Quadrance polygons, association schemes
and strongly regular graphs, ArXiv Mathematics
math/0509598 (2005).
[29] L. A. Vinh, Quadrance graphs, Austral. Math. Soc.
Gaz. 33 (2006), no. 5, 330–332.
[30] L. A. Vinh, Some colouring problems for unit-qua-
drance graphs, ArXiv Mathematics math/0606482
(2006).
[31] N. Wage, Character sums and Ramsey properties of
generalized Paley graphs, Integers 6 (2006).
[32] N. J. Wildberger, Divine proportions. Rational
trigonometry to universal geometry, Kingsford:
Wild Egg. xx, 300 p., 2005.
60
Chapter 8
Integral point sets in higher dimensional affine
spaces over finite fields
SASCHA KURZ1 AND HARALD MEYER2
ABSTRACT. We consider point sets inm-dimensional affine space
Fmq where each squared Euclidean distance of two points is a
square in Fq and determine the automorphism group of these
spaces, which preserves integral distances. For some small param-
etersm and q we determine the maximum cardinality I (Fq,m) of
integral point sets in Fmq . For m = 3 we give upper bounds and
for generalm we give some lower bounds on I (Fq,m). If we map
integral distances to edges in a graph, we can define a graph Gm,q
with vertex set Fmq . It turns out that Gm,q arises from a 3-class
association scheme and even is strongly regular for some cases.
2000 MSC: 51E15;05D99,05B25,05E30,20B25.
Key words and phrases: finite geometry, integral distances,
integral point sets, automorphism group, association schemes,
strongly regular graphs.
1 Introduction and Notation
Let p be a prime and let q be a power of p. We write Fq for
the field with q elements and F∗q := Fq\{0} for the units of
Fq. Our notation GL (m,Fq) for the general linear group is
standard. By
O (m,Fq) :=
{
A ∈ GL (m,Fq) | ATA = AAT = Em
}
,
where Em is the m × m identity matrix, we denote the
orthogonal group in dimension m. We remark that for
even dimension 2n the orthogonal group comes in two
types O+ (2n,Fq) and O− (2n,Fq), and the group we
defined above is isomorphic to O+ (2n,Fq) in this case.
By AΓL (m,Fq) we denote the affine general semilinear
group over Fq. It is well known that the center Z :=
Z (GL (m,Fq)) consists of the diagonal matrices with equal
entries at the diagonal, i. e. the corresponding linear map is
just a multiplication with an element d ∈ F∗q.
1Sascha Kurz, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
2Harald Meyer, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: harald.meyer@uni-bayreuth.de
Originally integral point sets were defined in m-
dimensional Euclidean spaces Em as sets of n points with
pairwise integral distances in the Euclidean metric, see e. g.
[6, 11, 12, 14, 15] for an overview on the most recent results.
Here we consider integral point sets in the affine spaces Fmq .
We equip those spaces with a bilinear form
〈u, v〉 := uTv =
m∑
i=1
uivi
and a squared distance
d2(u, v) := 〈u− v, u− v〉
= (u− v)T (u− v)
=
m∑
i=1
(ui − vi)
2 ∈ Fq
for any two points u = (u1, . . . , um), v = (v1, . . . , vm)
in Fmq . We say that two points u, v ∈ Fmq are at inte-
gral distance if d2(u, v) is contained in the set Fq :={
r2 | r ∈ Fq
}
consisting of the squares in Fq. As in the
Euclidian space we define the cross product of two vectors
u, v ∈ F3q by
u×v := (u2v3 − u3v2,−u1v3 + u3v1, u1v2 − u2v1) ∈ F3q.
The proofs of some of the common formulas for the cross
product do not depend on any specific attributes of the Eu-
clidian space, so they still hold in F3q. Especially this is true
for the formulas
〈u× v, u〉 = 〈u× v, v〉 = 0
and
〈u× v, u× v〉 = 〈u, u〉 · 〈v, v〉− 〈u, v〉2
we will use later on. The notation
U⊥ :=
{
v ∈ Fmq | 〈u, v〉 = 0 for all u ∈ U
}
for a subspace U 6 Fmq is also inspired by the notation for
the Euclidian space.
61
Using the Kronecker delta δij =
{
1, if i = j
0, if i 6= j
we can
state the equivalence
A = (a1| . . . |am) ∈ O (m,Fq)
⇐⇒ 〈ai, aj〉 = δij for all 1 6 i, j 6 m
and we have the equation
〈Av,Aw〉 = (Av)T (Aw) = vTATAw = vTw = 〈v,w〉
for all v,w ∈ Fmq and all A ∈ O (m,Fq). If we have a
matrix A ∈ GL (m,Fq) with 〈Av,Aw〉 = 〈v,w〉 for all
v,w ∈ Fmq , then we have
vTATAw = (Av)T (Aw) = 〈Av,Aw〉 = 〈v,w〉 = vTw
for all v,w ∈ Fmq , i. e. ATA = Em and so A is an element
of O (m,Fq).
1.1 Related work
There has been done a lot of work on integral point sets in
Euclidean spaces, see e. g. [6, 11, 12, 14, 15]. Some authors
also consider other spaces, e. g. Banach spaces [5], integral
point sets over rings [10], or integral point sets over finite
fields [1, 4, 8, 13]. In [13] one of the authors of this article
determines the automorphism group for dimension m = 2
and in [8] integral point sets over F2q which are maximal
with respect to inclusion were classified for q 6 47. For
m = 2 and q ≡ 3 mod 4 the graphs Gm,q from Section
4 are isomorphic to Paley graphs of square order. In [3]
Blokhuis has determined the structure of cliques of maximal
size in Paley graphs of square order.
1.2 Our contribution
We determine the automorphism group of Fmq with respect
to integral distances and analyze the graphs of integral dis-
tances Gm,q for m > 3, 2 - q. They arise from 3-class
association schemes. The determination of some of their
parameters let us conjecture that they are strongly regular
for even dimensions m. We give some new exact numbers
I (Fq, 3) and upper bounds for the maximum cardinality of
integral point sets over F3q for dimension m = 3. For gen-
eral dimension n we give some constructions yielding lower
bounds.
1.3 Organization of the paper
After the short introduction and the basic notation in this
section we give the basic facts on integral point sets over
commutative rings in Section 2. In Section 3 we completely
determine the automorphism group of Fmq with respect to
integral distances and analyze its operation on Fmq . We in-
troduce and analyze the graphs of integral distances Gm,q
in Section 4. In Section 5 we consider the maximum cardi-
nality I (Fq,m) of integral point sets over Fmq . We finish
with a conclusion and an outlook in Section 6.
2 Integral point sets
From a more general point of view one can define integral
point sets over commutative rings with 1. If not stated oth-
erwise we assume that R is a commutative ring with 1 and
consider sets of elements of the R-module Rm. We speak
of these elements as points with a geometric interpretation
in mind. For our purpose we equip the module Rm with
something similar to an Euclidean metric:
Definition 2.1 For two points u = (u1, . . . , um), v =
(v1, . . . , vm) in Rm we define the squared distance as
d2(u, v) :=
m∑
i=1
(ui − vi)
2 ∈ R.
We are interested in those cases where d2(u, v) is con-
tained in the set R :=
{
r2 | r ∈ R
}
of squares of R.
Definition 2.2 Two points u = (u1, . . . , um), v =
(v1, . . . , vm) in Rm are at integral distance if there exists
an element r in R with d2(u, v) = r2. As a shorthand we
define ∆ : Rm × Rm → {0, 1},
(u, v) 7→
{
1 if u and v are at integral distance,
0 otherwise.
A set P of points in Rm is called an integral point set if all
pairs of points are at integral distance.
If R is a finite ring it makes sense to ask for the maximum
cardinality of an integral point set in Rm.
Definition 2.3 By I (R,m) we denote the maximum cardi-
nality of an integral point set in Rm.
Lemma 2.4
|R| 6 I (R,m) 6 |R|m .
PROOF. For the lower bound we consider the line P =
{(r, 0, . . . , 0) | r ∈ R}. 
Lemma 2.5 If R has characteristic 2, meaning that 1+1 =
0 holds, then we have I (R,m) = |R|m.
PROOF. For two points u = (u1, . . . , um), v =
(v1, . . . , vm) in Rm we have
d2(u, v) =
m∑
i=1
(ui − vi)
2
=
(
r∑
i=1
ui + vi
)
︸ ︷︷ ︸
∈R
2
.

So in the remaining part of this article we consider only
R = Fq where two does not divide q.
Also the lower bound of Lemma 2.4 is attained in some
cases, see e. g. [13] for a proof:
Theorem 2.6
I (Fq, 2) = q for 2 - q.
62
3 Automorphisms preserving integral
distances
As shorthand we useq := Fq . We need some facts about
roots in Fq and the set of solutions of quadratic equations in
Fq.
Definition 3.1 For q ≡ 1 mod 4 we denote by ωq an ele-
ment withω2q = −1.
Lemma 3.2 For a finite field Fq with q = pr and p 6= 2
we have −1 ∈ q iff q ≡ 1 mod 4, ωq ∈ q iff q ≡ 1
mod 8, and 2 ∈ q iff q ≡ ±1 mod 8.
PROOF. The multiplicative group of the units F∗q is cyclic of
order q− 1. Elements of order 4 are exactly those elements
x with x2 = −1. A similar argument holds for the the fourth
roots of −1. For the last statement we have to generalize
the second Ergänzungssatz of the quadratic reciprocity law
to Fq: If q = p is prime then the statement is true by the
second Ergänzungssatz. If 2 is a square in Fp then 2 is also
a square in Fpr and from p ≡ ±1 mod 8 we get q = pr ≡
±1 mod 8, i. e. the statement is true in this case. If 2 is
not a square in Fp then the polynomial x2 − 2 ∈ Fp[x]
is irreducible and 2 is a square in Fp[x]/
(
x2 − 2
)
∼= Fp2 .
Hence 2 is a square in Fpk iff 2 | k. As p is an odd prime
with p ≡ ±3 mod 8 we obtain p2 ≡ 1 mod 8 and also
p2m ≡ 1 mod 8 as well as p2m+1 ≡ ±3 in this case. 
Definition 3.3 A triple (a, b, c) is called Pythagorean triple
over Fq if a2 + b2 = c2.
In the following it will be useful to have a parametric rep-
resentation of the Pythagorean triples over Fq.
Lemma 3.4 For 2 - q let c ∈ Fq and let Pc be the set of
Pythagorean triples (a, b, c) over Fq.
(a) If c = 0 then
P0 =
{
{(t,±tωq, 0) | t ∈ Fq} if q ≡ 1 mod 4
{(0, 0, 0)} if q ≡ 3 mod 4
and
|P0| =
{
2q− 1 if q ≡ 1 mod 4
1 if q ≡ 3 mod 4.
(b) If c 6= 0 then
Pc = {(±c, 0, c)} ∪ {(0,±c, c)}∪{(
t2−1
t2+1
· c, 2t
t2+1
· c, c
)
| t ∈ F∗q, t2 6= ±1
}
and
|Pc| =
{
q− 1 if q ≡ 1 mod 4
q+ 1 if q ≡ 3 mod 4.
(c) There are exactly q2 Pythagorean Triples over Fq.
PROOF. Part (a) is easy to verify. For part (b) there are 4
solutions with ab = 0, these are {(0,±c, c), (±c, 0, c)}. For
ab 6= 0 we get:
a2 + b2 = c2 ⇔ c− a
b
· c+ a
b
= 1.
Setting t := c+ab ∈ F
∗
q we obtain t
−1 = c−ab , hence
a
b
=
t− t−1
2
and
c
b
=
t+ t−1
2
.
Because of a 6= 0, c 6= 0 we have t 6= ±t−1, i. e. t2 /∈
{−1, 1}. It follows
a =
t− t−1
t+ t−1
· c and b = 2
t+ t−1
· c.
It is easily checked that for all admissible values of t, the
resulting triples (a, b, c) are pairwise different Pythagorean
triples.
The expression for the number of solutions follows be-
cause −1 is a square in Fq exactly if q ≡ 1 mod 4.
With part (a) and part (b) we get the number of
Pythagorean triples over Fq as∑
c∈Fq
|Pc| = |P0| + (q− 1)|P1| = q
2
So also part (c) is shown. 
From this lemma we can deduce the following corollary.
Corollary 3.5 If Qc :=
{
(a, b) | a2 + b2 = c
}
then we
have
|Q0| =
{
2q− 1 if q ≡ 1 mod 4
1 if q ≡ 3 mod 4
and
|Qc| =
{
q− 1 if q ≡ 1 mod 4
q+ 1 if q ≡ 3 mod 4
for c 6= 0.
PROOF. For c ∈ q (this includes c = 0) the formulas were
proven in Lemma 3.4. So let c ∈ Fq be a non-square. As
the squares q\{0} form a subgroup of F∗q, the non-squares
have the form c ·d2 with d2 ∈ q\{0}. If a2+b2 = c then
(ad)2 + (bd)2 = cd2. Therefore the number of solutions
(a, b) is the same for all non-squares and we can determine
the number of solutions by counting: There are q2 pairs
(a, b) ∈ Fq×Fq. As there are q−12 squares and non-squares
in F∗q we obtain
q− 1
2
|Qc| = q
2 − (2q− 1) −
q− 1
2
· (q− 1)
=
1
2
(q− 1)2
for q ≡ 1 mod 4 and
q− 1
2
|Qc| = q
2 − 1−
q− 1
2
· (q+ 1)
=
1
2
(q− 1)(q+ 1)
for q ≡ 3 mod 4, which gives our statement. 
63
Since later on we want to study the automorphism group
of Fmq with respect to ∆ we have to define what we consider
as an automorphism.
Definition 3.6 An automorphism of Fmq with respect to ∆ is
a bijective mapping ϕ ∈ AΓL(Fq,m) with
∆ (u1, . . . , um, v1, . . . , vm)
= ∆ (ϕ (u1, . . . , um) , ϕ (v1, . . . , vm))
for all (u1, . . . , um) , (v1, . . . , vm) ∈ Fmq . The group
of automorphisms with respect to ∆ is denoted by
Aut
(
Fmq , ∆
)
.
In other words this definition says thatϕ has to map affine
subspaces, like points, lines, or hyperplanes, to subspaces
with equal dimension, and has to preserve the integral dis-
tance property.
Lemma 3.7 We have the following examples of automor-
phisms:
1. ϕ(a1,...,am) (x1, . . . , xm) =
(x1 + a1, . . . , xm + am) for (a1, . . . , am) ∈ Fmq ,
2. ϕ̃λ (x1, . . . , xm) = (λx1, . . . , λxm) for λ ∈ F∗q,
3. ϕ̃A (x1, . . . , xm) = A · (x1, . . . , xm)T for A ∈
O (m,Fq), and
4. ϕ̂j (x1, . . . , xm) =
(
x
pj
1 , . . . , x
pj
m
)
for j ∈ N and p
being the characteristic of Fq.
PROOF. The first two cases are easy to check. For the third
case we consider d2(Au,Av)
= 〈A(u− v), A(u− v)〉 = (u− v)TATA(u− v)
= (u− v)T (u− v) = 〈u− v, u− v〉 = d2(u, v)
and for the fourth case we have
d2 (ϕ̂j(0, . . . , 0), ϕ̂j (x1, . . . , xm))
=
m∑
i=1
(
x
pj
i
)2
=
m∑
i=1
(
x2i
)pj
=
(
m∑
i=1
x2i
)pj
= d2 (0, . . . , 0, x1, . . . , xm)
pj

We would like to remark the orders of the groups
O (m,Fq), GL (m,Fq), and 〈O (m,Fq) , Z〉:
(1) |GL (m,Fq)| =
m−1∏
i=0
(
qm − qi
)
for allm ∈ N.
(2) |O (2n+ 1,Fq)| = 2qn ·
n−1∏
i=0
(
q2n − q2i
)
for n ∈ N.
(3) |O (2n,Fq)| = 2 (qn − 1) ·
n−1∏
i=1
(
q2n − q2i
)
for
n ∈ N and −1 ∈ q.
(4) |O (2n,Fq)| = 2
(
qn + (−1)n+1
)
·
n−1∏
i=1
(
q2n − q2i
)
for n ∈ N and −1 /∈ q.
(5) |〈O (m,Fq) , Z〉| = q−12 · |O (m,Fq)| for all m ∈
N\{1}.
For dimensionm = 3 we have |O (3,Fq)| = 2(q−1)q(q+
1), |GL (3,Fq)| = q3(q − 1)3(q + 1)
(
q2 + q+ 1
)
, and
|〈O (3,Fq) , Z〉| = (q− 1)2q(q+ 1).
Since the Frobenius homomorphisms and the translations
are automorphisms with respect to ∆ it suffices to determine
the matrix group Aut
(
Fmq , ∆
)
∩ GL (m,Fq) of all matri-
ces which are automorphisms with respect to ∆ in order to
determine the whole automorphism group. Due to Lemma
3.7 we have 〈O (m,Fq) , Z〉 6 Aut
(
Fmq , ∆
)
∩GL (m,Fq).
Thus for dimension m = 3 we have (q − 1)2q(q +
1) |
∣∣Aut (F3q, ∆) ∩GL (3,Fq)∣∣. We will prove later on
that 〈O (3,Fq) , Z〉 already is isomorphic to Aut
(
F3q, ∆
)
∩
GL (3,Fq).
At first we summarize our knowledge on Aut
(
Fmq , ∆
)
:
Theorem 3.8 We have
(1) Aut
(
Fmq , ∆
)
= AΓL (m,Fq) for 2 | q,
(2) Aut
(
F1q, ∆
)
= AΓL (1,Fq),
(3) Aut
(
F2q, ∆
)
∩ GL (2,Fq) = 〈O (2,Fq) , Z〉 for 2 - q,
q /∈ {5, 9},
(4) Aut
(
F25, ∆
)
∩GL (2,F5) > 〈O (2,F5) , Z〉,
|Aut(F25,∆)∩GL(2,F5)|
|〈O(2,F5),Z〉| = 2, and
(5) Aut
(
F29, ∆
)
∩GL (2,F9) > 〈O (2,F9) , Z〉,
|Aut(F29,∆)∩GL(2,F9)|
|〈O(2,F9),Z〉| = 3.
PROOF. (1) and (2) hold since for m = 1 or 2 | q all
distances are integral. So in general we assume dimension
m > 2 and odd characteristic 2 - q if not stated otherwise in
the rest of this article. For the proof of (3), (4), and (5) we
refer to [13]. 
Next we prove some results on the orbits of Fmq under
the groups O (m,Fq) and 〈O (m,Fq) , Z)〉. Therefore we
need:
Definition 3.9 By Pk
(
Fmq
)
we denote the set{
v ∈ Fmq \{0} | d2(0, v) = k
}
. Whenever q and m are
clear from the context we use Pk instead of Pk
(
Fmq
)
.
Lemma 3.10 For every k ∈ Fq\{0} the group O (2,Fq)
acts transitively on Pk.
PROOF. Let (a, b) and (c, d) be two points in F2q with a2+
b2 = c2 + d2 6= 0. With x = ac+bd
a2+b2
and y = bc−ad
a2+b2
we
have x2 + y2 = (
a2+b2)·(c2+d2)
(a2+b2)
2 = 1. Thus the matrix
A =
(
x y
−y x
)
is an element of O (2,Fq) which maps
(a, b) to (c, d). 
64
Lemma 3.11 The group O (2,Fq) acts transitively on P0.
PROOF. If −1 /∈ q then we have |P0| = 0. Thus we may
assume −1 ∈ q. For a, b ∈ Fq with a2+b2 = 0 we have
either a = b = 0 or a, b 6= 0. In the latter case we have(
a
b
)2
= −1, which has two solutions ab = ω and
a
b = −ω,
where ω is a root of −1. Thus we can write all elements of
P0 as
(
z ±zω
)T with z ∈ F∗q. Now we apply all matrices
of the form M :=
(
x y
−y x
)
with x2 + y2 = 1 to the
vector
(
1 ω
)T . By definition these matrices are elements
ofO (2,Fq). If we parametrize x and y as in Lemma 3.4 we
getM
(
1 ω
)T
=
(
z zω
)T , where z = t−t−1
t+t−1
+ 2
t+t−1
·
ω. By a small computation we check that
f : Fq\{0,ω,−ω}→ F\{−1, 0, 1},
t 7→ t− t
−1
t+ t−1
+
2
t+ t−1
·ω
is well defined and injective. Thus all points
(
z zω
)T are
in the same orbit as
(
1 ω
)T under the action ofO (2,Fq).
Since
(
−1 0
0 1
)
∈ O (2,Fq), the points
(
z −zω
)T are
also contained in this orbit and the proposed statement
holds. 
Lemma 3.12 The group O (3,Fq) acts transitively on P0.
PROOF. See e. g. [17, Theorem 11.6] for a proof. 
Lemma 3.13 For each v1 := (x1, y1, z1) ∈ F3q with
x21 + y
2
1 + z
2
1 = 1 there exist v2 := (x2, y2, z2), v3 :=
(x3, y3, z3) ∈ F3q fulfilling x2i + y2i + z2i = 1 for i = 2, 3,
such that 〈vi, vj〉 = 0 for i 6= j and i, j = 1, 2, 3.
PROOF. The set 〈v1〉⊥ of vectors v solving the linear equa-
tion 〈v, v1〉 = 0 forms a 2-dimensional vector space. Let
w ∈ 〈v1〉⊥ be an arbitrary element with w 6= 0. Then
〈w〉⊥ is also a 2-dimensional vector space and certainly
v1 ∈ 〈w〉⊥. Thus we get 〈w〉⊥ 6= 〈v1〉⊥. Therefore the or-
thogonal vector space 〈v1〉⊥ is non-degenerate in the sense
of [7, II.10.1]. By [7, II.10.2 b)] there is an orthogonal ba-
sis {w2, w3} of 〈v1〉⊥, i. e. we have 〈w2, w3〉 = 0 and
〈wi, wi〉 6= 0 for i = 2, 3. For λ, µ ∈ Fq we obtain
〈λw2 + µw3, λw2 + µw3〉 = λ2 〈w2, w2〉+µ2 〈w3, w3〉 .
As 〈w2, w2〉 , 〈w3, w3〉 ∈ F∗q there exist λ, µ ∈ Fq such
that
〈λw2 + µw3, λw2 + µw3〉 = 1
by [17, Lemma 11.1]. Therefore there is a vector v2 ∈ F3q
such that 〈v1, v2〉 = 0 and 〈v2, v2〉 = 1. Now v3 can easily
be constructed: The cross product v3 := v1 × v2 is a vector
with 〈v1, v3〉 = 〈v2, v3〉 = 0 and
〈v3, v3〉 = 〈v1, v1〉 · 〈v2, v2〉− 〈v1, v2〉2 = 1.

From the previous lemma we can easily deduce:
Lemma 3.14 The group O (3,Fq) acts transitively on Pk
for all k ∈ q.
PROOF. Due to Lemma 3.12 we only have to consider the
case k 6= 0. Let v ∈ F3q such that 〈v, v〉 = a2 6= 0. We put
v1 := a
−1v. Then 〈v1, v1〉 = 1 and by Lemma 3.13 there
exist v2, v3 ∈ F3q such that A = (v1|v2|v3) is an orthogonal
matrix. Thus the vectors (1, 0, 0) and v1 are in the same
orbit of O (3,Fq). Thus all v with 〈v, v〉 = a2 6= 0 and the
vectors (±a, 0, 0) are in the same orbit. 
Lemma 3.15 The group O (3,Fq) acts transitively on Pk
for all k /∈ q.
PROOF. Let v = (v1, v2, v3) ∈ Pk be a arbitrary vec-
tor. We show that there exists an element A ∈ O (3,Fq)
such that the third coordinate of Av equals zero. This
reduces the problem to the 2-dimensional case where we
can apply Lemma 3.10 or Lemma 3.11, as we can ex-
tend a 2-dimensional Matrix A ′ ∈ O (2,Fq) to a matrix
A ∈ O (3,Fq) by adding a third row and a third column
consisting of a one in the diagonal and zeros elsewhere.
If v22 + v
2
3 = l
2 6= 0 then due to Lemma 3.10 there exists
an element A ′ ∈ O (2,Fq) which maps (v2, v3) to (l, 0).
Thus we can extend A ′ to a desired matrix A ∈ O (3,Fq)
such that the third coordinate of Av equals zero. Since v21 +
v22 + v
2
3 /∈ q we can not have v2i + v2j = 0 for i 6= j. So
we can assume v2i + v
2
j /∈ q for i 6= j.
For the remaining cases we use another technique. We set
Pf,k :=
{
(v1, v2, v3) ∈ F3q\{0} | v1 = f, v21+v22+v23 = k
}
.
By Lemma 3.10 all points of Pf,k are contained in the
same orbit under O (3,Fq). From Corollary 3.5 we deduce
|Pf,k| = q − 1 for q ≡ 1 mod 4 and |Pf,k| = q + 1 for
q ≡ 3 mod 4. Hence we have
|Pk| =
∑
f∈Fp
|Pf,k| = q · |P0,k| .
Now let us consider an arbitrary point v = (v1, v2, v3) ∈
Pf,k and set l = v21 + v
2
2. Since v
2
1 + v
2
2 + v
2
3 = k /∈ q we
have l 6= 0. Due to Lemma 3.10 all points (u1, u2, v3) with
u21 + u
2
2 = l lie in the same orbit as v under O (3,Fq).
Due to Corollary 3.5 we have at least q+12 solutions u1 of
the equation u21+u
2
2 = l for q ≡ 3 mod 4. This means that
every point in Pk lies in an orbit with at least q+12 ·|Pu1,k| =
(q+1)2
2 >
|Pk|
2 =
q(q+1)
2 points. Thus there can only be
one orbit.
For q ≡ 1 mod 4 we similarly conclude that every point
in Pk lies in an orbit with at least
(q−1)2
2 points. Since
|Pk| = (q − 1)q and |Pf,k| = q − 1 for all f ∈ Fp there
can exist at most two orbits and the length of every orbit has
to be divisible by |Pf,k| = q − 1. If there exist exactly two
orbits B1, B2 then we have w.l.o.g. |B1| = q−12 ·(q−1) and
|B2| =
q+1
2 ·(q−1). Due to |B1|
∣∣∣ |O (3,Fq)| we have (q−
65
1)2 | 4·(q−1)q(q+1). Using gcd(q−1, q) = 1we conclude
q−1 | 4(q+1). Thus we have q−1 | 8, which is equivalent to
q ∈ {3, 5, 9}. As 3 6≡ 1 mod 4 we only have to consider the
cases q = 9 and q = 5. In F9 ' F3[x]/
(
x2 + 1
)
we have
9 = {0, 1, 2, x, 2x}. Since we have either vi = 0 for some
i or |{v1, v2, v3} ∩ {1, 2}| > 2 or |{v1, v2, v3} ∩ {x, 2x}| > 2
there exist i, j with v2i + v
2
j ∈ 9 in this case and we can
apply our reduction to the 2-dimensional case.
For q = 5, k = 2 we have
B1 =
{
(v1, v2, v3) | v1, v2, v3 ∈ {2, 3}
}
,
B2 =
{
(0, v1, v2) , (v1, 0, v2) , (v1, v2, 0) | v1, v2 ∈ {1, 4}
}
,
and for q = 5, k = 3 we have
B1 =
{
(v1, v2, v3) | v1, v2, v3 ∈ {1, 4}
}
,
B2 =
{
(0, v1, v2) , (v1, 0, v2) (v1, v2, 0) | v1, v2 ∈ {2, 3}
}
.
By considering the matrixM1 =
1 2 42 1 4
1 1 3
 in O (3,Fq)
we conclude that in both cases B1 and B2 are contained in
the same orbit. 
Lemma 3.16 For dimension m > 4 and v =
(v1, . . . , vm) ∈ Fmq there exists an element A ∈ O (m,Fq)
such that them-th coordinate of Av equals zero.
PROOF. If one of the vi equals zero then there clearly exists
such a matrix A. So we assume vi 6= 0 for 1 6 i 6 m.
If v2h+v
2
i +v
2
j = 0 for all pairwise different 1 6 h, i, j 6
m then we would have v = 0 or 3 | q: As m > 4, there
is at least one further index k. If we replace vh by vk then
v2k + v
2
i + v
2
j = 0 and v
2
h + v
2
i + v
2
j = 0 give v
2
h = v
2
k.
Replacing vi and vj by vk leads to v2h = v
2
i = v
2
j = v
2
k, so
we obtain 3v2i = 0 and thus v = 0 if 3 - q.
For 3 | q the same computation leads to vi = ±vj for all
i, j. W. l. o. g. let v1 = 1. Then we have v2i + v
2
j = 2 for
all i, j > 1. By Lemma 3.10 the group O (2,Fq) acts tran-
sitively on P2. As we can extend 2-dimensional orthogonal
matrices by ones in the diagonal we can assume vi = 1 for
1 6 i 6 m. As the matrix
A =

1 1 1 1
1 1 2 2
1 2 1 2
1 2 2 1
 ∈ O (4,Fq)
maps
(
1 1 1 1
)T to (1 0 0 0)T , we can extend A
to a matrix in O (m,Fq) such that Av has a zero at coordi-
natem.
So we may assume 0 6= v2m−2 + v2m−1 + v2m =: k. Since
there exist a, b ∈ Fq with a2+b2 = k 6= 0 by [17, Lemma
11.1] we can apply Lemma 3.14 and Lemma 3.15 to deduce
that there exists an element A ′ ∈ O (3,Fq) which maps
(vm−2, vm−1, vm) onto (a, b, 0). Clearly we can extend
A ′ to obtain the desired matrix A ∈ O (m,Fq) mapping v
onto a point withm-th coordinate being equal to zero. 
Lemma 3.17 For dimension m > 2 the group O (m,Fq)
acts transitively on Pk for all k ∈ Fq.
PROOF. We prove the Lemma by induction and utilize lem-
mas 3.10, 3.11, 3.12, 3.14, and 3.15 as induction basis.
Now let u, v ∈ Pk be arbitrary. Due to Lemma 3.16 there
exist A1, A2 ∈ O (m,Fk) such that the m-th coordinate
of u ′ = A1u and the m-th coordinate of v ′ = A2v are
both equal to zero. Deleting the last coordinate from u ′
and v ′ gives two vectors ũ and ṽ in Pk
(
Fm−1q
)
, respec-
tively. Due to our induction hypothesis there exists an ele-
ment Ã3 ∈ O (m− 1,Fq) with Ã3ũ = ṽ. Clearly we can
extend Ã3 to a matrix A3 ∈ O (m,Fq) with A3u ′ = v ′.
WithA = A−12 A3A1 we haveA ∈ O (m,Fq) andAu = v.

Definition 3.18 We set
P+ :=
⋃
k∈q\{0}
Pk and P− :=
⋃
k/∈q
Pk.
Lemma 3.19 For 2 - q and m > 2 the orbits of Fmq under
the group 〈O (m,Fq) , Z〉 are P+, P0, and P−.
PROOF. From the previous lemmas we know thatO (m,Fq)
acts transitively on Pk for 2 - q, m > 2, and k ∈ Fq. Thus
〈O (m,Fq) , Z〉 acts transitively on P+, P0, and P−. (For
every element B ∈ 〈O (m,Fq) , Z〉 there exists an element
k ∈ F∗q so that we have 〈Bv, Bv〉 = k2〈v, v〉 for all v ∈ Fmq .)

Lemma 3.20 Let v = (v1, v2, v3), w = (w1, w2, w3) ∈
F3q with v,w 6= 0. If 〈v, v〉 = 〈v,w〉 = 0 and 〈v〉 6= 〈w〉
then we have 〈w,w〉 ∈ q if q ≡ 1 mod 4 and 〈w,w〉 /∈
q if q ≡ 3 mod 4.
PROOF. If the vi are non-zero we can assume w.l.o.g. that
v3 = 1. From 〈v,w〉 = 0 we conclude w3 = −w1v1 −
w2v2. Using v21 + v
2
2 + 1 = 0 this gives
〈w,w〉 = w21 +w22 +w21v21 +w22v22 + 2w1w2v1v2
= −v22w
2
1 − v
2
1w
2
2 + 2w1w2v1v2
= −(v2w1 − v1w2)
2
.
Since −1 /∈ q iff q ≡ 3 mod 4 by Lemma 3.2 we have
〈w,w〉 /∈ q\{0} for q ≡ 3 mod 4 and
〈w,w〉 ∈ q for q ≡ 1 mod 4
in this case.
Let us assume q ≡ 3 mod 4 and 〈w,w〉 = 0 for a
moment. Since −1 /∈ q we have v1, v2 6= 0 using
v21 + v
2
2 + 1 = 0. Thus we have w1 = w2
v1
v2
. Inserting
yields w =
(
w2
v1
v2
, w2,−w2
v1
v2
· v1 −w2v2
)
= w2v2 · v.
Since v,w 6= 0 we would have 〈w〉 = 〈v〉. Thus we even
have 〈w,w〉 /∈ q for q ≡ 3 mod 4.
In the remaining case we assume w.l.o.g. v3 = 0. Since
v21+v
2
2 = 0we have −1 ∈ q, q ≡ 1 mod 4, and v1, v2 6=
0. We can further assume w.l.o.g. v1 = 1 and v2 = ωq,
where ω2q = −1. With this 〈v,w〉 = 0 is equivalent to
w2 = ωqw1. Thus we have 〈w,w〉 = w23 ∈ q. 
66
Lemma 3.21 For 2 - q and m > 3 the orbits of Fmq under
the group Aut
(
Fmq , ∆
)
∩GL (m,Fq) are P+, P0, and P−.
PROOF. Since 〈O (m,Fq) , Z〉 6 Aut
(
Fmq , ∆
)
∩
GL (m,Fq) and due to Lemma 3.19 it may only happen that
some elements of P+, P0, and P− are contained in the same
orbit. Due to Definition 3.6 and Definition 2.2 P− forms its
own orbit. Thus only P+ and P0 may be contained in the
same orbit. Now we show that this is not the case.
In Section 4 we introduce the graph Gm,q of integral dis-
tances corresponding to Fmq and its integral distances. Due
to Lemma 4.5 for dimension m = 3 and 2 - q the graph
G3,q is not strongly regular. Thus P+ and P0 are disjoint
orbits.
For m > 4 let us assume that there exists an element
v in Fmq with 〈v, v〉 = 0 and there exists a matrix A
in
(
Aut
(
Fmq , ∆
)
∩ GL (m,Fq)
)
with
〈
A−1v,A−1v
〉
∈
q\{0}. W.l.o.g. we assume A−1v = e1, where ei is a
vector consisting of zeros and a single one at coordinate i,
this is the i-th unit vector. So we have Ae1 = v and we
set wi := Aei, µi := 〈v,wi〉 for 2 6 i 6 4. Now we
show that there exists a vector v ′ ∈ Fmq with 〈e1, v ′〉 = 0,
〈v ′, v ′〉 6= 0, and 〈Ae1, Av ′〉 = 0. If there exists 2 6 i 6 4
with µi = 0 then we may choose v ′ = ei. Otherwise we
have µ2, µ3, µ4 6= 0. We remark that
(
µi
µj
)2
= −1 is
equivalent to
(
µj
µi
)2
= −1 for all 2 6 i, j 6 4. Due to(
µ1
µ2
)2
·
(
µ2
µ3
)2
·
(
µ3
µ1
)2
= 1 6= −1 there exist i and j with
i 6= j,
(
µi
µj
)2
6= −1. We set v ′ := −µjei + µiej which
yields
〈e1, v ′〉 = 0,
〈v ′, v ′〉 = µ2i + µ2j 6= 0, and
〈Ae1, Av ′〉 = 〈v,−µjwi + µiwj〉
= −µj 〈v,wi〉+ µi 〈v,wj〉
= 0.
Let χ be the characteristic function of q, this is χ(x) =
1 for x ∈ q and χ(x) = 0 for x /∈ q. We set k :=
〈v ′, v ′〉 6= 0 and l := 〈Av ′, Av ′〉. For all λ1, λ2 ∈ Fq we
have
d2 (0, λ1e1 + λ2v
′) = 〈λ1e1 + λ2v ′, λ1e1 + λ2v ′〉
= λ21 + k · λ22 and
d2 (0,A (λ1e1 + λ2v
′)) = 〈λ1v+ λ2Av ′, λ1v+ λ2Av ′〉
= l · λ22.
Since A ∈
(
Aut
(
Fmq , ∆
)
∩ GL (m,Fq)
)
we have
χ
(
λ21 + k · λ22
)
= χ
(
l · λ22
)
for all λ1, λ2 in Fq. Insert-
ing λ2 = 1 yields χ(l) = χ
(
λ21 + k
)
for all λ1 ∈ Fq.
Due to
∣∣∣{λ21 + k | λ1 ∈ Fq} ∣∣∣ = q+12 we conclude χ(l) =
χ
(
λ21 + k
)
= 1. W.l.o.g. we may assume k = 1 ∈ q\{0}.
Thus for q = pr and x ∈ q we have
1 = χ(x) = χ(x+ 1) = χ((x+ 1) + 1)
= χ((x+ 2) + 1) = · · · = χ((x+ p− 2) + 1).
We conclude p
∣∣∣ |q| = q+12 = pr+12 , which is a contra-
diction. 
Theorem 3.22
Aut
(
F3q, ∆
)
∩GL (3,Fq) = 〈O (3,Fq) , Z〉 for 2 - q.
PROOF. Let A ∈ Aut(F3q, ∆) ∩ GL (3,Fq) be an automor-
phism. The idea of the proof is, to use the fact that A takes
every vector v of integral norm 〈v, v〉 6= 0 to another vec-
tor of integral norm 6= 0 with the aim to construct an auto-
morphism in Aut
(
F2q, ∆
)
. Using the classification of the 2-
dimensional automorphisms in Theorem 3.8, see also [13],
we conclude A ∈ 〈O (3,Fq) , Z〉.
Clearly, A is uniquely defined by its images of e1 =(
1 0 0
)T , e2 = (0 1 0)T , and e3 = (0 0 1)T .
Due to Lemma 3.19 and Lemma 3.21 we can assume A ·
e1 = e1. We set A · e2 =:
(
a b c
)T , where we have
a2 + b2 + c2 = d2 ∈ q\{0}
due to Lemma 3.21. Let χ : Fq → {0, 1}, where χ(x) = 1 iff
x ∈ q, be the characteristic function of q. By applying
A on
(
x y 0
)T we obtain
χ
(
x2 + y2
)
= χ
(
x2 + 2axy+ d2y2
)
for all x, y ∈ Fq.
(1)
Inserting x = −2a, y = 1 yields χ
(
4a2 + 1
)
= χ
(
d2
)
=
1. Now we prove χ
(
a2 + 1
)
= 1. Putting x = 2na, y = 1
for an arbitrary n ∈ Fq in Equation (1) we obtain
χ
(
4n2a2 + 1
)
= χ
((
4n2 + 4n
)
a2 + d2
)
.
Inserting x = −2(n+ 1)a, y = 1 yields
χ
(
4(n+ 1)2a2 + 1
)
= χ
((
4n2 + 4n
)
a2 + d2
)
,
hence we get
χ
(
(2n)2a2 + 1
)
= χ
(
(2n+ 2)2a2 + 1
)
for all n ∈ Fq. For n = 1 we have χ
(
4a2 + 1
)
= 1,
therefore we obtain χ
(
(2n)2a2 + 1
)
= 1 for all n ∈ Fp
(but not necessarily for all n ∈ Fq). As we have p 6= 2, we
can take n = 2−1 ∈ Fp and get χ
(
a2 + 1
)
= 1.
If we insert x = −a, y = 1 in Equation (1) we obtain
1 = χ
(
a2 + 1
)
= χ
(
x2 + y2
)
= χ
(
x2 + 2axy+ d2y2
)
= χ
(
d2 − a2
)
.
Thus there exists an e ∈ Fq with a2 + e2 = d2. Let
us consider the matrix M =
(
1 a
0 e
)
. Since we have
χ
(
x2 + y2
)
= χ
(
x2 + 2axy +
(
a2 + e2
)
y2
)
for all
x, y ∈ Fq the matrix M is an automorphism for F2q with
respect to ∆.
For q 6= {5, 9} we can apply Theorem 3.8.(3) and con-
clude a = 0, b2 + c2 = e2 = d2 = 1. Now we set
67
A · e3 =:
(
ã b̃ c̃
)T
and similarly conclude ã = 0,
b̃2 + c̃2 = 1. Therefore A has the form
A =
1 0 00 b b̃
0 c c̃
 =:
 1 0 00
0
A ′
 .
By applying A on all vectors
(
0 y z
)
for y, z ∈ Fq we
see that A ′ is an element of Aut
(
F2q, ∆
)
∩GL (2,Fq). Due
to Theorem 3.8.(3) the matrix A ′ is orthogonal and we con-
clude A ∈ O (3,Fq).
We deal with the missing cases q ∈ {5, 9} using the
the classification of the 2-dimensional automorphism group
Aut
(
F2q, ∆
)
as follows. Either we utilize the precise classifi-
cation in [13] or we utilize an exhaustive enumeration of the
elements in GL (2,Fq) to conclude a = 0, b2 + c2 = e2 =
d2 = 1 for q = 5 and a = 0, b2 + c2 = e2 = d2 ∈ {±1}
for q = 9. Now we set A · e3 =:
(
ã b̃ c̃
)T
and similarly
conclude ã = 0, b̃2+ c̃2 = 1 for q = 5 and b̃2+ c̃2 ∈ {±1}
for q = 9. Therefore A has the form
A =
1 0 00 b b̃
0 c c̃
 =:
 1 0 00
0
A ′
 .
Additionally we have 〈Ae2, Ae3〉 = 0 in both cases, where
we refer to [13] or an exhaustive enumeration. Next we ex-
clude the case b2 + c2 = −1 for q = 9. We use F9 '
F3[t]/
(
t2 + 1
)
and assume the contrary b2 + c2 = −1.
Since A is an automorphism of F39 with respect to ∆ we
have
χ
(
x2 + y2 + z2
)
= χ
(
x2 +
(
by+ b̃z
)2
+ (cy+ c̃z)
2
)
= χ
(
x2 +
(
b2 + c2
)
y2 +
(
b̃2 + c̃2
)
z2
)
for all x, y, z ∈ F9. Inserting insert x = 1, y = 1, and
z = t+ 2 yields
χ
(
x2 + y2 + z2
)
= χ
(
2+ t2 + 4t+ 4
)
= χ (t+ 2) = 0
and
χ
(
x2 +
(
b2 + c2
)
y2 +
(
b̃2 + c̃2
)
z2
)
= χ
( (
b̃2 + c̃2
)
z2
)
= 1,
a contradiction. Thus due to symmetry we have b2 + c2 =
b̃2 + c̃2 = 1 and A ∈ O
(
3,F3q
)
in both cases. 
Remark 3.23 Rotations in 3-space can be modeled using
quaternions. We consider unit quaternions a+bi+ cj+dk
with a2 + b2 + c2 + d2 6= 0. The corresponding rotation
can be written as a rightmultiplication with the 3×3-matrix
M =a2 + b2 − c2 −d2 2bc− 2ad 2ac+ 2bd2ad+ 2bc a2 − b2 + c2 −d2 2cd− 2ab
2bd− 2ac 2ab+ 2cd a2 − b2 − c2 +d2
 .
We have
∥∥(x y z) ·M∥∥ = ∥∥(x y z) ·Mt∥∥ =(
x2 + y2 + z2
) (
a2 + b2 + c2 + d2
)2 for these matrices.
Thus they all correspond to automorphisms with respect to
∆. Unfortunately this set is only isomorphic to a proper sub-
set of 〈O (3,Fq) , Z〉 and does not form a group.
Theorem 3.24 For dimension m > 3 and 2 - q we have
Aut
(
Fmq , ∆
)
∩GL (m,Fq) = 〈O (m,Fq) , Z〉.
PROOF. We prove the theorem by induction on the dimen-
sion m. For the induction basis we refer to Theorem 3.22.
Now let m > 4 and A ∈ Aut
(
Fmq , ∆
)
∩ GL (m,Fq) be
an automorphism. Due to Lemma 3.19 and Lemma 3.21
we can assume A · e1 = e1. For 2 6 i 6 m we set
A · ei =:
(
v1,i . . . vm,i
)T , where we have
m∑
j=1
v2j,i = d
2
i ∈ q\{0}.
Using a similar calculation as in the proof of Theorem 3.22
we obtain v1,i = 0 and
m∑
j=1
v2j,i = 1 for all 2 6 i 6 m.
Therefore A has the form
A =

1 0 0 . . .
0 v1,2 v1,3 . . .
0 v2,2 v2,3 . . .
...
...
...
. . .
 =:
 1 0 . . .0
... A
′
 .
Since A is an automorphism of Fmq with respect to ∆ the
matrix A ′ is an automorphism of Fm−1q with respect to ∆.
Due to
m∑
j=1
v2j,i = 1 for all 2 6 i 6 m and the induction
hypothesis we have A ′ ∈ O (m− 1,Fq). Thus we have
A ∈ O (m,Fq). 
4 Graph of integral distances
It turns out that it is usefull to model integral point sets as
cliques of certain graphs. For a given prime power q = pr
and a given dimension m we define a graph Gm,q with
vertex set Fmq , where two vertices v and w are adjacent if
d2(v,w) ∈ q. In this section we want to study the prop-
erties of Gm,q. A motivation for this study is that the graph
G2,q for dimension m = 2 is a strongly regular graph. A
graph is strongly regular, if there exist positive integers k, λ,
and µ such that every vertex has k neighbors, every adjacent
pair of vertices has λ common neighbors, and every nonad-
jacent pair has µ common neighbors, see e. g. [19]. If we
denote the number of vertices by v, our graph G2,q has the
parameters (v, k, λ, µ) =(
q2,
q2 + 2q− 3
2
,
q2 + 4q− 9
4
,
q2 + 4q+ 3
4
)
for q ≡ 1 mod 4 and the parameters (v, k, λ, µ) =(
q2,
q2 − 1
2
,
q2 − 5
4
,
q2 − 1
4
)
for q ≡ 3 mod 4. See e. g. [8] for this fact, which is easy
to prove.
For 2|q or m = 1 the graph of integral distances Gm,q
is equivalent to a complete graph on qm vertices. Thus we
assume 2 - q andm > 3 in the following.
68
Since the translations of Fmq are automorphisms with re-
spect to ∆ acting transitively on the points we know that G
is a regular graph, which means that every vertex u has an
equal number, called the degree of u, of neighbors. Thus we
can speak of a degree of Gm,q.
Lemma 4.1 The degree of G3,q is given by
∆ (G3,q) =
{
(q− 1) · (q+2)(q+1)2 if q ≡ 1 mod 4,
(q− 1) · q
2+q+2
2 if q ≡ 3 mod 4.
PROOF. It suffices to determine the number of vectors
(a, b, c) 6= (0, 0, 0) fulfilling a2 + b2 + c2 ∈ q. So let
a2+b2+ c2 = d2. If d = 0 then we have a2+b2 = −c2.
Using Corollary 3.5 we obtain q2 − 1 solutions in this case.
For d 6= 0 we have q−12 possible values for d
2. Using
Corollary 3.5 we obtain the number of solutions (a, b) of
the equation a2 + b2 = d2 − c2 for all possible values of c
and d. Summing up everything gives the stated formula. 
To determine the degree∆ (Gm,q) of the graph of integral
distances Gm,q in arbitrary dimension we define the three
functions
Sm(q) :=
∣∣∣∣∣
{
(a1, . . . , am) ∈ Fmq
∣∣∣ m∑
i=1
a2i ∈ q\{0}
}∣∣∣∣∣ ,
Zm(q) :=
∣∣∣∣∣
{
(a1, . . . , am) ∈ Fmq
∣∣∣ m∑
i=1
a2i = 0
}∣∣∣∣∣ , and
Nm(q) :=
∣∣∣∣∣
{
(a1, . . . , am) ∈ Fmq
∣∣∣ m∑
i=1
a2i /∈ q
}∣∣∣∣∣ .
The first few functions are given by
S1(q) = q− 1,
Z1(q) = 1,
N1(q) = 0,
S2(q) =
(q−1)2
2 if q ≡ 1 mod 4,
q2−1
2 if q ≡ 3 mod 4,
Z2(q) =
2q− 1 if q ≡ 1 mod 4,
1 if q ≡ 3 mod 4, and
N2(q) =
(q−1)2
2 if q ≡ 1 mod 4,
q2−1
2 if q ≡ 3 mod 4,
see Corollary 3.5. To recursively determine these functions
we can utilize:
Lemma 4.2 LetQ0 andQ1 be the sets defined in Corollary
3.5. Then for dimensionm > 3 we have
Zm(q) = Zm−2(q) · |Q0|
+
(
qm−2 − Zm−2(q)
)
· |Q1| ,
Sm(q) =
q− 1
2
·
(
Nm−2(q) + Zm−2(q)
)
· |Q1|
+
q− 3
2
· Sm−2(q) · |Q1| + Sm−2(q) · |Q0| ,
Nm(q) = q
m − Sm(q) − Zm(q), and
∆ (Gm,q) = Sm(q) + Zm(q) − 1.
PROOF. We rewrite the equation
m∑
i=1
a2i = y as a
2
1 + a
2
2 =
y−
m∑
i=3
a2i and apply Corollary 3.5. 
Theorem 4.3 Let m > 1 be arbitrary. For q ≡ 1 mod 4
we have
Zm(q) =
{
qm−1 form odd,
qm−1 + q
m
2 − q
m−2
2 form even,
Sm(q) =
1
2
(
qm − qm−1 + q
m+1
2 − q
m−1
2
)
form odd,
1
2
(
qm − qm−1 − q
m
2 + q
m−2
2
)
form even,
Nm(q) =
1
2
(
qm − qm−1 − q
m+1
2 + q
m−1
2
)
form odd,
1
2
(
qm − qm−1 − q
m
2 + q
m−2
2
)
form even,
and ∆ (Gm,q) =
1
2
(
qm + qm−1 + q
m+1
2 − q
m−1
2
)
− 1 form odd,
1
2
(
qm + qm−1 + q
m
2 − q
m−2
2
)
− 1 form even.
For q ≡ 3 mod 4 we have Zm(q) ={
qm−1 form odd,
qm−1 + (−q)
m
2 + (−q)
m−2
2 form even,
Sm(q) =
1
2
(
qm − qm−1 − (−q)
m+1
2 − (−q)
m−1
2
)
form odd,
1
2
(
qm − qm−1 − (−q)
m
2 − (−q)
m−2
2
)
form even,
Nm(q) =
1
2
(
qm − qm−1 + (−q)
m+1
2 + (−q)
m−1
2
)
form odd,
1
2
(
qm − qm−1 − (−q)
m
2 − (−q)
m−2
2
)
form even,
and ∆ (Gm,q) =
1
2
(
qm+qm−1−(−q)
m+1
2 −(−q)
m−1
2
)
− 1 form odd,
1
2
(
qm+qm−1+(−q)
m
2 +(−q)
m−2
2
)
− 1 form even.
PROOF. Induction onm utilizing Lemma 4.2. 
With strongly regular graphs in mind we consider the num-
ber of common neighbors.
Theorem 4.4 If N+c (m,q) denotes the number of common
neighbors of 0 and e1 in Fmq \ {0, e1}, then for odd m we
have N+c (m,q) =
qm−2(q+1)2+(−1)
(m−1)(q−1)
4 q
m−3
2
(
3q2−2q−1
)
4
− 2
and for evenm > 2 we have N+c (m,q) =
qm−2(q+1)2 + 2(−1)
m(q−1)
4 q
m−2
2 (q−1)
4
− 2.
69
PROOF. Clearly we haveN+c (1, q) = q− 2. Form > 1 we
count the number of solutions (v1, . . . , vm) of the equation
system
v21 +
m∑
i=2
v2i = x
2,
(v1 − 1)
2
+
m∑
i=2
v2i = y
2.
There are
(
q+1
2
)2
different pairs
(
x2, y2
)
for x, y ∈ Fq.
For given x2, y2 we have v1 = x
2−y2+1
2 and
m∑
i=2
v2i =
4x2y2−(x2+y2−1)
2
4 = −
(
x2−y2−1
2
)2
+ y2 =: d. Each
of the
(
q+1
2
)2
cases leads to a specific d ∈ Fq. Now let ai
be the number of pairs
(
x2, y2
)
which result in d = i. Then
we obtain ∑
i∈Fq
ai =
(
q+ 1
2
)2
. (2)
By bi,m we denote the number of vectors(
v2 . . . vm
)
∈ Fm−1q with
m∑
j=2
v2j = i. With this
we have
N+c (m,q) =
∑
i∈Fq
ai · bi,m − 2. (3)
Due to N+c (1, q) = q − 2 and bi,1 = 0 for i 6= 0 we
have a0 = q. If i, j ∈ q\{0} or i, j /∈ q then we have
bi,m = bj,m. Next we show
as :=
∑
i∈q\{0}
ai =
{
(q+1)(q−1)
8 for q ≡ 1 mod 4
(q−1)(q−3)
8 for q ≡ 3 mod 4,
(4)
from which we can conclude
an :=
∑
i 6∈q
ai =
{
(q−1)(q−3)
8 for q ≡ 1 mod 4
(q+1)(q−1)
8 for q ≡ 3 mod 4,
due to Equation (2). We use the information for dimension
m = 2. For i /∈ q we have bi,2 = 0 and for i ∈ q\{0}
we have bi,2 = 2. For q ≡ 3 mod 4 we have b0,2 = 1 and
for q ≡ 1 mod 4 we have b0,2 = 1. Inserting this and the
formula for N+c (2, q) in Equation (3) yields Equation (4).
Using b0,m = Zm−1(q), bi,m = 2q−1 · Sm−1(q) for
i ∈ q\{0}, and bi,m = 2q−1 ·Nm−1(q) for i /∈ q we get
N+c (m,q) = q · Zm−1(q) + as ·
2
q− 1
· Sm−1(q)
+an ·
2
q− 1
·Nm−1(q) − 2
and we obtain the stated formula by using Theorem 4.3. 
So for dimension m = 3 we have N+c (3, q) =
q3+5q2−q−9
4 for q ≡ 1 mod 4 and N
+
c (3, q) =
q3−q2+3q−7
4 for q ≡ 3 mod 4.
Lemma 4.5 For odd dimensionm > 3 the graph of integral
distances Gm,q is not a strongly regular graph.
PROOF. Let us assume that Gm,q is strongly regular. Then
there exist corresponding parameters (v, k, λ, µ) with
v = qm,
k = ∆ (Gm,q) , and
λ = N+c (m,q).
For a strongly connected graph we have the identity (v−k−
1)µ = k(k− λ− 1), see e. g. [19]. Using Theorem 4.3 and
Theorem 4.4 we can utilize this identity to determine µ. For
q ≡ 1 mod 4 andm odd we have
k(k− λ− 1) =
q
m−3
2 (q−1)(q+1)
(
q
m−1
2 − 1
)
8
·
(
qm+qm−1+q
m+1
2 −q
m−1
2 − 2
)
,
v− k− 1 =
q
m−1
2 · (q− 1) ·
(
q
m−1
2 − 1
)
2
, and
µ =
(q+1)
(
qm + qm−1 + q
m+1
2 −q
m−1
2 −2
)
4q
.
For q ≡ 3 mod 4 andm odd we obtain k(k− λ− 1)
=
q
m−3
2 (q−1)(q+1)
(
q
m−1
2 −(−1)
m−1
2
)
8
·
(
qm+qm−1−(−q)
m+1
2 −(−q)
m−1
2 −2
)
,
v− k− 1 =
q
m−1
2 (q−1)
(
q
m−1
2 −(−1)
m−1
2
)
2
, and
µ =
(q+1)
(
qm+qm−1−(−q)
m+1
2 −(−q)
m−1
2 −2
)
4q
.
Since for odd m > 3 the denominator of µ is divisible by
q and the numerator is not divisible by q, the graph of inte-
gral distances Gm,q is not a strongly regular graph in these
cases. 
If we accomplish the same computation for evenm then for
q ≡ 1 mod 4 we get k(k− λ− 1) =
qm−2(q−1)(q+1)
(
q
m
2 −1
) (
q
m
2 +q
m−2
2 +2
)
8
,
v− k− 1 =
q
m−2
2 (q−1)
(
q
m
2 −1
)
2
, and
µ =
q
m−2
2 (q+1)
(
q
m
2 +q
m−2
2 +2
)
4
,
70
and for q ≡ 3 mod 4 we obtain
k(k− λ− 1) =
qm−2(q−1)(q+1)
(
q
m
2 −(−1)
m
2
)
8
·
(
q
m
2 +q
m−2
2 +2(−1)
m
2
)
,
v− k− 1 =
q
m−2
2 (q−1)
(
q
m
2 −(−1)
m
2
)
2
, and
µ
q
m−2
2 (q+1)
(
q
m
2 +q
m−2
2 +2(−1)
m
2
)
4
.
So in both cases we have µ ∈ N for even dimension m.
Therefore the graph Gm,q could be strongly regular for even
dimensionm, and indeed this is our conjecture:
Conjecture 4.6 If N0c(m,q) denotes the number of com-
mon neighbors of 0 and an element v with 〈v, v〉 = 0 in
Fmq \{0, v}, then for even m > 2 we have N0c(m,q) =
N+c (m,q) and for oddm we have N
0
c(m,q) =
N+c (m,q) − (−1)
(q−1)(m−1)
4 · q
m−3
2 · q
2 − 1
4
.
For even dimensionm the graph of integral distances Gm,q
is a strongly regular graph.
We remark that due to Theorem 4.8 N0c(m,q) is well de-
fined. For q = p1 being a prime we have verified Conjec-
ture 4.6 for small values using computer calculations. More
explicitly, Conjecture 4.6 is valid for (m = 3, p 6 2029),
(m = 4, p 6 283), (m = 5, p 6 97), (m = 6, p 6 59),
(m = 7, p 6 31), and (m = 8, p 6 23). For all dimensions
m > 3 the graph of integral distances Gm,q is at least a
slightly generalization of a strongly regular graph.
Definition 4.7 An association scheme with s associate
classes on a finite setΩ is a coloring of the edges of the com-
plete undirected graph with vertex-set Ω by s colors such
that
(i) for all i, j, k in {1, . . . , s} there is an integer pkij such
that, whenever {α,β} is an edge of color k then pkij =∣∣∣ {γ ∈ Ω | {α, γ} has color i and {γ, β} has color j} ∣∣∣;
(ii) every color is used at least once;
(iii) there are integers ai for i ∈ {1, . . . , s} such that each
vertex is contained in exactly ai edges of color i.
For an introduction to association schemes we refer the
interested reader to e. g. [2, 20].
Theorem 4.8 Let Ω = Fmq . In the complete graph with
vertex set Ω we color edges with squared distance 0 by 1,
edges with squared distance in q\{0} by 2, and edges with
squared distance not in q by 3. For dimension m > 3 this
coloring forms a three-class association scheme onΩ.
PROOF. From Lemma 3.21 we know that the automorphism
group Aut
(
Fmq , ∆
)
acts transitively on the edges of each of
the three color classes. Thus the integers pkij and ai exist.
Due to Theorem 4.3 every color is used at least once. 
For the special class of three-class association schemes
and their properties we refer to [18]. We remark that we
have a1 = Zm(q) − 1, a2 = Sm(q), and a3 = Nm(q)
for Fmq , so that we can apply Theorem 4.3 to obtain explicit
formulae. The values pkij are harder to compute. Form = 3
we only state a conjecture:
Conjecture 4.9 The intersection numbers p1ij, p2ij, and p3ij
for the three class association scheme corresponding to the
integral distances in F3q are given by q− 2
q(q−1)
2
q(q−1)
2
q(q−1)
2
q(q−1)(q−3)
4
q(q−1)2
4
q(q−1)
2
q(q−1)2
4
q(q−1)(q+1)
4
,
 q+ 1
(q+1)(q−3)
2
(q+1)(q−1)
2
(q+1)(q−3)
2 1+
(q−3)(q−1)2
4
(q+1)(q−1)2
4
(q+1)(q−1)
2
(q+1)(q−1)2
4
(q+1)(q−1)2
4
,
 q− 1
(q−1)2
2
(q+1)(q−1)
2
(q−1)2
2
(q−1)3
4
(q−1)3
4
(q+1)(q−1)
2
(q−1)3
4
q3+q2−5q−1
4

for q ≡ 3 mod 4 and by q− 2
q(q−1)
2
q(q−1)
2
q(q−1)
2
q(q−1)(q+1)
4
q(q−1)2
4
q(q−1)
2
q(q−1)2
4
q(q−1)(q−3)
4
,
 q− 1
(q−1)(q+1)
2
(q−1)2
2
(q−1)(q+1)
2
q3+q2−5q−1
4
(q−1)3
4
(q−1)2
2
(q−1)3
4
(q−1)3
4
,
 q+ 1
(q−1)(q+1)
2
(q−3)(q+1)
2
(q−1)(q+1)
2
(q−1)2(q+1)
4
(q−1)2(q+1)
4
(q−3)(q+1)
2
(q−1)2(q+1)
4
q3−5q2+7q+1
4

for q ≡ 1 mod 4.
5 Maximum cardinality of integral
point sets in Fmq
By Definition 2.2 an integral point set P over Fmq is a subset
of Fmq , where all pairs of points are at integral distance. In
Definition 2.3 we have introduced the notion I (Fq,m) for
the maximum cardinality of an integral point set over Fmq .
Since for m = 1 or 2|q all distances in Fmq are integral, we
have I (Fq,m) = qm in these cases. We have already stated
I (Fq, 2) = q for 2 - q in Theorem 2.6. Combining this with
the obvious bound I (Fq,m) 6 q · I (Fq,m− 1) we obtain
I (Fq, 3) 6 q2 (5)
for 2 - q.
71
Theorem 5.1 If q ≡ 1 mod 4 then we have I (Fq, 3) =
q2.
PROOF. Consider the point set
P := {(a,ωqa, b) | a, b ∈ Fq} .
This point set is an integral point set of cardinality q2. Geo-
metrically it is a hyperplane. 
Using the graph of integral distances Gm,q from Sec-
tion 4 the problem of determining I (Fq,m) is transfered
to the well known problem of the determination of the max-
imum cardinality of cliques, these are complete subgraphs,
in Gm,q. For the latter problem there are software packages
as e. g. CLIQUER [16], available.
Thus for small values m and q the maximum cardinality
I (Fq,m) can be determined exactly using computer calcu-
lations. In the remaining part of this section we will deal
with the cases q - 2, m > 3. Since Gm,q consists of qm
vertices one should reduce the problem whenever possible.
One possibility is to predescribe points which must be con-
tained in the clique. Due to Lemma 3.21 it suffices to inves-
tigate the two cases where we predescribe 0 ∈ Fmq and an
arbitrary element of P+ or P0.
Now let us consider the special case of dimensionm = 3
and q ≡ 3 mod 4. Due to I (Fq,m) > q we can
restrict our search on cliques C with cardinality at least
q + 1. Thus there exists z ∈ Fq such that the hyperplane
{(x, y, z) | x, y ∈ Fq} contains at least two points of a clique
C with cardinality at least q + 1. We assume z = 0 and
since for q ≡ 3 mod 4 the equation x2+y2 has the unique
solution (0, 0) w.l.o.g. we predescribe the points (0, 0, 0)
and (1, 0, 0). Additionally we know the following: Either in
such a clique C there exists a third point in the hyperplane
with third coordinate being equal to zero, or there exist two
points in a hyperplane with third coordinate being equal to
an element of F∗q, or every hyperplane with fix third coor-
dinate contains at least one element of the clique C. Using
theses properties we were able to determine the following
values of I (Fq, 3) for small q ≡ 3 mod 4:
q 3 7 11 19 23 27 31
I (Fq, 3) 4 8 11 19 23 28 31
These first few values and some theoretical considerations
lead us to:
Conjecture 5.2 We have I (Fq, 3) ∈ {q, q + 1} for q ≡ 3
mod 4.
For any given point (a, b, c) 6= (0, 0, 0) the point set
(a, b, c) ·Fq is an integral point set over F3q of cardinality q.
For q ≡ 3 mod 4 there is another nice construction of an
integral point set in F3q with cardinality q. At first we con-
struct an integral point set on a circle, see [8]. Therefore we
consider the field F ′q := Fq[x]/
(
x2 + 1
)
. For z = a+bx ∈
F ′q with a, b ∈ Fq we set z := a− bx ∈ F ′q, which mimics
the complex conjugation. Now let z be a generator of the
cyclic group F ′q\{0}. We define C ′q :=
{
z ∈ F ′q | zz = 1
}
.
It is not difficult to check that C ′q corresponds to an integral
point set over F2q of cardinality
q+1
2 , see [8]. By Cq we de-
note the corresponding integral point set over F3q, where the
third coordinates of the points are equal to zero. Now we de-
fine the set L :=
{
x | x2 + 1 ∈ q
}
which has cardinality
q−1
2 for q ≡ 3 mod 4. With this notation we can state:
Lemma 5.3 For q ≡ 3 mod 4 the set Cq ∪ (0, 0, 1) · L is
an integral point set over F3q with cardinality q.
Lemma 5.4 For q ≡ 3 mod 4 there exists a hyperplane H
with squared distances being either 0 or non-squares.
PROOF. Due to Corollary 3.5 there exist a, b ∈ Fq with
a2+b2 = −1. We set v1 := (a, b, 1) and v2 := (−b, a, 0).
This gives 〈v1, v1〉 = 0, 〈v2, v2〉 = −1 /∈ q, and
〈v1, v2〉 = 0. Now let H := {xv1 + yv2 | x, y ∈ Fq}. The
squared distance of two elements xiv1+yiv2 ∈ H, i = 1, 2,
is given by (y1 − y2)
2 · 〈v2, v2〉 /∈ q\{0}. 
Corollary 5.5 Let P be an integral point set in F3q for q ≡ 3
mod 4. Either |P| 6 q or some squared distances equal
zero.
PROOF. We consider a covering of F3q by q translations of
the plane of Lemma 5.4. 
We remark that our two examples of integral point sets
of cardinality q for q ≡ 3 mod 4 do not contain a squared
distance being equal to zero.
Since for q ≡ 3 mod 4 integral point sets over
F3q of cardinality q + 1 seem to be something spe-
cial we want to list the examples that we have
found by our clique search. For I (F27, 3) = 28
an example is given by
{ (
2+ 2w+ 2w2, 2+w2,w2
)
,(
0,2w+ 2w2, 1+ 2w
)
,
(
1,1+w+w2,w
)
, (2,0, 0),(
2,w2, 2+w
)
,
(
2,2w2, 1+ 2w
)
,
(
2,2w+ 2w2, 1+ 2w
)
,(
w,2+ 2w,2+ 2w+ 2w2
)
,
(
2w,2w2, 2+ 2w+w2
)
,(
2+ 2w,w2, 2+w+w2
)
,
(
2+ 2w,w+ 2w2,w+ 2w2
)
,(
2+ 2w,2w+ 2w2, 2w
)
,
(
w2, 2+w+w2, 1+ 2w2
)
,(
1+w2, 2w+ 2w2, 2w
)
, (0,0, 0),
(
2+w2, 1+ 2w,2w2
)
,(
1+w+w2,w2, 2+w2
)
,
(
2+w+w2,w2, 0
)
,
(1,0, 0),
(
2w+w2, 1+ 2w+ 2w2, 2+ 2w+ 2w2
)
,(
2+ 2w+w2, 2+ 2w2, 1
)
,
(
1,0, 1+w2
)
,(
1+ 2w2,w+w2, 2w
)
,
(
w+ 2w2, 1+w2, 1+w+ 2w2
)
,(
2+w+ 2w2, 2+w,2+w+ 2w2
)
,(
2+w+ 2w2, 2+ 2w,2w+w2
)
,(
1+ 2w+ 2w2, 2+w+w2, 2w+w2
)
,(
1+ 2w+ 2w2, 2w+ 2w2, 2w
)}
, where we use F27 '
F3[w]/
(
w3 +w2 +w+ 2
)
. For q = 7 we have
{
(0, 0, 0), (1, 0, 0), (0, 0, 1), (1, 5, 5), (2, 1, 3), (3, 1, 2),
(5, 5, 1), (6, 3, 6)
}
and for q = 3 we have{
(0, 0, 0), (1, 0, 0), (2, 1, 1), (2, 2, 1)
}
as examples.
For higher dimensions we know some more exact num-
bers, see [9, 10]: I (F3, 4) = 9, I (F3, 5) = 27, I (F3, 6) =
72
33, I (F5, 4) = 25, I (F5, 5) = 125, I (F7, 4) = 49,
I (F7, 5) = 343, and I (F11, 4) = 121.
To obtain lower bounds we can consider pairs of inte-
gral point sets P1 ⊂ Fm1q and P2 ⊂ Fm2q , where all
squared distances in P2 are equal to zero. With P :=
{(p1|p2) | p1 ∈ P1, p2 ∈ P2} we obtain an integral point set
in Fm1+m2q with cardinality |P1| · |P2|.
Theorem 5.6 For q ≡ 1 mod 4, m > 1, and 2n 6 m we
have
I (Fq,m) > qn · I (Fq,m− 2n) > qd
m
2 e,
where we set I (Fq, 0) = 1.
PROOF. We set
P2 := {(a1, a1ωq, . . . , an, anωq) | a1, . . . , an ∈ Fq}
in the above described construction. Thus we have
I (Fq,m) > qn · I (Fq,m− 2n) for all 2n 6 m. The re-
maining inequality can by proven by induction on m using
I (Fq,m) > q. 
Lemma 5.7 There exists an integral point set P2 in F4q of
cardinality q2, where all squared distances are equal to
zero.
PROOF. Let (x, y) be a solution of x2 + y2 = −2 in
Fq. By Corollary 3.5 there are at least q − 1 > 1 such
solutions. We consider the vectors u = (x, y, 1, 1) and
v = (−y, x,−1, 1). Clearly u and v are linearly indepen-
dent and fulfill 〈u, v〉 = 0, 〈u, u〉 = 0, and 〈v, v〉 = 0.
We set P2 := {au+ bv | a, b ∈ Fq}. It suffices to check
d2(0, au+ bv) = 0 for all a, b ∈ Fq. Indeed we have
d2(0, au+ bv) = 〈au+ bv, au+ bv〉
= a2〈u, u〉+ 2ab〈u, v〉+ b2〈v, v〉
= 0.

Theorem 5.8 For q ≡ 3 mod 4, m > 1, and 4n 6 m we
have
I (Fq,m) > q2n · I (Fq,m− 4n)
> q
2·bm4 c+
⌈
m
4 −bm4 c
⌉
> qb
m
2 c,
where we set I (Fq, 0) = 1.
PROOF. We choose P2 as the n-fold cartesian product from
the integral point set of Lemma 5.7 in the construction de-
scribed above Lemma 5.6. Thus we have I (Fq,m) > q2n ·
I (Fq,m− 4n) for all 2n 6 m. The remaining inequality
can by proven by induction onm using I (Fq,m) > q. 
We would like to remark that there is a nice connection
between integral distances over Fmq and coding theory, at
least for q = 3. Therefore let us denote by dH : Fmq ×
Fmq → N0 the Hamming distance, which maps two vectors
u = (u1, . . . , um) and v = (v1, . . . , vm) to dH(u, v) =
|{i | ui 6= vi, 1 6 i 6 m}|. For q = 3 and u, v ∈ Fm3 we
have d2(u, v) ∈ 3 if and only if dH(u, v) 6≡ 2 mod 3.
If we denote by Hm the subsets of Fm2 , where all Ham-
ming distances are congruent to 0 or 1 modulo 4, then we
have I (Z4,m) = 2m · max
S∈Hm
|S|. For the proofs and a more
detailed description we refer the reader to [10].
6 Conclusion and outlook
For the study of discrete structures the knowledge of their
automorphism group is very important. In Section 3 we have
completed the determination of the automorphism group of
Fmq with respect to integral distances.
The graphs Gq,m of integral distances are interesting
combinatorial objects. We were able to determine a few pa-
rameters and properties, but the large part remains unsettled.
It would be nice to have a proof of Conjecture 4.6, which
maybe is not too difficult.
Section 5 gives a first glimpse on the maximum cardinal-
ities I (Fq,m) of integral point sets over Fmq . It remains a
task for the future to determine some more exact numbers
or lower and upper bounds. E.g. for small q we have no
idea for a general construction of integral point sets with
maximum cardinality. A detailed analysis of the parameters
of the 3-class association schemes including the eigenvalues
of the corresponding graphs could be very usefull to utilize
some general upper bounds on clique sizes. A geometrical
description of the point sets achieving I (Fq, 3) = q+ 1 for
q ≡ 3 mod 4 would be interesting.
There are some similarities between integral point sets
over Fmq and integral point sets over Euclidean spaces Em.
E.g. the constructions which lead to the maximum cardinal-
ity I (Fq,m) in Fmq often coincide with the constructions
which lead to integral point sets over Em with minimum di-
ameter, see [12, 14, 15].
Bibliography
[1] A. Antonov and M. Brancheva, Algorithm for finding
maximal Diophantine figures, Spring Conference
2007 of the Union of Bulgarian Mathematicians,
2007.
[2] R. A. Bailey, Association schemes. Designed exper-
iments, algebra and combinatorics, Cambridge
Studies in Advanced Mathematics 84. Cambridge:
Cambridge University Press. 387 p., 2004.
[3] A. Blokhuis, On subsets of GF(q2) with square differ-
ences, Indag. Math. 46 (1984), 369–372.
[4] S. Dimiev, A setting for a Diophantine distance geom-
etry, Tensor (N.S.) 66 (2005), no. 3, 275–283. MR
MR2189847
[5] R. E. Fullerton, Integral distances in banach spaces,
Bull. Amer. Math. Soc. 55 (1949), 901–905.
73
[6] H. Harborth, Integral distances in point sets, Butzer,
P. L. (ed.) et al., Karl der Grosse und sein Nach-
wirken. 1200 Jahre Kultur und Wissenschaft in Eu-
ropa. Band 2: Mathematisches Wissen. Turnhout:
Brepols, 1998, pp. 213–224.
[7] B. Huppert, Endliche Gruppen. I, Die Grundlehren
der mathematischen Wissenschaften in Einzel-
darstellungen. 134. Berlin-Heidelberg-New York:
Springer-Verlag. 793 p., 1967.
[8] M. Kiermaier and S. Kurz, Inclusion-maximal integral
point sets in affine planes over finite fields, (sub-
mitted).
[9] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Electron. Notes Discrete Math. 27 (2006), 65–66.
[10] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Discrete Appl. Math., (to appear).
[11] T. Kreisel and S. Kurz, There are integral heptagons,
no three points on a line, no four on a circle, Dis-
crete Comput. Geom., (to appear).
[12] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[13] S. Kurz, Integral point sets over finite fields, (submit-
ted).
[14] S. Kurz and R. Laue, Upper bounds for integral point
sets, Australas. J. Comb. 39 (2007), 233–240.
[15] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin., (to
appear).
[16] S. Niskanen and P. R. J. Östergård, Cliquer user’s
guide, version 1.0, Tech. Report T48, Communica-
tions Laboratory, Helsinki University of Technol-
ogy, Espoo, Finland, 2003.
[17] D. E. Taylor, The geometry of the classical groups,
Sigma Series in Pure Mathematics Volume 9. Hel-
dermann Verlag Berlin, 1992.
[18] E. R. van Dam, Graphs with few eigenvalues, Ph.D.
thesis, University of Gent, 1996.
[19] D. B. West, Introduction to graph theory, 2nd ed., New
Delhi: Prentice-Hall of India. 608 p., 2005.
[20] P.-H. Zieschang, Theory of association schemes,
Springer Monographs in Mathematics. Berlin:
Springer. 283 p., 2005.
74
Chapter 9
Inclusion-maximal integral point sets over
finite fields
MICHAEL KIERMAIER1 AND SASCHA KURZ2
ABSTRACT. We consider integral point sets in affine planes over
finite fields. Here an integral point set is a set of points in F2q where
the formally defined Euclidean distance of every pair of points is
an element of Fq. From another point of view we consider point
sets over F2q with few and prescribed directions. So this is related to
Rédei’s work. Another motivation comes from the field of ordinary
integral point sets in Euclidean spaces Em.
In this article we study the spectrum of integral point sets over
Fq which are maximal with respect to inclusion. We give some
theoretical results, constructions, conjectures, and some numerical
data.
2000 MSC: 51E20; 05B25.
Key words and phrases: integral distances, exhaustive search,
finite geometry, Paley graphs.
1 Introduction
The study of geometrical objects with integral edge lengths
has been attractive for mathematicians for ages. The first re-
sult may be obtained be the Pythagoreans considering rect-
angles with integral side and diagonal lengths. A slight
generalization of this problem is even unsolved up to our
times. Is there a perfect box? This is a rectangular par-
allelepiped with all edges, face diagonals and space diag-
onals of integer lengths [11, 15]. In a more general con-
text one is interested in the study of integral point sets, see
[12, 21, 22] for an overview. As originally introduced in-
tegral point sets are sets of n points in the m-dimensional
Euclidean space Em with pairwise integral distances. Here
the most results are known for dimension m = 2, see e. g.
[12, 13, 18, 21, 22, 27]. Although integral point sets were
studied for a long time our knowledge is still very limited.
1Michael Kiermaier, University of Bayreuth, Department of Mathemat-
ics, D-95440 Bayreuth, Germany.
E-mail adress: michael.kiermaier@uni-bayreuth.de
2Sascha Kurz, University of Bayreuth, Department of Mathematics, D-
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
So Stancho Dimiev [10] came up with the idea of studying
integral point sets over finite rings with the hope that the
situation in the finite case is easier and that some structure of
the problem may be preserved. So for a commutative ring R
with 1we consider point sets P over R2. For two points u =
(u1, u2), v = (v1, v2) in R2 we define the squared distance
as d2(u, v) := N(u− v) := (u1 − v1)
2
+ (u2 − v2)
2 ∈
R. We say that two points u, v are at integral distance if
there is an element r ∈ R with d2(u, v) = r2, meaning that
the distance is an element of R. Here an integral point set
is a set of points in R2 with pairwise integral distances. For
residue rings R = Zn first results were obtained in [10, 16].
If the ring R is a finite field we clearly have a bit more
algebraic tools at hand to attack the problem in this special
case. So in [19] one of the authors studied integral point
sets over F2q and classified those integral point sets with
maximum cardinality up to isomorphism almost completely,
see Section 3 for the definition of isomorphic integral point
sets. To state the classification result we need some notation.
For an odd prime power q there are exactly q+12 squares in
Fq. The set of squares will be denoted by q. We have
−1 ∈ q if and only if q ≡ 1 (mod 4). In this case ωq
will denote a fixed element with ω2q = −1. With this we
can state:
Theorem 1.1 (Kurz, 2007 [19])
Let q = pr be a prime power. If 2|q then F2q is an integral
point set otherwise the maximum cardinality of an integral
point set P over F2q is given by q. If q ≡ 3 mod 4 then each
integral point set of this maximum cardinality is isomorphic
to (1, 0) · Fq. If q = p ≡ 1 mod 4 then each integral point
set of this maximum cardinality is isomorphic (1, 0) · Fq,
(1,ωq) · Fq, or (1,ωq) ·q ∪ (1,−ωq) ·q.
The key ingredient for this result was a theorem on point
sets over F2q with few directions. Here two points (x1, y1),
(x2, y2) have the direction y1−y2x1−x2 ∈ Fq ∪ {∞}.
Theorem 1.2 (Ball, Blokhuis, Brouwer, Storme, Szőnyi,
1999 [7]; Ball 2003 [5])
Let f : Fq → Fq, where q = pn, p prime, f(0) = 0. Let
N = |Df|, where Df is the set of directions determined by
the function f. Let e (with 0 6 e 6 n) be the largest integer
75
such that each line with slope in Df meets the graph of f in
a multiple of pe points. Then we have the following:
(1) e = 0 and q+32 6 N 6 q+ 1,
(2) pe > 2, e|n, and qpe + 1 6 N 6
q−1
pe−1 ,
(3) e = n and N = 1.
Moreover, if pe > 2, then f is a linear map on Fq viewed as
a vector space over Fpe . If e = 0 and N = q+32 then f is
affinely equivalent to f(x) = x
q−1
2 . (All possibilities for N
can be determined in principle.)
In [3] the Bulgarian group around Dimiev considered in-
tegral point sets over F2p for p ≡ 3 mod 4 which are max-
imal with respect to inclusion. They classified the maximal
integral point sets up to isomorphism for p = 7, 11 and con-
jectured that the maximal integral point sets have either car-
dinality p+32 or p. In the latter case all p points are on a
line. Theorem 1.1 clears the situation for cardinality p. In
this article we disprove their conjecture about the spectrum
of possible cardinalities of maximal integral point sets and
classify them for q 6 47.
2 The graph of integral distances
It turns out that it is usefull to model integral points sets as
cliques of certain graphs.
Definition 2.1 For a fixed prime power q = pr we define
the graph G with vertex set F2q, where two vertices v and w
are adjacent if d(v,w) ∈ q. So two different vertices are
connected by an edge exactly if they are at integral distance.
The graph G will be called graph of integral distances.
Furthermore, we recall that for q ≡ 1 (mod 4) the Paley-
graph Paley(q) is defined as the graph with vertex set Fq
where two vertices v andw are adjacent if v−w ∈ q\{0}.
2.1 The case q ≡ 3 (mod 4)
Theorem 2.2 For q ≡ 3 (mod 4) it holds: G ∼=
Paley
(
q2
)
.
PROOF. We define the two sets
M :=
{
(x, y) ∈ F2q | x2 + y2 ∈ q
}
and
N :=
{
(x, y) ∈ F2q | x+ yi ∈ q2
}
Obviously, |N| = |q2 | =
q2+1
2 , and by Lemma 3.3: |M| =
|P0| +
q−1
2 |P1| = |N|. Let (x, y) ∈ N. Then there exist
a, b ∈ Fq with (a+ bi)2 = x+yi. That implies x = a2−
b2 and y = 2ab, and we get x2 + y2 =
(
a2 + b2
)2 ∈ q.
Hence (x, y) ∈ M. Because of the finiteness of M and N
we getM = N and the proof is complete. 
Now we can apply the existing theory for the Paley-
graphs on our situation. For example, G is a strongly regular
graph with parameters (v, k, λ, µ) =(
q2,
q2−1
2
,
q2−5
4
,
q2−1
4
)
In [6] Aart Blokhuis determined the structure of cliques
of maximal size in Paley graphs of square order: A clique of
maximal size of G is an affine line in F2q. This implies that
the size of a maximal integral point set in Fq is q, and—
anticipating the definitions of the next section—these point
sets are unique up to isomorphism.
Maximal cliques of size q+12 and
q−1
2 in Paley graphs of
square order can be found in [4].
2.2 The case q ≡ 1 (mod 4)
Theorem 2.3 For q ≡ 1 (mod 4), G is a strongly regular
graph with parameters (v, k, λ, µ) =(
q2,
(q−1)(q+3)
2
,
(q+1)(q+3)
4
−3,
(q+1)(q+3)
4
)
PROOF. The graph consists of q2 vertices of degree
(q−1)(q+3)
2 (there are
q+3
2 integral directions and q−1 fur-
ther points of one direction). We consider two points u and v
which are at a non-integral distance. From each point there
are q+32 integral directions. Since the direction from u to
v is non-integral and non-parallel lines intersect in exactly
one point we have µ = q+32 ·
q+1
2 . For the determination of
λ we consider two points u and v at integral distance. Thus
the direction from u to v is integral and all points on this line
have integral distances to u and v. There are q+12 further in-
tegral directions from u and from v respectively Each pair
intersects, if not parallel, in exactly one point. By a short
calculation we can verify the stated value for λ. 
We remark that the parameters of the complementary graph
of G are (v, k, λ, µ) =(
q2,
(q− 1)2
2
,
(q−1)(q−3)
4
+1,
(q−1)(q−3)
4
)
.
In both cases G corresponds to an orthogonal array. We
have G ∈ OA
(
q, q+12
)
for q ≡ 3 mod 4 and G ∈
OA
(
q, q+32
)
.
3 Automorphism group
It will be convenient to identify the affine plane F2q with the
ring Fq[i] where i is a root of the polynomial X2 + 1 ∈
Fq[X]. With this identification, the map N : (Fq[i], ·) →
(Fq, ·) is a monoid homomorphism. In the case q ≡ 3
(mod 4) we have −1 /∈ q, so X2 + 1 is irreducible
and Fq[i] ∼= Fq2 . For q ≡ 1 (mod 4), Fq is a finite
ring with two non-trivial ideals, namely Fq (ωq + i) and
Fq (ωq − i). These ideals are of order q and contain the
76
zero-divisors of Fq[i]. An element z = x + iy ∈ Fq[i] is a
zero-divisor iff N(z) = 0.
In the introduction we announced that we want to classify
maximal integral point sets up to isomorphism. So we have
to specify what we consider as an automorphism. Now we
say that an automorphism of F2q is a bijection τ : F2q → Fq
with d(x, y) ∈ q ⇔ d (τ(x), τ(y)) ∈ q for every
x, y ∈ F2q. This is exactly the automorphism group G of
the corresponding graph G of integral distances. For Paley
graphs of square order the automorphism group was known
since a while, see [9, 14, 28]. If we also request that au-
tomorphisms τ map lines to lines, then the automorphism
group of F2q for 2 - q was determined in [19].
Theorem 3.1 (Kurz, 2007 [19])
Let q = pr 6= 5, 9 an odd prime power, G the automor-
phism group of F2q and H := G ∩ A Γ L (2,Fq). Then H is
generated by
1. x 7→ x+ v for all v ∈ F2q,
2. x 7→
(
0 1
1 0
)
· x,
3. x 7→
(
a b
b −a
)
·x for all {a, b} ⊆ F2q such that a2+b2
is a square, and
4. (a, b) 7→
(
ap
i
, bp
i
)
for i ∈ N.
In the next section we will describe an algorithm which
calculates maximal integral point sets up to isomorphism. In
order to make this algorithm really fast we want to demand
weaker conditions on automorphisms as in [19] and not use
the multiplication in Fq[i] or that lines must be mapped onto
lines. Strictly speaking we choose the automorphism group
G of the corresponding graph G of integral distances instead
of H. It will turn out that a distinction between these two
slightly different definitions of automorphisms is not neces-
sary since we have G ' H in many cases.
Definition 3.2 A triple (a, b, c) is called Pythagorean triple
over Fq if a2 + b2 = c2.
In the following it will be useful to have a parametric rep-
resentation of the Pythagorean triples over Fq.
Lemma 3.3 For 2 - q let c ∈ Fq and Pc the set of
Pythagorean triples (a, b, c) over Fq.
(a) Case c = 0
P0 =
{
{(t,±tωq, 0) | t ∈ q} if q ≡ 1 (mod 4),
{(0, 0, 0)} if q ≡ 3 (mod 4),
|P0| =
{
2q− 1 if q ≡ 1 (mod 4),
1 if q ≡ 3 (mod 4).
(b) Case c 6= 0
Pc =
{
(±c, 0, c)
}
∪
{(
t2 − 1
t2 + 1
· c, 2t
t2 + 1
· c, c
) ∣∣∣
t ∈ F∗q, t2 6= 1
}
|Pc| =
{
q− 1 if q ≡ 1 (mod 4),
q+ 1 if q ≡ 3 (mod 4).
(c) There are exactly q2 Pythagorean triples over Fq.
PROOF. Part (a) is easy to verify. For part (b) there are 4
solutions with ab = 0, these are {(0,±c, c), (±c, 0, c)}. For
ab 6= 0 we get:
a2 + b2 = c2 ⇔ c− a
b
· c+ a
b
= 1.
Setting t := c+ab ∈ F
?
q, we obtain
a
b
=
t− t−1
2
and
c
b
=
t+ t−1
2
Because of a 6= 0, c 6= 0 we have t2 /∈ {−1, 1}. It follows
a =
t− t−1
t+ t−1
· c and b = 2
t+ t−1
· c
It is easily checked that for all admissible values of t, the
resulting triples (a, b, c) are pairwise different Pythagorean
triples.
The expression for the number of solutions follows be-
cause −1 is a square in Fq exactly if q ≡ 1 (mod 4).
With part (a) and part (b) we get the number of
Pythagorean triples over Fq as∑
c∈Fq
|Pc| = |P0| + (q− 1)|P1| = q
2
So also part (c) is shown. 
With the help of Lemma 3.3 we can easily deduce for
q 6= 5, 9,
|H| =
{
q2(q− 1)2r if q ≡ 1 (mod 4),
q2(q− 1)(q+ 1)r if q ≡ 3 (mod 4).
For q = 5 we have |H| = 800 and for q = 9 we have
|H| = 31104. It is not difficult to prove G ' H for q = p 6=
5, 9 being a prime. But since we need the automorphism
groups only for small qwe simply have utilized nauty [23]
for q 6 167. We have obtained |G| = 28800 for q = 5,
|G| = 186624 for q = 9, and
|G| =
{
q2(q− 1)2r2 if q ≡ 1 (mod 4),
q2(q− 1)(q+ 1)r2 if q ≡ 3 (mod 4).
for the remaining cases with q 6 167.
From Theorem 3.1 we can deduce:
Corollary 3.4 For two points p1 6= p2 ∈ F ′q at inte-
gral distance there exists an automorphism ϕ with either
ϕ (p1) = 0, ϕ (p2) = 1 orϕ (p1) = 0, ϕ (p2) = 1+ωqx.
77
4 Inclusion-maximal integral point
sets over F2q
For the classification of inclusion-maximal integral point
sets over F2q we can use Corollary 3.4 to prescribe the point
(0, 0). Now we build up a graph Gq which consists of the
elements of F2q which are at integral distance to (0, 0). Be-
tween two nodes x, y ∈ F2q there is an edge if and only
if d(x, y) ∈ q. For practical purposes the generation of
all q
2−1
2 points which are at integral distance to (0, 0) can
be easily done by a for loop, as in [3]. For theoretic appli-
cations one can deduce a parametric solution from Lemma
3.3. The cliques of Gq are in bijection to the inclusion-
maximal integral point sets over F2q. Thus we may use a
clique search program, f.e. cliquer [24], to search for
inclusion-maximal integral point sets.
For the classification up to isomorphism we use an orderly
algorithm in combination with nauty [23] as described in
[26] on the graph Gq. To guarantee that this approach yields
the correct classification we have to ensure that the auto-
morphism group of Gq equals the automorphism group of
the original problem. In our case we have simply checked
this condition using nauty. We remark that we consider G
as the automorphism group of the original problem and not
H 6 G.
If we denote by Aq,s the number of non-isomorphic
inclusion-maximal integral point sets over F2q we have ob-
tained the following results with the above described algo-
rithm. For q ≡ 3 mod 4 we have:
q Σ 3 5 7 8 9 10 11 12 13 14
3 1 1
7 2 1 1
11 4 3 1
19 54 25 7 19 4
23 294 85 108 80 7 9 4
27 645 27 411 142 50 12
31 6005 60 2004 2734 933 199 26 46
43 231890 15 1748 54700 109127 54759 9785 1490 156
47 805783 12 1097 125545 434029 210725 28533 4904 628
q Σ 15 16 17 19 23 25 27 31 43 47
3 1
7 2
11 4
19 54 1
23 294 1
27 645 2 1
31 6005 2 1
43 231890 87 20 2 1
47 805783 230 27 50 2 1
Conjecture 4.1 For each q ≡ 3 mod 4 there exist lq, rq ∈
N such that rq 6 q−12 , Aq,lq > 0, Aq,rq > 0, Aq,q+32 >
0, Aq,q > 0, and Aq,s = 0 for s 6∈
{
lq, . . . , rq,
q+3
2 , q
}
.
For q ≡ 1 mod 4 we have:
q Σ 5 6 7 8 9 10 11 12 13 14 15
5 1 1
9 4 2 2
13 30 2 11 8 5 1 3
17 107 8 57 24 12 2 1
25 488 9 122 148 108 41 23 17 8 4
29 9693 6 893 4264 2864 1230 284 116 22 6
37 103604 1 314 17485 44952 24067 10645 4835 906 234
41 347761 1 1169 61940 149839 86159 33941 10854 2891 646
q Σ 15 16 17 18 19 20 21 22 23 25 29 37 41
5 1
9 4
13 30
17 107 3
25 488 1 2 1 4
29 9693 3 2 3
37 103604 89 55 11 2 3 1 1 3
41 347761 136 131 27 16 4 3 1 1 3
Conjecture 4.2 For each q ≡ 1 mod 4 there exist
lq, rq,∈ N such that Aq,lq > 0, Aq,rq > 0, Aq,q > 0,
and Aq,s = 0 for s 6∈ {lq, . . . , rq, q}.
So clearly the spectrum of possible cardi-
nalities of inclusion-maximal integral point sets
of F2q is a bit more complicated as conjec-
tured in [3]. We would like to remark that for
q ∈ {59, 67, 71, 79, 83, 103, 107, 127, 131, 139, 151, 163}
the second largest inclusion-maximal integral point set
has size q+32 , which was verified using an clique search
approach. Besides the maximum and the second largest
cardinality of an integral point set also the minimum cardi-
nality of a maximal integral point set is of interest. Here we
remark that we have lq = 7 for q 6= 13 and 11 6 q 6 47.
For q ∈ {49, 53, 59, 61, 67, 73} we have lq = 8, l71 = 9,
and l79 ∈ {8, 9}.
Later on we will prove lq > 5 for q > 5, see Lemma 5.1.
Conjecture 4.3 For each w ∈ N there exists a qw ∈ N
such that we have lq > w for q > qw, meaning Aq,s = 0
for s < w and q > qw.
From Theorem 1.1 we can conclude the following corollary:
Corollary 4.4 For 2 | q we have Aq,q2 = 1 and all other
numbers equal 0. For 2 - q we have Aq,s = 0 if s >
q. Additionally we have Aq,q > 1 if q ≡ 3 mod 4 and
Aq,q > 3 if q ≡ 1 mod 4.
Conjecture 4.5 For q ≡ 3 mod 4 and q > 7 the second
largest cardinality of an inclusion-maximal integral point
set over F2q is
q+3
2 .
To have a deeper look at the second largest inclusion-
maximal integral point sets we need some lemmas from
[19].
Lemma 4.6 In Fq[i] the setN−1(1) = {z ∈ Fq[i] | zz̄ = 1}
is a cyclic multiplicative group.
PROOF. If −1 6∈ q then Fq[i] is a field and thus Cmust be
cyclic. For the case −1 ∈ q we utilize the bijection
ρq : F∗q → N−1(1), t 7→
1+ t2
2t
+ωq
1− t2
2t
x.
Now we only have to check that the mapping is a group
isomorphism, namely
ρq(i · j) = ρq(i) · ρq(j).

78
Lemma 4.7 For z ∈ R ′ with zz = 1 the set P ={
z2i | i ∈ N
}
is an integral point set.
PROOF. With c := a− b we have
d
(
z2a, z2b
)
=
(
z2a − z2b
)
· (z2a − z2b)
=
(
z2c − 1
)
· z2c − 1
= 2− z2c2− z2c
=
zci− zci︸ ︷︷ ︸
∈R
2

These two lemmas allow us to do a circle construction.
We choose a generator z of the cyclic groupN−1(1) and set
PW :=
{
z2i | i ∈ N
}
∪ {0}. With this we have
|PW | =
{
q+1
2 if q ≡ 1 (mod 4),
q+3
2 if q ≡ 3 (mod 4).
It is easy to check that PW is an integral point set. For the
order of the automorphism group we would like to mention
|Aut (PW)| =
{
(q− 1)r if pr = q ≡ 1 (mod 4),
(q+ 1)r if pr = q ≡ 3 (mod 4).
Theorem 4.8 For q /∈ {5, 9} PW is a maximal integral point
set.
PROOF. We identify the affine plane F2q with the field Fq[i].
Let ζ a generator of the cyclic group N−1(1). Assume that
there is a point a ∈ Fq[i] \ PW such that PW ∪ {a} is an
integral point set. Then N(a) ∈ q. The map ρ : z 7→
ζz2 is an integral automorphism. Let A the orbit of a with
respect to 〈ρ〉. Then P ′ := PW ∪ A is an integral point set,
because N
(
ζ2na− ζ2ma
)
= N(a)N
(
ζ2n − ζ2m
)
∈ q
and N
(
ζ2na− ζ2m
)
= N
(
a− ζ2m−2n
)
∈ q.
Furthermore, let ξ = u + vi 6= 1 with N (ξ) = 1 and
u, v ∈ Fq. Because of N (ξ) = u2 + v2 = 1, we have
u 6= 1. SoN (ξ− 1) = 2(1−u) 6= 0 and ξ−1 is invertible.
Thus ζna = a is equivalent to (ζn − 1) = 0, and we get
that |A| equals the multiplicative order of ζ. For q ≡ 3
(mod 4) we get |PW ∪A| = q + 2, a contradiction to the
maximum cardinality of an integral point set, see Theorem
1.1. In the case q ≡ 1 (mod 4) we have |PW ∪A| = q. We
can easily check that in PW\{0} no three points are collinear.
Thus with PW\{0} also P ′ = PW ∪ A determines at least
q−3
2 different integral directions. So for p > 3 we are either
in case (1) or case (3) of Theorem 1.2. In case (1) there is
a subset of q+12 collinear points. This is possible only for
q = 9. For case (3) all q points are situated on a line. This
is possible only for q = 5. For the other values q < 11 we
have checked the stated result via a computer calculation.
So only the case p = 3 is left. Here we only have to
consider case (2) of Theorem 1.2 and e = 1. So every line
through two points of P ′ meets the point set P ′ in a multiple
of pe = 3 points. Let us fix a point P ∈ PW\{0}. There are
q−3
2 different lines trough P and a further point of PW\{0}.
For each of these lines l we have |A ∩ l| 6 2. One such line
l ′ meets 0. Thus A ∩ l = ∅. For all other lines l (#=q−52 )
we have |A ∩ l| = 1. Let B := {b ∈ Fq[i] | N(b) = N(a)}.
We have |B| = q− 1. So all points of B\A lie on these lines
l and l ′. There are two points P1, P2 ∈ A left which are not
on these lines l or l ′. Since we have that the point 0 is met
by the line l ′′ through P1 and P2, we have that no further
point of P ′ is situated on l ′′. Thus we have two additional
integral directions PP1 and PP2. Thus there are in total at
least q+12 integral directions determined by P
′, which is too
much for case (2). 
Remark 4.9 For q ∈ {5, 9} the set PW can be extended to
an integral point set of size q.
To describe another construction we need some further
lemmas. (Most of them are already stated and proven in
[19].)
Lemma 4.10 An integral point set over F2q determines at
most q+32 different directions if −1 ∈ q and at most
q+1
2
different directions if −1 /∈ q.
PROOF. We consider the points p = a + bi at integral
distance to 0. Thus there exists an element c ′ ∈ Fq with
a2 + b2 = c ′2. In the case a = 0 we obtain the direc-
tion ∞. Otherwise we set d := ba and c := c′a , yielding
1 = c2 − d2 = (c − d)(c + d), where d is the direction of
the point. Now we set c+d =: t ∈ F∗q yielding c = t+t
−1
2 ,
d = t−t
−1
2 . The two values t and −t
−1 produce an equal
direction. Since t = −t−1 ⇔ t2 = −1 we get the desired
bounds. 
Definition 4.11 A line with slope d = yx is called vanishing
line if x2 + y2 = 0. We call the direction d a vanishing
direction. In all other cases d is called an integral direction
if 1 + d2 ∈ q or non-integral direction if 1 + d2 /∈ q.
The slope d = 10 =∞ is integral.
We remark that a vanishing line can only occur for −1 ∈
q and in this case there are exactly two different corre-
sponding slopes, d = ωq and d = −ωq. A line with
an integral direction forms an integral point set. Similar a
line with a non-integral directions forms a non-integral point
set. The vanishing lines form both integral and non-integral
point sets.
It is well known that PGL(2, q) acts transitively one the
pairs of a line l and a point p not on l. For the automorphism
group of integral point sets we have a similar result.
Lemma 4.12 If Li is the set of integral lines, Ln the set of
non-integral lines, and Lv the set of vanishing lines in F2q,
then the automorphism group Aut of integral point sets acts
transitively on the pairs (l, p) where l ∈ L, p ∈ F2q, p /∈ l
for L ∈ {Li, Ln, Lv}.
PROOF. We can easily check that the automorphism group
Aut acts transitively on Li, Ln, and Lv. Also after applying
an automorphism l and p are not incident. Let d = yx be the
slope of l. Now the multiplication by an invertible element
79
r ∈ F∗q or the addition of a vector r · (x, y)T let l fix. These
two types of automorphisms suffice to map each two points
p, p ′ /∈ l onto each other. 
Lemma 4.13 If −1 /∈ q, 2 - q and P is a non-collinear
integral point set over F2q, then each line l contains at most
q−1
2 points.
PROOF. If l is a line with an integral pair of points on it,
then its slope is an integral direction. Now we consider the
intersections of lines with integral directions containing a
point p /∈ l, with the line l. 
We remark that this lemma was already proved in [4, 8].
Lemma 4.14 If P is a non-collinear integral point set over
F2q then every line l contains at most
q+1
2 points.
PROOF. Analog to the proof of Lemma 4.13. 
Now we construct another maximal integral point set PL.
Therefore let us choose a non-vanishing integral line l and
an arbitrary point p not on l. Let p ′ be the mirror point of
p on l. If we draw the lines of integral directions from p
we receive some intersections with l. These points together
with p and p ′ form an integral point set Pl (orthogonal di-
rections are either both integral, both non-integral, or both
vanishing). For q ≡ 3 mod 4 we have |PL| = q+32 and for
q ≡ 1 mod 4 we have |PL| = q+52 .
Theorem 4.15 The integral point set PL is maximal for q ≡
3 mod 4.
PROOF. We identify the affine plane F2q with the field Fq[i].
Without loss of generality we choose the line Fq and the
point i not on Fq, that is P = Fq ∪ {±i}. For a point P =
x + iy ∈ Fq[i] \ Fq, let σP be the map Fq[i] → Fq[i],
z 7→ x+ yz and S(P) the set of the q−12 points in Fq which
have integral distance to P. For all automorphismsφ it holds
S (φ(P)) = φ (S(P)). Our strategy is to prove that S(i) =
S(P) and d(i, P) ∈ q only holds for P = ±i.
It is easily checked that for all P ∈ Fq[i] we have
σP (Fq) = Fq, σP(i) = P and σP is an automorphism.
Now we define the set of automorphisms
A = {σP : P ∈ Fq[i] \ Fq} and the subset B ={
σ(x,y) : x ∈ Fq, y ∈ Fq \ {0, 1}
}
. Clearly, A is a
subgroup of G and acts regularly on Fq[i] \ Fq, so
σkP = σσkP(i). For σ(x,y) ∈ B it holds:
• σ(x,y) has exactly one fixed point Q on Fq[i], namely
Q = x1−y . Furthermore, d(i, x + yi) ∈ q ⇔ Q ∈
Fq.
• For each k ∈ N: σk(x,y)(z) = x
yk−1
y−1 + y
kz and in
particular: σq−1(x,y) = id.
• For all z ∈ Fq[i]: σk(z) − z =
(
yk − 1
) (
x
y−1 + z
)
,
so the point set
{
σk(x,y)(z) : k ∈ N
}
⊆ z + Fq ·(
x
y−1 + z
)
is collinear.
It follows that for σ ∈ B we have σk ∈ B ∪ {id} and that the
order of each element of B divides q− 1.
Now we assume that P = x+ yi 6= ±i is a point not in P
such that S(P) = S(i) and d(P, i) ∈ q.
(1) The case σP /∈ B:
In this case σP is a translation and has no fixed point.
Since gcd(q, q − 1) = 1 we clearly have S(i) 6=
σP (S(i)) = S (σP(i)) = S(P), a contradiction.
(2) The case σP ∈ B, where the order p of σP is prime:
As seen above, p divides q − 1. The group action of
〈σP〉 on S(i) partitions S(i) into orbits of size p and
one fixed point. Hence p | −1+ |S(i)| = q− 3, which
yields p = 2. In B there is only one automorphism
of order 2, it is z 7→ −z. So P = σP(i) = −i, a
contradiction.
(3) The case σP ∈ B, where the order k of σP is not prime:
Because of σP(i) = P 6= i we have k 6= 1. Since k |
q− 1 and 4 - q− 1, k has a prime factor p 6= 2. We set
τ := σp
−1k, which is an element of B of order p. With
Q = τ(i) we have τ = σQ. The points i, P = σ(i) and
Q = τ(i) are collinear, so d(i,Q) ∈ q. One easily
verifies Q /∈ P and S(Q) = S(P) = S(i). Now the
previous case applied to τ = σQ gives a contradiction.

For q ≡ 1 mod 4 the situation is a bit harder and we
need the following result of Weil, see e. g. [25]:
Theorem 4.16 Let f(x) be a polynomial over
Fq of degree d without repeated factors and
N :=
∣∣{(x, y) ∈ F2q | y2 = f(x)}∣∣ then for q > 5 we
have
|N− q| 6 (d− 1)
√
q.
Theorem 4.17 The integral point set PL is maximal for 9 <
q = p1 ≡ 1 mod 4.
PROOF. We apply the same strategy as in the proof of The-
orem 4.15 and adopt the notation. Nevertheless Fq[i] is not
a field for q ≡ 1 mod 4 we can define P, σP, A, B, and
σ(x,y) in the same way. The three statements for σ(x,y) ∈ B
remain valid. Also the order of each element in B divides
q− 1. Let us again assume that P = x+ yi 6= ±i is a point
not in P such that S(P) = S(i) and d(P, i) ∈ q. Since
gcd(q, q − 1) = 1 we conclude σP ∈ B, see the proof of
Theorem 4.15. We have S(i) =
{
(u, 0) | u2 + 1 ∈ q
}
={
(u, 0) | (u− x)2 + y2 ∈ q
}
and (0, 0), (x, 0) ∈ S(i) =
S(P). Thus we have the implications (u, 0) ∈ S(i) ⇒
(−u, 0) ∈ S(i) and (u, 0) ∈ S(i) ⇒ (2x − u, 0) ∈ S(i).
We conclude {j · (u, 0) | j ∈ N} ⊆ S(i). For q being a prime
this is only possible for x = 0.
So in the remaining cases we have x = 0.
Thus we have S(i) =
{
(u, 0) | u2 + 1 ∈ q
}
={
(uy, 0) | (uy)2 + 1 ∈ q
}
. We remark that the equation
1 + u2 = s2 has the parameter solution s = t+t
−1
2 , u =
t−1−t
2 for t ∈ F
∗
q since 0 6= s − u = t. So for all t ∈ F∗q
80
the term 1+ y2
(
t−1−t
2
)2
is a square. By multiplying with
4t2 we can conclude that f(t) := 4t2 + y2
(
1− t2
)2 is a
square for all t ∈ Fq. Thus for the N in Theorem 4.16 we
have N > 2q − 4. So for q > 25 we have that f(t) con-
tains a repeated factor. We simply check the cases q 6 23
by computer and now assume q > 25. So there exists an
t with f(t) = f ′(t) = 0 or there exist a, b, c ∈ Fq with
f(t) = b
(
a+ t2
)2. We have
f ′(t) = 8t− 4ty2 + 4y2t3 = t ·
(
8− 4y2 + 4y2t2
)
= 0
in the first case. Since f(0) = y2 6= 0 we have t2 = 1− 2
y2
.
Inserting yields f(t) = 4 − 4
y2
= 0 which is equivalent to
y2 = 1 or y = ±1. In the second case we get b = y2,
a2 = 1, and 2(a + 1)y2 = 4. We conclude a = 1 and
y2 = 1. Thus P = ±1. 
We remark that if we would choose l as a vanishing line
in the construction of PL for q ≡ 1 then resulting integral
point set could be completed to (1,±ωq) ·q.
r
r
rr r
r r
rr
r
r
r
r
r
r
r
r
r
r
r
r
rr
r
r
r
Figure 1: The integral point sets P1 and P2.
We summarize that for q ≡ 3 mod 4 by Theorem
4.8 and Theorem 4.15 we have two constructions showing
Aq+3
2 ,q
> 2 for q > 11. One may conjecture Aq+3
2 ,q
= 2
for q > 27 and speak of sporadic solutions in the cases
q = 11, 19, 23. The sporadic solutions also have a nice
geometric pattern. By z11, z19, and z23 we denote an arbi-
trary generator of the multiplicative groupN−1(1) in F11[i],
F19[i], and F23[i], respectively. For q = 23 the examples
are given by
P1 = {0} ∪ 1 ·
〈
z623
〉
∪ 3 ·
〈
z623
〉
∪ 9 ·
〈
z623
〉
and
P2 = {0}∪1·
〈
z823
〉
∪2·z423 ·
〈
z823
〉
∪6·z423 ·
〈
z823
〉
∪8·
〈
z823
〉
,
see Figure 1. For q = 19 one of the two examples has a
similar shape and is given by
P3 = {0} ∪ 1 ·
〈
z419
〉
∪ 3 ·
〈
z419
〉
,
see Figure 2.
r r
r
r r
r
r rrr
r
Figure 2: The integral point set P3.
The second sporadic example P4 for q = 19 and the spo-
radic example P5 for q = 11 have a different geometric pat-
tern. They are subsets of N−1(1) ∪ Fq ⊂ Fq[i], see Figure
3.
rr
r
rr
r
r r rr
r
rr
r
r
rr
r
Figure 3: The integral point sets P4 and P5.
5 Remarks on integral point sets over
E2
It is interesting to mention that the situation for integral point
sets in E2 is somewhat similar. Since we have an infinite
number of points there must not be an integral point set
of maximum cardinality. So here we ask for the minimum
possible diameter d(2, n) of an integral point set in the Eu-
clidean plane E2 with pairwise integral distances, where the
diameter is the largest occurring distance. Without any extra
condition n points on a line would yield an integral point
set with small diameter. To make it more interesting one
forces integral point sets in E2 to be two dimensional. Here
all known non-collinear examples of integral point sets with
minimum diameter consist of a line with n − 1 points and
81
one point apart, see [22, 27]. If we forbid 3 points to be
collinear integral point sets on circles seem to be the ex-
amples with minimum diameter. The situation stays more
or less the same if we consider integral point sets over Z2.
These results on the structure of integral point sets over E2
or Z2 are up to now only conjectures which are verified for
the first few numbers n of points. So this is one motivation
to study integral point sets over F2q in the hope that here the
situation is easier to handle.
Besides the characterization of the inclusion-maximal in-
tegral point sets with largest or second largest cardinality
another interesting question is the characterization of those
inclusion-maximal integral point sets with minimum cardi-
nality. From our data we may conjecture that for q > 11 we
have Aq,s = 0 for s 6 6. Again we can compare this situ-
ation to the situation in E2. A result due to Almering [1, 2]
is the following. Given any integral triangle ∆ in the plane,
the set of all points x with rational distances to the three cor-
ners of ∆ is dense in the plane. Later Berry generalized this
results to to triangles where the squared side lengths and at
least one side length are rational. In Z2 the situation is a bit
different. In [17] the authors search for inclusion-maximal
integral triangles over Z2. They exist but seem to be some-
what rare. There are only seven inclusion-maximal integral
triangles with diameter at most 5000. The smallest possi-
ble diameter is 2066. In a forthcoming paper [20] one of
the authors has extended this list, as a by-product, up to di-
ameter 15000 with in total 126 inclusion-maximal integral
triangles. So is very interesting that we have the following
lemma:
Lemma 5.1 If P is an inclusion-maximal integral point set
over F2q for q > 5 then we have |P| > 5.
PROOF. For small q we use our classification of maximal
integral point sets over F2q. If 2|q then the only inclusion
maximal integral point set over Fq has size q2. So we as-
sume w.l.o.g. that q is odd. Clearly an integral point set of
cardinality 1 is not inclusion maximal. An integral point set
P of cardinality two can be completed by all other points
on the line defined by P. The similar statement holds for
three collinear points. So let us assume that we have an
inclusion maximal integral triangle ∆ = {p1, p2, p3} over
F2q. Let l be the line through p2 and p3. Starting from
point p1 there are at least q+12 integral directions. Lets
draw lines through p1 for these integral directions. Two of
them meet p2 and p3, respectively. Since at most of the re-
maining directions can be parallel to l we can expand ∆ by
least q−52 > 1 points if q > 7. We remark that for suit-
able large q the cardinality |P| = 4 may be only possible if
P = {P1, P2, P3, P4} is a point set without a collinear triple.
There are six configurations of lines defined by (Pa, Pb),
(Pc, Pd) with {a, b, c, d} = {1, 2, 3, 4}. In at least one case
the line through Pa, Pb and the line through Pc, Pd are not
parallel. W.l.o.g. we assume a = 1, b = 2, c = 3, d = 4,
P1, P2 ∈ Fq, and P3, P4 /∈ Fq. The line through P3 and P4
intersects the line Fq in a point P5 ∈ Fq. Since P ∪ {P5} is
an integral point set and P5 /∈ P we have the stated result.

Bibliography
[1] J. H. J. Almering, Rational quadrilaterals, Indag.
Math. 25 (1963), 192–199.
[2] J. H. J. Almering, Rational quadrilaterals II, Indag.
Math. 27 (1965), 290–304.
[3] A. Antonov and M. Brancheva, Algorithm for finding
maximal Diophantine figures, Spring Conference
2007 of the Union of Bulgarian Mathematicians,
2007.
[4] R. D. Baker, G. L. Ebert, J. Hemmeter, and A. Woldar,
Maximal cliques in the Paley graph of square or-
der, J. Statist. Plann. Inference 56 (1996), no. 1,
33–38.
[5] S. Ball, The number of directions determined by a
function over a finite field, J. Combin. Theory Ser.
A 104 (2003), no. 2, 341–350.
[6] A. Blokhuis, On subsets of GF(q2) with square differ-
ences, Indag. Math. 46 (1984), 369–372.
[7] A. Blokhuis, S. Ball, A. E. Brouwer, L. Storme, and
T. Szőnyi, On the number of slopes of the graph
of a function defined on a finite field, J. Combin.
Theory Ser. A 86 (1999), no. 1, 187–196.
[8] R. H. Bruck, Finite nets. II: Uniqueness and imbed-
ding, Pacific J. Math. 13 (1963), 421–457.
[9] L. Carlitz, A theorem on permutations in a finite field,
Proc. Amer. Math. Soc. 11 (1960), 456–459. MR
MR0117223 (22 #8005)
[10] S. Dimiev, A setting for a Diophantine distance geom-
etry, Tensor (N.S.) 66 (2005), no. 3, 275–283. MR
MR2189847
[11] R. K. Guy, Unsolved problems in number theory. 2nd
ed., Unsolved Problems in Intuitive Mathematics.
1. New York, NY: Springer- Verlag. xvi, 285 p.,
1994.
[12] H. Harborth, Integral distances in point sets, Butzer,
P. L. (ed.) et al., Karl der Grosse und sein Nach-
wirken. 1200 Jahre Kultur und Wissenschaft in Eu-
ropa. Band 2: Mathematisches Wissen. Turnhout:
Brepols, 1998, 213–224.
[13] H. Harborth, A. Kemnitz, and M. Möller, An upper
bound for the minimum diameter of integral point
sets, Discrete Comput. Geom. 9 (1993), no. 4, 427–
432.
[14] T. Khoon Lim and C. E. Praeger, On generalised Paley
graphs and their automorphism groups, Michigan
Math. J. (to appear).
[15] V. Klee and S. Wagon, Old and new unsolved prob-
lems in plane geometry and number theory, The
Dolciani Mathematical Expositions. 11. Washing-
ton, DC: Mathematical Association of America.
xv, 333 p., 1991.
[16] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Electron. Notes Discrete Math. 27 (2006), 65–66.
82
[17] A. Kohnert and S. Kurz, A note on Erdös-Diophantine
graphs and Diophantine carpets, Math. Balkanica
(N.S.) 21 (2007), no. 1-2, 1–5.
[18] T. Kreisel and S. Kurz, There are integral heptagons,
no three points on a line, no four on a circle, Dis-
crete Comput. Geom., (to appear).
[19] S. Kurz, Integral point sets over finite fields, (submit-
ted).
[20] S. Kurz, On generating integer heronian triangles,
(submitted).
[21] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[22] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin. (to
appear).
[23] B. D. McKay, Practical graph isomorphism, Congr.
Numer. 30 (1981), 45–87.
[24] S. Niskanen and P. R. J. Östergård, Cliquer user’s
guide, version 1.0, Tech. Report T48, Communica-
tions Laboratory, Helsinki University of Technol-
ogy, Espoo, Finland, 2003.
[25] T. K. Petersen, Polynomials over finite fields whose
values are squares, Rose-Hulman Undergraduate
Mathematics Journal 2 (2001), no. 1, 12 p.
[26] G. F. Royle, An orderly algorithm and some applica-
tions in finite geometry, Discrete Math. 185 (1998),
no. 1-3, 105–115.
[27] J. Solymosi, Note on integral distances, Discrete Com-
put. Geom. 30 (2003), no. 2, 337–342.
[28] D. B. Surowski, Automorphism groups of certain un-
stable graphs, Math. Slovaca 53 (2003), no. 3,
215–232. MR MR2025019 (2004k:05110)
83
84
Chapter 10
Maximal integral point sets over Z2
ANDREY R. ANTONOV1 AND SASCHA KURZ2
ABSTRACT. Geometrical objects with integral side lengths have
fascinated mathematicians through the ages. We call a set P =
{p1, . . . , pn} ⊂ Z2 a maximal integral point set over Z2 if all
pairwise distances are integral and every additional point pn+1 de-
stroys this property. Here we consider such sets for a given cardi-
nality and with minimum possible diameter. We determine some
exact values via exhaustive search and give several constructions
for arbitrary cardinalities. Since we cannot guarantee the maxi-
mality in these cases we describe an algorithm to prove or disprove
the maximality of a given integral point set. We additionally con-
sider restrictions as no three points on a line and no four points on
a circle.
2000 MSC: 52C10; 52C45, 05D99, 11D99, 52-04.
Key words and phrases: integral distances, diameter, exhaustive
search, maximality.
1 Introduction
Geometrical objects with integral side lengths have fasci-
nated mathematicians through the ages. A very early exam-
ple is the Pythagorean triangle with side lengths 3, 4, and
5. A universal framework for most of these objects are in-
tegral point sets. By an integral point set we understand a
set of n points in an m dimensional Euclidean vector space
Em, where the pairwise distances between the points are
integral. Those integral point sets were studied by many au-
thors, see [9] for an overview. From a combinatorial point of
view for a given cardinality n and a given dimension m the
question on the minimum possible diameter d(n,m), this
is the largest distance between any two points, arises, see
[16, 19, 20] for an overview.
To obtain some interesting discrete structures one could
also require some additional properties. One possibility is to
request that besides the distances also the coordinates must
be integral. Another classical possibility is to forbid subsets
1Andrey Radoslavov Antonov, Department of Mathematics, University
of Chemical Technology and Metallurgy - Sofia, Bulgaria.
E-mail adress: andrio@uctm.edu
2Sascha Kurz, Fakultät für Mathematik, Physik und Informatik, Univer-
sität Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
of three points on a line or four points on a circle. The ques-
tion of P. Erdős whether there exists a set of seven points in
the plane with no three points on a line, no four points on
a circle, and pairwise integral distances, has recently been
answered positively, see [14]. If all three mentioned addi-
tional properties are required simultaneously, one speaks of
nm-clusters, see [22]. In this article we request that besides
the distances also the coordinates of the points are integral
and restrict ourselves to dimension 2. Additionally we con-
sider the cases where no three points are on a line or no four
points are on a circle.
In finite geometry one is sometimes interested in point
configurations which are maximal with respect to some
property. This means that it is not possible to add a point
without destroying the requested property. Here we con-
sider integral point sets which are maximal, meaning that
there does not exist an additional point x with integral dis-
tances to the other points of the point set.
1.1 Related work
There have been extensive studies on integral point sets in
Euclidean spaces. Some authors also consider other spaces,
e. g. Banach spaces [6], integral point sets over rings [13],
or integral point sets over finite fields [2, 11, 15]. In [3] the
authors consider integral point sets over Z2 and conjecture
some examples to be maximal. As an answer to their open
problems in [12], the authors describe an algorithm to prove
the maximality of a given integral point set and prove the
conjectures of [3].
1.2 Our contribution
In this paper we describe algorithms to efficiently test in-
tegral point sets for maximality and to determine possible
extension points. To deal with the isomorphism problem we
describe an algorithm which transforms a given plane inte-
gral point set into a normal form in O
(
n2
)
time, where n
is the cardinality of the point set. We give several construc-
tions of integral point sets over Z2 which have a given car-
dinality and fulfill additional conditions, such as that there
are “no three points on a line” or “no four points on a cir-
cle”. Although we cannot prove the maximality of the point
sets obtained with the proposed constructions in general, we
conjecture this property for many of our constructions. By
85
exhaustive search we have determined some exact minimum
diameters of integral point sets over Z2 with given cardinal-
ity and with or without additional conditions. We give con-
structive upper bounds in most cases and conjecture them to
be the exact values.
1.3 Outline of the paper
In Section 3 we state the basic definitions and in Section
2 we describe the basic algorithms to deal with maximal
integral point sets over Z2. These include an algorithm
to exhaustively generate Heronian triangles up to isomor-
phism, an algorithm to determine all possible embeddings
of an Heronian triangle on the integer grid Z2, and an algo-
rithm that determines all points of Z2 which have integral
distances to three given points in Z2 with pairwise integral
distances. The last mentioned algorithm enables us to al-
gorithmically prove or disprove the maximality of a given
integral point set. Since we intend to consider integral point
sets up to isomorphism, we introduce normal forms of in-
tegral point sets and algorithms to obtain them in Section
4. We deal with the key question of maximal integral point
sets over Z2 with given cardinality and minimum diame-
ter in Section 5. Several constructions for maximal integral
point sets, where the maximality is not guaranteed but very
likely, are described in Section 6. In Section 7 we deal with
additional properties as “no three points on a line” and “no
four points on a circle”. We finish with a short conclusion
and an outlook in Section 8.
2 Basics
Definition 2.1 An integral point set over Z2 is a non-
collinear set P of n points in the integer grid Z2, where
the points have pairwise integral distances.
For brevity we only speak of integral point sets and as-
sume that the coordinates of the points are integral numbers,
too.
Definition 2.2 We call an integral point set P over Z2 max-
imal if for every x ∈ Z2\P the point set P ∪ {x} is not an
integral point set.
The existence of maximal integral point sets in the plane
is guaranteed by a famous theorem of N. H.. Anning and
P. Erdős, respectively its proof.
Theorem 2.3 An infinite set P of points in the Euclidean
space Em with pairwise integral distances is situated on a
line. [1, 4]
PROOF. We only prove the statement for dimensionm = 2,
as the generalization is obvious. If A, B, and C are three
points not on a line, we set k = max
{
AC,BC
}
and con-
sider points P such that
∣∣PA− PC∣∣ and ∣∣PB− PC∣∣ are in-
tegral. Due to the triangle inequalities the attained values
are in {0, 1, . . . , k}. Thus the point P lies on the intersec-
tion of two distinct hyperbolas, where we have at most k+1
choices for each hyperbola. Thus there are at most 4(k+1)2
possible locations for the point P. 
This proof can clearly be converted into a constructive al-
gorithm. Given three points A = (x1, y1), B = (x2, y2),
and C = (x3, y3) in P ⊂ Z2, which are not on a line, the
problem of determining points P = (x4, y4) at integral dis-
tance to A, B, and C is reduced to the problem of solving
the equation system∣∣∣∣∣∣
√
∆x21,4 + ∆y
2
1,4 −
√
∆x23,4 + ∆y
2
3,4 = d1√
∆x22,4 + ∆y
2
2,4 −
√
∆x23,4 + ∆y
2
3,4 = d2
∣∣∣∣∣∣ , (1)
where ∆xi,j := xi − xj, ∆yi,j := yi − yj, d1 ∈{
−AC, . . . , AC
}
⊂ Z, and d2 ∈
{
−BC, . . . , BC
}
⊂ Z.
If there exists no integral solution in Z2\P, then the point
set P is maximal. This algorithm was already used in [12]
to prove the maximality of the two integral point sets of Fig-
ure 1.
z(0,−4)
z(−3, 0) z(0, 0) z(3, 0)
z(0, 4)





S
S
S
S
S
S
S
S
S
S





z
(0, 12)
z(9, 0) z(16, 0)
z(9, 24) z(16, 24)
z(25, 12)





S
S
S
S
S
S
S
S
S
S
S
S
S
S
















Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z









Figure 1: Examples of maximal integral point sets.
Since this algorithm is essential for our article we will go
into the details how to solve Equation System (1). To get rid
of some of the square roots we add w :=
√
∆x23,4 + ∆y
2
3,4
on both sides and square the expressions afterwards:
∆x21,4 + ∆y
2
1,4 = d
2
1 + 2d1 ·w+ ∆x23,4 + ∆y23,4
∆x22,4 + ∆y
2
2,4 = d
2
2 + 2d2 ·w+ ∆x23,4 + ∆y23,4
Rearranging yields∣∣∣∣ x21+y21−x23−y23−d21+2x4∆x3,1+2y4∆y3,1 = 2d1wx22+y22−x23−y33−d22+2x4∆x3,2+2y4∆y3,2 = 2d2w
∣∣∣∣ .
(2)
86
If d1 = 0 then the first equation corresponds to a linear
equation
c1x4 + c2y4 + c3 = 0, (3)
where not both c1 and c2 are equal to zero, since A 6= C. If
we square the second equation of (2) we can substitute one
variable using Equation (3) and obtain a quadratic equation
in one variable, which can be easily solved. The case where
d2 = 0 is similar. Here we use the second equation of (2)
to obtain Equation (3) (we have c1 6= 0 or c2 6= 0 due to
B 6= C), and substitute it into the squared version of the first
equation to obtain the quadratic equation in one variable. In
the remaining case we have d1, d2 6= 0. Here we subtract
d1 times the second equation of (2) from d2 times the first
equation of (2) to obtain Equation (3) (we have c1 6= 0 or
c2 6= 0 since the points A, B, and C are not located on a
line). Now we can square one of the two equations of (2)
and subsitute one variables using Equation (3). Again we
end up with a quadratic equation in one variable. At the
end we have to check if the obtained values (x4, y4) are
solutions of the original Equation System (1).
Definition 2.4 For an integral point set P its diameter
diam(P) is given by the largest distance between a pair of
its points.
We remark that the upper integral point set of Figure 1 has
diameter 8 and the lower integral point set of Figure 1 has
diameter 25.
3 Exhaustive generation of maximal
integral point sets
To obtain interesting examples of maximal integral point
sets we utilize computers to exhaustively generate maxi-
mal integral point sets. In the following we will describe
the algorithm used. For a given diameter d we loop over
all non-isomorphic Heronian triangles (having integral side
lengths and integral area) ∆ = (a, b, c) with diameter
d = max{a, b, c}. Utilizing the Heron formula
A =
√
(a+ b+ c)(a+ b− c)(a− b+ c)(−a+ b+ c)
4
for the area of a triangle we can generate this list e. g. by the
following short algorithm:
Algorithm 3.1 (Generation of Heronian triangles)
input: diameter d
output: complete list of Heronian triangles with diameter d
up to isomorphism
begin
a = d
for b =
⌊
a+2
2
⌋
, . . . , a do
for c = a+ 1− b, . . . , b do
if
√
(a+b+c)(a+b−c)(a−b+c)(−a+b+c)
4 ∈ Z then
output (a, b, c)
end
For a more sophisticated and efficient algorithm we refer
to [18]. The next step is to embed a given Heronian triangle
∆ = (a, b, c) in the plane integer grid Z2. Here we can
utilize two conjectures, which are theorems for dimension
m = 2, see e. g. [5].
Conjecture 3.2 Let P ⊂ Qm be a finite set of points such
that the distances between any two points of P are integers.
In this case one can find an Euclidean motion T such that
T (P) ⊂ Pm.
Conjecture 3.3 Let P ⊂ Zm be a finite set of points such
that the distances between any two points of P are integers
and divisible by an integer k. In this case one can find a set
P ′ ⊂ Zm such that P ′ · k (the set P ′ scaled by a factor k) is
congruent to P.
Since Conjecture 3.2 is a well known theorem for dimen-
sion m = 2, see e. g. [5], for every Heronian triangle
∆(a, b, c) there exists an embedding in the plane integer
grid Z2. We remark that there may be several embeddings
for the same triangle ∆ = (a, b, c), which lead to differ-
ent results. If we consider the number of points (x4, y4) ∈
Z2\E which are at integral distance to an embedded trian-
gle E = {(x1, y1) , (x2, y2) , (x3, y3)}, we can distinguish
three different embeddings of the Heronian triangle ∆1 =
(25, 20, 15). The embedding E1 = {(0, 0), (0, 25), (12, 16)}
of ∆1 yields 12 points (x4, y4) at integral distance to the
corners of ∆1 given by E1. For the embedding E2 =
{(0, 0), (15, 20), (0, 20)} we obtain 16 such points, and for
the embedding E3 = {(0, 0), (7, 24), (16, 12)} we obtain
only 5 such points. Determining the possible embeddings of
a given Heronian triangle ∆ = (a, b, c) is a rather easy task.
W.l.o.g. we assume a = max{a, b, c} and x2 = 0 = y2.
Since the point (x3, y3) is at distance a to the point (x2, y2),
we have to solve the Diophantine equation
x23 + y
2
3 = a
2
in integers. This is a well known problem. One might even
store for each small number (e. g. a 6 10 000) a ∈ N a
list of the corresponding solutions (x3, y3). Now the coor-
dinates of the remaining point A are given as solutions of
the equation system∣∣∣∣ (x2 − x1)2 + (y2 − y1)2 = c2(x3 − x1)2 + (y2 − y1)2 = b2
∣∣∣∣ , (4)
which can be easily solved. As an algorithm for the embed-
ding of an Heronian triangle in Z2 we obtain:
Algorithm 3.4 (Embedding of an Heronian Triangle)
input: Heronian Triangle ∆ = (a, b, c)
output: complete list of different embeddings of ∆ in Z2
begin
x2 = 0,y2 = 0
loop over the integer solutions (x3, y3) of
x23 + y
2
3 = a
2 do
loop over the integer solutions (x1, y1) of
Equation System (4) do
output
{
(x1, y1) , (x2, y2) , (x3, y3)
}
end
87
The next step is to determine the points (x4, y4) ∈ Z2
which are at integral distance to a given embedded triangle{
(x1, y1) , (x2, y2) , (x3, y3)
}
:
Algorithm 3.5 (Enlargement of an embedded triangle)
input: Embedded triangle
E =
{
(x1, y1) , (x2, y2) , (x3, y3)
}
⊂ Z2
output: complete list of points (x4, y4) ∈ Z2\E which are
at integral distance to E
begin
loop over the integer solutions (x4, y4) of Equation
System (1) do
if (x4, y4) /∈ E then
output (x4, y4)
end
We remark that the previous algorithms have to be imple-
mented using an arithmetic which is able to do integer cal-
culations with unlimited precision, since the occurring num-
bers can increase very quickly. We have utilized the soft-
ware package CLN [8] for this purpose.
Now we utilize the set of points given by Algorithm
3.5 to build up a graph G (E). The vertices are given
by the possible points (x4, y4). Two points (x4, y4)
and (x ′4, y
′
4) are connected by an edge if and only if√(
x4 − x
′
4
)2
+
(
y4 − y
′
4
)2 is an integer. A complete sub-
graph of G (E) is called a clique. A clique C1 is called max-
imal if it is not properly contained in another clique C2 of
G (E). Clearly the cliques of G (E) are in bijection to inte-
gral point sets P ⊂ Z2 containing E as a subset. The same
statement holds for maximal cliques of G (E) and maximal
integral point sets P ⊂ Z2 containing E as a subset. Thus
we can use a clique-search package as CLIQUER [21] to ex-
haustively generate maximal integral point sets M over Z2.
Let us consider an example. If we apply our algorithm on
the embedded triangle
E2 =
{
(0, 0), (15, 20), (0, 20)
}
with diameter 25, we obtain a set{
(0, 28), (0, 40), (0, 56), (0, 132), (0,−92), (0,−16),
(0, 12), (−15, 20), (15, 0), (−21, 20), (105,−36),
(21, 20), (−48, 20), (48, 20), (−99, 20)
}
of 16 possible points to enlarge the integral point set E2.
The clique-search program CLIQUER determines five maxi-
mal cliques which correspond to the following five maximal
integral point sets:
M1 =
{
(0, 0), (15, 20), (0, 20), (15, 0)
}
,
M2 =
{
(0, 0), (15, 20), (0, 20), (0,−92), (105,−36)
}
,
M3 =
{
(0, 0), (15, 20), (0, 20), (0, 40), (0, 56),
(0,−16), (−15, 20), (−48, 20), (48, 20)
}
,
M4 =
{
(0, 0), (15, 20), (0, 20), (0, 40), (−15, 20),
(−21, 20), (21, 20), (−48, 20), (48, 20),
(−99, 20), (99, 20)
}
, and
M5 =
{
(0, 0), (15, 20), (0, 20), (0, 28), (0, 40), (0, 56),
(0, 132), (0,−92), (0,−16), (0, 12), (−15, 20)
}
.
It is interesting to have a look at the cardinalities and di-
ameters of these maximal integral point sets. We have
|M1| = 4, diam (M1) = 25, |M2| = 5, diam (M2) = 119,
|M3| = 9, diam (M3) = 96, |M4| = 11, diam (M1) = 198,
|M5| = 11, and diam (M5) = 224. Although we start with
a point set E2 of small diameter, the resulting maximal in-
tegral point sets Mi may have a large diameter. We are
not aware of a formula to bound diam (M) with respect to
diam (E). A second somewhat disappointing fact of our al-
gorithm is, that each subset E ′ of three non-collinear points
of an maximal integral point set M produces M. Thus our
algorithm produces many identical copies of maximal inte-
gral point sets with large cardinality. We will deal with this
fact and the isomorphism problem in the next section.
The algorithms described in this section focus on the max-
imality of the integral point sets. They should not be used
to exhaustively generate all maximal integral point sets up
to a given diameter. To perform this task the algorithms to
exhaustively generate integral point sets with or without ad-
ditional properties are better suited, see [16, 20], and ignore
the maximality condition in the first run. All integral point
sets with required cardinalities and small diameters can then
be tested if they are maximal.
4 Normal forms and automorphisms
for integral point sets over Z2
In this section we aim to consider isomorphisms which pre-
serve certain properties of maximal integral point sets. Since
a main property of an integral point set is the set of distances
between its points, we only consider distance-preserving
isomorphisms, so called isometries. In the Euclidean plane
the isometries are given by compositions of translations
Tu,v :
(
x
y
)
7→
(
x
y
)
+
(
u
v
)
, rotations Rθ :
(
x
y
)
7→(
cos θ − sin θ
sin θ cos θ
)
·
(
x
y
)
, and reflections at one of the two
axes. Each isometry can be written as It,O : x 7→ t+O · x,
where t ∈ R2 is a translation vector and O ∈ R2×2 an
orthogonal matrix. Next we restrict ourselves to mappings
which map integral coordinates onto integral coordinates.
Thus we have t ∈ Z2 and O ∈ Z2×2. Each such isome-
try It,O maps integral point sets onto integral point sets. It
is easy to figure out that there are only 8 orthogonal matrices
88
in Z2×2. So we define
Aut :=
{
It,O : t ∈ Z2, O ∈
{(
±1 0
0 ±1
)
,(
±1 0
0 ∓1
)
,
(
0 ±1
±1 0
)
,
(
0 ±1
∓1 0
)}}
as the automorphism group of plane integral point sets.
We call two integral point sets P and P ′ isomorphic, if
there exists a mapping It,O ∈ Aut such that It,O (P) =
P ′. So our aim is to develop an algorithm which can check
whether two given integral point sets are isomorphic. For
this purpose we want to use the technique of normal forms
of discrete objects. This means that we have a function τ
which fulfills the following: If O is the orbit of an integral
point set P under the group Aut then τ (P) = τ (P ′) for each
P ′ ∈ O. Additionally for two integral point sets of different
orbits the function τ should have different images. Having
such a function τ at hand we can easily decide whether two
integral point sets P and P ′ are isomorphic, by checking
whether τ (P) = τ (P ′) or not.
In order to describe such a function τ we need to define a
total ordering  on Z2:
(1) if |a| < |c|, then we set
(
a
b
)
≺
(
c
d
)
,
(2) if a > 0, then we set
(
−a
b
)
≺
(
a
d
)
,
(3) if |b| < |d|, then we set
(
a
b
)
≺
(
a
d
)
, and
(4) if b > 0, then we set
(
a
−b
)
≺
(
a
b
)
for all a, b, c, d ∈ Z. We set
(
a
b
)
=
(
c
d
)
if and only if we
have a = c and b = d. By x1  x2 we mean x1 ≺ x2 or
x1 = x2. One of the properties of this total ordering  is,
that we have
(
0
0
)
 x for all x ∈ Z2, so
(
0
0
)
 x is the
smallest element in Z2. Using ≺ we can bijectively identify
an integral point set P with a list L (P) of its points, which is
sorted in ascending order with respect to . Now we extend
our total ordering  onto such lists by utilizing the lexico-
graphic ordering. This allows us to define our normalization
function by
τ (P) = min

{
L (σ (P)) : σ ∈ Aut
}
.
To obtain a finite algorithm for the determination of τ (P)
we use the fact, that for every point set P 6= ∅ the minimum
list-representation L (σ (P)) starts with
(
0
0
)
:
Algorithm 4.1 (Normalization of an integral point set)
input: integral point set P = {p1, . . . , pn}
output: minimum list representation τ (P)
begin
champion = L (P)
M1 =
(
1 0
0 1
)
,M2 =
(
1 0
0 −1
)
,
M3 =
(
−1 0
0 1
)
,M4 =
(
−1 0
0 −1
)
,
M5 =
(
0 1
1 0
)
,M6 =
(
0 1
−1 0
)
,
M7 =
(
0 −1
1 0
)
,M8 =
(
0 −1
−1 0
)
for i = 1, . . . , n do
for j = 1, . . . , 8 do
tmp = L
(
Mj · {p1 − pi, . . . , pn − pi}
)
if tmp ≺ champion then
champion = tmp
return champion
end
We remark that Algorithm 4.1 runs in O
(
n2
)
time. As an
example we consider the two integral point sets from Figure
1. Their normal forms or minimum list representations are
given by [(
0
0
)
,
(
0
−3
)
,
(
0
3
)
,
(
−4
0
)
,
(
4
0
)]
and[(
0
0
)
,
(
0
−7
)
,
(
−12
9
)
,
(
−12
−16
)
,
(
−24
0
)
,
(
−24
−7
)]
,
respectively.
For a given integral point set P there may exist rotation
matrices M ∈ R2×2, such that M (P) has integral coordi-
nates, which are different from the eight orthogonal matrices
in Z2×2. But for these matrices there is no guarantee for a
proper extension E ⊃ P, which is also an integral point set
over Z2, such that M (E) has integral coordinates. Exam-
ples are given by the sets E1, E2, E3 in Section 3. This
means that for a given maximal integral point set M over Z2
there can exist an orthogonal matrix M ∈ R2×2, such that
M (M) is also an integral point set over Z2, but which is not
maximal.
We may call a maximal integral point set M over Z2
strongly maximal, if such a matrix M does not exist. To
check whether a given integral point set P is strongly max-
imal, we only have to consider all possible embeddings of
P in Z2, which are finitely many. Another possibility is to
slightly alter Algorithm 3.5 by looping over the rational (in-
stead of integral) solutions (x4, y4) of Equation System (1).
Now the algorithm leads to point sets with integral distances
and rational coordinates. But due to Conjecture 3.2 (which
is a theorem for dimension m = 2), there exist embeddings
with integral coordinates.
To clear the situation with integral and rational coordi-
nates we will have to give some facts from the general theory
of integral point sets (without integral coordinates). So, let
P be a set of points in the m-dimensional Euclidean space
Em with pairwise integral distances. By S ⊆ P we denote
an integral simplex, which is a set of m + 1 points, and by
volm (S) we denote the m-dimensional volume spanned by
89
the m + 1 points. Since the pairwise distances are integral
we can write volm (S) = q · k with q ∈ Q and k being a
square free integer. If volm (S) 6= 0 the square free integer
k is unique and we set char (S) = k, which we call the char-
acteristic of S. Using this notation we can cite two results
from [17]:
Theorem 4.2 In an m-dimensional integral point set P all
simplices S = {v0, v1, . . . , vm} with volm (S) 6= 0 have the
same characteristic char (S) = k.
So we can speak of the characteristic char (P) of an inte-
gral point set P.
Lemma 4.3 An integral m-dimensional simplex S =
{v ′0, v
′
1, . . . , v
′
m} with distance matrix D = (di,j) ∈ N for
0 6 i, j 6 m and volm (S) 6= 0 can be transformed via an
isometry into the coordinates
v0 = (0, 0, . . . , 0),
v1 =
(
q1,1
√
k1, 0, 0 . . . , 0
)
,
v2 =
(
q2,1
√
k1, q2,2
√
k2, 0, . . . , 0
)
,
...
vm =
(
qm,1
√
k1, qm,2
√
k2, . . . , qm,m
√
km
)
,
where ki is the squarefree part of
voli(v′0,v′1,...,v′i)2
voli−1(v′0,v′1,...,v′i−1)
2 ,
qi,j ∈ Q, and qj,j, kj 6= 0.
We remark that we always have k1 = 1. The connection
between the ki and the characteristic char (P) = k is given
by
char (P) = char (S) = k = square free part of
m∏
i=1
ki.
Thus plane integral point sets P with rational coordinates
are exactly those with characteristic char (P) = 1. Due to
Conjecture 3.2 plane integral point sets over Z2 correspond
to plane integral point sets with characteristic 1. So in prin-
ciple there is no need to care about the coordinates – this can
still be done afterwards.
There is one further transformation that maps integral
point sets over Z2 onto integral point sets over Z2: scal-
ing by an integral factor λ. One handicap of this map-
ping is that the inverse mapping may lead to non-integral
point sets. Another shortcoming is that maximal integral
point sets may be mapped onto non-maximal integral point
sets. An example is given by the maximal integral point
set P =
{(
0
0
)
,
(
3
0
)
,
(
0
4
)
,
(
3
4
)}
. If we scale it by a
factor of 2 we obtain 2 · P =
{(
0
0
)
,
(
6
0
)
,
(
0
8
)
,
(
6
8
)}
an integral point set over Z2 which can be extended by the
point
(
3
4
)
. In contrast to this example the integral point
set 3 · P =
{(
0
0
)
,
(
9
0
)
,
(
0
12
)
,
(
9
12
)}
is maximal. One
might conjecture that for every maximal integral point set M
there exists an integer λ > 1 such that λ ·M is also maximal.
5 Maximal integral point sets with
given cardinality and minimum di-
ameter
From the combinatorial point of view a natural question is to
ask for the minimum possible diameter dM(k,m) of a max-
imal integral point set M ⊂ Zm of cardinality k. If such a
point set does not exist we set dM(k,m) = ∞. Utilizing
the exhaustive algorithm described in Section 3 we have ob-
tained the results given in Table 1.
k dM(k, 2) corresponding point set
4 5 {(0, 0), (3, 4), (0, 4), (3, 0)}
5 8 {(0, 0), (3, 4), (0, 4), (0, 8), (−3, 4)}
{(0, 0), (12, 16), (12, 9), (−12, 9),
6 25 (−12, 16), (0, 25)}
{(0, 0), (6, 8), (0, 8), (0, 16),
7 30 (−6, 8), (−15, 8), (15, 8)}
{(0, 0), (15, 36), (0, 16), (15,−20),
8 65 (48,−20), (48, 36), (63, 0), (63, 16)}
{(0, 0), (15, 20), (0, 20), (0, 40), (0, 56),
9 96 (0,−16), (−15, 20), (−48, 20), (48, 20)}
{(0, 0), (22, 120), (0, 120), (−27, 120),
(160, 120), (182, 0), (182, 120),
10 6 600 (−209, 120), (209, 120), (391, 120)}
{(0, 0), (5, 12), (0, 12), (0, 24), (−5, 12),
(−9, 12), (9, 12), (−16, 12), (16, 12),
11 70 (−35, 12), (35, 12)}
Table 1: Minimum possible diameters of maximal plane in-
tegral point sets with given cardinality.
Clearly we have dM(1, 2) = dM(2, 2) = ∞ since a line
l through two different points P1 and P2 with integral co-
ordinates and integral distance P1P2 contains an infinite in-
tegral point set P = {P1 + λ · (P2 − P1) : λ ∈ Z} as a sub-
set. So the next value to determine is dM(3, 2). Whether
dM(3, 2) is finite had been an open question of [3], which
was answered in [12] by determining dM(3, 2) = 2066, –
a diameter out of reach for our general exhaustive algorithm
described in Section 3. But it can be easily adapted for this
purpose. We alter Algorithm 3.1 by omitting right-angled
triangles, since these obviously are not maximal. Then we
skip Algorithm 3.4 and directly run the version of Algorithm
3.5 where we search for rational instead of integral solutions
(x4, y4) of Equation System (1). If we have found the first
solution (x4, y4) for a given triangle ∆ we can immediately
stop our investigations on ∆ since it cannot be a maximal
integral triangle. Using these reductions and skipping the
time consuming clique search we were able to exhaustively
search for (strongly) maximal integral triangles over Z2 with
90
diameter at most 15000 [12, 18]. There are exactly 126 such
examples. Here we list the first, with respect to their diam-
eter, ten examples, where we give the edge lengths and the
coordinates in minimal list representation, which is unique
in these cases:
{2066,1803,505}
[
(0, 0)T,(−336,−377)T,(384,−2030)T
]
{2549,2307,1492}
[
(0, 0)T,(−700,−2451)T,(1100,−1008)T
]
{3796,2787,2165}
[
(0, 0)T,(−387,−2760)T,(1680,−3404)T
]
{4083,2425,1706}
[
(0, 0)T,(−410,−1656)T,(1273, 2064)T
]
{4426,2807,1745}
[
(0, 0)T,(−280,−2793)T,(376,−4410)T
]
{4801,2593,2210}
[
(0, 0)T,(−1488,−1634)T,(1632, 2015)T
]
{4920,4177,985}
[
(0, 0)T,(−473,−864)T,(4015, 1152)T
]
{5044,4443,2045}
[
(0, 0)T,(−1204,−1653)T,(2156,−4560)T
]
{5045,4803,244}
[
(0, 0)T,(−44,−240)T,(240, 4797)T
]
{5186,5163,745}
[
(0, 0)T,(−407,−624)T,(4030,−3264)T
]
6 Constructions for maximal integral
point sets over Z2
In this section we want to describe constructions for maxi-
mal integral point sets M of a given cardinality or a given
shape. In most cases our constructions do not lead to inte-
gral point sets which are maximal in every case, but which
yield candidates, which are very likely to be maximal (from
an empiric point of view). W.l.o.g. we can assume that the
origin (0, 0)T is always contained in M. Every further point
(a, b)T meets a2 + b2 = c2. In this case we call (a, b) a
Pythagorean pair or (a, b, c) a Pythagorean triple. If addi-
tionally gcd (a, b) = gcd (a, b, c) = 1 we speak of primi-
tive pairs or triples. Given only one Pythagorean pair (a, b)
we can perform the following two constructions for integral
point sets over Z2:
Construction 6.1 If (a, b) is a Pythagorean pair, then
P1(a, b) :=
{(
0
0
)
,
(
a
0
)
,
(
0
b
)
,
(
a
b
)}
is an integral
point set of cardinality 4.
Construction 6.2 If (a, b) is a Pythagorean pair, then
P2(a, b) :=
{(
0
0
)
,
(
a
0
)
,
(
−a
0
)
,
(
0
b
)
,
(
0
−b
)}
is an
integral point set of cardinality 5.
We call Construction 6.1 the rectangle construction
of (a, b) and Construction 6.2 the rhombus construction
of (a, b). If we choose (a, b) with 2|a, 2|b then clearly
P1(a, b) cannot be maximal. On the other side P1(9, 12)
is a maximal integral point set although gcd(9, 12) = 3.
Empirically, we have observed that for primitive pairs
(a, b) the point set P1(a, b) is maximal in many, but not
all cases, see e. g. the non maximal integral point set
P1(7, 24), which can be extended to the maximal integral
point set
{(
0
0
)
,
(
7
0
)
,
(
0
24
)
,
(
7
24
)
,
(
−9
12
)
,
(
16
12
)}
.
For (a, b) = (3, 4) both constructions P1(a, b) and
P2(a, b) yield maximal integral point sets. Empir-
ically Construction 6.2 is a bit weaker, since it of-
ten happens that P1(a, b) is maximal but P2(a, b)
is not, as for example for (a, b) = (5, 12). For
the other direction we have no example. We would
like to mention that P2(5, 12) can be extended to
the very interesting maximal integral point set M ={(
0
0
)
,
(
5
0
)
,
(
0
12
)
,
(
0
−12
)
,
(
−5
0
)
,
(
9
0
)
,
(
−9
0
)
,(
16
0
)
,
(
−16
0
)
,
(
35
0
)
,
(
−35
0
)}
, which has an intrigu-
ing geometrical structure, see Figure 2.
t t
t
t
t tt tt tt
Figure 2: Extension of P2(5, 12) to a crab of cardinality 11.
Definition 6.3 For positive integers a, b1, . . . , bk we call
the point set
crab (a,b1,. . . ,bk) :=
{(
0
0
)
,
(
0
±a
)
,
(
±b1
0
)
, . . . ,
(
±bk
0
)}
a crab of order k.
We remark that the cardinality of crab (a, b1, . . . , bk)
is given by 2k + 3 and that the point set is symmetric
w.r.t. the two coordinate axes. This point set is indeed
integral if the pairs (a, b1) , . . . , (a, bk) are Pythagorean
pairs. So it is very easy to construct crabs, either di-
rectly or by extending P2(a, b), see Subsection 6.1.
Empirically the extension points of P2(a, b) very of-
ten lie on one of the two axes. An example that this
must not be the case in general is given by the primitive
pair (1480, 969), where P2(1480, 969) can be extended to{(
0
0
)
,
(
1480
0
)
,
(
−1480
0
)
,
(
0
969
)
,
(
0
−969
)
,
(
1040
462
)
,(
1040
−462
)
,
(
−1040
462
)
,
(
−1040
−462
)}
.
6.1 Construction of crabs
Since many maximal integral point sets over Z2 are crabs we
are interested in a method to construct them directly. From
the general theory of integral point sets we know that inte-
gral point sets P over R2 with minimum diameter consist
91
of point sets with n − 1 collinear points, see Figure 3, for
9 6 n 6 122 points, see [16, 20]. For these point sets there
is an interesting connection between the points of the point
set P and divisors of a certain number D, see [16, 20].
Definition 6.4 The decomposition number D of an integral
triangle with side lengths a, b, and c is given by
D =
(a+ b+ c)(a+ b− c)(a− b+ c)(−a+ b+ c)
gcd (b2 − c2 + a2, 2a)2
.
#
#
#
#
#
#
#
#
#
#
 
 
 
 
 
 
 
 
















C
C
C
C
C
C
C
C
A
A
A
A
A
A
A
A
@
@
@
@
@
@
@
@
u u u u u u u
u
a3 a2 a1
q q ′
h
a0 a
′
1 a
′
2
b3
b2 b1 b0 b
′
0 b
′
1
b ′2
Figure 3: Plane integral point set P with n − 1 points on a
line.
Lemma 6.5 (Decomposition lemma)
The distances of a plane integral point set P consisting of n
points where a subset of n−1 points is collinear correspond
to decompositions of the decomposition number D of the
largest triangle of P into two factors.
PROOF. We use the notation of Figure 3 and set
ci = q+
i∑
j=1
aj for 0 6 i 6 s,
c ′i = q
′ +
i∑
j=1
a ′j for 0 6 i 6 t.
Pythagoras’ Theorem yields c2i+1 + h
2 = b2i+1 and c
2
i +
h2 = b2i for 0 6 i < s. We subtract these equations from
each other and get
a2i+1 + 2ai+1
i∑
j=1
aj + 2ai+1q = b
2
i+1 − b
2
i .
Because the ai and the bi are positive integers we
have 2ai+1q ∈ N for 0 6 i < s and there-
fore 2 gcd (a1, a2, . . . , as)q ∈ N. From q + q ′ =
a0 ∈ N we conclude 2 gcd (a1, a2, . . . , as)q ′ ∈
N. With an analogous conclusion for the c ′i and
g = 2 gcd (a1, . . . , as, a ′1, . . . , a
′
t) we get gq ∈
N and gq ′ ∈ N. A last use of Pythagoras’ Theorem
yields for 1 6 i 6 s and for 1 6 j 6 t the factorization
of g2h2 into a product of two positive integers,
g2h2 = (gbi + gci) (gbi − gci)
=
(
gb ′j + gc
′
j
) (
gb ′j − gc
′
j
)
.
So we can obtain the possible values for ci and c ′i by de-
composing g2h2 into two factors.
If we are given the three side lengths a, b, and c of an
integral triangle and want to determine the points on the side
of length a so that the resulting point set is integral, then we
can associate b with bs, c with b ′t, and a with
∑s
i=1 ai +
a0 +
∑t
i=1 a
′
i. With this we have
cs = q+
s∑
j=1
aj =
b2 − c2 + a2
2a
.
Because g can also be defined as the smallest integer with
gcs ∈ N we receive
g =
2a
gcd (b2 − c2 + a2, 2a)
.
Due to the Heron formula 16A2∆ = (a + b + c)(a + b −
c)(a− b+ c)(−a+ b+ c) and the formula for the area of
a triangle 2A∆ = ah we finally get
g2h2 =
g2(a+b+c)(a+b−c)(a−b+c)(−a+b+c)
4a2
=
=
(a+b+c)(a+b−c)(a−b+c)(−a+b+c)
gcd (b2−c2+a2, 2a)2
= D .

If we choose g = 1 and h ∈ N we can directly
apply Lemma 6.5 to construct crabs. Let us look at an
example. We choose g = 1 and h = 2 · 3 · 5 = 30.
The divisors of D = g2h2 = 900 are given by
{1, 2, 3, 4, 5, 6, 9, 10, 12, 15, 18, 20, 25, 30, 36, 45, 50, 60, 75,
90, 100, 150, 180, 225, 300, 450, 900}. If we have D =
f1 · f2, then b = f1+f22 and c =
f1−f2
2 . Thus we must have
f1 > f2 and f1 ≡ f2 (mod 2) to determine the values bi
of a corresponding crab. Here we have b1 = 50−182 = 16,
b2 =
90−10
2 = 40, b3 =
150−6
2 = 72, b4 =
450−2
2 = 224,
and a = h = 30. This yields the integral point set
crab(30, 16, 40, 72, 224) of cardinality 2 ·4+3 = 11 and di-
ameter max
{
2bi, 2a,
√
b2i + a
2
}
= 2·max {bi, a} = 448.
Given the prime factorization h =
∏r
i=1 p
αi
i it is not dif-
ficult to determine the k-value of the resulting crab. Let us
fix p1 = 2 and set α̃1 = max (α1 − 1, 0). With this we can
state
k =
(2α̃1 + 1) ·
∏r
i=2 (2αi + 1) − 1
2
. (5)
Using h = pk, where p is an arbitrary odd prime, we are
able to produce a crab of order k for each k > 1. Thus
we have constructions for integral point sets of cardinality
2k+3 for each k ∈ N. To obtain small point sets with many
points we should clearly choose integers with many divisors
for h instead. As for all of our constructions the maximality
of the resulting integral point set is not guaranteed, but very
likely.
Construction 6.6 For a given integer h there exists an in-
tegral point set decompose(h) which is a crab of order k,
where k is given by Equation (5).
92
If h > 4 then the diameter of decompose(h) is given by
h2 − 1 if h is odd and given by h
2
2 − 2 if h is even.
Conjecture 6.7 For each integer h the plane integral point
set P = decompose(h) is maximal if |P| > 7.
Also, the recognition of a crab is a very easy task. Given
an integral point set P over Z2 one can easily check whether
a subset L ⊂ P of n− 2 points is collinear by using:
Lemma 6.8 Three points (x1, y1), (x2, y2), and (x3, y3)
in R2 are collinear if and only if we have∣∣∣∣∣∣
x1 y1 1
x2 y2 1
x3 y3 1
∣∣∣∣∣∣ = 0.
Additionally the lines through L and P\L are perpendicular.
If the point set is symmetric to these two lines then P is a
crab.
Crabs are very dominating examples of maximal integral
point sets over Z2. For the study of maximal integral point
sets over Z3 one might try to generalize the construction of
a crab. Let us remark in this context, that the existence of an
integral point set with coordinates
00
0
 ,
x0
0
 ,
0y
0
 ,
00
z
 ,
where x, y, z ∈ Z is equivalent to a famous open problem,
the existence of a perfect box, see [7, Problem D18].
So far we have only used g = 1 in Lemma 6.5. Now we
want to have a look at the case g > 1. So given integers g ·h
and g we can apply Lemma 6.5. For two factors f1 > f2
with f1 · f2 = g2h2 we have
gbi =
f1 + f2
2
and gci =
f1 − f2
2
.
The values gbi and gci are integers if and only if we have
f1 ≡ f2 (mod 2). Since not only the gbi’s but also the bi’s
must be integers we have to require f1 + f2 ≡ 0 (mod g).
Let us have an example. We choose gh = 672 = 25 ·3·7 and
g = 5. Now we look at the divisors of g2h2 = 451584 =
210 ·33 ·72 and determine the suitable pairs (f1, f2) fulfilling
f1 · f2 = g2h2, f1 > f2, f1 ≡ f2 (mod 2),
and f1 + f2 ≡ 0 (mod 5),{
(784, 576), (896, 504), (1176, 384), (1344, 336),
(1536, 294), (1764, 256), (2016, 224), (2304, 196),
(3136, 144), (3584, 126), (4704, 96), (5376, 84),
(7056, 64), (8064, 56), (12544, 36), (18816, 24),
(28224, 16), (32256, 14), (75264, 6), (112896, 4)
}
.
The corresponding values bi are given by{
136, 140, 156, 168, 183, 202, 224, 250, 328, 371, 480,
546, 712, 812, 1258, 1884, 2824, 3227, 7527, 11290
}
and the corresponding values gci are given by
C =
{
104, 196, 396, 504, 621, 754, 896, 1054, 1496,
1729, 2304, 2646, 3496, 4004, 6254, 9396, 14104,
16121, 37629, 56446
}
.
Clearly the ci cannot be integers unless h is an integer. So
let us consider the points on the left of the base point F of
the height h. They correspond to values gci which all fulfill
gci ≡ m (mod g), for a fixed m ∈ {1, . . . , g − 1}. The
points on the right hand side of F correspond to the values
gci fulfilling gci ≡ −m (mod g). So let us choosem = 1.
Since all elements of our candidate set C are congruent to
±1 modulo 5 we obtain an integral point set of cardinality
|C| + 1 = 21:
P =
{(
0
672
5
)
,
(
−196
5
0
)
,
(
−396
5
0
)
,
(
−621
5
0
)
,
(
−896
5
0
)
,(
−1496
5
0
)
,
(
−2646
5
0
)
,
(
−3496
5
0
)
,
(
−9396
5
0
)
,
(
−16121
5
0
)
,(
−56446
5
0
)
,
(
104
5
0
)
,
(
504
5
0
)
,
(
754
5
0
)
,
(
1054
5
0
)
,
(
1729
5
0
)
,(
2304
5
0
)
,
(
4004
5
0
)
,
(
6254
5
0
)
,
(
14104
5
0
)
,
(
37629
5
0
)}
After a suitable transformation and applying Algorithm
4.1 we obtain the minimum coordinate representation[(
0
0
)
,
(
0
−168
)
,
(
−40
30
)
,
(
64
−48
)
,
(
−88
66
)
,
(
112
−84
)
,(
144
−108
)
,
(
180
−135
)
,
(
−196
147
)
,
(
224
−168
)
,
(
−288
216
)
,(
320
−240
)
,
(
504
−378
)
,
(
−560
420
)
,
(
640
−480
)
,
(
−920
690
)
,(
1584
−1188
)
,
(
−2176
1632
)
,
(
2660
−1995
)
,
(
−5940
4455
)
,
(
9112
−6834
)]
.
We call point sets arising from Lemma 6.5, where g > 1
and h /∈ N semi-crabs, see Figure 4 for a drawing of our
example.
Definition 6.9 For positive integers g, h̃ and non-zero inte-
gers b̃1, . . . , b̃k we call the point set
semi-crab
(
g,h̃,b̃1, . . . ,b̃k
)
:=
{(
0
h
g
)
,
(
b̃1
g
0
)
, . . . ,
(
b̃k
g
0
)}
a semi-crab of order k.
Construction 6.10 For given positive integers g and gh,
where h /∈ N, there exists an integral point set
decompose(g, gh) which is isomorphic to a semi-crab.
Conjecture 6.11 For each pair of integers gh, g the plane
integral point set P = decompose(gh, g) is maximal if |P| >
7.
93
rrrrr rr rrr rr r
r
r
r
r
Figure 4: A semi-crab of cardinality 21 and diameter 18815.
Since Construction 6.6 can only produce integral point
sets of odd cardinality, Construction 6.10 is a convenient
completion. It is not difficult to implement an algorithm that
exhaustively generates crabs and semi-crabs up to a given
diameter by utilizing Lemma 6.5.
Let us have a look at the possible values for g > 1. If
we would choose g = 2 then due to 2 - g2h2 all divisors
of g2h2 would be odd and we would havem ≡ 1 (mod 2),
which is not possible. Thus 2 - g. For g = 3 the only
possibility for f1 + f2 ≡ 0 (mod 3) is f1 ≡ 1 (mod 3)
and f2 ≡ 2 (mod 3), which is not possible since 1 · 2 ≡ 2
(mod 3) is not a square in Z3. Thus g = 5 is the first valid
possibility. More generally we can state that if g is a prime
then we have g ≡ 1 (mod 4), since −1 has to be a square
in Zg.
6.2 Construction of integral point sets on cir-
cles
In Addition to the construction of crabs there is another use-
ful construction of integral point sets of Z2 with large car-
dinality, see [10] for a similar construction over the ring
Z
[
−1+
√
−3
2
]
. Let pj ≡ 1 (mod 4) be distinct primes over
N. We consider the ring Z[i], where every integer pj has a
unique prime factorization pj = ωj · ωj, where c denotes
the complex conjugate of c. We may write ωj = aj + bji,
with integers aj, bj. With multiplicities vj ∈ N we set
R =
r∏
j=1
p
vj
j
and for each of the τ(R) divisors of R,
r∏
j=1
p
uj
j =
r∏
j=1
ω
uj
j ω
uj
j , 0 6 uj 6 vj
we define η2h =
∏r
j=1ω
vj+uj
j ω
vj−uj
j , η2h−1 = i · η2h
for 1 6 h 6 τ(R). With this we define vertices ξs for
1 6 s 6 2τ(R) by
ξ2h−k =
η22h−k
R
, 1 6 h 6 τ(R), k ∈ {0, 1}.
We set ηs = xs + ysi with xs, ys ∈ Z for 1 6 s 6 2τ(R).
We have
|ηs|
2
= ηsηs = x
2
s + y
2
s =
r∏
j=1
ω
2vj
j ω
2vj
j =
r∏
j=1
p
2vj
j = R
2.
This yields x2s = R
2 − y2s , which we use to calculate
R2·|ξs − ξt|2=
∣∣η2s−η2t ∣∣2
=
∣∣x2s−y2s−x2t+y2t + i · (2xsys−2xtyt)∣∣2
=
∣∣(2y2t−2y2s)+ i · (2xsys−2xtyt)∣∣2
= 4
(
y2t−y
2
s
)2
+ 4 (xsys−xtyt)
2
= 4
(
y2t−y
2
s
) (
x2s−x
2
t
)
+ 4 (xsys−xtyt)
2
= 22 (xsyt−xtys)
2
.
Thus the distance between ξs and ξt is given by |ξs − ξt|
= 1R |xsyt − xtys|. Since ηsηt
= (xs + ysi) (xt − yti) = xsxt + ysyt + i (xtys − xsyt)
and
ηsηt = i
ksi
kt
r∏
j=1
ω
vj+uj
j ω
vj−uj
j
r∏
j=1
ω
vj+wj
j ω
vj−wj
j
= iks−kt
r∏
j=1
ω
2vj+uj−wj
j ω
2vj−uj+wj
j
= R · iks−kt
r∏
j=1
ω
vj+uj−wj
j ω
vj−uj+wj
j ∈ Z[i]
we have that the distance between ξs and ξt is integral for
every 1 6 s, t 6 2τ(R). Additionally we can add the center
of the circle to this point set to obtain an integral point set of
cardinality 2 · τ(R) + 1 having rational coordinates. After a
suitable rotation we can achieve integral coordinates.
So let us have an example. We choose R = 5 · 13 = 65
and successively obtain
ω1 = 2+ i, ω2 = 3+ 2i,
η1 = 65i, η2 = 65,
η3 = −52+ 39i, η4 = 39+ 52i,
η5 = −60+ 25i, η6 = 25+ 60i,
η7 = −56− 33i, η8 = −33+ 56i,
ξ1 = −65, ξ2 = 65,
ξ3 =
91
5
−
312
5
i, ξ4 = −
91
5
+
312
5
i,
ξ5 =
595
13
−
600
13
i, ξ6 = −
595
13
+
600
13
i,
ξ7 =
2047
65
+
3696
65
i, ξ8 = −
2047
65
−
3696
65
i.
After adding the origin (0, 0)T and applying a suitable ro-
tation and translation we obtain the maximal integral point
set
P =
[(
0
0
)
,
(
0
−32
)
,
(
−30
40
)
,
(
−30
−72
)
,
(
−63
−16
)
,(
−96
40
)
,
(
−96
−72
)
,
(
−126
0
)
,
(
−126
−32
)]
94
in minimum coordinate representation.
Construction 6.12 For a given R which has only prime fac-
tors p fulfilling p ≡ 1 (mod 4) there exists an integral point
set circle(R) consisting of 2·τ(R) points on a circle of radius
R together with its center, where τ(R) denotes the number of
divisors of R.
From the above it is easy to deduce that the 2τ(R) points
on the circle all have pairwise even distances and that the
diameter of this point set is given by 2R. Using this we can
give another construction.
Construction 6.13 For a given R which has only prime fac-
tors p fulfilling p ≡ 1 (mod 4) there exists an integral point
set c̃ircle(R) consisting of 2·τ(R) points on a circle of radius
R
2 , where τ(R) denotes the number of divisors of R.
Conjecture 6.14 The plane integral point sets given by
Construction 6.12 and Construction 6.13 are maximal.
We can generalize the idea of Construction 6.13 in some
way. Let t be an arbitrary integer, R be a integer having only
prime factors fulfilling p ≡ 1 (mod 4), and P(R) be the
integral point set given by Construction 6.12 with radius R.
By P(R, t) we denote the point set which arises from P(R)
by scaling the point set with a factor 1t , this means dividing
all distances by t. Thus P(R, t) is a point set with pairwise
rational distances and rational coordinates. With this we can
construct a graph G containing the points of P(R, t) as its
vertices. Two vertices of G are connected by an edge, if and
only if the corresponding points have an integral distance in
P(R, t). The maximal cliques C of G correspond to integral
point sets P (R, t,C).
Construction 6.15 For a given R which has only prime fac-
tors p fulfilling p ≡ 1 (mod 4) and a given integer t there
exist integral point sets circle (R, t,C) consisting of points
on a circle of radius Rt , where C is a maximal clique of
the above described graph. As an abbreviation we use
circle(R, t) instead of circle (R, t,C).
Conjecture 6.16 For t = 8 Construction 6.15 gives maxi-
mal integral point sets of cardinality τ(R).
7 Maximal integral point sets over Z2
with further conditions
In Table 2 we have summarized the constructions yielding
the smallest diameter of a maximal integral point set over
Z2. Some of the values dM(k, 2) could be determined ex-
actly by an exhaustive search, but for most values of k we
only have upper bounds (and 301 as lower bound). In some
cases, denoted by
?
., we were not able to check the maxi-
mality of the constructed point sets, since their diameter was
too large.
Looking at Table 2 we observe, that the constructions
of crabs (Construction 6.6 and Construction 6.10) are very
k dM(k, 2) construction
3 = 2066 ∆(2066, 1803, 505)
4 = 5 P1(3, 4) = c̃ircle(5)
5 = 8 P2(3, 4) = crab(3, 4)
6 = 25 c̃ircle
(
52
)
7 = 30 crab (8, 6, 15)
8 = 65 c̃ircle (5 · 13)
9 = 130 circle (5 · 13)
10 6 625 c̃ircle
(
54
)
11 = 70 decompose
(
22 · 3
)
12 = 325 c̃ircle
(
52 · 13
)
13 6 650 circle
(
52 · 13
)
14 6 15625 c̃ircle
(
56
)
15 6 8190 decompose
(
27
)
16 6 1105 c̃ircle (5 · 13 · 17)
17 = 286 decompose
(
23 · 3
)
18 6 4225 c̃ircle
(
52 · 132
)
19 6 8450 circle
(
52 · 132
)
20 6 8125 c̃ircle
(
54 · 13
)
21 6 16250 circle
(
54 · 13
)
22 6 53360 decompose
(
22 · 3 · 7 · 11, 5
)
23 6 1150 decompose
(
24 · 3
)
24 6 5525 c̃ircle
(
52 · 13 · 17
)
25 6 11050 circle
(
52 · 13 · 17
)
26 6 112895 decompose
(
26 · 3 · 7, 5
)
27 6 2590 decompose
(
23 · 32
)
28
?
. 203125 c̃ircle
(
56 · 13
)
29 6 1798 decompose
(
22 · 3 · 5
)
30 6 105625 c̃ircle
(
54 · 132
)
31
?
. 211250 circle
(
54 · 132
)
32 6 27625 c̃ircle
(
53 · 13 · 17
)
33 6 55250 circle
(
53 · 13 · 17
)
34 6 142295 decompose
(
23 · 3 · 7 · 11, 5
)
35 6 18430 decompose
(
26 · 3
)
36 6 40625 c̃ircle
(
55 · 13
)
37 6 10366 decompose
(
24 · 32
)
38
?
. 571535 decompose
(
24 · 33 · 7, 5
)
39
?
. 4816895 decompose
(
29 · 3 · 7, 5
)
40 6 138125 c̃ircle
(
54 · 13 · 17
)
41 6 73726 decompose
(
27 · 3
)
42
?
. 677375 decompose
(
26 · 32 · 7, 5
)
43
?
. 4573799 decompose
(
23 · 32 · 5 · 7 · 11, 17
)
44
?
. 6614998 decompose
(
24 · 32 · 52 · 7, 13
)
45
?
. 7001315 decompose
(
23 · 32 · 72, 5
)
46
?
. 64833614 decompose
(
22 · 34 · 5 · 7 · 11, 17
)
47 6 7198 decompose
(
23 · 3 · 5
)
48
?
. 160225 c̃ircle
(
52 · 13 · 17 · 29
)
49
?
. 320450 circle
(
52 · 13 · 17 · 29
)
50
?
. 4064255 decompose
(
27 · 32 · 7, 5
)
Table 2: Best known constructions for maximal integral
point sets over Z2 in arbitrary position.
95
dominating. The resulting point sets contain n − 2 and
n − 1 collinear points out of n points, respectively. So it
may be interesting to study maximal integral point sets over
Z2, where no three points are collinear. We also say, that a
point set is in semi-general position, if no three points are
collinear. By dM(k, 2) we denote the minimum possible di-
ameter of these point sets. We can check for this further con-
dition, that no three points are collinear, by applying Lemma
6.8.
k dM(k, 2) construction
3 = 2066 ∆(2066,1803,505)
4 = 5 P1(3,4)=c̃ircle(5)
5 = 120 see Figure 5
6 = 25 c̃ircle(52)
7 = 925 see Figure 6
8 = 65 c̃ircle(5·13)
9 = 1045 see Figure 7
10 = 625 c̃ircle(54)
11
?
. 2434375 circle(510,8)
12 = 325 c̃ircle(52·13)
13
?
. 60859375 circle(512,8)
14 6 15625 c̃ircle(56)
15 6 26390 circle(54·132,8)
16 = 1105 c̃ircle(5·13·17)
17
?
. 38037109375 circle(516,8)
18 = 4225 c̃ircle(52·132)
19
?
. 950927734375 circle(518,8)
20 = 8125 c̃ircle(54·13)
21
?
. 659750 circle(56·132,8)
22
?
. 9765625 c̃ircle(510)
23
?
. 595928935571106 circle(522,8)
24 = 5525 c̃ircle(52·13·17)
25
?
. 4462500 circle(54·134,8)
26
?
. 244140625 c̃ircle(512)
27
?
. 305218 circle(52·132·172,8)
28
?
. 203125 c̃ircle(56·13)
29
?
. 9311389618298531250 circle(528,8)
30 6 105625 c̃ircle(54·132)
31
?
. 232784740457463281250 circle(530,8)
32 6 27625 c̃ircle(53·13·17)
33
?
. 412343750 circle(510·132,8)
34
?
. 152587890625 c̃ircle(516)
35
?
. 111562500 circle(56·134,8)
Table 3: Best known constructions for maximal integral
point sets over Z2 in semi-general position - part 1.
Using the methods and algorithms described in this ar-
ticle, we were able to obtain some exact values and some
upper bounds for dM(k, 2). The results are summarized
in Table 3 and Table 4. We would like to remark that we
additionally have the lower bounds dM(k, 2) > 5525 for
k ∈ {11, 13, 14, 15, 17} and dM(k, 2) > 10001 for k > 19,
k 6= 20, 24.
k dM(k, 2) construction
36 6 71825 c̃ircle(52·132·17)
37
?
.3637261569647863769531250 circle(536,8)
38
?
. 3814697265625 c̃ircle(518)
39
?
. 10314771205 circle(512·132,8)
40 6 138125 c̃ircle(54·13·17)
41
?
.2273288481029914855957031250 circle(540,8)
42
?
. 2640625 c̃ircle(56·132)
43
?
.56832212025747871398925781250 circle(542,8)
44
?
. 126953125 c̃ircle(510·13)
45
?
. 7630450 circle(54·132·172,8)
46
?
. 2384185791015625 c̃ircle(522)
47
?
.35520132516092419624328613281250 circle(546,8)
48
?
. 160225 c̃ircle(52·13·17·29)
49
?
. 18854062500 circle(56·136,8)
50
?
. 17850625 c̃ircle(54·134)
Table 4: Best known constructions for maximal integral
point sets over Z2 in semi-general position - part 2.
We would like to have a closer look on the smallest known
examples of maximal integral point sets in semi-general po-
sition consisting of an odd number of points. For cardinality
5 the two smallest point sets with respect to the diameter are
given in minimum coordinate representation by[(
0
0
)
,
(
0
−78
)
,
(
−20
21
)
,
(
−20
−99
)
,
(
−52,−39
)]
and [(
0
0
)
,
(
0
−80
)
,
(
−45
28
)
,
(
−45
−108
)
,
(
−96
−40
)]
,
see Figure 5 for a drawing of the first point set. Both point
sets consist of four point on a circle C of radii 29·10140 and
13·53
10 , respectively. In each case the fifth point does not lie
on this circle C, but the line through this point and the center
of C is a symmetry axis of the point set.
x xx
x
x
Figure 5: The smallest maximal integral point set of cardi-
nality 5 in semi-general position.
96
For cardinality 7 the two smallest examples are given by[(
0
0
)
,
(
0
−285
)
,
(
−180
240
)
,
(
−440
−384
)
,(
−700
240
)
,
(
−880
0
)
,
(
−880
−285
)]
and [(
0
0
)
,
(
0
−855
)
,
(
−540
720
)
,
(
−1320
−1152
)
,(
−2100
720
)
,
(
−2640
0
)
,
(
−2640
−855
)]
,
see Figure 6 for a graphical representation of the first ex-
ample. The geometric shape of the corresponding two point
sets is similar to the case of cardinality 5. In each case 6
points are situated on a circle C of radii 5
2·37
2 and
3·52·37
2 ,
respectively. Again we have the symmetry axis through the
seventh point and the center of C.
t
tt
t
t
t
t
Figure 6: The smallest maximal integral point set of cardi-
nality 7 in semi-general position.
For cardinality 9 the two smallest examples are given by[(
0
0
)
,
(
0
−504
)
,
(
−64
−252
)
,
(
612
255
)
,
(
612
−759
)
,(
720
210
)
,
(
720
−714
)
,
(
836
123
)
,
(
836
−627
)]
and [(
0
0
)
,
(
0
−672
)
,
(
−123
164
)
,
(
−123
−836
)
,
(
−816
340
)
,(
−816
−1012
)
,
(
−960
280
)
,
(
−960
−952
)
,
(
−1323
−336
)]
,
see Figure 7 for a graphical representation of the first exam-
ple. Here in both examples all nine points are situated of
circles of radii 5
2·132
8 and
52·132
6 , respectively. They both
can be obtained using Construction 6.15.
Now we observe that the constructions based on cir-
cles, Construction 6.12, Construction 6.13, and Construc-
tion 6.15, are very dominating in this context. The next nat-
ural step is to also forbid four points on a circle. If no three
t
t t t
ttt
tt
Figure 7: The smallest maximal integral point set of cardi-
nality 9 in semi-general position.
points are on a line and no four points on a circle we speak
of general position. By ḋM(k, 2) we denote the minimum
possible diameter of a maximal plane integral point set in
general position over Z2. Without the maximality condi-
tion these point sets are also known as k2-cluster [22]. As
we cannot apply our most successful constructions based on
crabs and circles in this case, examples are scarce.
u
uu
u
Figure 8: The smallest maximal integral point set of cardi-
nality 4 in general position.
For the check whether four points are situated on a circle
we have a well known criterion similar to Lemma 6.8:
Lemma 7.1 Four points (x1, y1), (x2, y2), (x3, y3),
(x4, y4) in R2 are situated on a circle if and only if∣∣∣∣∣∣∣∣
x1 y1 x
2
1 + y
2
1 1
x2 y2 x
2
2 + y
2
2 1
x3 y3 x
2
3 + y
2
3 1
x4 y4 x
2
4 + y
2
4 1
∣∣∣∣∣∣∣∣ = 0
holds.
u
u
u
u
u
Figure 9: The smallest maximal integral point set of cardi-
nality 5 in general position.
97
u
uu
uu
u
Figure 10: The smallest maximal integral point set of cardi-
nality 6 in general position.
In Table 5 we have summarized our knowledge on
ḋM(k, 2). For the lower bound ḋM(7, 2) > 599000 we re-
fer to [18]. Whether ḋM(7, 2) is finite (even if we drop the
maximality condition) is an open problem, see [7, 22]. If
we drop the maximality condition and the condition on the
integrality of the coordinates (in other words characteristic
one), then very recently two such examples were found, see
[14]. The smallest example for k = 6 is indeed the small-
est integral point set of characteristic one in general position
with cardinality 6.
k ḋM(k, 2) construction
3 = 2066 ∆(2066, 1803, 505)
4 = 87
[(
0
0
)
,
(
0
−33
)
,
(
−16
30
)
,
(
44
−33
)]
,
see Figure 8
5 = 165
[(
0
0
)
,
(
0
−72
)
,
(
−35
12
)
,
(
64
−120
)
,(
−90
−120
)]
, see Figure 9
6 = 1886
[(
0
0
)
,
(
0
−828
)
,
(
−448
−414
)
,
(
−720
132
)
,(
−1260
−1023
)
,
(
−1840
−414
)]
, see Figure 10
7 > 599000
Table 5: Best known constructions for maximal integral
point sets over Z2 in general position.
We would also like to give the coordinates for the second
smallest examples. For cardinality 4 we have[(
0
0
)
,
(
0
−69
)
,
(
−20
−21
)
,
(
−92
0
)]
,
for cardinality 5 we have[(
0
0
)
,
(
0
−153
)
,
(
−60
144
)
,
(
−140
−48
)
,
(
−176
57
)]
,
and for cardinality 6 we have[(
0
0
)
,
(
−135
−1008
)
,
(
420
1008
)
,
(
735
−392
)
,
(
1155
616
)
,
(
1290
1624
)]
.
8 Conclusion and outlook
We have described several constructions for integral point
sets over Z2 with given cardinality that fulfill some further
properties. Although the maximality of the resulting inte-
gral point sets cannot be guaranteed so far, we conjecture
them to be in many cases. We have described efficient algo-
rithms for exhaustive generation of maximal integral point
sets over Z2 and for testing the maximality of a given inte-
gral point set. Some exact values of minimum diameters for
given cardinalities could be obtained and several values are
constructed as upper bounds and conjectured to be the exact
values.
It remains a task to prove the maximality of point sets
resulting from some of our constructions in general. Clearly
similar problems could be considered in higher dimensions.
Bibliography
[1] N. H. Anning and P. Erdős, Integral distances, Bull.
Amer. Math. Soc. 51 (1945), 598–600.
[2] A. Antonov and M. Brancheva, Algorithm for finding
maximal Diophantine figures, Spring Conference
2007 of the Union of Bulgarian Mathematicians,
2007.
[3] S. Dimiev and K. Markov, Gauss Integers and Dio-
phantine Figures, Mathematics and Mathematical
Education 31 (2002), 88–95.
[4] P. Erdős, Integral distances, Bull. Amer. Math. Soc. 51
(1945), 996.
[5] J. Fricke, On heron simplices and integer embedding,
preprint (2001).
[6] R. E. Fullerton, Integral distances in banach spaces,
Bull. Amer. Math. Soc. 55 (1949), 901–905.
[7] R. K. Guy, Unsolved problems in number theory. 2nd
ed., Unsolved Problems in Intuitive Mathematics.
1. New York, NY: Springer- Verlag. xvi, 285 p.,
1994.
[8] B. Haible and R. Kreckel, CLN, a class library for
numbers, 2005, http://www.ginac.de/CLN/.
[9] H. Harborth, Integral distances in point sets, Karl der
Grosse und sein Nachwirken. 1200 Jahre Kultur
und Wissenschaft in Europa. Band 2: Mathematis-
ches Wissen. Turnhout: Brepols (P. L. Butzer et al.,
eds.), 1998, 213–224.
[10] H. Harborth, A. Kemnitz, and M. Möller, An upper
bound for the minimum diameter of integral point
sets, Discrete Comput. Geom. 9 (1993), no. 4, 427–
432.
98
[11] M. Kiermaier and S. Kurz, Inclusion-maximal integral
point sets in affine planes over finite fields, (sub-
mitted).
[12] A. Kohnert and S. Kurz, A note on Erdös-Diophantine
graphs and Diophantine carpets, Math. Balkanica
(N.S.) 21 (2007), no. 1-2, 1–5.
[13] A. Kohnert and S. Kurz, Integral point sets over Zmn ,
Discrete Appl. Math. (to appear).
[14] T. Kreisel and S. Kurz, There are integral heptagons,
no three points on a line, no four on a circle, Dis-
crete. Comput. Geom. (to appear).
[15] S. Kurz, Integral point sets over finite fields, (submit-
ted).
[16] S. Kurz, Konstruktion und Eigenschaften ganzzahliger
Punktmengen, Ph.D. thesis, Bayreuth. Math. Schr.
76. Universität Bayreuth, 2006.
[17] S. Kurz, On the characteristic of integral point sets in
Em, Australas. J. Combin. 36 (2006), 241–248.
[18] S. Kurz, On the generation of heronian triangles, (sub-
mitted).
[19] S. Kurz and R. Laue, Upper bounds for integral point
sets, Australas. J. Combin. 39 (2007), 233–240.
[20] S. Kurz and A. Wassermann, On the minimum diam-
eter of plane integral point sets, Ars Combin. (to
appear).
[21] S. Niskanen and P. R. J. Östergård, Cliquer user’s
guide, version 1.0, Tech. Report T48, Communica-
tions Laboratory, Helsinki University of Technol-
ogy, Espoo, Finland, 2003.
[22] L. C. Noll and D. I. Bell, n-clusters for 1 < n < 7,
Math. Comp. 53 (1989), no. 187, 439–444.
99
100
Chapter 11
Bounds for the minimum oriented diameter
SASCHA KURZ1 AND MARTIN LÄTSCH2
ABSTRACT. We consider the problem of finding an orientation
with minimum diameter of a connected and bridgeless graph.
Fomin et. al. [7] discovered a relation between the minimum
oriented diameter and the size of a minimal dominating set. We
improve their upper bound.
2000 MSC: 05C12;05C20,05C69.
Key words and phrases: diameter, orientation, domination.
1 Introduction
An orientation of an undirected graph G is a directed graph
whose arcs correspond to assignments of directions to the
edges of G. An orientation H of G is strongly connected
if every two vertices in H are mutually reachable in H. An
edge e in an undirected connected graphG is called a bridge
ifG−e is not connected. A connected graphG is bridgeless
ifG−e is connected for every edge e, i. e. there is no bridge
in G.
Conditions when an undirected graphG admits a strongly
connected orientation were determined by Robbins in 1939
[25]. Necessary and sufficient conditions are that G is con-
nected and bridgeless. Chung et. al provided a linear-time
algorithm for testing whether a graph has a strong orienta-
tion and finding one if it does [1].
Definition 1.1 Let
→
G be a strongly connected directed
graph. By diam
(
→
G
)
we denote the diameter of
→
G. For
a simple connected graph G without bridges we define
−→
diammin(G) :=
min
{
diam
(
→
G
)
:
→
G is an orientation of G
}
,
which we call the minimum oriented diameter of a simple
graph G. By γ(G) we denote the smallest cardinality of a
dominating set of G.
1Sascha Kurz, Fakultät für Mathematik, Physik und Informatik, Univer-
sität Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
2Martin Lätsch, Zentrum für Angewandte Informatik, Universität zu
Köln, Germany.
E-mail adress: laetsch@zpr.uni-koeln.de
We are interested in graphs G which have a large mini-
mum oriented diameter
−→
diammin(G) in dependence of its
domination number γ(G). Therefore we set
Ξ(γ) := max
{
−→
diammin(G) : γ(G) 6 γ
for G being a connected and bridgeless graph
}
.
The aim of this note is to prove a better upper bound on
Ξ(γ). The previously best known result [7] was:
Theorem 1.2
Ξ(γ) 6 5γ− 1.
Our main results are
Theorem 1.3
Ξ(γ) 6 4γ
and
Conjecture 1.4
Ξ(γ) =
⌈
7γ(G) + 1
2
⌉
.
Clearly we have that Ξ(γ) is weak monotone increasing.
At first we observe that we have Ξ(γ) >
⌈
7γ(G)+1
2
⌉
. There-
fore we consider the following set of examples, where we
have depicted the vertices of a possible minimal dominating
set by a filled black circle, see Figure 1.
If we formalize this construction of graphs G, which is
depicted for γ(G) = γ = 1, 2, 3, 4 we obtain examples
which attain the proposed upper bound
⌈
7γ(G)+1
2
⌉
for all
γ ∈ N. In the following we always depict vertices in a given
dominating set by a filled circle.
1.1 Related results
Instead of an upper bound of
−→
diammin(G) in dependence
of γ(G) one is also interested in an upper bound in depen-
dence of the diameter diam(G). Here the best known result
is given by [2]:
101
f v
f
 	
6@R  
f
f?@I
f v
f
 	
6@R  
@I
f
f
@R
 	
f  f@R v   ff?@I
f v
f
 	
6@R  
@I
f
f
@R
 	
f  f@R v  
@I
f
f
@R
 	
f 	 f@I v-   ff?@I
f v
f
 	
6@R  
@I
f
f
@R
 	
f  f@R v  
@I
f
f
@R
 	
f 	 f@I v-  
@I
f
f
@R
 	
f  f@R v   ff?@I
Figure 1: Examples with large minimum oriented diameter
in dependence of the domination number γ(G).
Theorem 1.5 (Chvátal and Thomassen, 1978) Let f(d) de-
note the best upper bound on
−→
diammin(G) where d =
diam(G) and G is connected and bridgeless.
If G is a connected and bridgeless graph then we have
f(d) >
1
2
· diam(G)2 + diam(G) and
f(d) 6 2 · diam(G) · (diam(G) + 1).
In [2] it was also shown that we have f(2) = 6. Examples
achieving this upper bound are given by the Petersen graph
and by the graph obtained from K4 by subdividing the three
edges incident to one vertex. Recently in [21] 9 6 f(3) 6
11 was shown.
The oriented diameter is trivially at least the diameter.
Graphs where equality holds are said to be tight. In [15]
some Cartesian products of graphs are shown to be tight. For
n > 4 the n-cubes are tight [22]. The discrete tori Cn×Cm
which are tight are completely determined in [20].
The origin of this problem goes back to 1938, where Rob-
bins [25] proves that a graph G has a strongly connected
orientation if and only if G has no cut-edge. As an applica-
tion one might think of making streets of a city one-way or
building a communication network with links that are reli-
able only in one direction.
There is a huge literature on the minimum oriented diam-
eter for special graph classes, see e. g. [11, 12, 13, 14, 16,
17, 18, 19, 23].
From the algorithmic point of view the following result is
known [2]:
Theorem 1.6 The problem whether
−→
diammin(G) 6 2 is
NP-hard for a given graph G.
We remark that the proof is based on a transformation
to the problem whether a hypergraph of rank 3 is two-
colorable.
2 Preliminaries
A vertex set D ⊆ V(G) of a graph G is said to be a dom-
inating set of G if for every vertex u ∈ V(G)\D there is
a vertex v ∈ D such that {u, v} ∈ E(G). The minimum
cardinality of a dominating set of a graph G is denoted by
γ(G). If P is a path we denote by |P| its length which equals
the number of its edges. An elementary cycle C of a graph
G = (V, E) is a list [v0, . . . , vk] of vertices in V , where
v0 = vk, |{v0, . . . , vk−1}| = k and {vi, vi+1} ∈ E for
0 6 i < k. Similarly |C| denotes the length of C which
equals the number of its edges and vertices. For other not
explicitly mention graph-theoretic terminology we refer the
reader to [6] for the basic definitions.
Our strategy to prove bounds on Ξ(γ) is to apply some
transformations on connected and bridgeless graphs attain-
ing Ξ(γ) to obtain some structural results. Instead of consid-
ering graphs G from now on we will always consider pairs
(G,D), where D is a dominating set of G.
Definition 2.1 For a graph G and a dominating set D of G
we call {u, v} ⊆ V(G)\D an isolated triangle if there exists
an w ∈ D such that all neighbors of u and v are contained
in {u, v,w} and {u, v} ∈ E(G). We say that the isolated
triangle is associated with w ∈ D.
Definition 2.2 A pair (G,D) is in first standard form if
(1) G = (V, E) is a simple connected graph without a
bridge,
(2) D is a dominating set of G with |D| = γ(G),
(3) for u, v ∈ D we have {u, v} /∈ E,
(4) for each u ∈ V\D there exists exactly one v ∈ D with
{u, v} ∈ E,
(5) G is edge-minimal, meaning one can not delete an edge
in G without creating a bridge, destroying the connec-
tivity or destroying the property of D being a dominat-
ing set, and
(6) for |D| = γ(G) > 2 every vertex in D is associ-
ated with exactly one isolated triangle and for |D| =
γ(G) = 1 the vertex in D is associated with exactly
two isolated triangles.
Lemma 2.3
Ξ(γ) = max
{
−→
diammin(G) : |D| 6 γ,
(G,D) is in first standard form
}
.
PROOF. For a given γ ∈ N we start with a connected and
bridgeless graph G ′ attaining Ξ(γ) =
−→
diammin (G
′) and
minimum domination number γ (G ′). Let D ′ be an arbi-
trary dominating set of G ′ fulfilling |D ′| = γ (G ′). Our
aim is to apply some graph transformations onto (G ′, D ′)
to obtain a pair (G,D) in first standard form fulfilling
−→
diammin(G) >
−→
diammin (G
′) and |D| 6 |D ′|.
102
At the start conditions (1) and (2) are fulfilled. If there
is an edge e between two nodes of D then we recursively
apply the following graph transformation until there exists
no such edge:
y y 7→ y i i y
If there exists a node v ∈ V\D with at least r > 2 neigh-
bors d1, . . . , dr in D then we replace the edge (v, di) i =
2, . . . , r with a path of length 2. We iterate this until case (4)
is fulfilled. In Figure 2 we have depicted the graph transfor-
mation for r = 2, 3.
y i y 7→ y i i y
i@@   
y
yy
@  7→
i@@  
i
y
iy y  
@ 
Figure 2: Graph transformation to fulfill condition (4) of
Definition 2.2
So after a finite number of transformation we have con-
structed a pair (G,D) which fulfills conditions (1), (3), (4)
of the first standard form where D is a dominating set of G
and (G,D) also fulfills
γ(G) 6 |D| 6 |D ′| = γ (G ′)
and ∞ > −→diammin(G) > −→diammin (G ′) .
To additionally fulfill condition (5) of the first standard
form we only need to delete the controversial edges. If
γ(G) < |D| 6 γ (G ′) we would have a contradiction to
the minimality of γ (G ′). Since adding isolated triangles
does not contradict with the other properties and also does
not decrease the minimum oriented property we can assume
that every vertex ofD is associated with enough isolated tri-
angles. For two vertices x and y in two different isolated
triangles being associated with the same vertex w ∈ D we
have d(x, y) 6 4 in every strongly connected orientation.
Thus we can delete some isolated triangles to achieve the
stated number of isolated triangles for every vertex in the
dominating set D. Finally we have a pair (G,D) in first
standard form. 
So in order to prove bounds on Ξ(γ) we can restrict our-
selves on pairs (G,D) in first standard form. Due to Theo-
rem 1.2 we can assume γ(G) = |D| > 2 both for the proof
of Theorem 1.3 and also for Conjecture 1.4.
Corollary 2.4 If (G,D) is a pair in first standard form then
we have
(i) for all u, v ∈ D the distance fulfills d(u, v) > 3 and
(ii) for all u ∈ V(G)\D there exists exactly one f(u) ∈ D
with {u, f(u)} ∈ E(G).
Let G be a connected and bridgeless undirected graph,
D be a dominating set of G and H be a strongly connected
orientation of G. By diami(H,D) we denote
max
{
dH(u, v) :
∣∣∣ {u, v} ∩ (V(H)\D)∣∣∣ = i} .
Clearly we have diam(H) =
max
{
diam0(H,D), diam1(H,D), diam2(H,D)
}
.
Now we refine a lemma from [7]:
Lemma 2.5 Let G ′ and G be connected and bridgeless
graphs such that G is a subgraph of G ′ andD is a dominat-
ing set of both G ′ and G. Then for every strongly connected
orientationH ofG there is an orientationH ′ ofG ′ such that
diam(H ′) 6
max
{
diam0(H,D)+4,diam1(H,D)+2,diam2(H,D)
}
.
PROOF. (We rephrase most of the proof from [7].) We adopt
the direction of the edges from H to H ′. For the remaining
edges we consider connected components Q of G ′\V(G)
and direct some edges having ends in Q as follows.
If Q consists of one vertex x then x is adjacent to at least
one vertex u in D and to another vertex v 6= u (the graph
G is bridgeless and D is a dominating set). If also v is
an element of D then we direct one edge from x and the
second edge towards x. Otherwise v is in V\D. In this
case we direct the edges [x, u] and [v, x] in the same direc-
tion as the edge [f(v), v]. If there are more edges incident
with x (in both cases) we direct them arbitrarily. Then, we
have assured the existence of vertices u ′, v ′ ∈ D such that
dH′ (x, v
′) 6 2 and dH′ (u ′, x) 6 2.
Suppose that there are at least two vertices in the con-
nected componentQ. Choose a spanning tree T in this com-
ponent rooted in a vertex v. We orient edges of this tree as
follows: If a vertex x of the tree has odd distance from v,
then we orient all the tree edges adjacent to x from x out-
wards. Also, for every such vertex x we orient the edges
between x and V(G) towards x if the distance from v on the
tree is even, and towards V(G) otherwise, see Figure 1 in
[7]. The rest of the edges in the connected componentQ are
oriented arbitrarily.
In such an orientationH ′, for every vertex x ∈ Q there are
vertices u, v ∈ D such that dH′(x, v) 6 2 and dH′(u, x) 6
2. Therefore, for every x, y ∈ V (G ′) the distance between
x and y in H ′ is at most max
{
diam2−i(H,D) + 2i | 0 6
i 6 2
}
. 
103
Due to the isolated triangles being associated with the ver-
tices of the dominating set D, for every pair (G,D) in first
standard form, there exists an orientation H of G such that
−→
diammin(G) = diam(H) = (1)
max
{
diam0(H,D)+4,diam1(H,D)+2,diam2(H,D)
}
.
If we say that H is an optimal or a minimal orientation of
(G,D) we mean an orientation that fulfills Equation (1).
In [7] the authors have described a nice construction to
obtain such a subgraph G for a given connected and bridge-
less graph G ′ fulfilling |V(G)| 6 5 · γ (G ′) − 4:
For γ (G ′) = 1 we may simply choose the single vertex
inD as our subgraphD. Now we assume |D| = γ (G ′) > 2.
Iteratively, we construct a tree Tk for k = 1, . . . , |D|. The
tree T1 is composed by one vertex x1 in D. To construct
Tk+1 from Tk we find a vertex xk+1 inD\V (Tk) with min-
imum distance to Tk. The tree Tk+1 is the union of Tk
with a shortest path from xk+1 to Tk. Since D is a dom-
inating set this path has length at most 3. We say that the
edges of this path are associated with xk+1. At the last
step we obtain a dominating tree T with D ⊆ T and with
|V(T)| 6 2 (|D| − 1) + |D|.
In order to transform T in a connected and bridgeless
graph we construct a sequence of subgraphs Gk for k =
1, . . . , |D|. We say that xj ∈ D is fixed in Gk if no edge
associated with xj is a bridge in Gk. Notice that x1 is fixed
in T because it does not have any associated edge.
We set G1 = T . Assume we have constructed the sub-
graph Gk. If xk+1 is already fixed in Gk we set Gk+1 =
Gk. If xk+1 is not fixed in Gk we add a subgraph M to Gk
to obtain Gk+1.
Let Pk be the path added to Tk to obtain Tk+1. We only
consider the case where Pk has length three. The other cases
can be done similarly. Let us assume that Pk is given by
Pk = (xk+1, u, v, xj) with u, v /∈ D, and xj ∈ D, j 6 k.
Moreover let us denote the edges of Pk by e, e ′ and e ′′. If
we remove all edges e, e ′, e ′′ of Pk from T we obtain four
subtrees T1, T2, T3 and T4 containing xk+1, u, v and xj,
respectively.
Among all shortest paths inG ′\e connecting T1 with T2∪
T3 ∪ T4 we select P as one whose last vertex belongs to
T i with i maximum. Among all shortest paths in G ′\e ′′
connecting T4 with T1 ∪ T2 ∪ T3 we selectQ as one whose
first vertex belongs to T i with i minimum. Let R be any
shortest path in G ′\e ′ connecting T3 ∪ T4 with T1 ∪ T2.
Since G ′ is a connected and bridgeless graph the paths P,
Q, R exist. Since D ⊆ V(T) and the set D is a dominating
set, the length of paths P, Q and R is at most 3. Moreover,
if the length of P is three its end vertices belong to D. The
same holds for the paths Q and R.
The definition of M is given according to the following
cases. If the last vertex of P belongs to T4 we defineM = P.
If the last vertex of P belongs to T3 or it belongs to T2 and
the first vertex ofQ belongs to T2 we defineM = P ∪Q. If
none of the previous cases hold the first vertex of R belongs
to T2 and the last one belongs to T3. We define M = P ∪
Q ∪ R.
For the analysis that
∣∣V (G|D|)∣∣ 6 5 ·γ (G ′)− 4 we refer
to [7].
Since a shortest path does contain every vertex at most
once, we can combine the above described construction of
a subgraph with Lemma 2.5 to obtain the bound Ξ(γ) 6
5γ− 1.
Lemma 2.6
Ξ(1) = 4 and Ξ(2) = 8.
PROOF. At first we observe that the examples from Fig-
ure 1 give Ξ(1) > 4 and Ξ(2) > 8. For the other di-
rection let (G,D) be a pair in first standard form attaining
−→
diammin(G) = Ξ(γ(G)). For γ = γ(G) = 1 we have
|D| = 1, choose the single vertex of D as a subgraph and
apply Lemma 2.5. Going through the cases of the above de-
scribed subgraph construction for γ = γ(G) = 2 we obtain
up to symmetry the two possibilities given in Figure 3. By
H we denote the depicted corresponding orientation of the
edges. Since in both cases we have diam0(H,D) 6 4 and
diam1(H,D), diam2(H,D) 6 5 we can apply Lemma
2.5 to obtain the stated result. 
y  
i
i@@I
-

i
i  	
@
@Ry y  
@
@I
i
i
@
@R
 
 	
i  
i
@
@R y
Figure 3: The two possible subgraphs for γ(G) = 2.
With Lemma 2.5 in mind we would like to restrict our
investigations on connected and bridgeless subgraphs con-
taining the dominating set.
Definition 2.7 For a pair (G ′, D) in first standard form we
call G a minimal subgraph of (G ′, D), if
(1) G is a subgraph of G ′ containing the vertex set D,
(2) G is connected and bridgeless,
(3) for every vertex v ∈ V(G)\D we have {v, f(v)} ∈
E(G), where f : V (G ′) \D → D is the function from
the first standard form of (G ′, D), and
(4) G is vertex and edge-minimal with respect to properties
(1), (2), and (3).
Corollary 2.8 IfG is a minimal subgraph of (G ′, D) in first
standard form, we have
(1) |V(G)| 6 5 · |D| − 4 and
(2) there exists no chord {u, v} ∈ E(G), where {u, v} ∩ D
is an empty set.
104
Definition 2.9 Let G be a minimal subgraph of (G ′, D) in
first standard form. We construct a graph G̃ from G by
adding isolated triangles at vertices of D such that (G̃,D)
is in first standard form. We call G̃ a minimal completion
and we say that H is a minimal or an optimal orientation of
G, if H is strongly connected and we have
−→
diammin(G̃) >
max
{
diam0(H,D)+4,diam1(H,D)+2,diam2(H,D)
}
.
By considering the isolated triangles being associated to
the vertices of the dominating set D we can easily check,
that every minimal subgraphG of a pair (G ′, D) in first stan-
dard form admits a minimal orientation H and that we have
−→
diammin (G
′) 6
−→
diammin
(
G̃
)
. If G does only fulfill
conditions (1)-(3) of Definition 2.7 then we may consider
a minimal subgraph G ′′ of (G ′, D), which contains G as a
subgraph. With this we can call an orientation H of G mini-
mal or optimal if it is minimal or optimal for G ′′.
Definition 2.10 We call a pair (G ′, D) in first standard
form critical, if Ξ (γ (G ′)) =
−→
diammin (G
′).
Definition 2.11 We call a minimal subgraph G of (G ′, D)
in first standard form critical if for a minimal orientation H
of G we have
Ξ (γ (G ′)) =
max
{
diam0(H,D)+4,diam1(H,D)+2,diam2(H,D)
}
.
Together with Lemma 2.5 we obtain:
Lemma 2.12
Ξ(γ) = max
{
min
{
max
{diam0(H,D)+4,diam1(H,D)+2,diam2(H,D)}
: H is strongly connected orientation of G
}
: G is
critical minimal subgraph of (G ′, D) in first standard
form with |D| = γ
}
.
Sometimes it is useful to know some basic facts about
strongly connected orientations of graphs.
Lemma 2.13 (1) If H is a strongly connected orientation
of an undirected graph G and C is a directed cycle
without repeated edges inH, then inverting of the edges
of C yields another strongly connected orientation of
G.
(2) If H is a strongly connected orientation of an undi-
rected graph G and P1 and P2 are two edge-disjoint
directed paths from x to y, then inverting P2 yields an-
other strongly connected orientation of G.
(3) If H is a strongly connected orientation of an undi-
rected graph G then inverting all edges yields another
strongly connected orientation with equal diameter.
3 Reductions
In this section we will propose some reductions for critical
minimal subgraphsG of pairs (G ′, D) in first standard form,
in order to provide some tools for an inductive proof of a
better upper bound on Ξ(γ).
Lemma 3.1 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| >
3. If G contains vertices x, y ∈ D, l1, l2, r1, r2 ∈
V(G)\D, two edge disjoint paths P1 = [x, l1, r1, y], P2 =
[x, l2, r2, y], all neighbors of l1, r1 are in {x, l1, r1, y}, and
all neighbors of l2, r2 are in {x, l2, r2, y}, then we have
Ξ(γ) 6 Ξ(γ− 1) + 3.
PROOF. Let G̃ be the graph which arises fromG by deleting
l1, l2, r1, r2 and identifying x with y. Now let D̃ := D\{y}
and H̃ be an arbitrary minimal orientation of G̃. Thus we
have diam0
(
H̃, D̃
)
6 Ξ(γ − 1) + 4, diam1
(
H̃, D̃
)
6
Ξ(γ−1)+2, and diam2
(
H̃, D̃
)
6 Ξ(γ−1). We construct
an orientation H of G by directing the two paths P1 and P2
in opposing directions, and by taking the directions from H̃.
Now we analyze the distance dH(u, v) in H for all pairs
u, v ∈ V(G). If both u and v are in {l1, l2, r1, r2}, then we
have dH(u, v) 6 5 6 Ξ(γ− 1) + 3. If none of u and v is in
{l1, l2, r1, r2}, then we have dH(u, v) 6 dH̃(u, v) + 3. In
the remaining case we have dH(u, v) 6 dH̃(u, v)+5. Thus
we have
diam2(H,D)6max
{
diam2
(
H̃,D̃
)
+3,diam1
(
H̃,D̃
)
+5, 5
}
6Ξ(γ− 1) + 3,
diam1(H,D)6max
{
diam1
(
H̃,D̃
)
+3,diam0
(
H̃,D̃
)
+5, 5
}
6Ξ(γ− 1) + 1, and
diam0(H,D)6diam0
(
H̃,D̃
)
+3
6Ξ(γ− 1) − 1,
which yields Ξ(γ) 6 Ξ(γ− 1) + 3. 
We remark that Lemma 3.1 corresponds to a graph con-
taining the left graph of Figure 3 as an induced subgraph,
where the vertices corresponding to the empty circles have
no further neighbors in the whole graph.
Lemma 3.2 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) =
|D| > 3. If G contains vertices x, y, z ∈ D,
four edge disjoint paths P1 = [x, v1, v2, v3, y], P2 =
[y, v4, v5, v6, z], P3 = [x, u1, u2, y], P4 = [y, u3, u4, z],
and all edges being adjacent to vertices in I :=
{v1, v2, v3, v4, v5, v6, u1, u2, u3, u4} are contained in P :=
P1 ∪ P2 ∪ P3 ∪ P4, then we have Ξ(γ) 6 Ξ(γ− 2) + 7.
PROOF. At first we want to determine some structure infor-
mation on the vertices vi, uj and the adjacent edges. We
have f (v1) = f (u1) = x, f (v3) = f (v4) = f (u2) =
f (u3) = y, and f (v6) = f (u4) = z. Since all edges
105
being adjacent to vertices in I are contained in P we have
f (v2) , f (v5) ∈ {x, y, z}. Some vertices may have several
labels. By vi ∼ we denote the set of labels which correspond
to the same vertex as vi. Similarly we define ui ∼.
Let us at first assume |I| = 10, meaning, that each vertex
has a unique label. In this case we may consider the edge
{v2, f (v2)} which is not contained in P to see that G would
not be a minimal subgraph of (G ′, D) in first standard form.
Due to the 14 pairwise different edges of P and the infor-
mation on the values of f we have
(a) v1 ∼⊆ {v1, v5}, v3 ∼⊆ {v3, v5},
v4 ∼⊆ {v2, v4}, v6 ∼⊆ {v2, v6},
(b) u1 ∼⊆ {u1, v2, v5}, u2 ∼⊆ {u2, v2, v5},
u3 ∼⊆ {u3, v2, v5}, u4 ∼⊆ {u4, v2, v5},
(c) v2 ∼⊆ {v2, v4, v5, v6, u1, u2, u3, u4},
v5 ∼⊆ {v1, v2, v3, v5, u1, u2, u3, u4}.
Next we assume |I| = 9 which means that exactly one
vertex in I has two different labels and all other vertices have
unique labels.
(1) If v1 = v5 then v2, v3, and v4 could be deleted.
(2) If v3 = v5 then v4 could be deleted.
(3) If u1 = v2 then by considering the edge {v5, f (v5)} /∈
P we could conclude that either v4 or v6 could be
deleted.
(4) If u1 = v5 then u2 could be deleted.
(5) If u2 = v2 then by considering the edge {v5, f (v5)} /∈
P we could conclude that either v4 or v6 could be
deleted.
(6) If u2 = v5 then v4 could be deleted.
(7) If v2 = v5 then v3 and v4 could be deleted.
Thus the vertices v1, v3, u1, u2 are unique. Using symme-
try we conclude that also the vertices v4, v6, u3, and u4 are
unique. Since we have also dealt with the only left possibil-
ity v2 = v5 we can conclude |I| 6 8.
We proceed similar as in the proof of Lemma 3.1 and let
G̃ be the graph arising from G by deleting the vertices ui,
vi, y and by identifying x and z. Obviously G̃ is connected
and bridgeless. Now let D̃ := D\{y, z} and H̃ be an arbitrary
minimal orientation of G̃. Thus we have diam0
(
H̃, D̃
)
6
Ξ(γ − 2) − 4, diam1
(
H̃, D̃
)
6 Ξ(γ − 2) − 2, and
diam2
(
H̃, D̃
)
6 Ξ(γ− 2).
We construct an orientation H of G by directing the two
pairs of paths (P1, P3), (P2, P4) in opposing directions such
that the arcs [v3, y], [y, v4] are directed different, by taking
the directions from H̃ and by directing remaining edges ar-
bitrarily.
Now we analyze the distance dH(u, v) in H for all
pairs u, v ∈ V(G). Due to dH(x, z), dH(z, x) 6
7, dH(y, x), dH(y, z), dH(x, y), dH(z, y) 6 4 we have
dH(u, v) 6 dH̃(u, v) + 7 for u, v /∈ I. Now we consider
dH(u, v) for u, v ∈ I∪{x, y, z}. Due to L := |I ∪ {x, y, z}| 6
11we clearly have dH(u, v) 6 10. We assume L = 11 since
otherwise we would have dH(u, v) 6 9. Now we have a
closer look at the directed cycle C := P1 ◦ P4 ◦ P2 ◦ P3
of length 14 consisting of 11 vertices. It is not possible to
visit all 11 vertices going along edges of the cycle C with-
out visiting a vertex twice. Thus we have dH(u, v) 6 9 for
u, v ∈ I ∪ {x, y, z}. Summarizing our results gives
diam2(H,D)6max
{
diam2
(
H̃,D̃
)
+7, diam1
(
H̃,D̃
)
+9, 9
}
6Ξ(γ− 2) + 7,
diam1(H,D)6max
{
diam1
(
H̃,D̃
)
+7, diam0
(
H̃,D̃
)
+9, 9
}
6Ξ(γ− 2) + 5, and
diam0(H,D)6diam0
(
H̃,D̃
)
+7
6Ξ(γ− 2) + 3,
which yields Ξ(γ) 6 Ξ(γ− 2) + 7. 
We remark that Lemma 3.2 corresponds to a graph con-
taining the right graph of Figure 3 two times as an induced
subgraph for x, y, z ∈ D corresponding to the black circle,
where the vertices corresponding to the empty circles have
no further neighbors in the whole graph.
Lemma 3.3 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| > 3
and x a vertex contained in the dominating set D. If remov-
ing x produces at least three connectivity components C1,
C2, C3, . . . , then we have
Ξ(γ) 6 max
{
Ξ(γ− i) + Ξ(i) − 4 : 1 6 i 6 γ− 1
}
.
PROOF. Let C̃i be the induced subgraphs of V (Ci) ∪ {x}
in G. We set Di = {x} ∪ (V (Ci) ∩D) and γi := |Di| − 1
so that we have 1 +
∑
i γi = γ. Since G is a minimal
subgraph we have γi > 1 for all i. Now we choose
arbitrary minimal orientations H̃i of the C̃i. Thus we have
diam0
(
H̃i, Di
)
6 Ξ(γi + 1) − 4, diam1
(
H̃i, Di
)
6
Ξ(γi + 1) − 2, and diam2
(
H̃i, Di
)
6 Ξ(γi + 1) for
all i. Since C̃i and C̃j are edge-disjoint for i 6= j we can
construct an orientation H of G by taking the directions
of the H̃i. Now we analyze the distance dH(u, v) in H
for all pairs u, v ∈ V(G). If u and v are contained in the
same component C̃i we have dH(u, v) = dH̃i(u, v). If
u is contained in C̃i and v is contained in C̃j, then we
have dH(u, v) 6 dH̃i(u, x) + dH̃j(x, v). Thus we have
diam2(H,D)
6max
i 6=j
{
diam2
(
H̃i,Di
)
,diam1
(
H̃i,Di
)
+diam1
(
H̃j,Dj
)}
6max
{
Ξ(γi+1),Ξ(γi+1)+Ξ(γj+1)−4 : i 6= j
}
,
diam1(H,D)
6max
i 6=j
{
diam1
(
H̃i,Di
)
,diam1
(
H̃i,Di
)
+diam0
(
H̃j,Dj
)}
6max
i 6=j
{
Ξ(γi+1)−2, Ξ(γi+1)+Ξ(γj+1)−6
}
,
106
and diam0(H,D)
6max
{
diam0
(
H̃i, Di
)
+ diam0
(
H̃j, Dj
)
: i 6= j
}
6max
{
Ξ (γi+1) + Ξ (γj+1) − 8 : i 6= j
}
.
Since we have at least three connectivity components it
holds γi+γj 6 γ−2 for all i 6= j. Using this and Ξ(n−1) 6
Ξ(n) we conclude Ξ(γ) 6 max
{
Ξ(γ− i) +Ξ(i) − 4 : 1 6
i 6 γ− 1
}
. 
Lemma 3.4 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| > 3
and x a vertex not contained in the dominating set D. If
removing x produces at least three connectivity components
C1, C2, C3, . . . , then Ξ(γ) is at most
max
26i6γ−1
{
Ξ(i)+Ξ(γ+1−i)−7, Ξ(i−1)+Ξ(γ+1−i)−4
}
.
PROOF. W.l.o.g. let f(x) be contained in C1. Let C̃1
be the induced subgraph of V (C1) ∪ {x} in G and D1 =
D ∩ V (C1). For i > 2 let C̃i be the induced subgraph of
V (Ci) ∪ {x} in G with additional vertices yi, zi, additional
edges {x, yi}, {x, zi}, {yi, zi}, andDi = (V (Ci) ∩D)∪{zi}.
We set γ1 = |D1| > 1 and γi = |Di| − 1 > 1 for i > 2
so that we have
∑
i γi = γ. By H̃i we denote an optimal
orientation of Ci. W.l.o.g. we assume that in H̃1 the edge
{f(x), x} is directed from f(x) to x and that for i > 2 in H̃i
the edges {x, yi}, {x, zi}, {yi, zi} are directed from x to yi,
from yi to zi and from zi to x. Due to the minimality of the
orientations H̃i we have diam0
(
H̃1, D1
)
6 Ξ(γ1) − 4,
diam1
(
H̃1, D1
)
6 Ξ(γ1) − 2, diam2
(
H̃1, D1
)
6
Ξ(γ1), and for i > 2 we have diam0
(
H̃i, Di
)
6
Ξ(γi + 1) − 4, diam1
(
H̃i, Di
)
6 Ξ(γi + 1) − 2,
diam2
(
H̃i, Di
)
6 Ξ(γi + 1).
We construct an orientation H of G by taking the direc-
tions of the common edges with the H̃i. Now we analyze
the distance dH(u, v) in H for all pairs u, v ∈ V(G). We
only have to consider the cases where u and v are in differ-
ent connectivity components. Let us first assume u ∈ C̃i,
v ∈ C̃j with i, j > 2. We have
dH(u, v) 6 dH̃i(u, x) + dH̃j(x, v)
6 dH̃i(u, zi) − 2+ dH̃j(zj, v) − 1,
since every directed path from a vertex u ∈ V(G) to zi
in H̃i uses the arcs [x, yi], [yi, zi], and every directed path
from zj to a vertex v ∈ V(G) in H̃j uses the arc [zj, x]. Now
let u be in C̃1 and v be in C̃i with i > 2. Since the edge
{f(x), x} is directed from f(x) to x, both in H and in H̃1, we
can conclude
dH(u, v) 6 dH̃1(u, x) + dH̃i(x, v)
6 dH̃1(u, f(x)) + 1+ dH̃i(zi, v) − 1.
If u ∈ C̃i with i > 2 and v ∈ C̃1, then we similarly con-
clude
dH(u, v) 6 dH̃i(u, x) + dH̃1(x, v)
6 dH̃i(u, zi) − 2+ dH̃1(x, v).
Thus using Ξ(i− 1) 6 Ξ(i) for i ∈ N and γi + γj 6 γ− 1
for all i 6= j in total we have diam2(H,D)
6max
{
diam2
(
H̃1,D1
)
,diam2
(
H̃i,Di
)
,diam1
(
H̃i,Di
)
+diam1
(
H̃j,Dj
)
−3,diam1
(
H̃1,D1
)
+diam1
(
H̃i,Di
)
,
diam2
(
H̃1,D1
)
+diam1
(
H̃i,Di
)
−2
}
6 max
{
Ξ(γ− 1), Ξ(γi + 1) + Ξ(γj + 1) − 7,
Ξ(γ1) + Ξ(γi + 1) − 4 : 2 6 i < j
}
6 max
{
Ξ(i)+Ξ(γ+1−i)−7,
Ξ(i−1)+Ξ(γ+1−i)−4 : 2 6 i 6 γ− 1
}
,
diam1(H,D)
6 max
{
diam1
(
H̃1,D1
)
,diam1
(
H̃i,Di
)
,diam0
(
H̃i,Di
)
+diam1
(
H̃j,Dj
)
−3,diam0
(
H̃1,D1
)
+diam1
(
H̃i,Di
)
,
diam1
(
H̃1,D1
)
+diam0
(
H̃i,Di
)
,diam2
(
H̃1,D1
)
+
diam0
(
H̃i,Di
)
−2,diam1
(
H̃1,D1
)
+diam1
(
H̃i,Di
)
−2
}
6 max
{
Ξ(γ− 1) − 2, Ξ(γi + 1) + Ξ(γj + 1) − 9,
Ξ(γ1) + Ξ(γi + 1) − 6 : 2 6 i < j
}
6 max
{
Ξ(i) + Ξ(γ+ 1− i) − 9, Ξ(i− 1) +
Ξ(γ+ 1− i) − 6 : 2 6 i 6 γ− 1
}
,
and diam0(H,D)
6 max
{
diam0
(
H̃1, D1
)
,diam0
(
H̃i, Di
)
,diam0
(
H̃i, Di
)
+diam0
(
H̃j, Dj
)
−3,diam0
(
H̃1, D1
)
+diam0
(
H̃i, Di
)
,
diam1
(
H̃1, D1
)
+diam0
(
H̃i, Di
)
−2
}
6 max
{
Ξ(γ− 1) − 4, Ξ(γi + 1) + Ξ(γj + 1) − 11,
Ξ(γ1) + Ξ(γi + 1) − 8 : 2 6 i < j
}
6 max
{
Ξ(i) + Ξ(γ+ 1− i) − 11, Ξ(i− 1) +
Ξ(γ+ 1− i) − 8 : 2 6 i 6 γ− 1
}
.
Thus we can conclude that Ξ(γ) is at most max
26i6γ−1
{
Ξ(i)+
Ξ(γ+ 1− i) − 7, Ξ(i− 1) + Ξ(γ+ 1− i) − 4
}
. 
Now we are ready to determine the next exact value of
Ξ(γ):
Lemma 3.5
Ξ(3) = 11.
107
y i
i
i
i i
i
y
y
6
6
- -
?

6
6
@
@I
y
i
i
y i
i
y
ii6
6
6
-
@
@R
?
?

i
i
y i
i
y i
i
y
6
6
-
?
?

 
  @
@R
 
 	@
@I y
i
i
i
y
i
i
i
y
6
6
- -
?
?

@
@R
@
@R
y
i
i
i y
i y
ii6
6
- -
?

 
 

?
y
i i
y i
i
i
iy
6
- -
?

@
@I
-
?
@
@I

6
i
ii
y
y
i
i
i
y
6
- -
?

6
-
?
@
@I
?
y
i i
y i
i
i
iy
6
- -

@
@I
-
?

6
?
?
i i y i i
y i i y
6
-
?

-
6 
 	
-
?@
@I y i y i y
i i i i
6
- - -
?

6
?

 
 	@
@I
i
yi i
iy yi i
6
6
@
@I
@
@I  
 	
 
 	
- -
 
  @
@R?
6
i y
i
i i
yi y i
?
 
 

?
-
?
- 
 
@
@I  
 	 @
@I
Figure 4: Orientations for the proof of Lemma 3.5 - part 1.
PROOF. The third example from Figure 1 gives Ξ(3) > 11.
Going through the cases of the subgraph construction being
described in front of Lemma 2.6 we are able to explicitly
construct a finite list of possible subgraphs for γ = 3. This
fall differentiation is a bit laborious but not difficult. We
can assume that these graphs G are minimal subgraphs of
a suitable pair (G ′, D) in first standard form. During our
construction we can drop all graphs which are not minimal,
e. g. graphs containing a chord where no end vertex lies
in the dominating set D. Doing this we obtain a list of 25
non-isomorphic minimal subgraphs. In Figure 4 and Figure
5 we give suitable orientations for the cases, where we can
not apply Lemma 3.1, Lemma 3.2, or Lemma 3.4. 
i y i
i i i
y i i y
?
@
@I
6
-
@
@R  
 
-
?
 
 	 i y i
i i i
y i
i
y
?
@
@I
6
-
@
@R -
?
 
 
?


i
i
y
y
i
i
i
i
y
i

6
6
-
?
?
- -
?

6 
 	 i
i
yi
y
i
i
i
y i

6
6

@
@R -
?
-
6
?

-
 
 	
ii
y
y
ii
i
i
y i
-
6

6
-
?

6
-
 
 	
6
-
 
 	 y
i
i
i y i
i
i
yi6
- - - -
?

6 
 	@
@I
?

6
Figure 5: Orientations for the proof of Lemma 3.5 - part 2.
Going over the proofs of the previous lemmas again, we
can conclude some further, in some sense weaker, reduction
results. Similarly as in Lemma 3.2 we can prove:
Lemma 3.6 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| > 3.
If G contains vertices x, y,∈ D, two edge disjoint paths
P1 = [x, u1, u2, u3, y], P2 = [x, v1, v2, y], and all edges
being adjacent to vertices in I := {u1, u2, u3, v1, v2} are
contained in P1 ∪ P2, then we have Ξ(γ) 6 Ξ(γ− 1) + 4.
Lemma 3.7 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| > 3
and x a vertex contained in the dominating set D. If remov-
ing x produces two connectivity componentsC1 andC2 then
we have
Ξ(γ) 6 max
{
Ξ(γ+ 1− i) + Ξ(i) − 4 : 2 6 i 6 γ− 1
}
.
PROOF. We can rephrase most of the proof of Lemma 3.3.
Our estimations on diami(H,D) remain valid. Since we
only have two connectivity components we do not have γi+
γj 6 γ− 2 for i 6= j. Instead we have γ1 + γ2 = γ− 1 and
γ1, γ2 6 γ− 2. Combining this with Ξ(n− 1) 6 Ξ(n) we
obtain the stated upper bound. 
Lemma 3.8 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| > 3
and x a vertex not contained in the dominating set D. If re-
moving x produces at least two connectivity componentsC1,
C2 where f(x) ∈ C1 and |V (C1) ∩D| > 2 then we have
Ξ(γ) 6 max
{
Ξ(i) + Ξ(γ+ 1− i) − 4 : 2 6 i 6 γ− 1
}
.
PROOF. We can rephrase most of the proof of Lemma 3.4.
Using Ξ(i−1) 6 Ξ(i) for all i ∈ N and the fact that we have
108
exactly two connectivity components C1 and C2 yields
diam2(H,D)6max
{
Ξ(γ−1), Ξ(γ1)+Ξ(γ2+1)−4
}
diam1(H,D)6max
{
Ξ(γ−1)−2, Ξ(γ1)+Ξ(γ2+1)−6
}
diam0(H,D)6max
{
Ξ(γ−1)−4, Ξ(γ1)+Ξ(γ2+1)−8
}
.
Due to Ξ(i − 1)6Ξ(i), 26y16γ − 1, and 16γ26γ − 1
we have
Ξ(γ) 6 max
{
Ξ(i) + Ξ(γ+ 1− i) − 4 : 2 6 i 6 γ− 1
}
.

We would like to remark that Lemmas 3.1, 3.2, 3.3, 3.4
can be used in an induction proof of Conjecture 1.4, whereas
Lemmas 3.6, 3.7, 3.8 can only be used in an induction proof
of Theorem 1.3.
y
i
i
i
i
y
f(x) x z
w y1
y2
 
 
@
@ @
@
 
 
 
 
@
@
i
i
i
yx
z
y1
y2
@
@I
 
 
y
i
i
i
i
y
f(x) x z
w y1
y2
-
 
 	 @
@I @
@R
 
 	
 
 
@
@I
Figure 6: The situation of Lemma 3.9 if we can not apply
Lemma 3.8.
In order to prove Theorem 1.3 we need some further re-
duction lemmas.
Lemma 3.9 Let G be a critical minimal subgraph of
(G ′, D) in first standard form with γ = γ (G ′) = |D| > 3
and x a vertex not contained in the dominating set D. If re-
moving x produces at least two connectivity componentsC1,
C2, where f(x) ∈ C1 and there exist y1 6= y2 ∈ V(G)\D
fulfilling f (y1) = f (y2) and {x, y1} , {x, y2} ∈ E(G) then
we either can apply Lemma 3.8 or we have Ξ(γ) 6 Ξ(γ −
1) + 4.
PROOF. If |V (C1) ∩D| > 2 we can apply Lemma 3.8 to
obtain a contradiction to the minimality of (G ′, D). Thus
we may assume |V (C1) ∩D| = 1. Since G is a minimal
subgraph, we have V (C1) = {f(x), w} and the neighbors
of f(x) and w in G are contained in {f(x), w, x}. As an
abbreviation we set f (y1) = f (y2) = z ∈ D. See the upper
left drawing in Figure 6 for a graphical representation of
the situation. Now we consider the subgraph C̃2 consisting
of the induced subgraph of V(C2) ∪ {x} with the additional
edge {x, f (y1)}. Let H2 be an optimal orientation of C̃2,
where we assume that the arc [z, y1] is directed from z to
y1, see the upper right graph of Figure 6. Now we construct
an orientation H of G by taking the directions from H2 and
redirecting some edges. We direct x tow,w to f(x), f(x) to
x to y1, y1 to z, z to y2, and y2 to x, see the lower drawing
of Figure 6.
Now we analyze the distance dH(a, b) between two ver-
tices in V(G). If a and b are both in C̃2, then we can con-
sider a shortest path P in H2. It may happen that P uses
some of the redirected edges. In this case P contains at
least two vertices from {x, y1, y2, z}. If P uses more than
two vertices from {x, y1, y2, z} then we only consider those
two vertices which have the largest distance on P. Look-
ing at our redirected edges in H we see, the distance be-
tween two such vertices is at most three, so that we have
dH(a, b) 6 dH2(a, b) + 3 in this case.
Now let b be in C̃2. We consider a shortest path P in
H2 from z to b. In H we have dH(f(x), z) 6 3 by con-
sidering the path [f(x), x, y1, z]. Since dH (z, y2) = 1 we
have dH(f(x), b) 6 dH2(z, b) + 4. Similarly we obtain
dH(w,b) 6 dH2(z, b) + 5. With D2 = D\{f(x)} the
set D2 is a dominating set of C̃2 and we can check that
|D2| = γ
(
C̃2
)
holds. Since z ∈ D2 and H2 is an optimal
orientation, for b1 ∈ D2, b2 /∈ D2 we have dH2 (z, b1) 6
Ξ(γ − 1) − 4 and dH2 (z, b2) 6 Ξ(γ − 1) − 2 yielding
dH (f(x), b1) 6 Ξ(γ − 1), dH (f(x), b2) 6 Ξ(γ − 1) + 2,
dH (w,b1) 6 Ξ(γ−1)+1, and dH (w,b2) 6 Ξ(γ−1)+3.
This is compatible with Ξ(γ) 6 Ξ(γ − 1) + 4 due to
f(x), b1 ∈ D and w,b2 /∈ D.
Now let a be in C̃2. we consider a shortest path P in H2
from a to z. In H we have dH(z, f(x)) 6 4 by considering
the path [z, y2, x,w, f(x)]. Since P can not use an arc from
y1 to z (this arc is directed in the opposite direction in H2)
either P contains a vertex in {x, y2} or P also exists in H,
so that we have dH(a, f(x)) 6 dH2(a, z) + 4. Similarly
we obtain dH(a,w) 6 dH2(a, z) + 3. Since H2 we con-
clude similarly as in the above paragraph that all distances
are compatible with Ξ(γ) 6 Ξ(γ− 1) + 4. 
Lemma 3.10 Let G be a minimal subgraph of a pair
(G ′, D) in first standard form. If there exist z1, z2 ∈
V(G)\D with f (z1) = f (z2) and {z1, z2} ∈ E(G), then
either z1 or z2 is a cut vertex.
PROOF. If z1 has no other neighbors besides z2 and x :=
f (z1) then either z2 is a cut vertex or z1 can be deleted
from G without destroying the properties of Definition 2.7.
We assume that neither z1 nor z2 is a cut vertex. Thus both
z1 and z2 have further neighbors y1 and y2, respectively.
Since {z1, z2} can not be deleted we have y1 6= y2. Let P1
be a shortest path from y1 to z2 in G\ {z1}. Since {z1, z2}
can not be deleted P1 contains the edge {x, z2}. Similarly
there exists a shortest path from y2 to z1 containing the edge
{x, z1}. Thus in the end the existence of P1 and P2 shows
that {z1, z2} could be deleted, which is a contradiction to the
minimality of G. 
Lemma 3.11 Let G be a minimal subgraph of a pair
(G ′, D) in first standard form. Let x, y1, y2 be three vertices
not in the dominating setDwith {x, y1} , {x, y2} ∈ E(G) and
109
f (y1) 6= f(x) 6= f (y2) either one vertex of x, y1, y2 is a
cut vertex, or f (y1) 6= f (y2).
PROOF. We assume as contrary that none of x, y1, y2 is
a cut vertex and f (y1) = f (y2). Now we consider G\{x},
which must be connected. Thus there must exist a path P
connecting f(x) to f (y1) = f (y2) and either one of the
edges {x, y1}, {x, y2} is a chord or one of the vertices y1,
y2 could be deleted from G, which is a contradiction to the
minimality of G. 
4 Proof of the main theorem
In this section we want to prove Theorem 1.3. We use the
techniques of induction on γ(G) and minimal counter ex-
amples with respect to γ(G).
Definition 4.1 We call a minimal subgraph G of (G ′, D) in
first standard form a minimal counter example to Theorem
1.3 if we have max
{
diam0(H,D) + 4, diam1(H,D) +
2, diam2(H,D)
}
> 4γ for a minimal orientation H and
γ = |D| is minimal with this property.
y
i
i
y
i i y
y
i
i
ii
- - -
6
6
6

?
?
?
v0 v1 v2 v3
v4
v5
v6v7v8v9
v10
v11
y
i
i
iy
i
i
y i
i
i
i y
i
y
iyi- - - - 6
6

?

6@
@R

6@
@R
6
-
 
 	
-
6 
 	
v8 v9 v0 v1 v2
v3w8
z8
w7
z7 v4
z2
w2
v7
v6
v5
z6 w6
Figure 7: The situation of Lemma 4.2 and the situation of
Lemma 4.3.
Lemma 4.2 Let G be a minimal subgraph of (G ′, D) in
first standard form which is a minimal counter example to
Theorem 1.3, then there can not exist an elementary cycle
C = [v0, . . . , v3k = v0] in G with k > 2 and the v3j ∈ D
for all 0 6 j < k.
PROOF. We assume the existence of such a cycle C, see
the upper graph in Figure 7 for an example, and consider
another graph G̃ arising from G by:
(1) deleting the edges of C,
(2) deleting the vertices v3j for 0 < j < k,
(3) inserting vertices uj and edges {v0, vj}, {v0, uj},
{uj, vj} for all 0 < j < 3k with 3 - j, and by
(4) identifying all vertices v3j ∈ Gwith the vertex v0 ∈ G̃,
meaning that we replace edges {v3j, x} in G by edges
{v0, x} in G̃.
We remark that this construction does not produce multi-
ple edges since (G ′, D) is in first standard form. The set
D̃ := D\
{
v3, v6, . . . , v3k−3
}
is a dominating set of G̃ with∣∣∣D̃∣∣∣ = |D|−k+1. Let H̃ be a minimal orientation of (G̃, D̃).
We construct an orientationH ofG by taking over the direc-
tions of all common edges with H̃ and by orienting the edges
of C from vj to vj+1, see the upper graph in Figure 7.
Now we analyze the distances in H. For brevity we set
I :=
{
v3j : 0 6 j < k
}
(these are the vertices in G which
are associated with v0 in G̃). The distance of two vertices in
I in the orientation H is at most 3k − 3 and the distance of
two vertices in V(C) is at most 3k−1. Thus we may assume
|D| > k. Let a, b be vertices in V(G).
(1) If a and b are elements of {vj : 0 6 j < 3k} then we
have dH(a, b) 6 3k− 1 < 4|D| − 4.
(2) If a and b are not in I then we consider a shortest path
P̃ in H̃ connecting a and b.
(3) If a ∈ I and b /∈ I then we consider a shortest path P̃
in H̃ connecting v0 and b.
(4) The case a /∈ I and b ∈ I then we consider a shortest
path P̃ in H̃ connecting a and v0.
Let P̃ be an arbitrary shortest path in H̃ connecting a and
b. It may happen that in H this path P̃ does not exist since
it may contain the vertex v0 corresponding to two different
vertices v3i and v3j in G or may contain one of the edges
{v0, vj}, {v0, uj}, or {uj, vj} with 3 - j.
Now we want to construct a path P which does con-
nect a and b in H. The path P̃ may use one of the edges
{v0, vj}, {v0, uj}, or {uj, vj} with 3 - j. Deleting all these
edges decomposes P̃ in at least two parts P̃1, . . . , P̃m with∣∣∣P̃1∣∣∣ + ∣∣∣P̃m∣∣∣ 6 ∣∣∣P̃∣∣∣ − 1. Using a suitable segment C̃ of the
cycle C we obtain a path P = P̃1 ∪ C̃ ∪ P̃m of length at
most
∣∣∣P̃1∣∣∣ + ∣∣∣P̃m∣∣∣ + ∣∣∣C̃∣∣∣ 6 ∣∣∣P̃∣∣∣ + 3k − 2. If P̃ does not use
one of these edges then it can only happen that v0 is used
in P̃ corresponding to two different vertices v3i and v3j in
G. In this case we can use a suitable segment C̃ of the cycle
C, which starts and ends in a vertex of I, to obtain a path P
connecting a and b in H of length at most
∣∣∣P̃∣∣∣+ 3k− 3.
Now we are ready to prove that G is not a counter exam-
ple. If γ(G̃) <
∣∣∣D̃∣∣∣ then we have diam(H̃) 6 4·∣∣∣D̃∣∣∣−4 =
4 · |D| − 4k due to the minimality of G. In each of the cases
(1)-(4) we have dH(a, b) 6 4 · |D| − k − 2 6 4 · |D| − 4
110
for all a, b ∈ G. Otherwise we have γ(G̃) =
∣∣∣D̃∣∣∣ and D̃ is
a minimal dominating set of G̃. In this case we have
diam2(H,D) 6 max
{
diam2
(
H̃, D̃
)
+ 3k− 2,
diam1
(
H̃, D̃
)
+ 3k− 1, 3k− 1
}
6 4 · |D| − k+ 2
6 4 · |D|
diam1(H,D) 6 max
{
diam1
(
H̃, D̃
)
+ 3k− 2,
diam0
(
H̃, D̃
)
+ 3k− 1, 3k− 1
}
6 4 · |D| − k
6 4 · |D| − 2
diam0(H,D) 6 max
{
diam0
(
H̃,D̃
)
+3k−2, 3k−3
}
6 4 · |D| − k− 2
6 4 · |D| − 4

Lemma 4.3 Let G be a minimal subgraph of (G ′, D) in
first standard form which is a minimal counter example to
Theorem 1.3, then there can not exist an elementary cycle
C = [v0, . . . , vl = v0] in G with the following properties:
(1) v0 ∈ D,
(2) |V(C) ∩D| > 2,
(3) l > 6, and
(4) if vj /∈ D then either f (vj) ∈ {vj−1, vj+1} or vj is a
cut vertex in G where the component containing f (vj)
contains exactly one vertex of D.
PROOF. We assume the existence of such a cycle C. By y
we denote the number of cut vertices vj in C and by Y the
corresponding set. For all v ∈ Y we have f(v) /∈ C since
otherwise we could apply Lemma 3.8. If e = {v ′, v ′′} would
be a chord of C then |{v ′, v ′′} ∩D| = 1 since (G ′, D) is
in first standard form and G is a minimal subgraph, which
especially means that we can not delete the edge e. We as-
sume w.l.o.g. v ′ ∈ D and conclude f (v ′′) = v ′. Thus
v ′′ is not a cut vertex and due to property (4) the edge e is
not a chord. Finally we conclude that C is chordless. For
y = 0 we would have v3j ∈ D due to l > 6 and the prop-
erty f (vj) ∈ {vj−1, vj+1} for vertices vj /∈ D. Thus we
may assume y > 1 since otherwise we could apply Lemma
4.2. For each vj ∈ Y we set zj = f (vj) /∈ V(C) and de-
note by wj ∈ V(G)\(V(C) ∪ D) the vertex which is adja-
cent to vj and zj. By k we denote the number of vertices
vj in V(C) which are also contained in D. Due to condi-
tion (2) we have k > 2. The two neighbors on the cycle C
of a vertex in Y both are not contained in D. For a vertex
v ∈ V(C)\(D ∪ Y) one neighbor on C is f(v) and the other
neighbor lies in V(C)\D. Thus the length |C| of the cycle is
given by 3k+y > 7. On the lower side of Figure 7 we have
depicted an example with k = 2 and y = 4.
Now we consider another graph G̃ arising from G by:
(1) deleting the edges of C,
(2) deleting the vertices(
{zj, wj : 0 < j < l} ∪ (V(C) ∩D)
)
\ {v0},
(3) inserting vertices uj and edges {v0, vj}, {v0, uj},
{uj, vj} for all 0 < j < l with vj /∈ D, and by
(4) identifying all vertices vj ∈ D with the vertex v0 ∈ G̃,
meaning that we replace edges {vj, x} in G by edges
{v0, x} in G̃.
We remark that this construction does not produce multi-
ple edges since (G ′, D) is in first standard form. The set
D̃ := D\
{
v1, . . . , vl−1, z1, . . . , zl−1
}
is a dominating set
of G̃ with
∣∣∣D̃∣∣∣ = |D| − k − y + 1. Let H̃ be a mini-
mal orientation of (G̃, D̃). We construct an orientation H
of G by taking over the directions of all common edges
with H̃ and by orienting the edges of C from vj to vj+1.
The missing edges corresponding to zj and wj are oriented
from vj to zj, from zj to wj, and from wj to vj, see the
graph on the lower side of Figure 7. For brevity we set
A = V(C) ∪
{
wj, zj : 0 < j < l
}
.
Now we analyze the distances in H. For a1, b1 ∈ A we
have dH (a1, b1) 6 3k+y+3, for a2, b2 ∈ V(C) we have
dH (a2, b2) 6 3k + y − 1, and for a3, b3 ∈ V(C) ∩ D
we have dH (a3, b3) 6 3k + y − 3. Thus we may assume
|D| > k+ y. Let a, b be vertices in V(G).
(1) If a and b are elements of A then we have dH(a, b) 6
3k+ y+ 3 < 4|D| − 4.
(2) If a and b are not inA then we consider a shortest path
P̃ in H̃ connecting a and b.
(3) If a ∈ A and b /∈ A then we consider a shortest path P̃
in H̃ connecting v0 and b.
(4) The case a /∈ A and b ∈ A then we consider a shortest
path P̃ in H̃ connecting a and v0.
Let P̃ be a shortest path in H̃ connecting two vertices a and
b. Similarly as in the proof of Lemma 4.2 we construct a
path P in H connecting a and b. Doing the same analysis
we obtain |P| 6
∣∣∣P̃∣∣∣ + 3k + y − 2. Starting or ending at a
vertex zi or wi increases the length by at most 2.
If γ
(
G̃
)
<
∣∣∣D̃∣∣∣ = |D| − k − y + 1 then we would have
dH(a, b) 6 4|D| − k − 3y + 1 6 4|D| − 4. Thus we may
assume γ
(
G̃
)
=
∣∣∣D̃∣∣∣ = |D| − k − y + 1, meaning that
D̃ is a minimal dominating set. With this clearly we have
dH̃(v0, b), dH̃(a, v0) 6 4 ·
∣∣∣D̃∣∣∣ − 2 for all a, b ∈ G̃ and
dH̃ (v0, b
′) , dH̃ (a
′, v0) 6 4 ·
∣∣∣D̃∣∣∣− 4 for all a ′, b ′ ∈ D̃.
111
For k+ y > 3 and |D| > k+ y+ 1 we have
diam2(H,D) 6 max
{
diam2
(
H̃, D̃
)
+ 3k+ y− 2,
diam1
(
H̃, D̃
)
+ 3k+ y, 3k+ y+ 3
}
6 4 · |D| − k− 3y+ 2
6 4 · |D|
diam1(H,D) 6 max
{
diam1
(
H̃, D̃
)
+ 3k+ y,
diam0
(
H̃, D̃
)
+ 3k+ y, 3k+ y+ 3
}
6 4 · |D| − k− 3y+ 2
6 4 · |D| − 2
diam0(H,D) 6 max
{
diam0
(
H̃, D̃
)
+3k+y, 3k+y+3
}
6 4 · |D| − k− 3y
6 4 · |D| − 4

Now we are ready to prove Theorem 1.3:
PROOF.(of Theorem 1.3)
Let G be a minimal subgraph of (G ′, D) in first standard
form which is a minimal counter example to Theorem 1.3.
Due to Lemma 2.6 and Lemma 3.5 we can assume |D| > 4.
We show that we have |V(G)| 6 4 · (|D| − 1) + 1. In this
case we can utilize an arbitrary orientation H of G. Since a
shortest path uses every vertex at most once we would have
diam(H) 6 4·(|D|−1). Applying Lemma 2.5 we conclude
diammin (G
′) 6 4 · |D| = 4 ·γ (G ′), which is a contradic-
tion to G being a minimal counter example to Theorem 1.3
and instead proves this theorem.
At first we summarize some structure results for minimal
counter examples to Theorem 1.3.
(1) We can not apply one of the Lemmas 3.3, 3.4, 3.7, 3.8,
or 3.10. So if v ∈ V(G) is a cut vertex we have v /∈ D
and there exists a unique vertex t(V) /∈ D such that
we have {v, f(v)} , {f(v), t(v)} , {t(v), v} ∈ E(G) and all
neighbors of f(v), t(v) are contained in {f(v), t(v), v}.
(2) Due to Lemma 3.9, Lemma 3.11, and (1) there do not
exist pairwise different vertices x, y1, y2 ∈ V(G)\D
with {x, y1} , {x, y2} ∈ E(G) and f (y1) = f (y2).
(3) We can not apply Lemma 4.2 or Lemma 4.3 on G.
In order to bound |V(G)| from above we perform a technical
trick and count the number of vertices of a different graph
G̃. Therefore we label the cut vertices of G by v1, . . . , vm.
With this we set
D̃ =
(
D ∪ {vi : 1 6 i 6 m}
)
\ {f (vi) : 1 6 i 6 m} .
The graph G̃ arises from G by deleting the f (vi) , t (vi) for
1 6 i 6 m and by replacing the remaining edges {vi, x}
by a pair of two edges {vi, yx,i} , {yx,i, x}, where the yx,i
are new vertices. We have
∣∣∣D̃∣∣∣ = |D|, ∣∣∣V (G̃)∣∣∣ > |V(G)|,
the set D̃ is a dominating set of G̃, and G̃ is a subgraph
of a suitable pair in first standard form. If G̃ would not be
a minimal subgraph than also G would not be a minimal
subgraph. We have the following structure results for G̃:
(a) There do not exist two vertices u, v ∈ V(G̃)\D̃ with
{u, v} ∈ E(G̃) and f(u) = f(v).
(b) There do not exist pairwise different vertices
x, y1, y2 ∈ V(G̃)\D̃ with {x, y1} , {x, y2} ∈ E
(
G̃
)
and f (y1) = f (y2).
(c) We can not apply Lemma 4.2 or Lemma 4.3 on G̃.
Since our construction of G̃ has removed all such configu-
rations (a) holds. If in (b) f (y1) = f (y2) is an element
of D then such a configuration also exists in G, which is a
contradiction to (2). If f (y1) corresponds to a vi in G, then
y1 and y2 would correspond to two new vertices yi,e and
yi,e′ . In this case we would have a double edge from x to
vi in G, which is not true. Thus (b) holds. Since all vertices
in D̃\D correspond to cut vertices in G also (c) holds.
In order to prove
∣∣∣V (G̃)∣∣∣ 6 4 · (∣∣∣D̃∣∣∣− 1) + 1 we con-
struct a tree T fulfilling
(i) D̃ ⊆ V(T) and
(ii) if v1 ∈ V(T)\D̃ then we have {f (v1) , v1} ∈ E(T).
Therefore we iteratively construct trees Tk for 1 6 k 6
∣∣∣D̃∣∣∣.
The tree T1 is composed of a single vertex x1 ∈ D̃. The
tree T1 clearly fulfills condition (ii). To construct Tk+1 from
Tk we find a vertex xk+1 in D̃\V (Tk) with the minimum
distance to Tk. The tree Tk+1 is the union of Tk with a
shortest path Pk+1 from xk+1 to Tk. Since D̃ is a domi-
nating set this path Pk+1 has length at most three. Since G̃
is a subgraph of a suitable pair in first standard form Pk+1
has length at least two. For Pk+1 = [xk+1, v1, v2] we have
v1, v2 /∈ D̃ due to the first standard form and f (v1) = xk+1,
v2 ∈ V (Tk). Since condition (ii) is fulfilled for Tk it is
also fulfilled for Tk+1 in this case. In the remaining case
we have Pk+1 = [xk+1, v1, v2, v3] with v1, v2 /∈ V (Tk),
v1, v2 /∈ D̃, and v3 ∈ V (Tk). If f (v2) would not be con-
tained in V (Tk) then [f (v2) , v2, v3] would be a shorter path
connecting f (v2) to Tk. Thus we have f (v2) ∈ V (Tk)
and we may assume v3 = f (v2). (We may simply con-
sider the path [xk+1, v1, v2, f (v2)] instead of Pk+1.) Due
to xk+1 /∈ V (Tk) and Tk fulfilling condition (ii), these con-
ditions are also fulfilled for Tk+1. In the end we obtain a tree
T|D̃| fulfilling condition (i) and condition (ii). By consider-
ing the paths Pk we conclude |V(T)| 6
∣∣∣D̃∣∣∣+ 2(∣∣∣D̃∣∣∣− 1).
Clearly we have some alternatives during the construction
of T|D̃|. Now we assume that T is a subtree of G̃ fulfilling
conditions (i) and (ii), and having the maximal number of
vertices. In the next step we want to prove some properties
of the vertices in T .
112
Let v ∈ D̃ and let u ∈ V(G̃)\V(T) be a neighbor of v
in G̃. We prove that every neighbor u ′ of u in G̃ is con-
tained in V(T). Clearly we have u ′ /∈ D̃. Due to (a) we
have f (u ′) 6= v. If u ′ /∈ V(T) then adding the edges
A :=
{
{v, u}, {u, u ′} , {u ′, f (u ′)}
}
gives an elementary cy-
cle C = [v0, . . . , vl] in
(
V(T) ∪ {u, u ′} , E(T) ∪A
)
, where
v0 = vl and l > 6. Since we can not apply Lemma 4.2 there
exists an index j (reading the indices modulo l) fulfilling
vj ∈ D̃ and vj+1, vj+2, vj+3 ∈ V(T)\D̃.
Since the edge {vj+1, vj+2} is contained in E(T) also the
edge {vj+2, f (vj+2)} is contained in E(T). Similarly we
conclude that the edge {vj+3, f(vj+3)} is contained in E(T).
If vj+1 has no further neighbors besides vj and vj+2 in T
then
T ′ :=
(
(V(T) ∪ {u, u ′})\ {vj+1} ,
(E(T) ∪A)\
{
{vj, vj+1} , {vj+1, vj+2}
})
would be a subtree of G̃ fulfilling the conditions (i) and (ii)
with a larger number of vertices than T . Thus such an u ′
can not exist in this case. If vj+1 has further neighbors in
T , then deleting the edge {vj+1, vj+2} and adding the edges
and vertices of A would also yield a subtree of G̃ fulfilling
the conditions (i) and (ii) with a larger number of vertices
than T .
The same statement also holds for v ∈ V(T)\D̃ since we
may consider f(u) instead v. Thus in G̃ we have {u, v} ∩
V(T) 6= ∅ for every edge {u, v} ∈ E(G̃).
For a graphK and a vertex v ∈ V(K) we denote by S(K, v)
the uniquely defined maximal connected and bridgelesssub-
graph of K containing v. If every edge being adjacent to v is
a bridge or v does not have any edges, then S consists only
of vertex v. We remark that u ∈ S(K, v) is an equivalence
relation ∼K for all vertices u, v ∈ V(K). By F we denote the
set of vertices in V(T) which are either contained in D̃ or
have a degree in V(T) of at least three. We have
|V(T)| + |F| 6 4 ·
∣∣∣D̃∣∣∣− 2,
which can be proved by induction on |V (Tk)| +
|F ∩ V (Tk)| 6 4 · k − 2 for 1 6 k 6
∣∣∣D̃∣∣∣. Clearly we
have |V (T1)| + |F ∩ V (T1)| = 2 6 4 · 1 − 2. The tree
Tk+1 arises from Tk by adding a path Pk+1 of length at
most three. If |Pk+1| = 3 then we have F ∩ V (Tk+1) =(
F ∩ V (Tk)
)
∪ {xk+1} and |V (Tk+1)| 6 |V (Tk)| + 3.
For |Pk+1| = 2 we have |V (Tk+1)| 6 |V (Tk)| + 2 and
|F ∩ V (Tk+1)| 6 |F ∩ V (Tk)| + 2.
For a graph K containing T as a subgraph we denote
by N(K) the number
∣∣∣ {S(K, v) : v ∈ F} ∣∣∣ of equivalence
classes of ∼K. Since T is a tree we have N(T) = |F|.
Now we recursively construct a sequence of graphs Gi for
1 6 i 6 |F| fulfilling
|V (Gi)| +N (Gi) 6 4 ·
∣∣∣D̃∣∣∣− 2, N (Gi) 6 i,
and T ⊆ Gi ⊆ G̃. (2)
This yields a graphG1 containing at most 4·
∣∣∣D̃∣∣∣−3 vertices,
where each two elements of D̃ are connected by at least two
edge disjoint paths. So either we have
∣∣∣V(G̃)∣∣∣ 6 4 · ∣∣∣D̃∣∣∣− 3
or G̃ and G are not minimal subgraphs.
During the following analysis we often delete a vertex v
or an edge e from the tree T in such a way that it decomposes
in exactly two subtrees T1 and T2. Since T contains no cut
vertices there exists a path M in G̃ without v or without e
connecting T1 and T2. Since there does not exist an edge
{u1, u2} ∈ E
(
G̃
)
with {u1, u2}∩V(T) = ∅ we have |M| 6
2 ifM is a shortest path.
For G|F| = T condition (2) holds. Now for i > 2 let Gi
be given. If there exists a vertex u ∈ V(G̃)\V (Gi) hav-
ing neighbors x, y ∈ V (Gi) with S (Gi, x) 6= S (Gi, y)
we define Gi−1 by adding vertex u and adding all edges,
being adjacent with u in G̃, to Gi. With this we have
|V (Gi−1)| = |V (Gi)| + 1 and N (Gi−1) = N (Gi) − 1,
so that condition (2) is fulfilled for Gi−1.
Now we deal with the cases where i > 2 and where such
vertices u, x, y do not exist. We use the setwise defined
distance
dK(A,B) := min
{
dK(a, b) : a ∈ A, b ∈ B
}
.
Now we choose f1, f2 ∈ F with S (Gi, f1) 6= S (Gi, f2),
where dGi (S (Gi, f1) , S (Gi, f2)) is minimal. Clearly
we have 1 6 dGi (S (Gi, f1) , S (Gi, f2)) 6 3. By
Pf1,f2 we denote the corresponding shortest path connect-
ing S (Gi, f1) with S (Gi, f2).
If |Pf1,f2 | = [v0, v1] and the edge {v0, v1} is not con-
tained in E(T), then we simply add this edge to Gi to
obtain Gi−1. So we may assume that {v0, v1} ∈ E(T).
Deleting {v0, v1} in T decomposes T into two subtrees T1
and T2, where we assume w.lo.g. that f1 ∈ V
(
T1
)
and
f2 ∈ V
(
T2
)
. Due to dG̃\{v0,v1}
(
T1, T2
)
6 2 we can
obtain a graph Gi−1 adding add most one vertex, where
S (Gi−1, f1) = S (Gi−1, f2) holds.
If Pf1,f2 = [v0, v1, v2] and v1 /∈ V(T) the we can add
v1 and add all its edges to Gi to obtain Gi−1. So we may
assume v1 ∈ V(T). If {v0, v1} or {v1, v2} would not be
contained in E(T), then we may simply add it to Gi, with-
out increasing the number of vertices, and are in a case
|Pf1,f2 | = 1. So we may assume {v0, v1} , {v1, v2} ∈ E(T).
Due to S (Gi, v0) 6= S (Gi, v1) 6= S (Gi, v2) and the mini-
mality of Pf1,f2 we have v1 /∈ F. Thus v1 has degree two
in T and removing v1 decomposes T into two subtrees T1
and T2, where we assume w.lo.g. that f1 ∈ V
(
T1
)
and
f2 ∈ V
(
T2
)
. Since there does not exist a cut vertex in G̃
we have dG̃\{v1}
(
T1, T2
)
6 2 and we can obtain a graph
Gi−1 adding add most one vertex, where S (Gi−1, f1) =
S (Gi−1, f2) holds.
113
The remaining case is Pf1,f2 = [v0, v1, v2, v3]. Due to
the minimality of Pf1,f2 we have f (v2) ∈ V (S (Gi, f2))
and f (v1) ∈ V (S (Gi, f1)). Thus we may assume v0, v3 ∈
D̃. Additionally we have {v1, v2} ∩ V(T) 6= ∅. If vj /∈ V(T)
we may simply add vj and its edges to Gi to obtain Gi−1.
So we may assume v1, v2 ∈ V(T). W.l.o.g. we assume
{v1, v2} ∈ E(T). Otherwise there exists an edge {v1, v4} ∈
E(T) with v4 6= v0 and we could choose f1 = f (v1), f2 =
f (v4). The vertices v1 and v2 both have degree two in T .
Deleting v1 in T gives two subtrees T1 and T2, where we
can assume v0 ∈ V
(
T1
)
and v2 ∈ V
(
T2
)
. Since there does
not exist a cut vertex in G̃ we have dG̃\{v1}
(
T1, T2
)
6 2
and denote the corresponding shortest path by R1. If R1 =
[r0, r1, r2] does not end in v2 then we could obtain Gi−1
by adding vertex r1 and its edges to Gi. Similarly we may
delete vertex v2 to obtain a shortest path R2 which ends in
v1. But in this case the edge {v1, v2} could be deleted from
G̃, which is a contradiction to the minimality of G̃. 
We conjecture that ifG is a critical minimal subgraph of a
pair (G ′, D) in first standard form then we always can apply
one of the lemmas 3.1, 3.2, 3.3, 3.4, 3.6, 3.7, 3.8, 3.9, 3.10,
3.11, 4.2, or 4.3.
We would like to remark that our reduction technique is
constructive in the following sense: If we have a graph G
and a dominating setD, not necessarily a minimal dominat-
ing set of G, then we can construct an orientation H of G
in polynomial time fulfilling diam(H) 6 4 · |D|: At first
we apply the transformations of the proof of Lemma 2.3 to
obtain a graph G̃, which fulfills conditions (1), (3)-(6) of
Definition 2.2 and whereD remains a dominating set. In the
following we will demonstrate how to obtain an orientation
H̃ of G̃ fulfilling diam
(
H̃
)
6 4 · |D|. From such an ori-
entation we can clearly reconstruct an orientation H of G.
Since Lemma 2.5 does not use the minimality of the domi-
nating set D we can restrict our consideration on a minimal
subgraph Ĝ of G̃. Since none of the lemmas in Section 3
uses the minimality of the domination set D, we can apply
all these reduction steps on Ĝ. These steps can easily be re-
versed afterwards. The proofs of Lemma 4.2 and Lemma 4.3
have to be altered very slightly to guarantee a suitable reduc-
tion also in the case whereD is not minimal. (Here only the
analysis is affected, not the construction.) We end up with a
graph Ġwith dominating set Ḋ (here Ḋ arises fromD by ap-
plying the necessary reduction steps). Since in the proof of
Theorem 1.3 we show
∣∣V (Ġ)∣∣ 6 4 · ∣∣Ḋ∣∣− 3 we can choose
an arbitrary strong orientation and reverse all previous steps
to obtain an orientationH ofGwith diam(H) 6 4 · |D|. We
remark that all steps can be performed in polynomial time.
5 Conclusion and outlook
In this article we have proven
−→
diammin(G) 6 4 · γ(G)
for all connected and bridgeless graphs and conjecture
−→
diammin(G) 6
⌈
7γ(G) + 1
2
⌉
to be the true upper bound. Lemma 3.5 shows that Theorem
1.3 is not tight for γ = 3. Some of our reduction steps in
Section 3 can also be used for a proof of Conjecture 1.4.
Key ingredients might be the lemmas 4.2 and 4.3, which
can be utilized as reductions for Conjecture 1.4 if k + y is
large enough. Figure 4 and Figure 5 indicate several cases
which can not be reduced so far.
Besides a proof of Conjecture 1.4 one might consider spe-
cial subclasses of general graphs to obtain stronger bounds
on the minimum oriented diameter. E. g. for C3-free graphs
and C4-free graphs we conjecture that the minimum ori-
ented diameter is at most 3 · γ+ c.
Bibliography
[1] F. R. K. Chung, M. R. Garey, and R. E. Tarjan, Strongly
connected orientations of mixed multigraphs, Net-
works 15 (1985), 477–484.
[2] V. Chvátal and C. Thomassen, Distances in orien-
tations of graphs, J. Combin. Theory Ser. B 24
(1978), 61–75.
[3] P. Dankelmann, The diameter of directed graphs, J.
Combin. Theory Ser. B 94 (2005), no. 1, 183–186.
[4] P. Dankelmann, O. R. Oellermann, and J.-L. Wu, Min-
imum average distance of strong orientations of
graphs, Discrete Appl. Math. 143 (2004), no. 1-3,
204–212.
[5] P. Dankelmann, H. C. Swart, and D. P. Day, On strong
distances in oriented graphs, Discrete Math. 266
(2003), no. 1-3, 195–201.
[6] R. Diestel, Graph theory, second ed., Springer-Verlag,
New York, 2000.
[7] F. V. Fomin, M. Matamala, E. Prisner, and I. Rapaport,
Bilateral orientations and domination, Proceed-
ings of the Brazilian Symposiun on Graphs, Algo-
rithms and Combinatorics (GRACO 2001), Elec-
tron. Notes Discrete Math., vol. 7, Elesevier Sci-
ence Publishers, 2001.
[8] F. V. Fomin, M. Matamala, E. Prisner, and I. Rapaport,
AT-free graphs: Linear bounds for the oriented di-
ameter, Discrete Appl. Math. 141 (2004), no. 1-3,
135–148.
[9] F. V. Fomin, M. Matamala, and I. Rapaport, The
complexity of approximating the oriented diame-
ter of chordal graphs. (extended abstract), Kučera,
Luděk (ed.), Graph-theoretic concepts in com-
puter science. 28th international workshop, WG
2002, Český Krumlov, Czech Republic, June 13-
15, 2002. Revised papers. Berlin: Springer. Lect.
Notes Comput. Sci. 2573, 211-222 (2002), 2002.
114
[10] F. V. Fomin, M. Matamala, and I. Rapaport, Com-
plexity of approximating the oriented diameter of
chordal graphs, J. Graph Theory 45 (2004), no. 4,
255–269.
[11] K. M. Koh and K. L. Ng, The orientation number of
two complete graphs with linkages, Discrete Math.
295 (2005), no. 1-3, 91–106.
[12] K. M. Koh and B. P. Tan, The diameter of an orien-
tation of a complete multipartite graph, Discrete
Math. 149 (1996), no. 1-3, 131–139.
[13] K. M. Koh and B. P. Tan, The minimum diameter
of orientations of complete multipartite graphs,
Graphs Combin. 12 (1996), no. 4, 333–339.
[14] K. M. Koh and E. G. Tay, Optimal orientations of prod-
ucts of paths and cycles, Discrete Appl. Math. 78
(1997), no. 1-3, 163–174.
[15] K. M. Koh and E. G. Tay, On optimal orientations of
cartesian products with a bipartite graph, Discrete
Appl. Math. 98 (1999), no. 1-2, 103–120.
[16] K. M. Koh and E. G. Tay, On optimal orientations of
cartesian products of graphs. II: Complete graphs
and even cycles, Discrete Math. 211 (2000), no. 1-
3, 75–102.
[17] K. M. Koh and E. G. Tay, On optimal orientations ofG
vertex-multiplications, Discrete Math. 219 (2000),
no. 1-3, 153–171.
[18] K. M. Koh and E. G. Tay, On a conjecture concern-
ing optimal orientations of the cartesian product
of a triangle and an odd cycle, Discrete Math. 232
(2001), no. 1-3, 153–161.
[19] K. M. Koh and E. G. Tay, On optimal orientations of
tree vertex-multiplications, Australas. J. Combin.
34 (2006), 69–87.
[20] J.-C. König, D. W. Krumme, and E. Lazard, Diameter-
preserving orientations of the torus, Networks 32
(1998), no. 1, 1–11.
[21] P. K. Kwok, Q. Liu, and A. B. West, Oriented diameter
of graphs with diameter 3, (submitted).
[22] J. E. McCanna, Orientations of the n-cube with mini-
mum diameter, Discrete Math. 68 (1988), no. 2-3,
309–310.
[23] J. Plesnı́k, Remarks on diameters of orientations of
graphs, Acta Math. Univ. Comenian 46/47 (1985),
225–236.
[24] J. Plesnı́k, On minimal graphs of diameter 2 with every
edge in a 3-cycle, Math. Slovaca 36 (1986), 145–
149.
[25] H. E. Robbins, A theorem on graphs, with an appli-
cation to a problem in traffic control, Amer. Math.
Monthly 46 (1939), 281–283.
115
116
Chapter 12
Demand forecasting for companies with many
branches, low sales numbers per product, and
non-recurring orderings
SASCHA KURZ1 AND JÖRG RAMBAU2
ABSTRACT. We propose the new Top-Dog-Index to quantify the
historic deviation of the supply data of many small branches for a
commodity group from sales data. On the one hand, the common
parametric assumptions on the customer demand distribution in the
literature could not at all be supported in our real-world data set.
On the other hand, a reasonably-looking non-parametric approach
to estimate the demand distribution for the different branches di-
rectly from the sales distribution could only provide us with statis-
tically weak and unreliable estimates for the future demand. Based
on real-world sales data from our industry partner we provide ev-
idence that our Top-Dog-Index is statistically robust. Using the
Top-Dog-Index, we propose a heuristics to improve the branch-
dependent proportion between supply and demand. Our approach
cannot estimate the branch-dependent demand directly. It can,
however, classify the branches into a given number of clusters ac-
cording to an historic oversupply or undersupply. This classifica-
tion of branches can iteratively be used to adapt the branch distri-
bution of supply and demand in the future.
2000 MSC: 90B90; 90B05.
Key words and phrases: revenue management, demand forecast-
ing.
1 Introduction
Many retailers have to deal in their daily businesses with
small profit margins. Their economic success lies mostly
in the ability to forecast the customers’ demand for indi-
vidual products. More specifically: trade exactly what you
can sell to your customers. This task has two aspects if your
company has many branches in different regions: trade what
your customers would like to buy because the product as
1Sascha Kurz, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
2Jörg Rambau, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: joerg.rambau@uni-bayreuth.de
such is attractive to them and provide a demand adjusted
number of items for each branch or region.
In this paper we deal with the second aspect only: meet
the branch distributed demand for products as closely as
possible. The first aspect clearly also interferes with the to-
tal demand for a product over all branches. Therefore, we
assume that we are given a fix total number of items per
product which should be distributed over the set of branches
to meet the branch-dependent demand distribution as closely
as possible.
Our industry partner is a fashion discounter with more
than 1 000 branches most of whose products are never re-
plenished, except for the very few “never-out-of-stock”-
products (NOS products): because of lead times of around
three months, apparel replenishments would be too late any-
way. In most cases the supplied items per product and ap-
parel size lie in the range between 1 and 6.
The task can be formulated informally as follows: Given
historic supply and sales data for a commodity group, find
out some robust information on the demand distribution over
branches in that commodity group that can be used to opti-
mize or at least to improve the supply distribution over all
branches.
We remark that trading fashion has the special feature that
also the demand for different apparel size varies over the
branches. In this article, however, we focus on the aspect
of improving the supply distribution over all branches. The
apparel size distribution problem is subject some other re-
search in progress.
1.1 Related work
Demand forecasting for NOS items is an well-studied topic
both in research and practice. The literature is overboarding,
see, e. g., [1, 2, 3] for some surveys. For promotional items
and other items with single, very short life cycles, however,
we did not find any suitable demand forecasting methods.
The literature in revenue management (assortment opti-
mization, inventory control, dynamic pricing) very often as-
sumes the neglectability of out-of-stock substitution effects.
117
This out-of-stock substitution in the sales data of our part-
ner, however, poses the biggest problem in our case. In our
real-world application we have no replenishment, small vol-
ume deliveries per branch, lost sales with unknown or even
no substitution, sales rates depending much more on the suc-
cess of the individual product at the time it was offered than
on the size. Therefore, estimating the absolute future de-
mand distribution from historical sales data with no correc-
tion for out-of-stock substitution seems questionable.
Most demand forecasting tools used in practice are pro-
vided by specialized software companies. Quite a lot of soft-
ware packages are available, see [6] for an overview. Our
partner firm has checked several offers in the past and did
– apart from the NOS segment — not find any optimization
tools tailored to their needs.
1.2 Our contribution
We show that a reasonably-looking attempt to measure the
demand distribution over all branches by measuring for each
branch the sales over all products up to a certain day (to
avoid out-of-stock substitution) does not work because of
the high volatility in the sales rates of different products.
The key idea of this work is that estimating something
weaker than the absolute fraction of total demand of a
branch will result in stronger information that is still suf-
ficient to improve on the demand consistency of the supply
of branches.
More specifically, we propose the new Top-Dog-Index
(TDI) that can measure the branch dependent deviation of
demand from supply, even for very small sales amounts or
short selling periods. This yields, in particular, an estimate
for the direction in which the supply was different from de-
mand in the past for each branch.
On the one hand, the TDI is a rather coarse measurement;
on the other hand, we can show that on our real-world data
set it is statistically robust in the sense that the TDIs of the
branches relative to each other are surprisingly similar on
several independent samples from the sales data and their
complements.
To show the value of the information provided by the TDI,
we propose a dynamic optimization procedure that shifts rel-
ative supply among branches until the deviation measured is
as small as possible.
Of course, the impact of such an optimization procedure
has to be evaluated in practice. This is subject of future re-
search.
1.3 Outline of the paper
In Section 2 we state the real-world problem we are inter-
ested in. Moreover, we give an abstract problem formu-
lation. An obvious approach of determining the demand
distribution of the branches directly from historic sales data
is shown to be inappropriate on our given set of sales data
in Section 3. We propose our new Top-Dog-Index in Sec-
tion 4. We analyze its statistical robustness and its distinc-
tive character in clustering branches according to the devi-
ation of the historic ratio between supply and demand. In
Section 5 we describe an heuristic iterative procedure that
uses the information from the Top-Dog-Indices to alter the
supply distribution towards a suitable distribution that more
or less matches the demand distribution over branches. An
outlook and a conclusion will be given in Section 6.
2 The real-world problem and an ab-
stract problem formulation
Our industry partner is a fashion discounter with over 1 000
branches. Products can not be replenished and the number of
sold items per product and branch is rather small. There are
no historic sales data for a specific product available since
every product is sold only for one selling period. The chal-
lenge for our industry partner is to determine a suitable to-
tal amount of items of a specific product which should be
bought. For this part the knowledge and experience of the
buyers employed by a fashion discounter is used. We seri-
ously doubt that a software package based on historic sales
data can do better. But there is another task being more ac-
cessible for computer aided forecasting methods. Once the
total amount of sellable items of a specific product is deter-
mined, one has to decide how to distribute this total amount
to a set of branches B which differ in their demand. The
remaining part of this paper addresses the latter task.
In the following, we formulate this problem in a more
abstract way. Given a set of branches B, a set of prod-
ucts P, a function S(b, p) which denotes the historic sup-
ply of product p for each branch b, and historic sales trans-
actions from which one can determine how many items of
a given product p are sold in a given branch b at a given
day of sales d. The target is to estimate a demand η (b, p̃)
for a future product p̃ /∈ P in a given branch b, where we
can use
∑
b∈B η (b, p̃) = 1 as normalization. This estima-
tion η (b, p̃) should be useable as a good advice for a supply
S (b, p̃). No further information, e. g., on a stochastic model
for the purchaser behavior, is available.
3 Some real-data analysis evaluating
an obvious approach
The most obvious approach to determine a demand distri-
bution over branches is to count the sold items per branch
and divide by the total number of sold items. Here we have
some freedom to choose the day of the sale where we mea-
sure these magnitudes. We have to balance two competing
influences. An early measurement may provide numbers of
sale which are statistically too small for a good estimate.
On the other hand on a late day of sales there might be too
much unsatisfied demand to estimate the demand since no
replenishment is possible in our application.
The business strategy of our partner implies to cut prices
until all items are sold. So, a very late measurement would
only estimate the supply instead of the demand. As there
is no expert knowledge to decide which is the optimal day
118
of sales to measure the sales and estimate the branch de-
pendent demand distribution we have adapted a statistical
test to measure the significance of the demand distributions
obtained for each possible day of counting the sold items.
Given a data set D, a day of sales d let φb,d(D) be the es-
timated demand for branch b determined using the amounts
of sold items up to day d as described above.
We normalize the values φb,d(D) so that we have∑
b∈B
φb,d(D) = 1 for each day of sales d, where B is the set
of branches. A common statistical method to analyze the re-
liability of a prediction based on some data universe D is to
randomly partition D into two nearly equally sized disjoint
samples D1 and D2 with D1∪̇D2 = D and to compare the
prediction based on D1 with the prediction based on D2. If
the two predictions differ substantially than the used predic-
tion method is obviously not very trustworthy or statistically
speaking not very robust.
In the following part of this section we analyze the robust-
ness of the prediction φb,d(D) for every possible sales day,
meaning that even an optimal sales day for the measurement
does not provide a prediction being good enough for our
purpose. To measure exactly by how much two predictions
φ·,d (D1) and φ·,d (D2) differ we introduce the following:
Definition 3.1 For a given sales day d and two samplesD1
and D2 we define the discrepancy δd as
δd (D1, D2) :=
∑
b∈B
|φb,d (D1) − φb,d (D2)| . (1)
Similarly we define a discrepancy between supply and de-
mand. We compare both discrepancies in Figure 1. The re-
sult: there is no measuring day for which the discrepancy be-
tween two samples is smaller than the discrepancy between
a sample and the supply. In other words, if we consider the
discrepancy between supply and demand as a measure for
the inconsistency of the supply distribution with the demand
distribution, then either the supply is not significantly incon-
sistent with demand (i. e., we should better change nothing)
or the measurements on the various samples are significantly
different (i. e., nothing can be learned about how to correct
the supply distribution).
0,00
0,05
0,10
0,15
0,20
0,25
0,30
0,35
Day
Di
sc
re
pa
nc
y
sales vs. sales
sales vs. supply
Figure 1: Discrepancy for the first 60 days.
An explanation why this obvious approach does not work
well in our case is due to the small sale numbers and the
interference of the demand of a branch with product attrac-
tivity and price cutting strategies. In Figure 2 we depict the
change of prediction φb,d(D) over time for five character-
istic but arbitrary branches
0,0000
0,0005
0,0010
0,0015
0,0020
0,0025
0,0030
Day
Re
la
tiv
e 
fr
ac
tio
n
Branch 1
Branch 2
Branch 3
Branch 4
Branch 5
Figure 2: Prediction φb,d(D) over time.
We would like to remark that one of the authors cur-
rently advises two diploma theses which check some com-
mon parametric models for demand forecasting on historic
sales data from literature. None of them gives significant in-
formation of the demand distribution over branches of our
data set because the data does not exhibit any similarity to
the parametric distributions coming from economic theory
and the like. This may be due to the fact that the contami-
nating effects of promotion, mark-downs, openings/closings
of competing stores prohibit a causal model for the demand.
We do not claim that the assumptions of parametric demand
models never hold, but in our application they are most cer-
tainly not met.
4 The Top-Dog-Index (TDI)
In the previous section we learned that in our application we
cannot utilize the most obvious approach of looking at the
sales distribution over the different branches on an arbitrary
but fixed day of the selling period of each individual product.
Since there is also no indication that any of the common
parametric models for the demand estimation directly from
sales data fit in our application we make no assumptions on
a specific stochastic distribution of the purchaser behavior.
Our new idea dismisses the desire to estimate an absolute
percental demand distribution for the branches. Instead we
develop an index measuring the relative success of a branch
in the competition of all branches that can be estimated from
historic sales data in a stable way.
To motivate our distribution free measurement we con-
sider the following thought experiment. For a given branch
b and given product p let θb(p) denote the stock-out-day.
Let us assume that we have θb(p) = θb′(p) for all products
p and all pairs of branches b, b ′. In this situation one could
certainly say that the branch-dependent demand is perfectly
matched by the supply. Our measure tries to quantify the
variation of the described ideal situation.
119
Therefore, we sort for each product p the stock-out-days
θb(p) in increasing order. If for a fixed product p a branch b
is among the best third according to this list it gets a winning
point for p. If it is among the last third it is assigned a losing
point for p. With Bp being the set of branches which trade
product p and P being the set of the products traded by the
company we can define more precisely:
Definition 4.1 Let b be a branch. The Top-Dog-Count is
defined asW(b) :=∣∣∣∣{p ∈ P ∣∣∣ 13 |Bp| > |{b ′ ∈ Bp | θb′(p) 6 θb(p)}|
}∣∣∣∣ (2)
and the Flop-Dog-Count is defined as L(b) :=∣∣∣∣{p ∈ P ∣∣∣ 13 |Bp| > |{b ′ ∈ Bp | θb′(p) > θb(p)}|
}∣∣∣∣ .
(3)
For a fix dampening parameter C > 0 let
TDI(b) :=
W(b) + C
L(b) + C
(4)
be the Top-Dog-Index (TDI) of branch b.
If the TDI of a branch b is significantly large compared
to the TDIs of the other branches then we claim that branch
b was undersupplied in the past. Similarly, if the TDI of
branch b is significantly small compared to the TDIs of the
other branches then we claim that branch b was oversup-
plied in the past. We give an heuristic optimization proce-
dure past on this information in the section. The effect of the
dampening parameter C is on the one hand that the TDI is
well defined since division by zero is circumvented. On the
other hand, and more important, the influence of small Top-
Dog- or Flop-Dog-Counts, which are statistically unstable,
is leveled to a decreased importance.
4.1 Statistical significance of the TDI
Similarly as in Section 3 we want to analyze the signifi-
cance of the proposed Top-Dog-Index on some real sales
data. Instead of two data setsD1 andD2 we use seven such
samples Di. Therefore we assign to each different product
p ∈ P a equi-distributed random number rp ∈ {1, 2, 3, 4}.
The samples Di are composed as summarized in Table 1.
D1 :=
{
p ∈ P
∣∣ rp ∈ {1, 2}}
D2 :=
{
p ∈ P
∣∣ rp ∈ {3, 4}}
D3 :=
{
p ∈ P
∣∣ rp ∈ {1, 3}}
D4 :=
{
p ∈ P
∣∣ rp ∈ {2, 4}}
D5 :=
{
p ∈ P
∣∣ rp ∈ {3}}
D6 :=
{
p ∈ P
∣∣ rp ∈ {1, 2, 4}}
D7 :=
{
p ∈ P
∣∣ rp ∈ {1, 2, 3, 4}}
Table 1: Assignment of test sets.
For the interpretation we remark that the pairs (D1, D2),
(D3, D4), and (D5, D6) are complementary. The whole
data population is denoted by D7 and equals P. We use
TDI (b,Di) as an abbreviation of TDI(b) where P is re-
placed by Di.
Since the Top-Dog-Index is designed as a non-
quantitative index we have to use another statistical test to
assure ourselves that it gives some significant information.
We find it convincing to regard the Top-Dog-Index as sig-
nificant and robust whenever we have
TDI (b,Di)
TDI (b,Dj)
≈ TDI
(b ′, Di)
TDI (b ′, Dj)
(5)
for each pair of branches b, b ′ and each pair of samples
Di, Dj. In words we claim that the Top-Dog-Index is a rela-
tive index which is independent of the underlying sample if
we consider a fixed universe D7.
Branches
Set 7
Set 6
Set 5
Set 4
Set 3
Set 2
Set 1
Figure 3: Relative distribution of the Top-Dog-Index on dif-
ferent data samples and branches.
Our first aim is to provide evidence that the TDI(b) val-
ues are robust measurements. There is a nice way to look at
equation (5) graphically. For each branch b let us plot a col-
umn of the relative values TDI(b,Di)∑
j
TDI(b,Dj)
for all i. The result
for our data set is plotted in Figure 3.
To get the correct picture in the interpretation of the plot
of Figure 3 we compare it to the extreme cases of determin-
istic numbers (i. e., TDI(b,Di)TDI(b,Dj) = cij = c for all i and j), see
Figure 4, and random numbers, see Figure 5.
Branches
Set 7
Set 6
Set 5
Set 4
Set 3
Set 2
Set 1
Figure 4: Relative distribution of deterministic numbers.
120
As a matter of fact, the regions of same color in the plot of
the relative distribution of deterministic numbers in Figure
4 are formed by perfect rectangles, which are not forced in
general to have equal height.
Branches
Set 7
Set 6
Set 5
Set 4
Set 3
Set 2
Set 1
Figure 5: Relative distribution of in [0.5, 1.5] equi-
distributed random variables.
As an example for a random plot we depict in Figure
5 the relative distribution of random numbers being equi-
distributed in the interval [0.5, 1.5].
In the plots of Figure 3, 4, and 5 we can see that that the
TDI on the given data set behaves more like a perfect deter-
ministic estimation than a random number distribution. (Ide-
ally, one should now quantify how large the probability is to
obtain a TDI chart as in Figure 3 by a random measurement.)
So there is empirical evidence that the TDI gives some sta-
ble information. As a comparison of the TDI and the method
described in Section 3 we depict the corresponding relative
distribution for measuring day 5 in Figure 6. Although a
measurement on this day was the best we could find, it still
produces more severe outliers than the TDI measurement.
Branches
Set 7
Set 6
Set 5
Set 4
Set 3
Set 2
Set 1
Figure 6: Relative distribution of φ·,5.
Now the question remains whether this information is
enough to cluster branches into oversupplied and undersup-
plied ones. More directly: is the distinctive character of the
TDI strong enough? We consider this question in the next
subsection. How the TDI information can be used to iter-
atively improve the branch dependent ratio between supply
and demand will be the topic of Section 5.
4.2 The distinctive character of the TDI
If one forces the values of the TDIs to be contained in an in-
terval of small length, then clearly a plot of the relative dis-
tributions would look like the plot of Figure 4. As an thought
experiment just imagine how Figure 5 would look like, if
we would use random numbers being equi-distributed in the
interval [0.9, 1.1] instead of being equi-distributed in the in-
terval [0.5, 1.5]
Forcing the possible values of the TDIs in an interval
of small length is feasible by choosing a sufficiently large
dampening parameter C. So this parameter has to be chosen
with care. We remind ourselves that we would like to use the
TDIs to cluster branches. Therefore the TDIs should vary
over a not to small range of values to have a good distinc-
tive character. Clearly by using the TDI we can only detect
possible improvements if the supply versus demand ratio ac-
tually inadequate in a certain level. In Figure 7 we have plot-
ted the occurring TDIs of our data set to demonstrate there
is indeed some variation of values in our data set, no mat-
ter which sample we consider (let alone the data universe).
As one can see the TDIs vary widely enough to distinguish
between historically under- and oversupplied branches.
0,00
0,50
1,00
1,50
2,00
2,50
3,00
Branches
TD
I
Figure 7: Occurring TDIs.
5 The heuristic supply optimization
procedure based on the TDI
So far we have developed and statistically stable index cap-
turing the deviation of supply from demand for each branch.
Now we have to specify how we can use this information
to improve the branch dependent ratio between supply and
demand.
Let S(b) be the historic supply of branch b being normal-
ized so that we have
∑
b∈B
S(b) = 1. Our aim is to estimate
supplies S̃(b), also fullfilling
∑
b∈B
S̃(b) = 1, which are more
appropriate concerning the satisfaction of demand by using
the TDI information.
Therefore let us partition the interval (0,∞) of the posi-
tive real numbers into a given number of l appropriate cho-
sen intervals Ij. Further we need l appropriately chosen in-
121
crement numbers ∆j. Our proposed update formula for the
estimated branch dependent demand is given by
S̃(b) =
S(b) + ∆j(b)∑
b′∈B S (b
′) + ∆j(b′)
(6)
for all branches b, where j(b) is the unique index with
TDI(b) ∈ Ij(b).
We do not claim that the S̃(b) are a good estimation for
the demand of all branches. Our claim is that they approach
a good estimation of the branch dependent demand if one it-
erates the described procedure over several rounds and care-
fully chooses the increment numbers ∆j, which may vary
over the time.
Once you have a new proposal S̃(b) of the relative supply
for each branch b, one only has to fit it into an integer val-
ued supply for each new product p ′. Given the problem of
apparel size assortment and pre-packing, this is easier said
than done and is subject of further studies.
In contrast to the other sections here we are somewhat im-
precise and there is a lot of freedom, e. g., how to choose the
intervals Ij and increment numbers ∆j. That is for several
reasons. On the one hand that is exactly the point where
some expert from the business should calibrate the param-
eters to specific data of the company. One the other hand
there are quite a lot of possibilities how to do it in detail.
Their analysis will be a topic of future research. For the
practical application we account rather simple than sophis-
ticated variants in the first step.
6 Conclusion and outlook
We have introduced the new Top-Dog-Index which is ca-
pable to cluster branches of a retail company into oversup-
plied and undersupplied branches at a statistically robust
level where more direct methods fail. The robustnest of
this method is documented by some statistical tests based
on real-world data.
We have also documented that the distinctive character of
the proposed TDI is significant for our application: for the
first time we can gain information about the demand dis-
tribution of branches from historic sales data on only few
products with volatile success in sales rates and with un-
known stock-out substitution effects, and this information
does not depend too much on the sample of the sales data
universe out of which the TDI is computed.
For the dynamic optimization of the supply distribution
among branches, some fine tuning of parameters is needed;
for a real-world implementation these details have to be
fixed. This, together with a field study of the impacts of
an improved supply distribution are research in progress.
Bibliography
[1] J. S. Armstrong (ed.), Principles of forecasting: A hand-
book for researchers and practitioners, Kluwer,
2001.
[2] A. Kok and M. Fisher, Demand estimation and assort-
ment optimization under substitution: Methodology
and application, Oper. Res. (to appear).
[3] S. Makridakis, S. Wheelwright, and R. Hyndman, Fore-
casting:methods and applications, Wiley, 2004.
[4] M. K. Mantrala and S. Rao, A decision-support sys-
tem that helps retailers decide order quantities and
markdowns for fashion goods, Interfaces 31 (2001),
no. 3b, 146–165.
[5] B. P. Pashigian, Demand uncertainty a sales: A study of
fashion and markdown pricing, The American Eco-
nomic Review 78 (1988), no. 5, 936–953.
[6] J. Yurkiewicz, Software survey: Forecasting 2000,
OR/MS Today 27 (2000), no. 1.
122
Chapter 13
The Top-Dog Index: A New Measurement for
the Demand Consistency of the Size
Distribution in Pre-Pack Orders for a Fashion
Discounter with Many Small Branches
SASCHA KURZ1, JÖRG RAMBAU2 , JÖRG
SCHLÜCHTERMANN3, AND RAINER WOLF4 5
ABSTRACT. We propose the new Top-Dog-Index, a measure for
the branch-dependent historic deviation of the supply data of ap-
parel sizes from the sales data of a fashion discounter. A common
approach is to estimate demand for sizes directly from the sales
data. This approach may yield information for the demand for
sizes if aggregated over all branches and products. However, as
we will show in a real-world business case, this direct approach is
in general not capable to provide information about each branch’s
individual demand for sizes: the supply per branch is so small that
either the number of sales is statistically too small for a good esti-
mate (early measurement) or there will be too much unsatisfied de-
mand neglected in the sales data (late measurement). Moreover, in
our real-world data we could not verify any of the demand distribu-
tion assumptions suggested in the literature. Our approach cannot
estimate the demand for sizes directly. It can, however, individually
measure for each branch the scarcest and the amplest sizes, aggre-
gated over all products. This measurement can iteratively be used
to adapt the size distributions in the pre-pack orders for the future.
A real-world blind study shows the potential of this distribution
free heuristic optimization approach: The gross yield measured in
percent of gross value was almost one percentage point higher in
the test-group branches than in the control-group branches.
1Sascha Kurz, Fakultät für Mathematik, Physik und Informatik, Univer-
sität Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
2Jörg Rambau, Fakultät für Mathematik, Physik und Informatik, Uni-
versität Bayreuth, Germany.
E-mail adress: joerg.rambau@uni-bayreuth.de
3Jörg Schlüchtermann, Fakultät für Rechts- und Wirtschaftswis-
senschaften, Universität Bayreuth, Germany.
E-mail adress: j.schluechtermann@uni-bayreuth.de
4Rainer Wolf, Betriebswirtschaftliches Forschungszentrum für Fragen
der mittelständischen Wirtschaft e. V. an der Universität Bayreuth, Ger-
many.
E-mail adress: rainer.wolf@uni-bayreuth.de
5This research was supported by the Bayerische Forschungsstiftung,
Project DISPO—A Decision Support for the Integrated Size and Price Op-
timization
2000 MSC: 90B05; 90B90.
Key words and phrases: revenue management, size optimization,
demand forecasting, Top-Dog-Index, field study, parallel blind
testing.
1 Introduction
The financial performance of a fashion discounter depends
very much on its ability to predict the customers’ demand for
individual products. More specifically: trade exactly what
you can sell to your customers. This task has two aspects:
offer what your customers would like to wear because the
product as such is attractive to them and offer what your
customers can wear because it has the right size.
In this paper, we deal with the second aspect only: meet
the demand for sizes as accurately as possible. The first as-
pect, demand for products, is a very delicate issue: Products
in a fashion discounter are never replenished because of lead
times of around three months. Therefore, there will never
be historic sales data of an item at the time when the order
has to be submitted (except for the very few “never-out-of-
stock”-items, NOS items, for short).
When one considers the knowledge and experience of
the professional buyers employed at a fashion discounter—
acquired by visiting expositions, reading trade journals, and
the like—it seems hard to imagine that a forecast for the de-
mand for a product could be implemented in an automated
decision support system at all. We seriously doubt that the
success of fashion product can be assessed by looking at
historic sales data only. In contrast to this, the demand for
sizes may stay reasonably stable over time to extract useful
information from historic sales data.
In the historic sales data the influences of demand for
products and demand for sizes obviously interfere. More-
over, it was observed at our partners’ branches that the de-
123
mand for sizes seems not to be constant over all around
1 200 branches.
The main question of this work is: how can we forecast
the demand for sizes individually for each branch or for a
class of branches?
1.1 Related Work
Interestingly enough, we have not found much work that ex-
actly deals with our task. It seems that, at first glance, the
problem of determining the size distribution in delivery pre-
packs can be considered as simple regression once you have
historic sales data: Just estimate the historic size profile and
fit your delivery to that. At least two trivial US-patents [6, 8]
have recently been granted and published along these lines
(which witnesses that the US patent system may not have
employed the necessary expertise in their patent evaluations
. . . ).
In our problem, however, the historic sales data is not nec-
essarily equal to the historic demand data, and it is interest-
ing how to find the demand data in the sales data in the pres-
ence of unsatisfied demand and very small delivery volumes
per branch and per product.
The type of research closest to ours seems to be classified
as assortment optimization. In a sense, we want to decide
on the start inventory level of sizes in a pre-pack for an in-
dividual product in an individual branch. (Let us ignore for
a moment that these unaggregated inventory levels are very
small compared to other inventory levels, e. g., for grocery
items.)
Mostly, the successful approaches deal rather with NOS
items than with perishable and not replenishable fashion
goods. For example, assortment optimization in the grocery
sector [4, Section 4] — one of the very few papers docu-
menting a field study — can usually neglect the effects of
stockout substitution in sales data, which make demand es-
timation from sales data much more reliable. There is work
on the specific influence of substitution on the optimization
of expected profit (see, e. g., [7]), but the problem of how to
estimate demand parameters from low-volume sales data in
the presence of stock-out substitution remains.
Much more work has been published in the field of dy-
namic pricing, where in one line of research pricing and in-
ventory decisions are linked. See [2, 3] for surveys.
A common aspect of all cited papers (and papers cited
there) that separates their research from ours is the follow-
ing: those papers, in some sense, postulate the possibility
to estimate a product’s demand in an individual branch di-
rectly from sales data, in particular from sales rates. In our
real-world application we have no replenishment, small de-
livery volumes per branch, lost sales with unknown or even
no substitution, and sales rates depending much more on the
success of the individual product at the time it was offered
than on the size. Therefore, estimating future absolute de-
mand data from historic sales data directly seems to need
extra ideas, except maybe for the data aggregated over many
branches.
Size optimization can be found in a few of-
fers of retail optimization systems, like 7thOnline
(http://www.7thonline.com). It is not clear,
on what kind of research these products are based and
under which assumptions they work well. Our partner firm
has checked several offers in the past and did not find any
optimization tools that met their needs.
1.2 Our contribution
The main result of this work is: a useful forecast for the
demand for sizes on the level of individual branches is too
much to be asked for, but historic information about which
sizes have been the scarcest and which sizes have been the
amplest ones can be obtained by measuring the new Top-
Dog-Index (TDI). The TDI can be utilized in a dynamic
heuristic optimization procedure, that adjusts the size dis-
tributions in the branches’ corresponding pre-packs accord-
ingly until the difference between the scarcest and the am-
plest sizes can not be improved anymore. The main benefit
of the TDI: it measures the consistency of historic supply
with sizes with the historic demand for sizes in a way that is
not influenced by the attractivity of the product itself. This
way, we can aggregate data over all products of a product
group, thereby curing the problem with small delivery vol-
umes per branch and product and size.
The potential of our TDI-approach is shown in a blind-
study with 20 branches and one product group (womens’
outer garments). Ten branches randomly chosen from the
20 branches (test-branches) received size pre-packs accord-
ing to our heuristics’ recommendations, ten received un-
changed supply (control-branches). The result: One per-
centage point increase of gross yield per merchandise value
for the test-branches against the control-branches. A con-
servative extrapolation of this result for our partner would
already mean a significant increase of gross yield.
We have not seen any field study of this type documented
in the literature so far. The only documented yield manage-
ment studies in the apparel retail business (e. g., for dynamic
pricing policies) try to prove the success of their methods by
showing that they would have gained something on the set of
data that was used to estimate the parameters of the model
[1]. Such tests are very far from reality: a by-product of
our study is that in our case it makes absolutely no sense to
compare gross yield data of a fashion discounter across sea-
sons, because the differences between the yields in different
seasons are much larger than the differences caused by any-
thing we are interested in. This was the reason for us to use
the parallel blind testing instead.
Further tests are planned by our partner on a larger scale
in the near future.
1.3 Outline of the paper
In Section 2, we briefly restate the real-world problem we
are concerned with. In Section 3, we show our experience
with straight-forward estimators for the demand distribution
on sizes. In Section 4, we introduce the new Top Dog In-
dex, which is utilized in Section 5 in a heuristic optimization
124
procedure. Section 6 is the documentation of a field study
containing a blind testing procedure among two groups of
branches: one supplied with and one supplied without the
suggestions from the first step of the optimization heuris-
tics. We summarize the findings in Section 7, including
some ideas for further research.
2 The real-world problem
In this section, we state the problem we are concerned with.
Before that we briefly provide the context in which our prob-
lem is embedded.
2.1 The supply chain of a fashion discounter
As in most other industries the overall philosophy of sup-
ply chain management in fashion retailing is to coordinate
the material flow according to the market demand. The cus-
tomer has to become the “conductor” of the “orchestra” of
supply chain members. Forecasting the future demand is,
therefore, crucial for all logistics activities. Special prob-
lems occur in cases like ours, when the majority of inventory
items is not replenished, because the relationship between
lead times and fashion cycles makes replenishments simply
impossible. The resulting “textile pipeline” has strong inter-
dependencies between marketing, procurement, and logis-
tics.
The business model of our real world problem bases on
a strict cost leadership strategy with sourcing in low cost
countries, either East Asia or South East Europe. The trans-
portation time is between one and six weeks, economies of
scale are achieved via large orders.
2.2 Internal stock turnover of pre-packs
The material flow in our problem is determined by a cen-
tral procurement for around 1 200 branches. All items are
delivered from the suppliers to a central distribution center,
where a so called “slow cross docking” is used to distribute
the items to the branches. Some key figures may give an
impression of the situation: 32 000 square meters, 80 work-
ers, 30 000 tons of garment in 10 million lots per year. Each
branch is delivered once a week with the help of a fixed rout-
ing system. This leads to a sound compromise between in-
ventory costs and costs of stock turnover.
There are two extreme alternatives for the process of pick-
ing the items. The retailer can either work with one basic lot
and deliver this lot or integer multiples of it for every article
to the branches, or he develops individual lots for the shops.
At the beginning of our analysis most of the articles were
picked in one basic lot, but more than 40 other constellations
were used additionally. The costs for picking the items are
not relevant for the following analysis because only minor
changes of internal processes are necessary. Only in later
phases of our project a detailed analysis of the picking costs
will be needed.
2.3 The problem under consideration
Recall that the stock turn-over is accelerated by ordering
pre-packs of every product, i. e., a package containing a
specified number of items of each size. We call the corre-
sponding vector with a non-negative integral entry for every
size a lot-type.
In this environment, we focus on the following problem:
Given historic delivery data (in terms of pre-packed lots of
some lot-type for each branch) and sales data for a group
of products for each branch, determine for each branch a
new lot-type with the same number of items that meets the
relative demand for sizes more accurately.
In particular, find out from historic sales data some in-
formation about the relative demands for sizes. We stress
the fact that stockout substitution in the data can not be ne-
glected since replenishment does not take place (unsatisfied
demand is lost and does not produce any sales data). We also
stress the fact that we are not trying to improve the number
of items delivered to each branch but the distribution of sizes
for each branch only.
3 Some real-data analysis evaluating
seemingly obvious approaches
To deal with the problem described in Section 2 our partner
has provided us some historic sales data for approximately
1 200 branches over a time period of 12 months. The task
was to forecast the size distribution of the future demand
for each branch. A possible size distribution is depicted in
Figure 1.
Table 1: A possible size distribution of the demand.
The most obvious way to determine a size distribution as
in Figures 1 is to count the number of sold items per size and
divide by the total number of sold items. Here we have some
freedom to choose the day of the sale where we measure the
amounts. We have to balance two competing facets. An
early measurement may provide sales figures which are sta-
tistically too small for a good estimate while a late measure-
ment may suffer from unsatisfied demand that is not present
in the sales data.
125
The business strategy of our partner implies to cut prices
until all items are sold. So, a very late measurement would
only estimate the supply instead of the demand. As there is
no expert knowledge to decide which is the optimal day of
sales to count the amounts and estimate the size distribution
we have applied a statistical test to measure the significance
of the size distributions obtained for each possible day of
counting the sold items.
Given a data set D, a day of sales d, and a size s
let φs,d(D) be the estimated demand for size s mea-
sured on day d as described above. We normalize so that∑
s
φs,d(D) = 1 for each day and each data set. Our sta-
tistical test partitions the original data set D randomly into
two disjoint data sets D1 and D2. Naturally we would not
trust a forecast φ whenever φs,d (D1) and φs,d (D2) are
too far apart. Statistically speaking φ would not be ro-
bust in that case. To measure more precisely how far apart
φs,d (D1) and φs,d (D2) are, we define the discrepancy δd
as δd (D1, D2) :=
∑
s
|φs,d (D1) − φs,d (D2)|. In Figure 2
we have depicted the average discrepancy over all branches
for the first 60 days of sale.
Table 2: Average discrepancy δd over all branches.
For our practical application the significance of φ is too
low for all possible days of measurement. We remark that
in our examined data set the discrepancy δd tends to 0.19
as d tends to the end of the sales period. An explanation
why this obvious approach does not work in our case is due
to the small sales numbers and the interference of product
attractivity and price cutting strategies.
Even when we tried to use only use ordinal information
generated from an estimated size distribution (some size is
too scarce, some size too ample), we encountered different
results from different samples (same size was scarce in one
sample and ample in the other).
In the same manner we have checked some common para-
metric models (mostly based on an estimation of a constant
sales rate for each individual product-size pair) for demand
forecasting on historic sales data from literature. None of
them gives significant information of the size distribution of
the demand of our data set, since the sales rates vary dras-
tically and depend more on the attractivity of the products
than on the sizes. For the details we refer to two diploma
theses [5, 9] from our group.
4 The Top-Dog-Index (TDI)
In the previous section we learned that in our application,
first, we cannot trust the common parametric models for the
demand distribution and, second, measuring a size profile
directly from sales data may lead to more or less random de-
cisions. The main reason for the latter is the former and the
interference between attractiveness of offered products and
compatibility of offered sizes. Because of this, the stockout
saturation of sales data happens at almost all times during
the sales period, and thus aggregating the sales data of dif-
ferent products yields no reasonable information.
Our new idea throws overboard the desire to estimate an
absolute size profile of the demand in every branch. Instead,
we try to define a measure for the scarcity of sizes during the
sales process that can be estimated from historic sales data
in a stable way.
The following thought experiment is the motivation for
our distribution free measure: Consider a product, for which
in a branch all sizes are sold out at the very same day. This
can be regarded as the result of an ideal balance between
sizes in the supply. Our measure tries to quantify the devi-
ation of this ideal situation in historic sales data. How can
this be done? In the following, we extract data of a new type
from the sales process.
Fix a delivery period ∆ := [0, T ] from some day in the
past normed to day 0 to day T . Let B be the set of all
branches that are operating in time interval ∆, and let P be
the set of all products in a group delivered in time interval ∆
in sizes from a size set S. We assume that in each branch the
product group can be expected to have homogeneous de-
mand for sizes throughout the time period. Fix b ∈ B. For
each p ∈ P and for each s ∈ S let θb(p, s) be the stockout-
day of size s of product p, i. e., the day when the last item
of p in size s was sold out in branch b.
Fix a size s ∈ S. Our idea is now to compare for how
many products p size s has the earliest stockout-day θ(p, s)
and for how many products p size s has latest stockout-
day θ(p, s). These numbers have the following interpre-
tation: If for many more products the stockout-day of the
given size was first among all sizes, then the size was scarce.
If for many more products the stockout-day of the given size
was last among all sizes, then the size was ample.
In order to quantify this, we use the following approach.
(In fact, it is not too important how we exactly quantify our
idea, since we will never use the absolute quantities for deci-
sion making; we will only use the quantities relative to each
other.)
Definition 4.1 (Top-Dog-Index) Let s ∈ S be a size and b
be a branch.
The Top-Dog-Count Wb(s) for s in b is defined as
Wb(s) :=
∣∣∣∣{ p ∈ P | θb(p, s) = mins′∈S θb (p, s ′)
}∣∣∣∣
126
and the Flop-Dog-Count Lb(s) in b is defined as
Lb(s) :=
∣∣∣∣{ p ∈ P | θb(p, s) = maxs′∈S θb (p, s ′)
}∣∣∣∣ .
Moreover, for a fixed dampening parameter C > 0 let
TDIb(s) :=
Wb(s) + C
Lb(s) + C
be the Top-Dog-Index (TDI) of Size s in Branch b.
In the data of this work, we used C = 15.
4.1 Statistical significance of the Top-Dog-
Index
In a similar way as in Section 3 we want to analyze the sig-
nificance of the proposed Top-Dog-Index. Since this method
is supposed to be applied to a real business case, we analyze
the statistical significance in more detail. Instead of two data
sets D1 and D2 as in Section 3 we utilize seven such sets
Di. Therefore, we assign a random number in {1, 2, 3, 4}
to each different product. The sets are composed of the
data of products where the corresponding random number
lies in a characteristic subset of {1, 2, 3, 4}. See Table 3 for
the assignment. For the interpretation we remark that the
pairs (D1, D2), (D3, D4), and (D5, D6) are complemen-
tary. The whole data set is denoted by D7.
D1 {1, 2}
D2 {3, 4}
D3 {1, 3}
D4 {2, 4}
D5 {3}
D6 {1, 2, 4}
D7 {1, 2, 3, 4}
Table 3: Assignment of test sets.
Since the Top-Dog-Index is designed to provide mainly
ordinal information, we have to use another statistical test
to make sure that it yields some significant information.
Let TDIb(s,Di) denote the Top-Dog-Index in Branch b of
Size s computed from the data in Data Set Di. We find it
convincing to regard the ordinal information generated by
the Top-Dog-Index as robust whenever we have
TDIb(s,Di) TDIb(s ′, Di)
⇐⇒ TDIb(s,Dj) TDIb(s ′, Dj) (1)
for each pair of sizes s, s ′ and each pair of data setsDi, Dj.
In words: the order of Top-Dog-Indices of various sizes does
not change significantly when computed from a different
sample. The following is a sufficient condition for this to
happen:
TDIb(s,Di)∑
j TDIb(s,Dj)
≈ consti (2)
Our first aim is to provide evidence that the TDIb(s) val-
ues are robust measurements in this sense. There is a nice
way to look at Equation (2) graphically. Let us fix a size s.
For each branch b let us plot a column of the relative values
TDIb(s,Di)∑
j TDIb(s,Dj)
for all branch-size combinations and for all i.
The columns corresponding to the same branch-size combi-
nation but different samples are stacked on top of each other.
This way, each column stack has height one in total, and
the size relations of the measurements based on the different
samples can be assessed right away. To show the robustness
of the mean and the median, we have added an additional
column for each of them: The median of the seven estimates
corresponds to the height of the top-most column, the mean
to the height of the second-to-top-most column. The goal
now is not to read off the exact values, but to get an intu-
itive impression how heavy an estimate depends on the data
subset it was computed from.
The Top-Dog-Indices are plotted this way in Figure 1.W/L aller Stichprobendatensets, Median und Mittel
0%
20%
40%
60%
80%
100%
1 436 871 1306 1741 2176 2611 3046 3481 3916 4351 4786 5221 5656 6091
Filialnummer
A
n
te
il
 a
n
 d
e
r 
S
u
m
m
e
 ü
b
e
r 
a
ll
e
 
S
ti
ch
p
ro
b
e
n
d
a
te
n
se
ts
W/L Mittel
W/L Median
W7/L7
W6/L6
W5/L5
W4/L4
W3/L3
W2/L2
W1/L1
Figure 1: Relative distribution of the Top-Dog-Index on
seven data subsets for all branch-size combinations; the two
top-most columns are median and mean, resp.
W/L aller Stichprobendatensets, Median und Mittel
0%
20%
40%
60%
80%
100%
1 436 871 1306 1741 2176 2611 3046 3481 3916 4351 4786 5221 5656 6091
Filialnummer
A
n
te
il
 a
n
 d
e
r 
S
u
m
m
e
 ü
b
e
r 
a
ll
e
 
S
ti
ch
p
ro
b
e
n
d
a
te
n
se
ts
W/L Mittel
W/L Median
W7/L7
W6/L6
W5/L5
W4/L4
W3/L3
W2/L2
W1/L1
W/L aller Stichprobendatensets, Median und Mittel
0%
20%
40%
60%
80%
100%
1 436 871 1306 1741 2176 2611 3046 3481 3916 4351 4786 5221 5656 6091
Filialnummer
A
n
te
il
 a
n
 d
e
r 
S
u
m
m
e
 ü
b
e
r 
a
ll
e
 
S
ti
ch
p
ro
b
e
n
d
a
te
n
se
ts
W/L Mittel
W/L Median
W7/L7
W6/L6
W5/L5
W4/L4
W3/L3
W2/L2
W1/L1
Figure 2: Relative distribution of deterministic and random
numbers on seven data subsets and branches; the two top-
most columns are median and mean, resp.
In order to provide some intuitively clear reference data to
compare to the plot of Figure 1, we present the correspond-
ing plots for the two extreme cases of deterministic numbers
(i. e., TDIb(s,Di) = TDIb(s,Dj) for all i and j) and totally
random numbers in Figure 2. In the complete determinis-
tic case the areas of same color form perfect rectangles. In
the random case the areas of same color corresponding to
the data subsets form zig-zag lines; the median has fewer
zig-zag than the mean, but both are quite stable because the
random numbers are all from the same distribution.
It is immediately obvious that the plot of Figure 1 looks
127
more like the plot in the deterministic case as the plot in the
random case. It is interesting to note that the dampening pa-
rameter in the computation of the TDI does indeed influence
the amount of noise in the plot but had almost no influence
on the order of TDI values, which is what we intend to use.
Size distribution of Sales up to Day 0 for all 7 Data Subsets
0%
20%
40%
60%
80%
100%
1 282 563 844 1125 1406 1687 1968 2249 2530 2811 3092 3373 3654 3935 4216 4497
Branch No. / Size Combination
Median
Mean
Sample 7
Sample 6
Sample 5
Sample 4
Sample 3
Sample 2
Sample 1
Figure 3: Relative distribution of sales up to Day 0 on on
seven data subsets for all branch-size combinations; the two
top-most columns are median and mean, resp.
Size distribution of Sales up to Day 12 for all 7 Data Subsets
0%
20%
40%
60%
80%
100%
1 282 563 844 1125 1406 1687 1968 2249 2530 2811 3092 3373 3654 3935 4216 4497
Branch No. / Size Combination
Median
Mean
Sample 7
Sample 6
Sample 5
Sample 4
Sample 3
Sample 2
Sample 1
Figure 4: Relative distribution of sales up to Day 12 on on
seven data subsets for all branch-size combinations; the two
top-most columns are median and mean, resp.
Recall that we have analyzed the direct estimation of size
distributions for each branch by looking at two complemen-
tary samples of the data set. In order to be able to directly
compare the results of that attempt to Figure 1, we plot the
size distributions for the same seven data subsets. This is
shown in Figure 3 for an estimate from the sales up to Day 0
(the first day in the sales period) and in Figure 4 for an esti-
mate from the sales up to Day 12.
It can be seen that Day 0-estimates are extremely depen-
dent on the data subset even if only the relative values are
taken into account, i. e., the estimates are not robust even
in the weak sense measured in the plot. The Day-12 esti-
mates are more robust, but not even close to what the TDI
achieves in Figure 1. Moreover, as we said, those estimates
are already quite close to the supply because of unsatisfied
demand, and will therefore fail to measure the size distribu-
tion of the demand.
Generating a robust statistics for a set of data is, of course,
easy: just assign the same deterministic number to each ob-
ject. This is not what we want since this does not carry any
useful information. We claim that the Top-Dog-Index ex-
hibits differences between demands for sizes in each branch
individually. That this is indeed the case, follows from the
Top-Dog-Indices that we encountered in the field study doc-
umented below. But let us first discuss which actions we
could take to improve the size distributions of the branches’
supply.
So far we have argued that the Top-Dog-Index produces
size-related information in a robust way, while other meth-
ods fail (at least for our given real-world data). In the next
section we describe a procedure to harmonize demand and
supply with respect to the size distribution. In Section 6
we provide evidence via a real-world blind study that this
procedure helps to raise the gross yield in reality; thus, the
Top-Dog-Index is correlated to the size distribution of the
demand.
5 The heuristic size optimization pro-
cedure based on the TDI
Interesting for us is not the absolute TDI of a size but the
TDIs of all sizes in a branch compared to each other, i. e.,
the ordinal information implied by the TDIs. The size with
the maximal TDI among all sizes can be interpreted as
the scarcest (the one that was sold the fastest) size in that
branch; the size with the minimal TDI among all sizes can
be interpreted as the amplest size in that branch. Of course,
we have the problem of deciding whether or not a maximal
TDI is significantly larger than the others. Since the absolute
values of the TDIs have no real meaning we did not even try
to assess this issue in a statistically profound way.
Our point of view is again that absolute forecasting is
too much to be asked for. Therefore, we resort to a dy-
namic heuristic optimization procedure: sizes with “signif-
icantly” large TDIs (Top-Dog-Sizes) should receive larger
volumes in future deliveries until their TDIs do not improve
anymore, while sizes with “significantly” small TDIs (Flop-
Dog-Sizes) need smaller supplies in the future. Whenever
this leads to oversteering, the next TDI analysis will show
this, and we go back one step. This is based on the assump-
tion that the demand for sizes does not change too quickly
over time. If it does then optimization methods based on
historic sales data are useless anyway.
Let us describe our size distribution optimization ap-
proach in more detail.
We divide time into delivery periods (e. g., one quarter of
a year). We assume that the sales period of any product in
a delivery period ends at the end of the next delivery period
(e. g., half a year after the beginning of the delivery period).
Recall that a size distribution in the supply of a branch is
given by a pre-pack configuration: a package that contains
for each size a certain number of pieces of a product (com-
pare Subsection 2.2).
We want to base our delivery decisions for an up-coming
period on
• the pre-pack configuration of the previous period and
• the TDI information of the previous period giving us
the deviation from the ideal balance
128
According to given restrictions from the distribution system,
we assume that only one pre-pack configuration per branch
is allowed. We may use distinct pre-pack configurations for
different branches, though.
Since we are only dealing with the size distribution of the
total supply but not with the total supply for a branch itself,
the total number of pieces in a pre-pack has to stay constant.
Since the TDI information only yields aggregated informa-
tion over all products in the product group, all products of
this group will receive identical pre-pack configurations in
the next period, as desired.
In order to adjust the supply to the demand without chang-
ing the total number of pieces in a pre-pack, we will remove
one piece of a Flop-Dog-Size from the pre-pack and add one
piece of a Top-Dog-Size instead. At the end of the sales pe-
riod (i. e., at the end of the next delivery period), we can do
the TDI-analysis again and adjust accordingly.
Given the usual lead times of three months this leads to a
heuristics that reacts to changes in the demand for sizes with
a time lag of nine month to one year. Not exactly prompt, but
we assume the demand for sizes to be more or less constant
over longer periods of time.
The most interesting question for us was how much, in
practice, could be gained by performing only one step of the
heuristics explained above.
6 A real-world blind study
In this section we describe the set-up and the results of the
blind study carried out by our partner. A summary of pa-
rameters can be found in Table 4.
Test period : April through June 2006
(3 Months)
Data collection period: April through September
2006 (6 Months)
Branches: 20 branches with unbalanced
TDIs randomly classified into
10 test and 10 control branches
Pieces of merchandise: approx. 4 000 pieces for all test
and control branches
Merchandise value: approx. 30 000e
Table 4: Summary of parameters of the blind study.
6.1 Selection of branches
A reasonable selection of branches for a test and a control
group had to meet essentially three requiremens: first, only
those branches should be chosen whose TDI indicated that,
in the past, the supply by sizes did not meet the demand for
sizes; secondly, no branch should be chosen, where other
tests were running during the test period; thirdly, the assign-
ment of branches to test- and control group should be com-
pletely random. The reason for the third aspect was that this
way all other influences on the gross yield than the selection
special no
test group advertising advertising
Branch remove add remove add
1 L XL L XL
2 M XL M XL
3 L XL S XL
4 L XL S XL
5 M XL M XL
6 M XL M XL
7 M XL M XL
8 L XL S XL
9 M XL M XL
10 M XL M XL
Table 5: How the pre-packs were modified in the test group.
of sizes would appear similarly in both the test group and
the control group and, thus, would average out evenly.
We suggested a set of 50 branches with interesting Top-
Dog-Indices to our partner. Out of these 50 branches, our
partner chose 20 branches where a potential re-packing of
pre-packs would be possible. This set of 20 branches was
fixed as the set of branches included in our blind study.
After that, a random number between 0 and 1 was as-
signed to each of the 20 branches. The 10 branches with the
smallest random numbers were chosen to be the test group,
the rest was taken as the control group.
6.2 Handling of pre-packs
Next, we had to specify the modifications to the size dis-
tribution in pre-packs on the basis of the TDI information.
It turned out that additional side constraints had to be sat-
isfied: Whenever a product would appear in an advertise-
ment flyer, the pre-pack had contained at least one piece in
each of the four main sizes S, M, L, and XL. That means,
although sometimes the TDI suggested that S was the am-
plest size, we could not remove the only piece in S from
the pre-pack. We removed a piece of the second amplest
size (M or L, of which there were two in the unmodified
pre-packs) instead. To all branch deliveries, one additional
piece of XL was packed, because this was the scarcest size
in every branch in the test group. This way, the total number
of pieces was unchanged in every pre-pack, as suggested in
Section 5.
Since all orders had been placed well before the decision
to conduct a blind study, our partner re-packed all pre-packs
for the test branches according to Table 5.
6.3 Time frame
The test included two relevant time periods: the first period
from which the TDI data was extracted and the test period
in which the recommendations based on the TDI data were
implemented for the test group.
The TDI data was drawn from a delivery period of nine
month (January through September 2005) and a sales period
129
of twelve month (January through December 2005).
The test data was drawn from a delivery period of three
months (April through June 2006) and a sales period of six
months (April through September 2006).
6.4 Data collection
In order to sort out contaminated data easily, our partner
agreed to take stock to check inventory data for correctness
every month. To receive a good estimate for the financial
benefit of the supply modification proposed by the proce-
dure described in the previous section we had defined some
criteria how to detect contaminated data automatically via a
computer program.
6.5 Data analysis
Top-Dog Index (TDI) for Various Samples
(Mean of Test Branches before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
 
Figure 5: TDI in the test branches from historic sales data.
Top-Dog Index (TDI) for Various Samples
(Mean of Control Branches before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
 
Figure 6: TDI in the control branches from historic sales
data.
The initial situation was given by the data set described in
Section 3. In Figure 5 we have depicted the initial Top-Dog-
Indices for the test branches and in Figure 6 the initial Top-
Dog-Indices for the control branches. Moreover, Figures 7
and 8 finally show the situations for the individual branches.
The analysis of our field study was intended to answer
the following two main questions: are the Top-Dog-Indices
better distributed in the test branches than in the control
branches, and, if yes, does this have a significant monetary
impact?
Top-Dog Index (TDI) for Various Samples
(Test Branch 1 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 3 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 5 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 7 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 9 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 2 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 4 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 6 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 8 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 10 before Field Study)
0
0,5
1
1,5
2
2,5
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Figure 7: Individual TDIs in test branches from historic
sales data.
To investigate the latter, we had to analyze some mone-
tary variables. The most important monetary indices for our
partner are the gross yield and the last price. The gross yield
directly shows how much turnover was lost using a price cut-
ting strategy to sell out all items. The last price tells us how
far one was forced to dump items provoked by an inadequate
size distribution of the supply. Since the values of different
products vary widely we only consider relative values. So,
the gross yield is given by the ratio of realized turnover and
theoretic revenue without cutting the prices.
Since we had to deal with a large amount of lost or incon-
sistent data, we have applied two ways of evaluating gross
yield and last price. Imagine that your data says that you
have sold 10 items of a given article in a given branch but
that the supply was only 8 items. Or the other way round that
the initial supply was 10 items, during the time 8 items were
sold, but all items are gone. Both of the described situations
occurred significantly often in our data set.
Our first strategy to evaluate the given data was to ignore
inconsistent data. In the first case, 8 sale transactions are
130
consistent. For the remaining two items the corresponding
supply transaction is missing. So, we simply ignore these
transactions. In the other case we would ignore the supply
of two items.
Top-Dog Index (TDI) for Various Samples
(Control Branch 1 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 3 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 5 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 7 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 9 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 2 before Field Study)
0
0,5
1
1,5
2
2,5
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 4 before Field Study)
0
0,5
1
1,5
2
2,5
3
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 6 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 8 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 10 before Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Figure 8: Individual TDIs in control branches from historic
sales data.
The alternative to ignoring inconsistent data is to estimate
or recover it from the rest of the data set. As an example, we
would simply assume that there was a supply of 10 items
instead of 8 items at the same price level in the first case. In
the second case we would assume that the remaining 2 items
were also sold. Maybe they were shoplifted, some sort of
selling for a very cheap prize. So, we need an estimation for
the selling prize of the two missing items. Here, we have
used the last selling price over all sizes for this product in
this branch as an estimate.
Neither evaluation method reflects reality exactly. Our
hope was that both estimations encompass the true values.
At least our partner accepts both values as a good approxi-
mation of reality. The truth may be somewhere in between
both values.
6.6 Results
Top-Dog Index (TDI) for Various Samples
(Test Branch 1 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 3 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 5 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 7 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 9 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 2 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 4 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 6 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 8 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Test Branch 10 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Figure 9: Individual TDIs in test branches in test period.
We have depicted the new Top-Dog-Indices after applying
our proposed repacking in Figure 10 for the test branches
and in Figure 12 for the control branches. Figures 9 and 11
finally show the results for the individual branches.
Top-Dog Index (TDI) for Various Samples
(Mean of Test Branches after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
 
Figure 10: TDI in the test branches in test period.
We can see in Figure 8 and 11 that the absolute Top-
Dog-Indices are not as constant over seasons as we would
131
Top-Dog Index (TDI) for Various Samples
(Control Branch 1 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 3 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 5 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 7 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 9 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 2 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 4 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 6 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 8 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Top-Dog Index (TDI) for Various Samples
(Control Branch 10 after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
Figure 11: Individual TDIs in control branches in test pe-
riod.
wish. However, the induced order on sizes seems quite sta-
ble across seasons, and this is all we try to exploit.
Top-Dog Index (TDI) for Various Samples
(Mean of Control Branches after Field Study)
0
0,2
0,4
0,6
0,8
1
1,2
1,4
Median of all
Samples
Sample 1 Sample 2
(Complement of
1)
Sample 3 Sample 4
(Complement of
3)
Sample 5 Sample 6
(Complement of
5)
Sample 7
(All Data)
Sample No.
TDI
S
M
L
XL
 
Figure 12: TDI in the control branches in test period.
We can see that it is rather hard to compare the Top-
Dog-Indices of the same branches before and after the blind
study. The situation on the real market almost never stays
constant over time. There are so many influences not con-
sidered in our study that it would have been a bad idea to
measure a possible raise of earnings directly. For this rea-
son, the simultaneous observation of a test group and a con-
trol group makes all outer effects appear in both.
Comparing Figure 10 and Figure 12 based on the same
time period, it appears that the Top-Dog-Indices of the test
group have improved more.
More specifically, in Figures 9 and 11 we see that in some
of the test branches (especially, Test Branches 5 and 6),
Size XL is no longer too scarce, while it remains too
scarce in other branches. Moreover, on average over all test
branches, the Top-Dog-Indices of Sizes S, M, and L are bet-
ter balanced, while in the control branches the correspond-
ing Top-Dog-Indices differ.
While the former achievement might have been equally
possible on the basis of a statistics aggregated over all
branches, it seems that the latter result was made possible
only by the branch dependent information from the Top-
Dog-Index, since different sizes were removed from the pre-
packs in favor of XL. Moreover, some of the test branches
still need fewer pieces in Size XL, some test branches don’t.
That is, in the next optimization step, the branch dependent
information becomes vital also for the supply with Size XL.
But is an improved Top-Dog-Index really an improvement
for the business? To answer this question, we have quanti-
fied the gross yields and the last prices in the test group and
the control group, resp.
75,00%
80,00%
85,00%
90,00%
95,00%
100,00%
last price         (sorted out) last price      (estimated) gross yield     (sorted out) gross yield      (estimated)
test branches
control branches
Figure 13: Average last prices/gross yields per merchandise
value.
In Figure 13 we have compared the average values of the
gross yield and the last price for the control and the test
branches for both evaluation methods. The gross yield of
the test branches is 98.0 % using the ignore and 97.2 % using
the estimate method. For the control branches we have gross
yields of 97.2 % (ignore) and 95.7 % (estimate). This corre-
sponds to improvements of 0.85 and 1.5 percentage points,
resp.
The improvement for the last price is even larger. The
test branches show a last price level of 94.2 % (ignore) and
94.1 %; the control branches exhibit a last price level of
92.5 % (ignore) and 92.7 % (estimate). This corresponds to
improvements of 1.7 and 1.4 percentage points, resp.
The drastically improved results for the respective “loser
branches” (see Figure 14) and the reduced standard devia-
132
75,00%
80,00%
85,00%
90,00%
95,00%
100,00%
last price         (sorted out) last price      (estimated) gross yield     (sorted out) gross yield      (estimated)
test branches
control branches
Figure 14: Minimal last prices/gross yields per merchandise
value.
last price         
(sorted out)
last price      
(estimated)
gross yield     
(sorted out)
gross yield      
(estimated)
0,00%
1,00%
2,00%
3,00%
4,00%
5,00%
6,00%
7,00%
8,00%
9,00%
10,00%
test branches
control branches
Figure 15: Standard deviation of last prices/gross yields per
merchandise value.
tion (see Figure 15) in the data of the test branches provides
evidence for the fact that our procedure was able to reduce
the risk of a very low last price or a very low gross yield
in an individual branch. This effect is desirable beyond the
better earnings, as very low last prices undermine the image
of the retailer.
6.7 Statistical evidence of the improvement of
the gross yield
As in the previous sections we analyze our results con-
cerning the gross yield from the statistical point of view.
Faced with the fact of a widely varying gross yield over the
branches with no appropriate theoretic sales model, we have
to restrict ourselves to distribution-free statistics.
Therefore, we adapt the Wilcoxon rank sum test to our
situation. This is a test method to find out whether or not
two data sets are drawn from the same distribution. We sort
in increasing order the gross yields of the 20 branches par-
ticipating in our blind study. We associate the largest value
with Rank 1, the second largest with Rank 2, and so on.
Then we form the rank sums of the test branches and the
control branches, resp. The more the rank sums differ, the
less likely is the event that our method did not influence the
gross yields/last prices at all.
For the Wilcoxon rank sum test, it is vital that we have
partitioned the 20 branches for the blind study indepen-
dently at random into test and control branches.
It is intuitively clear that a smaller rank sum for the gross
yield/last price is more likely if the corresponding expected
values are better. A lower rank sum can indeed occur by
pure coincidence, but the probability decreases with the rank
sum. As an example, the rank sum for the test branches
regarding the gross yield measured by the ignore method
is 89. If we had not changed anything, the chance to receive
a rank sum of 89 or lower would have been 12.4 %. So,
we have a certainty of 87.6 % that our proposed re-packing
improved the situation. (More formally: the probability that
the gross yields of the test branches and the gross yields of
the control branches stem from the same distribution, i. e.,
nothing has changed systematically, is at most 12.4 %.)
Now we consider different scenarios. Let yi(b) be the
gross yield measured with the method ignore of branch b
and ye(b) the gross yield measured with the method esti-
mate. By ic we denote the scenario where we consider the
values yi(b) for control branches and the values yi(b)+ c100
for test branches. Similarly, we define the scenarios for ec
utilizing ye(b) instead of yi(b). In Table 6 we have given
the rank sums and the certainties of some scenarios.
i−0.00 e−0.00 i−0.25 e−0.25
control group 121 131 118 128
test group 89 79 92 82
certainty (%) 87.6 97.4 82.4 95.5
i−0.50 e−0.50 i−0.75 e−0.75
control group 105 124 94 120
test group 105 86 116 90
certainty (%) 48.5 91.7 19.7 86.0
e−1.00 e−1.50
control group 112 107
test group 98 103
certainty (%) 68.5 54.4
Table 6: Ranks sums and certainties of improvements of the
gross yield.
How can we interpret these numbers? The first two
columns of Table 6 show that with a certainty of 87.6 % (ig-
nore) and 97.4 % (estimate) that our proposed modification
increased the expected gross yield. In Scenario i−0.25 we
artificially decrease the gross yield (ignore) values by 0.25
percentage points. The monetary value associated with this
specific decrease can be interpreted, e. g., as the implemen-
tation and consultancy costs of the modification. So, by a
look at Table 6 we can say that with a certainty of 82.4 % our
proposed modification yields an improvement of the gross
yield (ignore) by at least 0.25 percentage points.
133
7 Conclusion and outlook
The distribution of fashion goods to the branches of a fash-
ion discounter must meet the demand for sizes as accurately
as possible. However, in our business case, an estimation of
the relative demand for apparel sizes from historic sales data
was not possible in a straight-forward way.
Our proposal is to use the Top-Dog-Index (TDI), a mea-
sure that yields basically ordinal information about what
were the scarcest and the amplest sizes in a product group
in a historic sales period. This information was utilized to
change the size distributions for future deliveries by replac-
ing one piece of the amplest size by a piece of the scarcest
size in every pre-pack (this can be seen as a subgradient
improvement step in an iterative size distribution heuristics
based on the TDI analysis).
Empirical evidence from a blind study with twenty
branches (ten of them, randomly chosen, were supplied ac-
cording to TDI-based recommendations; ten of them were
supplied as before) showed a significant increase in gross
yield: On average, the increase in the gross yield in our blind
study was around one percentage point. The probability that
gross yield improvements of at least 0.25 percentage points
occurred is at least 87.6 (even 95.5 % if inconsistent data is
repaired in a plausible way). And: this was the result of a
single iteration of the optimization procedure, which did not
result in perfectly balanced Top-Dog-Indices.
Given the large economies of scale of a fashion dis-
counter, we consider the TDI a valuable contribution to rev-
enue management tools in this business sector. Moreover, to
the best of our knowledge, our blind study is the first pub-
lished study that evaluates a revenue management method in
the apparel retailer industry by comparing simultaneously
obtained business results of test-branches (optimized) and
control-branches (no action).
The draw-back of the TDI is its lack of information about
the cardinal expected revenue for a given size distribution
of the supply. This is partly due to the fact that the loss of
a bad size distribution is closely related to the markdown
policy of the discounter. This markdown policy, however, is
itself subject of revenue management methods. Therefore,
we regard the integration of size and price optimization, as
is done in our project BFS-DISPO, as a valuable direction
of further research .
Bibliography
[1] G. R. Bitran, R. Caldentey, and S. V. Mondscheinm,
Coordinating clearance markdown sales of sea-
sonal products in retails chains, Oper. Res. 46
(1998), 609–624.
[2] L. M. A. Chan, Z. J. M. Shen, D.Simchi-Levi, and J. L.
Swann, Coordination of pricing and inventory de-
cisions: A survey and classification, Handbook of
Quantitative Supply Chain Analysis: Modeling in
the E-Business Era (David Simchi-Levi, S. D. Wu,
and Z. J. Max Shen, eds.), Kluwer Academic Pub-
lishers, 2006, 335–392.
[3] W. Elmaghraby and P. Keskinocak, Dynamic pricing in
the presence of inventory considerations: Research
overview, current practices, and future directions,
Management Science 49 (2003), 1287–1309.
[4] A. G. Kök and M. L. Fisher, Demand estimation
and assortment optimization under substitution:
methodology and application, Preprint FRPS04-
135, Duke University, 2006, Oper. Res. (to appear).
[5] I. Kouris, Dynamic pricing strategies: Markdown pro-
cedure for a textile retailer, Diplomarbeit, Uni-
versität Bayreuth, Fakultät für Mathematik, Physik
und Informatik, 2007.
[6] M. Levanoni, Y. T. Leung, and S. E. Ramaswamy,
Method and apparatus suitable for demand fore-
casting, US Patent 6976001, 2006.
[7] S. Mahajan and G. van Ryzin, Stocking retail assort-
ments under dynamic consumer substitution, Oper.
Res. 49 (2001), 334–351.
[8] D. M. Rose, S. M. Leven, and J. W. Woo, Assortment
decisions, US Patent 7006981, 2006.
[9] C. Wopperer, Optimierung der Preisreduzierungs-
strategie eines Textildiscounters, Diplomarbeit,
Universität Bayreuth, Fakultät für Mathematik,
Physik und Informatik, 2007.
134
Chapter 14
Lotsize optimization leading to a p-median
problem with cardinalities
CONSTANTIN GAUL1, SASCHA KURZ2, AND JÖRG
RAMBAU3
ABSTRACT. We consider the problem of approximating the branch
and size dependent demand of a fashion discounter with many
branches by a distributing process being based on the branch deliv-
ery restricted to integral multiples of lots from a small set of avail-
able lot-types. We propose a formalized model which arises from
a practical cooperation with an industry partner. Besides an inte-
ger linear programming formulation and a primal heuristic for this
problem we also consider a more abstract version which we relate
to several other classical optimization problems like the p-median
problem, the facility location problem or the matching problem.
2000 MSC: 90B80; 90C59, 90C10.
Key words and phrases: lotsize optimization, p-median problem,
facility location problem, integer linear program formulation,
primal heuristic, real world data, location-allocation.
1 Introduction
Usually, fashion discounters can only achieve small profit
margins. Their economic success depends mostly in the
ability to meet the customers’ demands for individual prod-
ucts. More specifically: offer exactly what you can sell to
your customers. This task has two aspects: offer what the
customers would like to wear (attractive products) and of-
fer the right volumes in the right places and the right sizes
(demand consistent branch and size distribution).
In this paper we deal with the second aspect only: meet
the branch and size specific demand for products as closely
as possible. Our industry partner is a fashion discounter with
more than 1 000 branches most of whose products are never
1Constantin Gaul, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: costa.gaul@gmx.de
2Sascha Kurz, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
3Jörg Rambau, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: joerg.rambau@uni-bayreuth.de
replenished, except for the very few “never-out-of-stock”-
products (NOS products): because of lead times of around
three months, apparel replenishments would be too late any-
way. In most cases the supplied items per product and ap-
parel size lie in the range between 1 and 6. Clearly there
are some difficulties to determine a good estimate for the
branch and size dependent demand, but besides a few prac-
tical comments on this problem we will blind out this aspect
of the problem completely.
The problem we deal with in this article comes from an-
other direction. Our business partner is a discounter who
has a lot of pressure to reduce its costs. So he is forced to
have a lean distribution logistics that works efficiently. Due
to this reason he, on the one hand, never replenishes and, on
the other hand, tries to reduce the distribution complexity.
To achieve this goal the supply of the branches is based on
the delivery of lots, e. g., pre-packed assortments of single
products in various sizes. Every branch can only be sup-
plied with an integral multiple of one lot-type from a rather
small number of available lot-types. So he has to face an ap-
proximation problem: which (integral) multiples of which
(integral) lot-types should be supplied to a branch in order
to meet a (fractional) mean demand as closely as possible?
We call this specific demand approximation problem the
lot-type design problem (LDP).
1.1 Related Work
The model we suggest for the LDP is closely related to the
extensively studied p-median- and the facility location prob-
lem. These problems appear in various applications as some
kind of clustering problems. Loads of heuristics have been
applied onto them. Nevertheless the first constant-factor ap-
proximation algorithm, based on LP rounding, was given
not until 1999 by Charikar, Guha, Tardos, and Shmoys [5].
We will give some more detailed treatment or literature of
approximation algorithms and heuristics for the p-median-
and the facility location problem in Subsection 4.1.
1.2 Our contribution
In cooperation with our business partner, we identified the
lot-type design problem as a pressing real-world task. We
135
present an integer linear program (ILP) formulation of the
LDP that looks abstractly like a p-median problem with an
additional cardinality constraint. We call this problem the
cardinality constrained p-median problem (Card-p-MP). To
the best of our knowledge, the Card-p-MP has not been stud-
ied in the literature so far.
Although the ILP model can be solved by standard soft-
ware on a state-of-the-art PC in reasonable time, the com-
putation times are prohibitive for the use in the field, where
interactive decision support on a laptop is a must for nego-
tiations with the supplier. Therefore, we present a very fast
primal any-time heuristics, that yields good solutions almost
instantly and searches for improvements as long as it is kept
running. We demonstrate on real data that the optimality
gaps of our heuristics are mostly way below 1 %. At the
moment these heuristics are in test mode.
1.3 Outline of the paper
In Section 2 we will briefly describe the real world problem,
which we will formalize and model in Section 3. In Sec-
tion 4 we will present its abstract version, the cardinality
constrained p-median problem (Card-p-MP). Besides a for-
malized description we relate it to several other well known
optimization problems like the matching problem, the facil-
ity location problem, or the p-median problem. In Section 5
we present a primal heuristic for the Card-p-MP, which we
apply onto our real world problem. We give some numerical
data on the optimality gap of our heuristic before we draw a
conclusion in Section 6.
2 The real world problem
Our industry partner is a fashion discounter with over 1 000
branches. Products can not be replenished, and the number
of sold items per product and branch is rather small. There
are no historic sales data for a specific product available,
since every product is sold only for one sales period. The
challenge for our industry partner is to determine a suitable
total amount of items of a specific product which should be
bought from the supplier. For this part the knowledge and
experience of the buyers employed by a fashion discounter
is used. We seriously doubt that a software package based
on historic sales data can do better.
But there is another task being more accessible for com-
puter aided forecasting methods. Once the total amount of
sellable items of a specific product is determined, one has to
decide how to distribute this total amount to a set of branches
B in certain apparel sizes with in general different demands.
There are some standard techniques how to estimate branch-
and size-dependent demand from historic sales data of re-
lated products, being, e. g., in the same commodity group.
We will address the problem of demand forecasting very
briefly in Subsection 3.1. But let us assume for simplicity
that we know the exact (fractional) branch and size depen-
dent mean demands for a given new product or have at least
good estimates.
Due to cost reasons, our industry partner organizes his
distribution process for the branches using a central ware-
house. To reduce the number of necessary handholds in the
distributing process he utilizes the concept of lots, by which
we understand a collection of some items of one product.
One could have in mind different sizes or different colors
at this point. To reduce the complexity of the distribution
process also the number of used lot-types, e. g., different
collections of items, is limited to a rather small number.
One could imagine that the branch- and size-dependent
demand for a specific product may vary broadly over the
large set of branches. This is at least the case for the
branches of our industry partner. The only flexibility to sat-
isfy the demand in each single branch is to choose a suit-
able lot-type from the small sets of available lot-types and
to choose a suitable multiplier, e. g., how many lots of a
chosen lot-type a specific branch should get. One should
keep in mind that we are talking about small multipliers
here, e. g., small branches will receive only one lot, medium
sized branches will receive two lots, and very big branches
will receive three lots of a lot-type with, say, six items.
The cost reductions by using this lot-based distribution
system are paid with a lack of possibility to approximate
the branch and size-dependent demand. So one question is,
how many different lot-types one should allow in order to be
able to approximate the branch- and size-dependent demand
of the branches up to an acceptable deviation on the one
hand and to avoid a complex and cost intensive distribution
process in the central warehouse on the other hand. But also
for a fixed number of allowed lot-types the question of the
best possible approximation of the demand by using a lot-
based supply of the branches arises. In other words we are
searching for an optimal assignment of branches to lot-types
together with corresponding multipliers so that the deviation
between the theoretical estimated demand and the planned
supply with lots is minimal. This is the main question we
will focus on in this paper.
3 Mathematical modeling of the
problem
In this section we will prescind the real world problem from
the previous section and will develop an formulation as a
well defined optimization problem. Crucial and very basic
objects for our considerations are the set of branches B, the
set of sizes S (in a more general context one could also think
of a set of variants of a product, like, e. g., different colors),
and the set of products P.
In practice, we may want to sell a given product π ∈ P
only in some branches Bπ ⊆ B and only in some sizes Sπ ⊆
S (clearly there are different types of sizes for, e. g., skirts
or socks). To model the demand of a given branch b ∈
Bπ for a given product π ∈ P we use the symbol ηb,π, by
which we understand a mapping ϕb,π from the set of sizes
Sπ into a suitable mathematical object. This object may be
a random variable or simply a real number representing the
mean demand. In this paper we choose the latter possibility.
136
For the sake of a brief notation we regard ηb,π as a vector(
ϕb,π (si1) ϕb,π (si2) . . . ϕb,π (sir)
)
∈ Rr, where
we assume that S = {s1, . . . , st} and Sπ = {si1 , . . . , sir }
with ij < ij+1 for all j ∈ {1, . . . , r− 1}.
3.1 Estimation of the branch- and size-
dependent demand
For the purpose of this paper, we may assume that the de-
mands ηb,π are given, but, since this is a very critical part
in practice, we would like to mention some methods how to
obtain these numbers. Marketing research might be a possi-
ble source. Another possibility to estimate the demand for a
product is to utilize historic sales information. We may as-
sume that for each product πwhich was formerly sold by our
retailer, each branch b ∈ B, each size s ∈ S and each day
of sales d we know the number τb,π(d, s) of items which
where sold in branch b of product π in size s during the
first d days of sales. Additionally we assume, that we have
a set U ⊆ P of formerly sold products which are in some
sense similar (one might think of the set of jeans if our new
product is also a jeans) to the new product π̂. By Ub,s we
denote the subset of products in U, which were traded by
a positive amount in size s in branch b and by χb,s(π) we
denote a characteristic function which equals 1 if product π
is distributed in size s to branch b, and equals 0 otherwise.
For a given day of sales d the value η̂b,π̂,d(s)
:=
c
|Ub,s|
∑
u∈Ub,s
τb,u(d, s) ·
∑
b′∈Bπ̂
∑
s′∈Sπ̂
χb′,s′(u)∑
b′∈Bπ̂
∑
s′∈Sπ̂
τb′,u (d, s ′)
(1)
might be a useable estimate for the demand ηb,π̂(s), after
choosing a suitable scaling factor c ∈ R so that the total
estimate demand ∑
b∈Bπ̂
∑
s∈Sπ̂
η̂b,π̂,d(s)
over all branches and sizes equals the total requirements. We
would like to remark that for small days of sale d the qual-
ity of the estimate η̂b,π̂,d(s) suffers from the fact that the
stochastic noise of the consumer behavior is to dominating
and for large d the quality of the estimate suffers from the
fact of stockout-substitution.
There are parametric approaches to this problem in the lit-
erature (like Poisson-type sales processes). In the data that
was available to us, we could not verify the main assump-
tions of such models, though (not even close).
In our real world data set we have observed the fact that
the sales period of a product (say, the time by which 80 %
of the supply is sold) varies a lot depending on the product.
This effect is due to the attractiveness of a given product
(one might think of two T-shirts which only differ in there
color, where one color hits the vogue and the other color
does not). To compensate this effect we have chosen the day
of sales d in dependence of the product u ∈ Ub,s. More
precisely, we have chosen du so that in the first du days of
sales a certain percentage of all items of product u where
sold out over all branches and sizes.
Another possibility to estimate the demand is to perform
the estimation for the branch-dependent demand aggregated
over all sizes and the size-dependent demand for a given
branch separately.
More sophisticated methods of demand estimation from
historic sales based on small data sets are, e. g., described in
[19, 20]. Also research results from forecasting NOS (never-
out-of-stock) items, see, e. g., [1, 17, 24] for some surveys,
may be utilized. Also quite a lot of software-packages for
demand forecasting are available, see [31] for an overview.
3.2 Supply of the branches by lots
To reduce handling costs in logistic and stockkeeping our
business partner orders his products from its external suppli-
ers in so called lots. These are assortments of several items
of one product in different sizes which form an entity. One
could have a set of T-shirts in different sizes in mind which
are wrapped round by a plastic foil. The usage of lots has the
great advantage of reducing the number of picks during the
distribution process in a high-wage country like Germany,
where our partner operates.
Let us assume that the set of sizes for a given product
π is given by Sπ = {si1 , . . . , sir } with ij < ij+1 for all
j ∈ {1, . . . , r− 1}. By a lot-type l we understand a map-
ping ϕ : Sπ → N, which can also be denoted by a vec-
tor
(
ϕ (si1) ϕ (si2) . . . ϕ (sir)
)
of non-negative in-
tegers.
By L we denote the set of applicatory lot-types. One
could imagine that a lot of a certain lot-type should not con-
tain too many items in order to be manageable. In the other
direction it should also not contain too few items in order to
make use of the cost reduction potential of the lot idea. Since
the set of applicatory lot-types may depend on a the charac-
teristics of a certain product πwe specialize this definition to
a set Lπ of manageable lot-types. (One might imagine that
a warehouseman can handle more T-shirts than, e. g., win-
ter coats; another effect that can be modeled by a suitable
set of lot-types is to enforce that each size in Sπ is supplied
to each branch in Bπ by a positive amount due to juridical
requirements for advertised products.)
To reduce the complexity and the error-proneness of the
distribution process in a central warehouse, each branch
b ∈ Bπ is supplied only with lots of one lot-type lb,π ∈ Lπ.
We model the assignment of lot-types l ∈ Lπ to branches
b ∈ Bπ as a function ωπ : Bπ → Lπ, b 7→ lb,π. Clearly,
this assignmentωπ is a decision variable which can be used
to optimize some target function. The only flexibility that
we have to approximate the branch-, size- and product de-
pendent demand ηb,π by our delivery in lots is to supply
an integral multiple of mb,π items of lot-type ωπ(b) to
branch b. Again, we can denote this connection by a func-
tion mπ : Bπ → N, b 7→ mb,π. Due to practical reasons,
also the total number |ωπ (Bπ)| of used lot-types for a given
product is limited by a certain number κ.
137
3.3 Deviation between supply and demand
With the notation from the previous subsection, we can rep-
resent the replant supply for branch b with product π as a
vector mπ(b) ·ωπ(b) ∈ Nr. To measure the deviation be-
tween the supply mπ(b) ·ωπ(b) and the demand ηb,π we
may utilize an arbitrary vector norm ‖·‖. Mentionable vec-
tor norms in our context are the sum of absolute values
∥∥(v1 v2 . . . vr)∥∥1 := r∑
i=1
|vi| ,
the maximum norm∥∥(v1 v2 . . . vr)∥∥∞ := max {|vi| : 1 6 i 6 r} ,
and the general k-norm
∥∥(v1 v2 . . . vr)∥∥k := k
√√√√ r∑
i=1
|vi|
k
for real numbers k > 0, which is also called the Euclidean
norm for k = 2. With this we can define the deviation
σb,l,m := ‖ηb,π −m · l‖?
between demand ηb,π and supply m ∈ {1, . . . ,M} =: M ⊂
N times lot-type l ∈ Lπ for each branch b ∈ Bπ and an
arbitrary norm ‖·‖? for a given product π ∈ P. It depends
on practical considerations which norm to choose. The ‖·‖1-
norm is very insensitive in respect to outliers in contrast to
the ‖·‖∞-norm which is absolutely sensitive with respect to
outliers. A possible compromise may be the Euclidean norm
‖·‖2, but for most considerations we choose the ‖·‖1-norm
because of its robustness. (We do not trust every single exact
value in our demand forecasts that much.)
For given functions mπ and ωπ we can consider the de-
viation vector
Σπ :=

σb1,ωπ(b1),mπ(b1)
σb2,ωπ(b2),mπ(b2)
...
σbq,ωπ(bq),mπ(bq)

T
if the set of branches is written as Bπ := {b1, . . . , bq}. To
measure the total deviation of supply and demand we can
apply an arbitrary norm ‖·‖?, which may be different from
the norm to measure the deviation of a branch, onto Σπ. In
this paper we restrict ourselves on the ‖·‖1-norm, so that we
have
‖Σπ‖1 =
∑
b∈Bπ
σb,ωπ(b),mπ(b).
3.4 The cardinality condition
For a given assignmentωπ of lot-types to branches and cor-
responding multiplicitiesmπ then quantity
I :=
∑
b∈Bπ
mπ(b) · ‖ωπ(b)‖1 ∈ N
gives the total number of replant distributed items of product
π over all sizes and branches. From a practical point of view
we introduce the condition
I 6 I 6 I, (2)
where I, I are suitable integers. One might imagine that
our retailer may buy a part of already produced products so
that there is a natural upper bound I or that there are some
minimum quantities. Another interpretation may be that the
buying department of our retailer has a certain idea on the
value of I but is only able to give an interval
[
I, I
]
.
During our cooperation with our busines partner we have
learned that in practice you do not get what you order. If
you order exactly I items of a given product you will obtain
I plus minus some certain percentage items in the end. (And
there actually exists a certain percentage up to which a re-
tailer accepts a deviation between the original order and the
final delivery by its external suppliers as a fulfilled contract.)
Besides these and other practical reason to consider an in-
terval
[
I, I
]
for the total number of items of a given product,
there are very strong reasons not to replace Inequalities (2)
by an equation, as we will explain in the following. Let
us consider the case where our warehouse (or our external
suppliers in a low-cost-country) is only able to deal with a
single lot-type per product. This is the case κ = 1. Let us
further assume that there exists a rather small integer k (e. g.
k = 20) fulfilling ‖l‖1 6 k for all l ∈ Lπ. If I contains
a prime divisor being larger than k, then there exist no as-
signments multiplicitiesmπ ∈ N (ωπ is a constant function
due to κ = 1) which lead to a feasible solution of our prob-
lem. These number-theoretic influences are somewhat ugly.
In some cases the lead to the infeasibility of our problem or
to bad solutions with respect to the quality of the demand-
supply approximation in comparison to a relaxed version of
the problem, where the restrictions on I are weaker. One
could have in mind the possibility of throwing one item into
the garbage if this will have a large impact on the quality of
the demand-supply approximation.
In Equation (1) for the demand estimation we have used
a certain number Ĩ for the total number of items to scale the
demands ηb,π by a factor c. From a more general point of
view it may also happen that the total demand∑
b∈Bπ
∑
s∈Sπ
ηb,π(s)
is not contained in the interval
[
I, I
]
. In this case the ‖·‖1-
norm may not be very appropriate. In our estimation pro-
cess, however, the demand forecasts in fact yield demand
percentages rather than absolute numbers. The total volume
is then used to calculate the absolute (fractional) mean de-
mand values, so that in our work-flow the total demand is
always in the target interval.
3.5 The optimization problem
Summarizing the ideas and using the notations from the pre-
vious subsections we can formulate our optimization prob-
138
lem in the following form. We want to determine an as-
signment function ωπ : Bπ → Lπ and multiplicities
mπ : Bπ → M = {1, . . . ,M} ⊂ N such that the total
deviation between supply and demand
∑
b∈Bπ
σb,ωπ(b),mπ(b) (3)
is minimized with respect to the conditions
|ωπ (Bπ)| 6 κ (4)
and
I 6
∑
b∈Bπ
mπ(b) · ‖ωπ(b)‖1 6 I. (5)
We use binary variables xb,l,m, which are equal to 1 if and
only if lot-type l ∈ Lπ is delivered with multiplicitym ∈M
to branch b, and binary variables yl, which are 1 if and only
if at least one branch in Bπ is supplied with lot-type l ∈ Lπ.
With this, we can easily model out problem as an integer
linear program:
min
∑
b∈Bπ
∑
l∈Lπ
∑
m∈M
σb,l,m · xb,l,m (6)
s.t.
∑
l∈Lπ
∑
m∈M
xb,l,m = 1 ∀b ∈ Bπ (7)∑
b∈Bπ
∑
l∈Lπ
∑
m∈M
m · ‖l‖1 · xb,l,m 6 I (8)∑
b∈bπ
∑
l∈Lπ
∑
m∈M
m · ‖l‖1 · xb,l,m > I (9)∑
m∈M
xb,l,m 6 yl ∀b ∈ Bπ, l ∈ Lπ (10)∑
l∈Lπ
yl 6 κ (11)
xb,l,m ∈ {0, 1} ∀b∈Bπ, l∈Lπ,m∈M (12)
yl ∈ {0, 1} ∀l ∈ Lπ (13)
The objective function (6) represents the sum (3),
since irrelevant tuples (b, l,m) may be downtroddened by
xb,l,m = 0. Condition (7) states that we assign for each
branch b exactly one lot-type with a unique multiplicity.
The cardinality condition (5) is modeled by conditions (8)
and (9) and the restriction (4) on the number of used lot-
types is modeled by condition (11). The connection between
the xb,l,m and the yl is fixed in the usual Big-M condition
(10). We would like to remark that the LP-relaxation of this
ILP formulation is very strong above all in comparison to the
more direct ILP formulation, where we assume the branch
deviation between supply and demand is measured by the
‖·‖1-norm:
min
∑
b∈Bπ
∑
s∈Sπ
zb,s
s.t. ηb,π(s) − αb,s 6 zb,s ∀b∈Bπ, s∈Sπ
αb,s − ηb,π(s) 6 zb,s ∀b∈Bπ, s∈Sπ∑
l∈Lπ
∑
m∈M
xb,l,m = 1 ∀b∈Bπ∑
b∈Bπ
∑
l∈Lπ
∑
m∈M
m · ‖l‖1 · xb,l,m 6 I∑
b∈Bπ
∑
l∈Lπ
∑
m∈M
m · ‖l‖1 · xb,l,m > I∑
m∈M
xb,l,m 6 yl ∀b∈Bπ, l∈Lπ∑
l∈Lπ
yl 6 κ∑
l∈Lπ
∑
m∈M
m·l[s]·xb,l,m=αb,s ∀b∈Bπ, s∈Sπ
xb,l,m ∈ {0, 1} ∀b∈Bπ, l∈Lπ,m∈M
yl ∈ {0, 1} ∀l∈Lπ
αb,s ∈ R+0 ∀b∈Bπ, s∈Sπ,
where l[s] is the entry in vector l corresponding to size s.
We would like to remark that our strong ILP formulation
of the problem of Subsection 3.5 can be used to solve all real
world instances of our business partner in at most 30 minutes
by using a standard ILP solver like CPLEX 11. Unfortu-
nately, this is not fast enough for our real world application.
The buyers of our retailer need a software tool which can
produce a near optimal order recommendation in real time
on a standard laptop. The buying staff travels to one of the
external suppliers to negotiate several orderings. When they
get to the details, the buyer inserts some key data like I, I,
Bπ, Sπ, and Lπ into his laptop and immediately wants a rec-
ommendation for an order in terms of multiples of lot-types.
For this reason, we consider in Section 5 a fast heuristic,
which has only a small gap compared to the optimal solu-
tion on a test set of real world data of our business partner.
4 The cardinality constrained p-
median problem
In the previous section we have modeled our real world
problem from Section 2. Now we want to abstract from this
practical problem and formulate a more general optimiza-
tion problem which we will relate to several well known op-
timization problems.
For the general cardinality constrained p-median problem
let p be an integer, S a set of chooseable items, D a set of
demanders, a demand function δ : D→ R+, and
[
I, I
]
⊆ N
an interval. We are looking for an assignment ω : D → S
with corresponding multipliers m : D → N, such that the
sum of distances∑
d∈D
‖δ(d) −m(d) ·ω(d)‖
139
is minimized under the conditions
|ω (D)| 6 p
and
I 6
∑
d∈D
m(d) · |ω(d)| 6 I.
Let us now bring this new optimization problem in line
with known combinatorial optimizations problems. Since
we have to choose an optimal subset of S to minimize a
cost function subject to some constraints the cardinality con-
strained p-median problem belongs to the large class of
generic selection problems.
Clearly, it is closely related to the p-median problem.
The only characteristics of our problem that are not cov-
ered by the p-median problem are the multipliers m and
the cardinality condition. If we relax the cardinality con-
dition we can easily transform our problem into a classical
p-median problem. For every element d ∈ D and every ele-
ment s ∈ S there exists an optimal multipliermd,s such that
‖δ(d) −md,s · s‖ is minimal.
If we do not bound |ω (D)| from above but assign costs
for using elements of S instead, which means using another
lot-type in our practical application, we end up with the fa-
cility location problem. Clearly we also have some kind of
an assignment-problem, since the have to determine an as-
signmentω between the sets D and a subset of S.
One can also look at our problem from a completely dif-
ferent angle. Actually we are given a set of |B| real-valued
demand-vectors, which we want to approximate by a finite
number of integer-valued vectors using integral multiples.
There is a well established theory in number theory on so
called Diophantine approximation [4, 21] or simultaneous
approximation, which is somewhat related to our approxi-
mation problem. Here one is interested in simultaneously
minimizing ∥∥∥∥αi − piq
∥∥∥∥
for linearly independent real numbers αi by integers pi and
q [22, 27]. One might use some results from this theory to
derive some bounds for our problem. One might also have a
look at [9].
For a more exhaustive and detailed analysis of the taxon-
omy of the broad field of facility-location problems and their
modeling we refer to [26].
4.1 Approximation algorithms and heuristics
for related problems
Facility location problems and the p-median problem are
well known and much research has been done. Since, more-
over, these problems are closely related to our optimiza-
tion problem, we would like to mention some literature
and methods on approximation algorithms and heuristics for
these problems.
Lin and Vitter [23] have developed a filtering and round-
ing technique which rounds fractional solutions of the stan-
dard LP for these problems to obtain good integer solution.
For the metric case some some bounds for approximation
quality are given. Based on this work some improvements
were done in [28], were the authors give a polynomial-
time 3.16-approximation algorithm for the metric facility
location problem, and in [5, 6], where the authors give a
polynomial-time 203 -approximation algorithm for the metric
p-median problem and a 9.8-approximation algorithm for
the p-facility location problem.
Besides rounding techniques of LP-solutions also greedy
techniques have been applied to the facility location prob-
lem and the p-median problems. Some results are given in
[12, 15, 16]. Since these problems are so prominent in ap-
plications the whole broadness of heuristics are applied onto
it. Examples are scatter search [8, 10], local search [2, 18],
and neighborhood search [11, 14].
Good overviews for the broad topic of approximation al-
gorithms and heuristics for the facility location and the p-
median problem are given in [7, 25, 28, 29].
Besides results for the metric case there are also results
for the non-metric case, see, e. g., [30].
Unfortunately, none of the theoretical guarantees seem to
survive the introduction of the cardinality constraint in gen-
eral.
5 A practical heuristic for the cardi-
nality constrained p-median prob-
lem
As already mentioned in Section 3 solving our ILP formu-
lation of our problem is too slow in practical applications.
So there is a real need for a fast heuristic which yields good
solutions, which is the topic of this section.
In Section 4 we have analyzed our problem from different
theoretical point of views. What happens if we relax some
conditions or fix some decisions. A very important decision
is: which lot-types should be used in the first place? Here
one should have in mind that the cardinality |Lπ| of the set
of feasible lot-types is very large compared to the number κ
of lot-types which can be used for the delivery process of a
specific product π.
5.1 Heuristic selection of lot-types
For this selection problem of lot-types we utilize a scoring
method. For every branch b ∈ Bπ with demand ηb,π there
exists a lot-type l ∈ Lπ and a multiplicity m ∈ N such that
‖ηb,π −m · l‖ is minimal in the set
{
‖ηb,π −m ′ · l ′‖ :
l ′ ∈ Lπ, m ′ ∈ N
}
. So for every branch b ∈ Bπ there
exists a lot-type that fits best. More general, for a given k 6
|Lπ| there exist lot-types l1, . . . , lk such that li fits i-best
if one uses the corresponding optimal multiplicity. Let us
examine this situation from the point of view of the different
lot-types. A given lot-type l ∈ Lπ is the i-best fitting lot-
type for a number ρl,i of branches in Bπ. Writting these
numbers ρl,i as a vector ρl ∈ Nk we obtain score vectors
for all lot-types l ∈ Lπ.
140
Now we want to use these score vectors ρl to sort the
lot-types of Lπ in decreasing approximation quality. Using
the lexicographic ordering  on vectors we can determine a
bijective rank function λ : Lπ → {1, . . . , |Lπ|}. (We simply
sort the score vectors according to  and for the case of
equality we choose an arbitrary succession.) We extend λ to
subsets L ′ ⊆ Lπ by λ (L ′) =
∑
l∈L′
λ(l) ∈ N.
To fix the lot-types we simply loop over subsets L ′ ⊆ Lπ
of cardinality κ in decreasing order with respect to λ (L ′).
In principle we consider all possible selections L ′ of κ lot-
types, but in practise we stop our computations after an ad-
equate time period with the great advantage that we have
checked the in some heuristic sense most promising selec-
tions L ′ first.
Now we have to go into detail how to efficiently deter-
mine the p best fitting lot-types with corresponding optimal
multiplicities for each branch b ∈ Bπ. We simply loop over
all branches b ∈ Bπ and determine the set of the p best
fitting lot-types separately. Here we also simply loop over
all lot-types l ∈ Lπ and determine the corresponding opti-
mal multiplier m by binary search (it is actually very easy
to effectively determine lower and upper bounds form from
ηb,π and l) due to the convexity of norm functions. Using a
heap data structure the sorting of the p best fitting lot-types
can be done in O (|Lπ|) time if p logp ∈ O (|Lπ|), which
is not a real restriction for practical problems. We further
want to remark that we do not have to sort the score vectors
completely since in practice we will not loop over all
(
|Lπ|
κ
)
possible selections of lot-types. If one does not want to use a
priori bounds (meaning that one excludes the lot-types with
high rank λ) one could use a lazy or delayed computation of
the sorting of λ by utilizing again a heap data structure.
5.2 Adjusting a delivery plan to the cardinal-
ity condition
If we determine assignments ωπ with corresponding multi-
pliers mπ with the heuristic being described in Subsection
5.1 in many cases we will not satisfy the cardinality condi-
tion (2) since it is totally unaccounted by our heuristic. Our
strategy to satisfy the cardinality condition (2) is to adjust
mπ afterwards by decreasing or increasing the calculated
multipliers unless condition (2) is fulfilled by pure chance.
Here we want to use a greedy algorithm and have to dis-
tinguish two cases. If I (ωπ,mπ) is smaller then I, then
we increase some of the values of mπ, other wise we have
I (ωπ,mπ) > I and we decrease some of the values ofmπ.
Our procedure works iteratively and we assume that the cur-
rent multipliers are given by m̃π. Our stopping criteria is
given by I 6 I (ωπ, m̃π) 6 I or that there are no feasible
operations left. We restrict our explanation of a step of the
iteration to the case where we want to decrease the values of
m̃π. For every branch b ∈ Bπ the reduction of m̃π(b) by
one produces costs
∆−b = σb,ωπ(b),m̃π(b)−1 − σb,ωπ(b),m̃π(b)
if the reduction of m̃π(b) by one is allowed (a suitable con-
dition is m̃π > 1 or m̃π > 2) and ∆−b = ∞ if we do
not have the possibility to reduce the multiplier m̃π(b) by
one. A suitable data structure for the ∆−b values is a heap,
for which the update after an iteration can be done in O(1)
time. If we reach I (ωπ, m̃π) < I at some point, we simply
discard this particular selection ωπ and consider the next
selection candidate.
We would like to remark that for κ = 1 and an arbitrary
norm ‖·‖? the described heuristic produces the optimal so-
lution if we check all lot-types l ∈ Lπ, which can be seen as
follows: Since we loop over all l ∈ Lπ in one step the opti-
mal lot-type is chosen. Without the cardinality condition as-
signing to each branch its locally optimal multiplicity would
be globally optimal. Now let us assume that the number of
items I in our assignment is larger than the upper bound I
of the cardinality condition. Due to a simple swapping ar-
gument and the convexity of a norm function we conclude
that in an optimal solution no multiplier of a branch is larger
then the locally optimal multiplier. Thus every optimal so-
lution arises from our initial distribution plan, insulting the
cardinality condition, by deleting exactly
⌈
I−I
l
⌉
lot pack-
ages. Due to the convexity of the norm function the greedy
way of deleting lot packages of our heuristic ends up with
an optimal solution.
Since this adjustment step can be performed very fast one
might also take some kind of general swapping techniques
into account. Since for these techniques there exists an over-
boarding amount of papers in the literature we will not go
into detail here, but we would like to remark that in those
cases (see Subsection 5.3) where the optimality gap of our
heuristic lies above 1 % swapping can improve the solutions
of our heuristic by a large part.
5.3 Optimality gap
To substantiate the usefullness of our heuristic we have com-
pared the quality of the solutions given by this heuristic after
one second of computation time (on a standard laptop) with
respect to the solution given by CPLEX 11.
Our business partner has provided us historic sales infor-
mation for nine different commodity groups each ranging
over a sales period of at least one and a half year. For each
commodity group we have performed a test calculation for
κ ∈ {1, 2, 3, 4, 5} distributing some amount of items to al-
most all branches. By I we denote the cardinality inter-
val, by |Sπ| the number of sizes, and by |Bπ| the number
of branches.
Commodity group 1:
I = [10630, 11749], |Sπ| = 5, |Bπ| = 1119:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 4033.34 3304.10 3039.28 2951.62 2891.96
heuristic 4033.34 3373.95 3076.55 3011.49 2949.31
gap 0.000% 2.114% 1.226% 2.028% 1.983%
Table 1: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 1.
141
Commodity group 2:
I = [10000, 12000], |Sπ| = 5, |Bπ| = 1091:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 2985.48 2670.04 2482.23 2362.75 2259.57
heuristic 2985.48 2671.72 2483.52 2362.90 2276.32
gap 0.000% 0.063% 0.052% 0.006% 0.741%
Table 2: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 2.
Commodity group 3:
I = [9785, 10815], |Sπ| = 5, |Bπ| = 1030:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 3570.33 3022.27 2622.82 2488.10 2413.55
heuristic 3570.33 3023.91 2625.29 2492.07 2417.65
gap 0.000% 0.054% 0.094% 0.160% 0.170%
Table 3: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 3.
Commodity group 4:
I = [10573, 11686], |Sπ| = 5, |Bπ| = 1119:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 4776.36 4364.63 4169.94 4023.60 3890.87
heuristic 4776.36 4365.47 4170.23 4024.55 3892.35
gap 0.000% 0.019% 0.007% 0.024% 0.038%
Table 4: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 4.
Commodity group 5:
I = [16744, 18506], |Sπ| = 5, |Bπ| = 1175:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 4178.71 3418.37 3067.74 2874.70 2786.69
heuristic 4178.71 3418.87 3068.25 2875.21 2787.21
gap 0.000% 0.015% 0.017% 0.018% 0.019%
Table 5: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 5.
Commodity group 6:
I = [11000, 13000], |Sπ| = 4, |Bπ| = 1030:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 2812,22 2311,45 2100,78 1987,46 1909,21
heuristic 2812,22 2311,87 2101,25 1987,93 1909,63
gap 0.000% 0.018% 0.022% 0.024% 0.022%
Table 6: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 6.
Commodity group 7:
I = [15646, 17293], |Sπ| = 5, |Bπ| = 1098:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 4501.84 3917.96 3755.20 3660.32 3575.55
heuristic 4501.84 3918.46 3755.70 3660.84 3576.04
gap 0.000% 0.013% 0.013% 0.014% 0.014%
Table 7: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 7.
Commodity group 8:
I = [11274, 12461], |Sπ| = 5, |Bπ| = 989:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 3191.66 2771.89 2575.37 2424.31 2331.67
heuristic 3191.66 2772.33 2575.81 2424.75 2332.11
gap 0.000% 0.016% 0.017% 0.018% 0.019%
Table 8: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 8.
Commodity group 9:
I = [9211, 10181], |Sπ| = 5, |Bπ| = 808:
κ = 1 κ = 2 κ = 3 κ = 4 κ = 5
CPLEX 3616.71 3215.17 2981.02 2837.66 2732.29
heuristic 3616.71 3215.53 3009.01 2860.85 2758.39
gap 0.000% 0.011% 0.939% 0.817% 0.955%
Table 9: Optimality gap in the ‖ · ‖1-norm for our heuristic
on commodity group 9.
Besides these nine test calculations we have done several
calculations on our data sets with different parameters, we
have, e. g., considered case with fewer sizes, fewer branches,
smaller or larger cardinality intervals, larger κ, or other mag-
nitudes for the cardinality interval. The results are from a
qualitative point of view more or less the same, as for the
presented test calculations.
6 Conclusion and outlook
Starting from a real world optimization problem we have
formalized a new general optimization problem, which we
call cardinality constrained p-median problem. It turns out
that this problem is related to several other well known stan-
dard optimization problems. In Subsection 3.5 we have
given an integer linear programming formulation which has
a very strong LP-relaxation. Nevertheless this approach is
quit fast (computing times below one hour), there was a
practical need for fast heuristics to solve the problem. We
have presented one such heuristic which performs very well
on real world data sets with respect to the optimality gap.
Some more theoretic work on the cardinality constrained
p-median problem and its relationships to other classical op-
142
timization methods may lead to even stronger integer lin-
ear programming formulations or faster branch-and-bound
frameworks enhanced with some graph theoretic algorithms.
We leave also the question of a good approximation al-
gorithm for the cardinality constrained p-median problem.
Having the known approximation algorithms for the other
strongly related classical optimization problems in mind, we
are almost sure that it should be not too difficult to develop
good approximation algorithms for our problem.
For the practical problem the uncertainties and difficulties
concerning the demand estimation have to be faced. There
are several ways to make solutions of optimization problems
more robust. One possibility is to utilize robust optimization
methods. Another possibility is to consider the branch- and
size dependent demands as stochastic variables and to uti-
lize integer linear stochastic programming techniques. See,
e. g., [3] or more specifically [29]. These enhanced models,
however, will challenge the solution methods a lot, since the
resulting problems are of a much larger scale than the one
presented in this paper. Nevertheless, this is exactly what
we are looking at next.
Bibliography
[1] J. S. Armstrong (ed.), Principles of forecasting:
A handbook for researchers and practitioners,
Kluwer, 2001.
[2] V. Arya, N. Garg, R. Khandekar, K. Munagala, A.
Meyerson, and V. Pandit, Local search heuristics
for k-median and facility location problems, 33rd
Annual ACM Symposium on Theory of Comput-
ing (STOC), 2001, 21–29.
[3] J. R. Birge and F. Louveaux, Introduction to stochastic
programming, Springer Series in Operations Re-
search and Financial Engineering, Springer, 1997.
[4] J. W. S. Cassels, An introduction to diophantine ap-
proximation, Cambridge, 1965.
[5] M. Charikar, S. Guha, E. Tardos, and D. Shmoys, A
constant-factor approximation algorithm for the k-
median problem, 31st Annual ACM Symposium
on the Theory of Computing, 1999, 1–10.
[6] M. Charikar, S. Guha, E. Tardos, and D. Shmoys, A
constant-factor approximation algorithm for the k-
median problem, JCSS 65 (2002), no. 1, 129–149.
[7] G. Cornuéjols, G. L. Nemhauser, and L. A.
Wolsey, The uncapacitated facility location prob-
lem, Discrete Location Theory (P. Mirchandani and
R. Francis, eds.), John Wiley and Sons, Inc., New
York, 1990, 119–171.
[8] J. A. Dı́aza and E. Fernández, Hybrid scatter search
and path relinking for the capacitated p-median
problem, European J. Oper. Res. 169 (2006), no. 2,
570–585.
[9] A. Frank and E. Tardos, An application of simultane-
ous diophantine approximation in combinatorial
optimization, Combinatorica 7 (1987), no. 1, 49–
65.
[10] F. Garcı́a, B. Melian, J. A. Moreno, and J. M. Moreno-
Vega, Scatter search for multiple objective p-
facility location problems, Workshop on Multiob-
jective Metaheuristics, 2002.
[11] D. Ghosh, Neighborhood search heuristics for the un-
capacitated facility location problem, European J.
Oper. Res. 150 (2003), no. 1, 150–162.
[12] S. Guha and S. Khuller, Greedy strikes back: improved
facility location algorithms, ninth annual ACM-
SIAM symposium on Discrete algorithms, 1998,
649–657.
[13] M. T. Hajiaghayi, M. Mahdian, and V. S. Mirrokni, The
facility location problem with general cost func-
tions, Networks 42 (2003), no. 1, 6 p.
[14] P. Hansen and N. Mladenović, Variable neighbor-
hood search for the p-median, Location Science 5
(1997), no. 4, 207–226.
[15] K. Jain, M. Mahdian, E. Markakis, A. Saberi, and V. V.
Vazirani, Greedy facility location algorithms ana-
lyzed using dual fitting with factor-revealing LP, J.
ACM 50 (2003), no. 6, 795–824.
[16] K. Jain and V. V. Vazirani, Primal-dual approxima-
tion algorithms for metric facility location and
k-median problems, 40th Annual Symposium on
Foundations of Computer Science, 1999, 2 p.
[17] A. Kok and M. Fisher, Demand estimation and assort-
ment optimization under substitution: Methodol-
ogy and application, Oper. Res. (to appear).
[18] M. R. Korupolu, C. G. Plaxton, and R. Rajaraman,
Analysis of a local search heuristic for facility lo-
cation problems, J. Algorithms 37 (2000), no. 1,
146–188.
[19] S. Kurz and J. Rambau, Demand forecasting for com-
panies with many branches, low sales numbers per
product, and non-recurring orderings, Proceedings
of the Seventh International Conference on Intelli-
gent Systems Design and Applications, 2007, 196–
201.
[20] S. Kurz, J. Rambau, J. Schlüchtermann, and R. Wolf,
The top-dog index: A new measurement for the de-
mand consistency of the size distribution in pre-
pack orders for a fashion discounter with many
small branches, (submitted).
[21] S. Lang, Introduction to diophantine approximations
(new expanded edition), Springer-Verlag, 1995.
[22] D. Leviatan and V. Temlyakov, Simultaneous approxi-
mation by greedy algorithms, Adv. Comput. Math.
25 (2006), no. 1-3, 73–90.
[23] J.-H. Lin and J. S. Vitter, e-approximations with min-
imum packing constraint violation (extended ab-
stract), twenty-fourth annual ACM symposium on
Theory of computing, 1992, 771–782.
143
[24] S. Makridakis, S. Wheelwright, and R. Hynd-
man, Forecasting:methods and applications, Wi-
ley, 2004.
[25] G. L. Nemhauser and L. A. Wolsey, Integer and com-
binatorial optimization, John Wiley and Sons, Inc.,
New York, 1988.
[26] C. S. ReVelle, H. A. Eiselt, and M. S. Daskin, A bibli-
ography for some fundamental problem categories
in discrete location science, European J. Oper. Res.
184 (2008), 817–848.
[27] W. M. Schmidt, Simultaneous approximation to al-
gebraic numbers by rationals, Acta Math. 125
(1970), no. 1, 189–201.
[28] D. B. Shmoys, E. Tardos, and K. Aardal, Approxima-
tion algorithms for facility location problems (ex-
tended abstract), twenty-ninth annual ACM sym-
posium on Theory of computing, 1997, 265–274.
[29] C. Swamy, Approximation algorithms for clustering
problems, Ph.D. thesis, Cornell University, 2004.
[30] N. E. Young, K-medians, facility location, and the
chernoff-wald bound, eleventh annual ACM-SIAM
symposium on Discrete algorithms, 2000, 86–95.
[31] J. Yurkiewicz, Software survey: Forecasting 2000,
OR/MS Today 27 (2000), no. 1.
144
Chapter 15
On the Hegselmann-Krause conjecture in
opinion dynamics
SASCHA KURZ1 AND JÖRG RAMBAU2
ABSTRACT. We give an elementary proof of a conjecture by R.
Hegselmann and U. Krause in opinion dynamics, concerning a
symmetric bounded confidence interval model: If there is a truth
and all individuals take each other seriously by a minimal posi-
tive amount, then all truth seekers will converge to the truth. Here
truth seekers are the individuals which are attracted by the truth by
a positive amount. In the absence of truth seekers it was already
shown by Hegselmann and Krause that the opinions of the individ-
uals converge.
2000 MSC: 40A99; 62P25, 91D10, 37N99.
Key words and phrases: opinion dynamics, consensus/dissent
bounded confidence, non-linear dynamical systems.
1 Introduction
In this article we consider a symmetric bounded confidence
interval model to model opinion dynamic and prove a con-
jecture of R. Hegselmann and U. Krause. Suppose there is
a set [n] := {1, . . . , n} of individuals with opinion xi(t) ∈
[0, 1] at time t for all i ∈ [n], t ∈ N. The abstract truth is
modeled as a constant over time denoted by h ∈ [0, 1]. The
opinion of an individual i ∈ [n] is influenced in a time step
t only by those individuals which have a similar opinion,
more precisely which have an opinion in the confidence set
of xi(t).
Definition 1.1 For x ∈ [0, 1] and a parameter ε > 0 we
define the confidence set of value x at time t as
Iεx(t) := {j ∈ [n] | |x− xj(t)| 6 ε} .
As a shorthand we define Iεi (t) := I
ε
xi(t)
(t) for any i ∈ [n].
1Sascha Kurz, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: sascha.kurz@uni-bayreuth.de
2Jörg Rambau, University of Bayreuth, Department of Mathematics,
95440 Bayreuth, Germany.
E-mail adress: joerg.rambau@uni-bayreuth.de
The update of the opinions is modeled as a weighted arith-
metic mean of opinions in the confidence set and a possible
attraction towards the truth.
Definition 1.2 Let n ∈ N, h ∈ [0, 1], ε ∈ [0, 1], α ∈ (0, 1],
β ∈
(
0, 12
]
, αi(t) ∈ [α, 1] or αi(t) = 0 for all t ∈ N,
βij(t) ∈ [β, 1 − β] with
n∑
j=1
βij(t) = 1 for all i ∈ [n] and
for all t ∈ N, and starting positions xi[0] ∈ [0, 1]. These
parameters define a weighted arithmetic mean symmetric
bounded confidence model (WASBOCOD) for opinion dy-
namics. Now we define the update of the opinions by
xi(t+1) := αi(t)·h+
(
1−αi(t)
) ∑
j∈Iεi (t)
βij(t)xj(t)∑
j∈Iεi (t)
βij(t)
. (1)
The value h is called the truth. Individuals are members
of the index set [n]. Truth seekers are members of the set
K := {k ∈ [n] | αk(t) > α∀t ∈ N}. All other individuals,
i. e. those with αi(t) = 0 for all t, are called ignorants;
their set is denoted by K.
The main result we wish to prove is the following:
Theorem 1.3 (Generalized Hegselmann-Krause Conjec-
ture) All truth seekers in an (WASBOCOD) Ω converge to
the truth h. Formally, for each γ > 0 and each setting Ω
there exists a T(γ,Ω) so that we have |xk(t) − h| < γ for
all k ∈ K and all t > T(γ,Ω).
This is a somewhat weak convergence since it depends on
the complete settingΩ and not only on the structural param-
eters ε, α, β, and n. Actually, such a stronger convergence
can not be expected in general:
Example 1.4 Consider a (WASBOCOD) with truth h = ε,
ε > 0, α1(t) = α, α2(t) = 0, βij(t) = 12 (for all t ∈ N0),
β = 12 , x1(0) = 2ε, x2(0) = ε̃, where ε > ε̃ > 0. Let T ∈
N0 be the smallest integer such that (1 − α)Tε 6 ε̃. Then
by induction we have x1(t) = ε + (1 − α)tε and x2(t) =
x2(0) = ε̃ for all t 6 T . So truth seeker 1 converges to
the truth, but at time T + 1 we have x1(T + 1) = αε +
1−α
2
(
ε+ (1− α)Tε+ ε̃
)
6 1+α2 · ε+ ε̃.
145
This example shows that in general we can not expect
convergence in a strong sense, meaning that for every γ > 0
there is a T(γ, ε, α, β, n) that for all t > T(γ, ε, α, β, n) we
have |xk(t) − h| < γ for each truth seeker k ∈ K, since we
may choose ε̃ arbitrarily small. But we may have an inter-
rupted convergence:
Definition 1.5 In our situation we say that the convergence
of the truth seekers k ∈ K is (1-fold) interrupted con-
vergent, if there exist two functions Ts1 (γ, ε, α, β, n) and
Ts2 (γ, ε, α, β, n, T
e
1 ), so that for each (WASBOCOD) Ω,
with structural parameters ε, α, β and n, there exists an
Te1 ∈ N0 fullfilling
∀k ∈ K, ∀t ∈ [Ts1 (γ, ε, α, β, n) , Te1 ] : |xk(t) − h| < γ,
∀k ∈ K, ∀t > Ts2 (γ, ε, α, β, n, Te1 ) : |xk(t) − h| < γ.
With this definition we can sharpen Theorem 1.3 so that
it becomes a corollary of the following:
Theorem 1.6 All truth seekers in an (WASBOCOD) Ω are
(1-fold) interrupted convergent.
Originally Hegselmann and Krause considered the (WAS-
BOCOD) model for αi(t) ∈ {0, α} and βij(t) = 1n for all
t ∈ N0. In the case of complete absence of truth seekers
they have already proved, that the opinion of each individ-
ual converges, as can be expected, not necessarily to the
truth. In fact in general the individuals form several clus-
ters, where two individuals of different clusters converge to
different opinions.
We give an example without truth seekers where the indi-
viduals will converge to five different clusters.
Example 1.7 Consider a (WASBOCOD) with αi(t) = 0
(no truth seekers), β = βij(t) = 1n , n = 12, and
α = h = 12 for formal reasons. The starting positions are
given by
x1(0) = x2(0) = 0, x3(0) = ε, x4(0) = 2ε,
x5(0) = 3ε, x6(0) = x7(0) = 4ε, x8(0) = 5ε,
x9(0) = 6ε, x10(0) = 7ε, and x11(0) = x12(0) = 8ε,
see Figure 1.
In Table 1 we give the complete dynamics of the opinions
of all 12 individuals over time until the opinion of every in-
dividual has converged. For brevity we write xi instead of
xi(t) and drop the constant ε by writing 2 instead of 2ε.
After three time steps we have reached a stable state, see
Figure 2.
ff f f f ff f f f ff
0ε 1ε 2ε 3ε 4ε 5ε 6ε 7ε 8ε
Figure 1: Starting positions of the individuals in Example
1.7.
x1 x6 x11
t x2 x3 x4 x5 x7 x8 x9 x10 x12
0 0 1 2 3 4 5 6 7 8
1 13
3
4 2
13
4 4
19
4 6
29
4
23
3
2 1736
17
36 2
15
4 4
17
4 6
271
36
271
36
3 1736
17
36 2 4 4 4 6
271
36
271
36
Table 1: Dynamics of Example 1.7.
fff f fff
f
f fff
0ε 1ε 2ε 3ε 4ε 5ε 6ε 7ε 8ε
Figure 2: Final positions of the individuals in Example 1.7.
We remark that for symmetric weights βij(t) = βji(t)
one can easily show that in the absence of truth seekers the
dynamics becomes stable after a finite number of time steps.
In the case of asymmetric weights βij(t) 6= βji(t) we only
have convergence, but need not reach a stable state after
an arbitrary, problem dependent, but finite number of time
steps, as illustrated in the following example.
Example 1.8 Consider a (WASBOCOD) with αi(t) = 0
(no truth seekers), n = 2, x1(0) = 0, x2(0) = ε, β11(t) =
2
3 , β12(t) =
1
3 , β21(t) =
1
2 , β22(t) =
1
2 for all t > 0, and
β = α = h = 13 for formal reasons.
One can easily verify, e. g. by induction, that we have
x1(t) =
(
2
5
−
2
5 · 6t
)
· ε and x2(t) =
(
2
5
+
3
5 · 6t
)
· ε
for all t ∈ N0. So we have |x1(t) − x2(t)| = 16t · ε > 0 but
clearly the opinions of the two individuals converge to 25 .
All stated insights with the absence of truth seekers were
known so far. It becomes a bit more interesting if we allow
truth seekers, i. e. if we consider a general (WASBOCOD).
Example 1.9 Consider a (WASBOCOD) with α1(t) = α,
αi(t) = 0 for i 6= 1, βij(t) = 1n , h =
1
2ε, x1(0) = 0, and
xi(0) = ε for i 6= 1. The opinion ut of the truth seeker 1
at time t and the opinion vt of the other ignorants at time
t > 0 are given by
ut =
[
1
2
− α
(
1
2
−
1
n
)(
1−
α
n
)t−1]
ε,
vt =
[
1
2
+
(
1
2
−
1
n
)(
1−
α
n
)t−1]
ε
respectively. This can be verified e. g. by induction. We see
that the opinion of the truth seekers, and here also those of
the ignorants, converge to the truth h = 12ε (not all opinions
of ignorants must converge to the truth as one can see by
adding some further ignorants with x̃i(0) = 3ε).
146
As our analysis of the previous example was rather tech-
nical we also depict the situation for special values n = 6
and α = 23 in Figure 3 where we depict the truth seeker by
a filled circle and the ignorants by an empty circle.
0
5
10
15
20
v vv
vvv
vvv
vvv
vvv
vvv
vvv
fff
fff
fff
fff
fff
fff
fff
0ε 12ε 1ε
Figure 3: Dynamics of example 1.9.
One can easily imagine more complicated configurations
as in Example 1.9 where one has little chance and willing-
ness to describe the situation analytically. Our result The-
orem 1.3 states that whatever the parameters of a (WAS-
BOCOD) are the opinions of the truth seekers converge to
the truth. This settles an open conjecture of Hegselmann
and Krause.
2 The crucial objects
To get a first impression of what we may expect in terms of
convergence we consider a lonely truth seeker, i. e. n = 1.
Lemma 2.1 For a lonely truth seeker i = 1 we have
|xi(t+ r) − h| 6 |xi(t) − h| · (1− α)r.
PROOF.
|xi(t+ 1) − h| = |xi(t) − h| · (1− αi(t))
6 |xi(t) − h| · (1− α).

Clearly this bound is sharp. Similar to this very special
situation of a lonely truth seeker is the case ε = 0, so that
we now assume ε > 0 for the remaining part of this article.
To describe the state of the discrete time dynamical sys-
tem we look at the truth seekers with the most extreme opin-
ion.
Definition 2.2 We define ũ(t) ∈ K as the lexicographi-
cally smallest truth seeker which fullfills xũ(t)(t) > h and
xũ(t)(t) > xk(t) for all k ∈ K. If there is no truth seeker
with opinion greater or equal to the truth h we set ũ(t) = 0,
where x0 (t ′) := h for all t ′ ∈ N0. Similar we define l̃(t)
as the lexicographically smallest truth seeker which fullfills
xl̃(t)(t) 6 h and xl̃(t)(t) 6 xk(t) for all k ∈ K. Again we
set l̃(t) = 0 if there is no such truth seeker.
Due to the symmetrical or fair definition of the confidence
set, the intermediate interactions between the individuals
can be described as a simple graph with loops.
Definition 2.3 The confidence graph G(t) with vertex set
V(t) and edge set E(t), of a configuration x(t) =
(x1(t), . . . , xn(t)) ∈ Rn is defined as follows:
V(t) := [n] ∪ {0},
E(t) := {{i, j} | |xi(t) − xj(t)| 6 ε} .
For i ∈ V(t) let Ci(t) be the set of vertices in the connec-
tivity component of vertex i in G(t).
Because we want to keep track of the individuals which
can influence the truth seekers in the future, we give a further
definition for individuals, which is similar to Definition 2.2
for truth seekers.
Definition 2.4 We define û(t) ∈ Cũ(t)(t) as the lexico-
graphically smallest individual with xû(t)(t) > xc(t) ∀c ∈
Cũ(t)(t) and l̂(t) ∈ Cl̃(t)(t) as the lexicographically small-
est individual with xl̂(t)(t) 6 xc(t) ∀c ∈ Cl̃(t)(t) for all
t ∈ N0.
The opinions of û(t) and l̂(t) form an interval[
xl̂(t)(t), xû(t)(t)
]
called the hope interval which is cru-
cial for our further investigations. To prove the main theo-
rem we will show that the length of this hope interval con-
verges to zero.
In Figure 4 we have depicted a configuration to illustrate
Definition 2.2 and Definition 2.4. Here we have l̃ = 4, ũ =
9, l̂ = 2, and û = 12. Individual 1 is lost and not contained
in the hope interval, because there is no path in G from 1 to
l̃ = 4. So we already know that the opinion of individual 1
will not converge to the truth.
g g g wgww g ww g g↓
1
↓
2
↓
3
↓
4
↓
5
↓
6
↓
7
↓
8
↓
9
10
↓
11
↓
12
0ε 12ε 1ε
3
2ε
↓
h
2ε 52ε 3ε
7
2ε
Figure 4: Illustration of Definition 2.2 and Definition 2.4.
In the configuration depicted in Figure 5 we have l̃ = 2,
ũ = 0, l̂ = 2, and û = 5.
We remark that due to the possibility of asymmetric
weights βij the sequence of the opinions of the individuals
may reorder during the time steps. Therefore let us consider
e. g. three ignorants with starting positions x1(0) = 1ε,
x2(0) =
3
2ε, and x3(0) = 2ε. The weights may be given as
147
g w g g g↓
1
↓
2
↓
3
↓
4
↓
5
0ε 12ε 1ε
3
2ε
↓
h
2ε 52ε 3ε
7
2ε
Figure 5: Illustration of a special case in Definition 2.2.
β11(0) = 0.01, β12(0) = 0.01, β13(0) = 0.98, β21(0) =
0.98, β22(0) = 0.01, β23(0) = 0.01, β31(0) = 0.4,
β32(0) = 0.4, and β33(0) = 0.2. After one time step the
new opinions are given by x1(1) = 1.985ε, x2(1) = 1.015ε,
and x3(1) = 1.4ε. We remark that it is possible to achieve
every ordering of the three opinions in one time step by
choosing suitable weights βij in this example. Nevertheless
we have the following trivial lemma:
Lemma 2.5 Let i be an ignorant, l ∈ Iεi (t) be an individual
with smallest opinion and u ∈ Iεi (t) be an individual with
largest opinion then we have xi(t+ 1) ∈ [xl(t), xu(t)].
PROOF. Follows from update equation (1). 
For truth seekers we have a similar lemma:
Lemma 2.6 Let i be a truth seeker, l ∈ Iεi (t) be an in-
dividual with smallest opinion and u ∈ Iεi (t) be an in-
dividual with largest opinion. For xi(t) 6 h we have
xi(t + 1) ∈ [xl(t),max (h, xu(t))] and for xi(t) > h we
have xi(t+ 1) ∈ [min (h, xl(t)) , xu(t)].
Our aim is to prove that the length of the hope interval
converges to zero. So at first we show that the length does
not increase after an iteration of Equation (1).
Lemma 2.7 For all time steps t ∈ N0 we have xû(t+1)(t+
1) 6 xû(t)(t) and xl̂(t+1)(t+ 1) > xl̂(t)(t).
PROOF. We only prove the last inequality since the proof is
similar for the first inequality. Due to Definition 2.4 we have
xl̂(t+1)(t+1) 6 h and xl̂(t)(t) 6 h. By L(t) we denote the
set of individuals with opinion strictly smaller than xl̂(t)(t),
this is L (t ′) :=
{
i ∈ [n] | xi (t ′) < xl̂(t′) (t ′)
}
for all t ′ >
t. We remark that by definition L (t ′) does not contain a
truth seeker. We set U (t ′) := [n]\L (t ′), which contains
the remaining individuals.
Letu be an individual in L(t) with the largest opinion. By
applying Lemma 2.5 we get xi(t + 1) 6 xu(t) for all i ∈
L(t). Now let l (e. g. l = l̂(t)) be an individual in U(t) with
smallest opinion then by applying Lemma 2.5 and Lemma
2.6 we receive xi(t + 1) > xl(t) for all i ∈ U(t). Thus
we have l̂(t + 1) ∈ U(t) and so xl̂(t+1)(t + 1) > xl̂(t)(t)
follows. 
In the remaining part of this article we prove that the
length of the hope interval
∣∣∣xû(t)(t) − xl̂(t)(t)∣∣∣ converges
(in some special sense) to zero, as t tends to infinity.
3 Proof of the Hegselmann-Krause
Conjecture
At first we show that after a finite number T of time
steps, depending only on n, ε, α, and β, the hope in-
terval
[
xl̂(T)(T), xû(T)(T)
]
is contained in the interval[
h− ε− εαβ12 , h+ ε+
εαβ
12
]
. Therefore we give:
Definition 3.1 A good iteration is an iteration where for a
bounded r one of the following conditions is fullfilled:
(1) the number of individuals in the hope interval de-
creases,
(2) the opinion of l̂(t+ r) reaches or passes h− ε− εαβ12 ,
(3) the opinion of û(t+ r) reaches or passes h+ ε+ εαβ12 ,
(4)
∣∣xû(t+r)(t+ r) − xû(t)(t)∣∣ > εαβ212 ,
(5)
∣∣∣xl̂(t+r)(t+ r) − xl̂(t)(t)∣∣∣ > εαβ212 .
Clearly, there is only a finite number of good iterations.
We may choose T = r ·
(
n+ 2 · 1+ 2 · 12
εαβ2
)
. We for-
mulate the next lemmas only for the lower bound xl̂(t)(t)
because analog arguments hold for xû(t)(t). As a shorthand
we define d(i, j, t) := |xi(t) − xj(t)|. For each point in time
t we define the sets
N(t) :=
{
i ∈ [n] | d
(
l̂(t), i, t
)
∈
[
0,
εαβ
12
)}
,
M(t) :=
{
i ∈ [n] | d
(
l̂(t), i, t
)
∈
[εαβ
12
, ε
]}
, and
F(t) :=
{
i ∈ [n] | xi(t) − xl̂(t)(t) > ε
}
.
Lemma 3.2 If M(t) 6= ∅ then there is a good iteration after
1 step.
PROOF. We assume that there is an individual j ∈M(t) with
d
(
l̂(t), j, t
)
∈
[
εαβ
12 , ε
]
. For the evaluation of Equation
(1) for elements of N, M, or F we do not need to consider
the opinion of individuals in [n]\ (N ∪M ∪ F). Let i be
an element of N with opinion xi(t) = xl̂(t) + δ, where
0 6 δ < εαβ12 . Let us first assume that i is an ignorant. Due
to individual j we have xi(t+ 1)
> xi(t) − δ (1− 2β)︸ ︷︷ ︸
individuals in N\{i}
+ 0 · β︸︷︷︸
i
+
(
εαβ
12
− δ
)
· β︸ ︷︷ ︸
j
> xl̂(t) +
εαβ2
12
.
For a truth seeker we similarly receive xi(t+ 1)
> xi(t) + αε+ (1−α)
(
−δ (1−2β) +
(
εαβ
12
− δ
)
·β
)
> xl̂(t) +
εαβ2
12
.
148
Now let i be an element of M ∪ F with xi(t) = xl̂(t) + δ
where δ > εαβ12 . In any case (i being a truth seeker or an
ignorant) we have
xi(t+ 1) > xl̂(t) + δ− δ(1− β)︸ ︷︷ ︸
individuals with smaller opinion than i
+β · 0 > xl̂(t) +
εαβ2
12
.

Lemma 3.3 If xl̂(t) < h − ε −
εαβ
12 then after at least 3
time steps we have a good iteration.
PROOF. Due to Lemma 3.2 we can assume M(t) = M(t +
1) = M(t+ 2) = ∅. We can also assume
∣∣∣xl̂(t)(t) − xl̂(t+1)(t+ 1)∣∣∣ < εαβ212 ,∣∣∣xl̂(t+1)(t+ 1) − xl̂(t+2)(t+ 2)∣∣∣ < εαβ212 , and
d
(
l̂(t+ 1), 0, t+ 1
)
> ε+
εαβ
12
since otherwise we have a good iteration in at most 2 time
steps. At first we claim N(t+ 1) ∩ K = ∅. If at time t there
is a truth seeker i ∈ N(t) ∩ K then we have
xi(t+ 1) > xl̂(t)(t) + αε−
(1− α)(1− β)εαβ
12
> xl̂(t)(t) +
εαβ2
12
+
εαβ
12
> xl̂(t+1)(t+ 1) +
εαβ
12
.
So the only possible truth seeker who has a chance to move
into the set N(t + 1) could be those of the set F(t). So let
truth seeker i be in the set F(t)∩K, with xi(t) = xl̂(t)(t)+δ,
where ε < δ < ε+ εαβ12 . (Truth seekers where δ > ε+
εαβ
12
are ruled out by Lemma 2.6.) We have
xi(t+ 1) > xl̂(t)(t) + ε︸ ︷︷ ︸
6xi(t)
− (1− α)(1− 2β)
> xl̂(t)(t) + εα
> xl̂(t)(t) +
εαβ2
12
+
εαβ
12
> xl̂(t+1)(t+ 1) +
εαβ
12
.
Similarly we can deduce N(t + 2) ∩ K = ∅. Now we can
assume that the individuals of N(t + 1), who are all igno-
rants, are in the hope interval at time t + 1, since other-
wise we would have a good iteration after 1 time step. So
there exist individuals i ∈ N(t + 1) and j ∈ F(t + 1)
with |xi(t+ 1) − xj(t+ 1)| 6 ε. We set xi(t + 1) =
xl̂(t+1)(t + 1) + δ, where 0 6 δ 6
εαβ
12 and calculate
xi(t+ 2)
> xi(t+ 1) − (1− 2β)δ+ β · 0︸︷︷︸
i
+ β
(
ε−
εαβ
12
)
︸ ︷︷ ︸
j
> xl̂(t+1)(t+ 1) +
εαβ2
12
+
εαβ
12
> xl̂(t+2)(t+ 2) +
εαβ
12
.
For the other direction we have
xi(t+ 2) 6 xi(t+ 1) − βδ︸︷︷︸
l̂(t+1)
+ (1− 2β)ε
6 xl̂(t+1)(t+ 1) +
εαβ
12
+ ε− 2βε
6 xl̂(t+1)(t+ 1) +
εαβ2
12
+ ε
6 xl̂(t+2)(t+ 2) + ε.
Thus i ∈M(t+2), which results in a good iteration in three
time steps. 
Thus we can conclude:
Lemma 3.4 After a finite number of steps T we have
xl̂(T)(T) > h− ε−
εαβ
12 and xû(T)(T) 6 h+ ε+
εαβ
12 .
Due to Lemma 2.1 there can not exist a general bound on
the convergence that does not depend on α. We consider
the two side lengths l2(t) :=
∣∣xû(t)(t) − h∣∣ and l1(t) :=∣∣∣xl̂(t)(t) − h∣∣∣ of the hope interval. Clearly l1(t) and l2(t)
are not increasing due to Lemma 2.7. For t > T we have
l1(t), l2(t) 6 ε+
εαβ
12
Lemma 3.5 If l1(t) + l2(t) 6 ε then we have
(l1(t+ 1) + l2(t+ 1)) 6 (l1(t) + l2(t)) ·
(
1−
β
2
)
.
PROOF. Let us assume w.l.o.g. that l1(t) > l2(t) > 0. If
i is an ignorant with xi(t) = h − l1(t) + δ then we have
xi(t+ 1)
> h− l1(t) + δ− (1− 2β)δ+ β (l1(t) + l2(t) − δ)
> h− (1− β)l1(t).
For a truth seeker i with xi(t) = h − l1(t) + δ we have
xi(t+ 1)
> h− l1(t) + δ− α(δ− l1(t)) − (1− α)(1− 2β)δ+
(1− α)β (l1(t) + l2(t) − δ)
> h− l1(t) + βδ(1− α) + αl1(t)(1− β) +
βl2(t)(1− α) + βl1(t)
> h− (1− β)l1(t).
Thus we have l1(t+ 1) 6 (1− β)l1(t). Using l2(t+ 1) 6
l2(t) and l2(t) 6 l1(t) we conclude
l1(t+ 1) + l2(t+ 1) 6 (1− β)l1(t) + l2(t)
6
(
1−
β
2
)
(l1(t) + l2(t)) .

149
This states that once the length of the hope interval be-
comes at most ε its lengths converges to zero.
Lemma 3.6 If there exists an individual i with αβl1(t)12 6
d
(
l̂(t), i, t
)
6 ε, then we have l1(t + 1) 6 l1(t) ·(
1− αβ
2
12
)
. If there exists an individual i with αβl2(t)12 6
d (û(t), i, t) 6 ε, then we have l2(t + 1) 6 l2(t) ·(
1− αβ
2
12
)
.
PROOF. Due to symmetry it suffices to prove the first state-
ment. Let j be an ignorant with xj(t) = h−l1(t)+δ, where
δ > 0. We have xj(t+ 1)
> h− l1(t) + δ− (1− 2β)δ+ β
(
αβl1(t)
12
− δ
)
︸ ︷︷ ︸
i
> h−
(
1−
αβ2
12
)
l1(t).
For a truth seeker j with xj(t) = h − l1(t) + δ, δ > 0 we
have xj(t+ 1)
> h− l1(t) + δ+ α(l1(t) − δ) − (1− α)(1− 2β)δ+
(1− α)β
(
αβl1(t)
12
− δ
)
︸ ︷︷ ︸
i
> h− l1(t) + βδ(1− α) + αl1(t)
(
1−
αβ2
12
)
+
αβ2l1(t)
12
> h−
(
1−
αβ2
12
)
l1(t).

For transparency we introduce the following six sets:
N1(t) =
{
i ∈ [n] | d
(
l̂(t), i, t
)
<
αβl1(t)
12
}
,
N2(t) =
{
i ∈ [n] | d (û(t), i, t) < αβl2(t)
12
}
,
M1(t) =
{
i ∈ [n] | αβl1(t)
12
6 d
(
l̂(t), i, t
)
6 ε
}
,
M2(t) =
{
i ∈ [n] | αβl2(t)
12
6 d (û(t), i, t) 6 ε
}
,
F1(t) =
{
i ∈ [n] | d
(
l̂(t), i, t
)
> ε, xi(t) 6 h+ l2(t)
}
,
F2(t) = {i ∈ [n] | d (û(t), i, t) > ε, xi(t) > h− l1(t)} .
With this the individuals of the hope interval are parti-
tioned into
N1(t) ∪M1(t) ∪ F1(t) = N2(t) ∪M2(t) ∪ F2(t).
Lemma 3.7 If for k ∈ {1, 2} there exists an ignorant i ∈
Nk(t) and an individual j ∈ Fk(t) with |xi(t) − xj(t)| 6 ε
then lk(t+ 2) 6 lk(t) ·
(
1− αβ
2
12
)
.
PROOF. If lk(t+ 1) > lk(t) ·
(
1− αβ
2
12
)
, then it is easy to
check that the influence of individual j suffices to put igno-
rant i in set Mk(t + 1). In this case we can apply Lemma
3.6 
Lemma 3.8 If Nk(t+ 1) ∩ K 6= ∅ then lk(t+ 1) 6 lk(t) ·(
1− α2
)
.
PROOF. Due to symmetry it suffices to consider k = 1. So
let i be a truth seeker with i ∈ N1(t + 1). We set xi(t) =
h− l1(t) + δ and calculate xi(t+ 1)
> h− l1(t) + δ+ α (l1(t) − δ) − (1− α)(1− β)δ
> h− (1− α)l1(t).

Lemma 3.9 We have lk(t+ 3) 6 lk(t) ·
(
1− αβ
2
12
)
for at
least one k ∈ {1, 2}.
PROOF. Due to Lemma 3.8 we can assume Nk(t+1)∩K =
∅. At time t+1 there must be a truth seeker i. W.l.o.g. we as-
sume xi(t) 6 h and i = l̃(t+1). Due to Lemma 3.6 we can
assume i ∈ F1(t+1). Now let j1 be the ignorant with small-
est opinion fulfilling d(i, j1, t + 1) 6 ε. If j1 ∈ N1(t + 1)
then we can apply Lemma 3.7 with j1 and i. Otherwise
we let j2 be the ignorant with smallest opinion fulfilling
d (j1, j2, t+ 1) 6 ε. So we have d (j2, i, t+ 1) > ε and
j2 ∈ N1(t+ 1). Thus we can apply Lemma 3.7 with j2 and
j1. 
Lemma 3.10 If lk(t) > ε then we have ε − lk(t + 3) 6
(ε− lk(t)) ·
(
1− αβ
2
12
)
or lk(t+ 3) 6 ε.
PROOF. Due to Lemma 3.8 we can assume Nk(t+1)∩K =
∅ and due to Lemma 3.6 we can assume Mk(t + 1) = ∅.
Due to symmetry we only consider the case k = 1. Let
i ∈ N1(t + 1) the ignorant with largest opinion xi(t + 1),
meaning that d
(
l̂(t+ 1), i, t+ 1
)
is maximal. If there ex-
ists an individual j ∈ F1(t+ 1) with d(i, j, t+ 1) 6 ε, then
we can apply Lemma 3.7. If no such individual j exists then
we must have d(i, 0, t + 1) 6 ε or l1(t + 1) = 0. So only
the first case remains. We set δ = d
(
l̂(t+ 1), i, t+ 1
)
>
ε − l1(t + 1). Let h ∈ N1(t + 1) be an ignorant with
xh(t+1) = xl̂(t+1)(t+1)+µ, where 0 6 µ 6 δ. For time
t+ 2 we get xh(t+ 2)
> xl̂(t+1)(t+ 1) + µ− (1− 2β)µ+ β(δ− µ)
> xl̂(t+1)(t+ 1) + βδ
> xl̂(t+1)(t+ 1) + β(ε− l1(t+ 1)).

From Lemma 3.9 and Lemma 3.10 we conclude:
Lemma 3.11 There exists a finite number T(ε, n, α, β) so
that we have
l1(t) + l2(t) 6 ε+
εα2β3
60
150
and
min(l1(t), l2(t)) 6
εα2β3
60
for all t > T(ε, n, α, β).
Let k ∈ {1, 2} be the value where the maximum of l1(T)
and l2(T) is attained. Then we have
(1) ε− εα
2β3
60 6 lk(T) 6 ε+
εα2β3
60 ,
(2) l3−k(T) 6 εα
2β3
60 .
Due to Lemma 3.6 and Lemma 3.7, at time T + 3 we either
have l1(T + 3) + l2(T + 3) 6 ε and can apply Lemma 3.5,
or at time T the opinions of the individuals are contained the
two intervals
I1 =
[
h− ε−
εα2β3
60
, h− ε+
εα2β3
60
]
and
I2(t) =
[
h−
εα2β3
60
·
(
1−
β
2
)t−T
,
h+m · εα
2β3
60
·
(
1−
β
2
)t−T]
,
and xk(T) ∈ I2(T) for all truth seekers k ∈ K.
Lemma 3.12 For each t > T we have
l1(t+ 3) + l2(t+ 3) 6 ε
or the individuals of the hope interval all have opinions in
I1 ∪ I2(t) and xk(t) ∈ I2(t) for all truth seekers k ∈ K.
PROOF. We prove by induction on t. The induction base
is given for t = T . If there exist individuals i and j with
xi(t) ∈ I1, xj(t) ∈ I2(t), and d(i, j, t) 6 ε then due to
Lemma 3.6 and Lemma 3.7 we would have l1(t + 3) +
l2(t + 3) 6 ε. Otherwise the individuals with opinions in
I2(t) influence each other pairwise and there is no influence
from another individual with an opinion not in I2(t). With
a similar calculation as in the proof of Lemma 3.5, we get
xi(t+ 1) ∈ I2(t+ 1) for all i with xi(t) ∈ I2(t). 
From the previous lemmas we can conclude Theorem 1.3
and Theorem 1.6. After a finite time T(ε, n, α, β) we are
in a nice situation as described in Lemma 3.11. If we have
l1(T + 3) + l2(T + 3) 6 ε then we have an ordinary con-
vergence of the truth seekers being described in Lemma 3.5.
Otherwise we have d(k, 0, T) 6 εα
2β3
60 for all truth seekers
k ∈ K. Due to Lemma 3.12 and Lemma 3.5 either we have
d(k, 0, t) 6
εα2β3
60
·
(
1−
β
2
)t−T
for all truth seekers k ∈ K and all t > T , or there exists an
S ∈ N0, such that
(1) d(k, 0, t) 6 εα
2β3
60 ·
(
1− β2
)t−T
for all T 6 t 6 S,
(2) d(k, 0, t) 6 ε
(
1− β2
)t−S−3
for all t > S+ 3.
The latter case is 1-fold interrupted convergence. Thus the
Hegselmann-Krause Conjecture is proven.
4 Remarks
In this section we would like to generalize the Hegselmann-
Krause Conjecture and show up which requirements can not
be weakened.
Lemma 4.1 A finite number n of individuals and symmetric
confidence intervals are necessary for a convergence of the
truth seekers.
PROOF. Infinitely many ignorants can clearly hinder a truth
seeker in converging to the truth. If the confidence intervals
are not symmetric then it is easy to design a situation where
some ignorants are influencing a truth seeker which does
not influence the ignorants, so that the truth seeker has no
chance to converge to the truth. 
Lemma 4.2 The condition βij(t) > β > 0 is necessary for
a convergence of the truth seekers.
PROOF. If we would only require βij(t) > 0, then we
could have the following example: n = 2, x1(0) = 1− 15ε,
x2(0) = 1 − ε, α1(t) = 15 , α2(t) = 0, β11(t) =
(
1
2
)t+1
,
β12(t) = 1 −
(
1
2
)t+1
, β21(t) =
(
1
2
)t+1
, β22(t) =
1 −
(
1
2
)t+1
, and h = 1. By a straight forward calculation
we could see that |x1(t) − h| > 12ε for t > 1. 
We remark that conditions like βij(t) +βij(t+ 1) > 2β
would also not force a convergence of the truth seekers in
general. One might consider an example consisting of two
ignorants with starting positions h± 710ε and a truth seeker
k with starting position h − 15ε. We may choose suitable
βij(t) and αi(t) so that we have |h− xk(t)| > 15ε for all t,
h− xk(t) > 15ε for even t and xk(t) − h >
1
5ε for odd t.
For the next lemma we need a generalization of Definition
1.5.
Definition 4.3 In our situation we say that the truth seekers
are r-fold interrupted convergent, if there exists r + 1 func-
tions Tsi
(
γ, ε, α, β, n, Tei−1
)
, i = 1, . . . , r + 1 so that for
each (WASBOCOD) Ω with structural parameters ε, α, β
and n there exist Tei ∈ N0, i = 1, . . . , r fullfilling
∀k ∈ K, ∀t ∈
[
Tsi
(
γ, ε, α, β, n, Tsi−1
)
, Tei
]
:
|xk(t) − h| < γ
for i = 1, . . . , r, where Te0 = 0, and
∀k ∈ K, ∀t > Tsr+1 (γ, ε, α, β, n, Ter ) :
|xk(t) − h| < γ.
Lemma 4.4 The condition αi(t) = 0 for all i ∈ K is neces-
sary for Theorem 1.6. If it is dropped then the truth seekers
are not (
∣∣K∣∣− 1)-fold convergent in general.
PROOF. At first we remark that clearly it suffices to have
αi(t) = 0 for all i ∈ K only for all t > T , where T is
a fix integer. W.l.o.g. we assume T = 0 and consider the
following example: h = 1, xi(0) = 1− 2iε, 1 ∈ K, 1 6= i ∈
151
K, βij(t) = β, αi(t) = α for the truth seekers, and αi(t) =
0 for the ignorants until we say otherwise. Let there be a
given γ > 0 being sufficiently small. There exists a time T1
until x1(T1) < 1−γ. Up to this time no other individual has
changed its opinion. After time T1 + 1 we suitably choose
α2(t) so that we have 12ε 6 x1(T̃1) − x2(T̃1) 6 ε. So at
time T̃1 + 1 the convergence of truth seeker 1 is interrupted
the first time. After that we may arrange it that x1 and x2 get
an equal opinion and will never differ in there opinion in the
future. Now there exists a time T2 until x2(T2) = x1(T2) <
1 − γ and we may apply our construction described above
again. Thus every ignorant i ∈ K may cause an interruption
of the convergence of the truth seekers. 
Conjecture 4.5 If we drop the condition αi(t) = 0 for all
i ∈ K in Theorem 1.6 then we have (
∣∣K∣∣)-fold convergence
of the truth seekers.
The Hegselmann-Krause Conjecture might be general-
ized to opinions in Rm instead of R when we use a norm
instead of |·| in the definition of the update formula. Using
our approach to prove thism-dimensional conjecture would
become very technical, so new ideas and tools are needed.
We give an even stronger conjecture:
Conjecture 4.6 The m-dimensional generalized
Hegselmann-Krause Conjecture holds and there exists
a function φ(Ω,γ) so that the truth seekers in an arbitrary
generalized (WASBOCOD) Ω are φ(Ω,γ)-fold interrupted
convergent in ε, α, β, and n.
Bibliography
[1] S. Fortunato, The Krause-Hegselmann Consensus
Model with Discrete Opinions, Int. J. Mod. Phys.
C 15 (2004), 1021–1029.
[2] S. Fortunato, Damage spreading and opinion dynam-
ics on scale-free networks, Phys. A 348 (2005),
683–690.
[3] S. Fortunato, On the Consensus Threshold for the
Opinion Dynamics of Krause-Hegselmann, Int. J.
Mod. Phys. C 16 (2005), 259–270.
[4] S. Fortunato, V. Latora, A. Pluchino, and A. Rapisarda,
Vector opinion dynamics in a bounded confidence
consensus model, Int. J. Mod. Phys. C 16 (2005),
no. 10, 1535–1551.
[5] S. Fortunato, V. Latora, A. Pluchino, and A. Rapis-
arda, Vector Opinion Dynamics in a Bounded Con-
fidence Consensus Model, Int. J. Mod. Phys. C 16
(2005), 1535–1551.
[6] S. Fortunato and D. Stauffer, Computer Simulations
of Opinions, ArXiv Condensed Matter e-prints
(2005).
[7] R. Hegselmann and U. Krause, Opinion dynamics and
bounded confidence: models, analysis and simula-
tion, Journal of Artificial Societies and Social Sim-
ulation (JASSS) 5 (2002), no. 3.
[8] R. Hegselmann and U. Krause, Truth and cognitive di-
vision of labour: First steps towards a computer
aided social epistemology, Journal of Artificial So-
cieties and Social Simulation (JASSS) 9 (2006),
no. 3.
[9] U. Krause, Time-variant consensus formation in
higher dimensions, Elaydi, Saber (ed.) et al., Pro-
ceedings of the 8th international conference on dif-
ference equations and applications (ICDEA 2003),
Masaryk University, Brno, Czech Republic, July
28–August 1, 2003. Boca Raton, FL: Chapman
&amp; Hall/CRC. 185-191 (2005), 2005.
[10] U. Krause, Arithmetic-geometric discrete systems, J.
Difference Equ. Appl. 12 (2006), no. 2, 229–231.
[11] W. Liebrand, A. Nowak, and R. Hegselmann (eds.),
Computer modeling of social processes, Sage Pub-
lications, 1998.
[12] J. Lorenz, A stabilization theorem for dynamics of con-
tinuous opinions, Phys. A 355 (2005), 217–223.
[13] J. Lorenz, Consensus strikes back in the Hegselmann-
Krause model of continuous opinion dynamics un-
der bounded confidence, Journal of Artificial So-
cieties and Social Simulation (JASSS) 9 (2006),
no. 1.
[14] K. Malarz, Truth seekers in opinion dynamics models,
ArXiv Physics e-prints (2006).
[15] D. Stauffer, The Sznajd Model of Consensus Building
with Limited Persuasion, Int. J. Mod. Phys. C 13
(2002), 315–317.
[16] D. Stauffer, How to Convince Others? Monte Carlo
Simulations of the Sznajd Model, AIP Conf. Proc.
690: The Monte Carlo Method in the Physical
Sciences (J. E. Gubernatis, ed.), November 2003,
147–155.
[17] D. Stauffer, Sociophysics simulations II: opinion dy-
namics, AIP Conf. Proc. 779: Modeling Cooper-
ative Behavior in the Social Sciences (P. Garrido,
J. Maroo, and M. A. Muñoz, eds.), July 2005, 56–
68.
[18] D. Stauffer and M. Sahimi, Discrete simulation of the
dynamics of spread of extreme opinions in a soci-
ety, Phys. A 364 (2006), 537–543.
152
Zusammenfassung
Diese kumulative Habilitationsschrift handelt von diskreten
Strukturen, den zugehörigen Algorithmen und Anwen-
dungsproblemen in denen diskrete Strukturen vorkommen
bzw. zur Lösung nützlich sind. Als Leitfrage im Hinter-
grund stand:
”Wie kann man auf diskreten Strukturen optimieren?“
Da dies eine sehr umfassende Frage ist haben wir uns im
Rahmen dieser Arbeit, auf einige Anwendungsbeispiele und
ausgewählte diskrete Strukturen beschränkt.
1 Polyominoes
Abbildung 1: Polyominoes aus höchstens fünf Einheits-
quadraten.
Ein Polyomino ist eine Seite-an-Seite-Anlagerung von
Einheitsquadraten, siehe Abbildung 1. Hierbei werden
Polyominoes, die sich durch Translationen, Rotationen bzw.
Spiegelungen ineinander überführen lassen, als äquivalent
betrachtet.
?
Abbildung 2: Spiralkonstruktion.
Seit längerem ist bekannt, dass der minimale Umfang
p(n) eines Polyominoes aus n Einheitsquadraten durch
2
⌈
2
√
n
⌉
gegeben ist. Diese untere Schranke wird z. B.
von der sogenannten Spiralkonstruktion angenommen, siehe
Abbildung 2. Ausgehend von einem Einheitsquadrat wer-
den hier spiralförmig Einheitsquadrate angebaut. Bestimmt
man für kleine Anzahlen n an Einheitsquadraten alle Poly-
ominoes mit minimalem Umfang p(n), so stellt man fest,
dass es einige Beispiele gibt, die nicht durch die Spiralkons-
truktion erzeugt werden, siehe Abbildung 3.
Abbildung 3: Polyominoes mit minimalem Umfang p(n)
für n 6 11.
Bei dem Optimierungsproblem ”minimaler Umfang eines
Polyomino aus n Einheitsquadraten“ war also bisher der
minimale Wert p(n) bekannt. Man hatte aber keine kom-
plette Beschreibung der Menge der minimalen Elemente.
In Kapitel 2 zeigen wir, dass jedes Polyomino mit mi-
nimalem Umfang entsteht, indem man bei einem geeignet
gewählten a × b-Rechteck, mit 2(a + b) = p(n) und
ab > n, von den vier Ecken ausgehend ab − n Einheits-
quadrate entfernt. Für n = 122 braucht man z. B. nur die
11× 12-, 10× 13- und 9× 14-Rechtecke zu betrachten. In
Abbildung 4 haben wir die Mengen der an einer Ecke ent-
fernten Einheitsquadrate dargestellt. Sie bilden sogenannte
Ferrers-Diagramme von Partionen.
Abbildung 4: Gestalt der entfernten Einheitsquadrate an den
Ecken.
Die Anzahl fi der Ferrers-Diagramme aus i Quadraten
bzw. die Anzahl der Partitionen von i lässt sich durch die
153
Erzeugendenfunktion
f(x) =
∞∑
i=0
fix
i =
∞∏
j=1
1
1− xj
angeben.
Da wir die ab − n Einheitsquadrate an allen vier Ecken
des a × b-Rechtecks entfernen können und symmetrische
Konfigurationen identifizieren müssen, zählen wir durch
s(x) = 1+
∑∞
k=1 x
k2
k∏
j=1
1
1−x2j
die symmetrischen Ferrers-
Diagramme und wenden folgendes Lemma von Cauchy-
Frobenius an.
Lemma 1.1 Sei eine Gruppenaktion einer endlichen
Gruppe G auf einer Menge S und eine Abbildung
w : S −→ R von S in einen kommutativen Ring R, der
Q als Teilring enthält, gegeben. Falls w konstant auf den
Bahnen von G auf S ist, dann gilt für jede Transversale T
der G-Bahnen:∑
t∈T
w(t) =
1
|G|
∑
g∈G
∑
s∈Sg
w(s),
wobei Sg die Elemente von S bezeichnet, welche von einem
Gruppenelement g auf sich selber abgebildet werden:
Sg = {s ∈ S|s = gs}.
Fügt man alle technischen Details zusammen, so erhält
man algorithmisch schnell auswertbare Formeln für die An-
zahl der Polyominoes aus n Einheitsquadraten mit mini-
malem Umfang p(n). Da dieses Abzählresultat in einem
gewissen Sinne konstruktiv erzielt wurde, kann man mit
diesem Vorgehen auch alle minimalen Beispiele algorith-
misch effizient erzeugen. Man könnte aber noch mehr damit
anstellen. Nach leichten Modifikationen kann man einen
Algorithmus erhalten, der Polyominoes aus n Einheits-
quadraten mit minimalem Umfang gleichverteilt zufällig
erzeugt, ohne vorher alle derartigen Polyominoes erzeugen
zu müssen.
Abbildung 5: Die konvexe Hülle von Polyominoes aus bis
zu 5 Einheitsquadraten.
In Kapitel 3 betrachten wir ein weiteres Opti-
mierungsproblem auf Polyominoes. Diesmal soll der
Flächeninhalt der konvexen Hülle eines Polyominoes aus n
Einheitsquadraten maximiert werden, siehe Abbildung 5.
Abbildung 6: Polyominoes mit maximalem Flächeninhalt
der konvexen Hülle aus bis zu 6 Einheitsquadraten.
In Abbildung 6 haben wir alle Polyominoes mit ma-
ximalem Flächeninhalt der konvexen Hülle aus bis zu 6
Einheitsquadraten dargestellt. Auch bei diesem Problem
ergibt sich ein Zoo an extremalen Lösungen. Wiederum
war der maximale Wert dieses Optimierungsproblems schon
bestimmt, die Menge der extremalen Lösungen aber noch
nicht charakterisiert. Der maximale Flächeninhalt von
n +
⌊
n−1
2
⌋ ⌊
n
2
⌋
wird z. B. von einer Winkelkonstruktion
angenommen, siehe Abbildung 7.
. . .
...
@
@
@
@
@
⌊
n+2
2
⌋
⌊
n+1
2
⌋
Abbildung 7: Winkelkonstruktion für ein Polyomino mit
maximalem Flächeninhalt der konvexen Hülle.
In Kapitel 3 klassifizieren wir die Menge der Polyomi-
noes aus n Einheitsquadraten mit maximalem Flächeninhalt
der konvexen Hülle konstruktiv. Als Abzählresultat erhalten
wir die zugehörige Erzeugendenfunktion
1+x−x2−x3+2x5+8x6+2x7+4x8+2x9−x10+x12
(1− x2)
2
(1− x4)
2
.
Da die Eckpunkte eines Polyominoes auf einem
quadratischen Gitter liegen, ist der Flächeninhalt der kon-
vexen Hülle ein ganzzahliges Vielfaches von 12 . Der mi-
nimale Flächeninhalt der konvexen Hülle bei n Einheits-
quadraten ist offensichtlich durch n gegeben und wird von
154
den rechteckigen Polyominoes angenommen. Es stellt sich
die Frage, welche Flächeninhalte der konvexen Hülle bei
Polyominoes aus n Einheitsquadraten angenommen werden
können. Dies kann vollständig charakterisiert werden und
wird ebenfalls in Kapitel 3 dargestellt.
Für Polyominoes gibt es viele Verallgemeinerungs-
möglichkeiten. Eine sehr naheliegende betrachtet Seite-
an-Seite-Anlagerungen von d-dimensionalen Einheitshy-
perwürfeln. Auch hier stellt sich die Frage nach dem maxi-
malen Volumen der konvexen Hülle eines d-dimensionalen
Polyominoes aus n Einheitshyperwürfeln. Verallgemeinert
man die Winkelkonstruktion aus Abbildung 7 auf Dimen-
sion d, so erhält man ein Polyomino mit Volumen∑
I⊆{1,...,d}
1
|I|!
∏
i∈I
⌊
n− 2+ i
d
⌋
der konvexen Hülle.
Dass dieser Wert dem Maximum entspricht, war bisher
eine offene Vermutung. In Kapitel 3 verwenden wir soge-
nannte Potentialfunktionen, eine Technik, die mehr aus der
Online-Optimierung bekannt ist, um diese Vermutung zu be-
weisen. Hierzu führen wir Parameter l1, . . . , ld, v1, . . . , ld
ein, um d-dimensionale Polyominoes näher zu beschreiben.
Dieses Vorgehen vereinfacht den bisherigen Beweis für Di-
mension d = 2 und macht es überhaupt möglich, die Ver-
mutung für größere Dimensionen d zu beweisen.
2 Ganzzahlige Punktmengen
Seit Jahrhunderten beschäftigen sich Mathematiker mit geo-
metrischen Objekten deren Seiten und Diagonalen ganz-
zahlig sind. Etwas allgemeiner versteht man unter einer
ganzzahligen Punktmenge P eine Menge von n Punk-
ten im m-dimensionalen Euklidischen Raum Em, bei der
alle paarweisen Abstände ganzzahlig sind. Die Fortset-
zungen der pythagoräischen Dreiecke zu Rechtecken sind
Beispiele solcher ganzzahligen Punktmengen. Bezeichnet
man den größten Abstand einer solchen Punktmenge als
ihren Durchmesser, so stellt sich aus kombinatorischer Sicht
sofort die Frage nach dem kleinstmöglichen Durchmesser
einer ganzzahligen Punktmenge bei gegebener Dimension
m und gegebener Anzahl an Punkten n.
In Abbildung 8 haben wir die minimalen Beispiele für
Dimension m = 2 und 3 6 n 6 9 Punkte dargestellt.
Die besten bisher bekannten Schranken für den minimalen
Durchmesser in Dimensionm = 2 sind
c1n 6 d(2, n) 6 n
c2 log logn
mit geeignet zu wählenden Konstanten c1 und c2. Durch
vollständige Enumeration konnte gezeigt werden, dass die
2-dimensionalen Beispiele mit minimalem Durchmesser für
9 6 n 6 122 Punkte eine sehr einfache geometrische
Struktur haben: Sie bestehen aus einer Menge von n −
1 kollinearen Punkten und einem Punkt außerhalb dieser
Linie. Derartige Punktmengen entsprechen Faktorzerle-
gungen einer korrespondierenden Zahl, siehe z. B. Kapitel
s ss
1
1 1 s s ss
13
4 2 2 s ss s
4
2 2
3
4 4 s s s ss
1 33
4 42 2
sss s
s s
5
8
3
3 3
5 57 7
8 8
7 7 s s s s s
s s
5 3 5 3
8
11 9 911
13
17 13 11
9 9
s s s s
s s s
5 3 5
8 8
9 911 11
9 9
13 13
17 17
11 11 s s s s s s
s s
5 3 5 3 5
8
11 1117 1713 13
1111
99 99
s s s s s s s s
s
5 3 5 3 5 3 5
17 13 11 9 9 11 13 17
Abbildung 8: Ganzzahlige Punktmengen mit minimalem
Durchmesser in der Ebene für 3 6 n 6 9 Punkte.
10, so dass es möglich war, für ihren Durchmesser eine un-
tere Schranke von nc3 log logn herzuleiten.
Verbietet man, dass drei Punkte auf einer Linie liegen
dürfen, so bestehen die ganzzahligen Punktmengen mit mi-
nimalem Durchmesser aus bis zu 36 Punkten aus Punkt-
mengen auf jeweils einem Kreis. Auch hier lässt sich ein
Zusammenhang zwischen Faktorzerlegungen über gewissen
Ringen herstellen, siehe z. B. Kapitel 10.
Verbietet man nun zusätzlich, dass vier Punkte auf einem
Kreis liegen dürfen, so waren bisher nur Beispiele aus bis
zu 6 Punkten bekannt. In Kapitel 6 geben wir zwei derartige
Beispiele aus sieben Punkten an und klären damit die seit
längerem offene Existenzfrage konstruktiv.
Eine mögliche Anwendung von planaren ganzzahligen
Punktmengen liegt in der Planung von Antennensystemen,
wie dem VERY LARGE ARRAY (VLA) auf den Ebenen von
San Agustin, 80 Kilometer westlich von Socorro, New Me-
xico, siehe Abbildung 9.
Abbildung 9: Very Large Array in New Mexico, USA (Im-
age courtesy of NRAO/AUI).
Mit Hilfe solcher Antennensysteme werden Objekte im
Weltraum näher analysiert. Ist der Abstand zwischen zwei
Antennen hierbei kein ganzzahliges Vielfaches der verwen-
deten Wellenlänge, so tritt Interferenz auf. Da z. B. die am
155
VLA verwendeten Wellenlängen zwischen 7 Millimetern
und 4 Metern liegen, ist es technisch machbar, auch solch
riesige Antennen so zu positionieren, dass quasi keine In-
terferenz auftritt. Eine komplete Konfiguration von Anten-
nen ohne Interferenzverlusten entspricht offensichtlich einer
ganzzahligen Punktmenge. In der Praxis gibt es allerdings
eine ganze Reihe weiterer Nebenbedingungen und anderer
Ziele neben der Vermeidung von Interferenz.
Die bisher stärkste Strukturaussage über ganzzahlige
Punktmengen betrifft die sogenannte Charakteristik einer
ganzzahligen Punktmenge. Betrachten wir hierfür die
Heronsche Formel A∆(a, b, c) =√
(a+ b+ c)(a+ b− c)(a− b+ c)(−a+ b+ c)
4
für den Flächeninhalt A∆ eines Dreiecks mit Seitenlängen
a, b und c. Da diese ganzzahlig sind, existieren für A∆ 6= 0
eine eindeutig bestimmte rationale Zahl q und eine ein-
deutig bestimmte quadratfreie Zahl k mit A∆ = q
√
k.
Dieses k heißt Charakteristik des Dreiecks ∆. Die Tatsache,
dass jedes nicht-degenerierte Dreieck ∆ in einer ganz-
zahligen Punktmenge dieselbe Charakteristik besitzt, er-
laubt die effiziente Erzeugung ganzzahliger planarer Punkt-
mengen durch Kombination von Dreiecken. Vor kurzem
konnte dieser wichtige Satz auch auf den m-dimensionalen
Raum übertragen werden, so dass m-dimensionale ganz-
zahlige Punktmengen effizient durch Kombination ganz-
zahliger Simplizes erzeugt werden können.
Möchten wir nun ganzzahlige Punktmengen im dreidi-
mensionalen Euklidischen Raum konstruieren, so benötigen
wir bei diesem Ansatz alle ganzzahligen Tetraeder bis zu
einem gegeben Durchmesser d. In Kapitel 4 geben wir einen
Algorithmus an, mit dem man eine derartige Liste effizient
erstellen kann. Für alle Durchmesser d 6 1000 bestimmen
wir dort die Anzahl ganzzahliger Tetraeder mit Durchmesser
d bis auf Isomorphie. Desweiteren betrachten wir an die-
ser Stelle eine interessante geometrische Wahrscheinlich-
keit. Die Wahrscheinlichkeit P2, dass drei Zufallszahlen
aus [0, 1] die Seiten eines Dreiecks sein können, also die
Dreiecksungleichungen erfüllen, lässt sich leicht zu P2 = 12
bestimmen. Als Verallgemeinerung kann man natürlich
nach der Wahrscheinlichkeit P3, dass sechs Zufallszahlen
aus [0, 1] die Seiten eines Tetraeders sein können, fragen. In
Kapitel 4 bestimmen wir numerisch die Schranken
0, 090 6 P3 6 0, 111.
Obwohl sich Mathematiker schon seit langer Zeit mit
ganzzahligen Punktmengen beschäftigen, gibt es bisher nur
sehr wenige theoretische Resultate. Die Lücke zwischen der
besten bekannten unteren und der oberen Schranke für den
minimalen Durchmesser d(2, n) spricht Bände. In Kapitel
5 wird deswegen versucht, ein ähnliches Problem zu betra-
chten, in der Hoffnung die zugrunde liegende Struktur ganz-
zahliger Punktmengen in Euklidischen Räumen hinreichend
genau zu approximieren. Anstatt von Punkten im Rm be-
trachten wir dort Punkte in Restklassenringen Zmn . Analog
zum Euklidischen Fall lässt sich dort ein quadrierter Eukli-
discher Abstand zwischen zwei Punkten (u1, . . . , ud) und
(v1, . . . , vd) als
m∑
i=1
(ui − vi)
2
= a ∈ Zn
definieren. Existiert nun ein Element d ∈ Zn mit d2 = a so
sagen wir, dass diese zwei Punkte einen ganzzahligen Ab-
stand besitzen und können damit von ganzzahligen Punkt-
mengen über Zmn sprechen. Noch etwas allgemeiner lässt
sich dieses Konzept auch auf kommutative Ringe R anstatt
Zn übertragen.
Anstatt ganzzahligen Punktmengen mit minimalem
Durchmesser über Em untersuchen wir in Kapitel 5 ganz-
zahlige Punktmengen über Zmn mit maximaler Kardi-
nalität I(n,m). Interessanterweise zeigt sich für n =
3, 4 ein Zusammenhang zur Kodierungstheorie über Ham-
mingabstände.
Um starke theoretische Hilfsmittel zur Hand zur haben
spezialisieren wir uns in Kapitel 7 auf den Fall wo der
kommutative Ring R ein endlicher Körper Fq ist. Für
2 - q können wir für die maximale Kardinalität einer ganz-
zahligen Punktmenge I(q, 2) = q zeigen und in einigen
Teilfällen die geometrische Struktur der extremalen Lösun-
gen bestimmen. Definiert man Punkte auf einer Geraden
bzw. Punkte auf einem Kreis durch eine polynomiale Glei-
chung über Fq, lassen sich auch Punktmengen ohne drei
Punkte auf einer Geraden bzw. ohne vier Punkte auf einem
Kreis betrachten. Für q ≡ 3 (mod 4) konnte in Kapitel
7 beispielsweise bewiesen werden, dass ganzzahlige Punkt-
mengen mit maximaler Kardinalität ohne drei Punkte auf
einer Gerade aus Punkten auf einem Kreis bestehen.
Ein wichtiger Punkt bei der Analyse einer diskreten
Struktur ist die Bestimmung ihrer Automorphismengruppe.
Und so bestimmen wir in Kapitel 7 die Menge aller Auto-
morphismen von F2q, welche ganzzahlige Abstände wieder
auf ganzzahlige Abstände abbilden. Dieses Resultat wird
in Kapitel 8 auf den m-dimensionalen Fall verallgemeinert.
Dort wird für q ≡ 3 (mod 4) die geometrisch reizvolle Ver-
mutung I(q, 3) 6 q+ 1 aufgestellt.
Bildet man ganzzahlige Abstände über Fmq auf Kanten
in einem Graphen ab, so erhält man interessante Graphen
Gm,q. Für Dimension m = 2 und q ≡ 3 (mod 4) ist
dieser Graph beispielsweise isomorph zum sogennanten Pa-
leygraphen quadratischer Ordnung q2. In Kapitel 9 konnte
gezeigt werden, dass auch G2,q für q ≡ 1 (mod 4) ein stark
regulärer Graph ist. Als Verallgemeinerung beweisen wir in
Kapitel 8, dass die Graphen Gm,q aus einem 3-Klassen As-
soziationsschema hervorgehen. Für gerade Dimensionen m
vermuten wir, dass diese Graphen sogar stark regulär sind.
Da es einige Arbeiten über die inklusionsmaximalen
Cliquen von Paleygraphen gibt, haben wir uns in Kapitel 9
mit inklusionsmaximalen ganzzahligen Punktmengen über
F2q beschäftigt. Es gelang eine vollständige Klassifikation
der inklusionsmaximalen Punktmengen für q 6 47 und der
Beweis der Maximalität einiger Klassen von Punktmengen.
Auch im Euklidischen Raum E2 kann man inklu-
sionsmaximale ganzzahlige Punktmengen betrachten. Die
zugehörigen Resultate beschreiben wir in Kapitel 10.
156
3 Minimale Orientierungen von
Graphen
In der extremalen Graphentheorie betrachtet man Graphen
welche in Bezug auf eine gegebene Eigenschaft extremal in
einer Klasse von Graphen sind. Ein Beispiel eines Graphen
G ist in Abbildung 10 dargestellt. Die Länge eines Weges
zwischen zwei Knoten inG ist durch die Anzahl der verwen-
deten Kanten gegeben. Als Abstand zwischen zwei Knoten
bezeichnet man nun die Länge eines kürzesten Weges zwi-
schen diesen beiden Knoten. Damit lässt sich nun der
Durchmesser eines Graphen G als der maximale Abstand
eines Paares von Knoten aus G definieren.
i
i
i
i i i
i
i
i
i
 
 
@
@ 
 
Abbildung 10: Ein Graph mit Durchmesser 5.
Unser Beispiel aus Abbildung 10 besitzt Durchmesser 5.
Dies bedeutet, dass man von jeder Ecke in G zu jeder be-
liebigen anderen Ecke in G durch Benutzung von maximal
5 Kanten kommen kann, wenn man sich von Ecke zu Ecke
fortbewegt.
Eine Verallgemeinerung von (ungerichtenen) Graphen,
wie in Abbildung 10, sind gerichtete Graphen. Hier
besitzt jede Kante eine Richtung, siehe Abbildung 11.
Entsprechend kann man auch hier den Abstand zweier
Knoten bzw. den Durchmesser eines Graphen definieren.
In unserem Beispiel ergibt sich ein orientierter Durchmesser
von 9.
i
i
i
i i i
i
i
i
i
?
  - -
?
6
-  
 
@
@I 
 	
Abbildung 11: Ein gerichteter Graph mit Durchmesser 9.
Bis auf die Orientierungen der Kanten sind die Graphen
aus Abbildung 10 und Abbildung 11 identisch. Wir sagen
auch, dass der Graph aus Abbildung 11 aus dem Graphen
aus Abbildung 10 durch Orientierung der Kanten her-
vorgeht. Besitzt ein Graph m Kanten so gibt es, ohne
Berücksichtigung von Isomorphie, 2m verschiedene Orien-
tierungen dieses Graphen. In Abbildung 12 geben wir eine
weitere Orientierung unseres Ausgangsgraphen an. Dieses
Mal mit einem orientierten Durchmesser von 8.
Hier drängt sich natürlich ein Optimierungsproblem
auf: Finde zu einem gegebenen ungerichteten Graphen G
eine Orientierung mit minimalem orientierten Durchmesser
−→
diammin(G).
i
i
i
i i i
i
i
i
i
?
 - - -
?
6
-  
 
@
@I 
 	
Abbildung 12: Ein gerichteter Graph mit Durchmesser 8.
Abgesehen von einer algorithmischen Lösung dieses
Problems ist man auch an oberen Schranken für
−→
diammin(G) in Abhängigkeit anderer Graphinvarianten
interessiert.
In Bezug auf den Durchmesser diam(G) des un-
gerichteten Graphen lässt sich eine unendliche Klasse von
Beispielen konstruieren, bei denen der minimal orien-
tierte Durchmesser
−→
diammin(G) quadratisch in diam(G)
wächst.
y
i
i
i y y
i
y
i
i
 
 
@
@ 
 
Abbildung 13: Dominierende Mengen eines Graphen.
Betrachten wir nun eine andere Grapheninvariante. Eine
Teilmenge D der Eckenmenge V(G) eines Graphens G
heißt dominierende Menge, wenn jeder Knoten in V(G)\D
einen Nachbarn inD besitzt. Die kleinste Kardinalität einer
dominierenden Menge von G bezeichnen wir als γ(G). In
Abbildung 13 bilden sowohl die schwarzen als auch die
weißen Knoten eine dominierende Menge des Graphen.
Kürzlich konnte für brückenfreie Graphen die obere
Schranke
−→
diammin(G) 6 5γ(G) − 1
gezeigt werden.
In Kapitel 11 verbessern wir dieses Resultat zu
−→
diammin(G) 6 4γ(G)
und vermuten
−→
diammin(G) 6
⌈
7γ(G) + 1
2
⌉
als scharfe obere Schranke. Der geführte Beweis ist kon-
struktiv und lässt sich leicht in einen Algorithmus umwan-
deln, der aus einer gegebenen dominierenden Menge D in
Polynomialzeit eine Orientierung von G mit Durchmesser
höchstens 4|D| bestimmt.
4 Vektorapproximation bzw. Opti-
mierung bei einem Textildiscounter
Die Motivation für den nächsten Block an Forschungsar-
tikeln dieser Arbeit kommt aus einer sehr praktischen An-
157
wendung und wurde von einem aktuellen Kooperationspart-
ner aus der Industrie initiiert. Betrachten wir einen Textild-
iscounter mit vielen Filialen, sehr geringen Verkaufszahlen
pro Artikel ohne die Möglichkeit von Nachlieferungen
zu einem späteren Zeitpunkt als dem Erstbelieferungszeit-
punkt.
Da die Möglichkeit von Nachlieferungen fehlt, ist es
besonders wichtig, den potentiellen Bedarf in den einzelnen
Filialen zu schätzen, da man nur sehr teure Möglichkeiten
(z. B. Preisreduzierungen) hat, Fehlschätzungen zu kor-
rigieren.
Bedarfsschätzung von Sortimentsware ist ein sehr gut
untersuchtes Gebiet, sowohl in der Theorie, als auch in
der Praxis, mit einer Unmenge an Literatur. Für einma-
lig angebotene Werbeartikel oder sonstige Artikel mit ein-
maligen sehr kurzen Lebenszyklen konnten wir dagegen
keine geeignete Literatur finden. Und so beschreiben wir
in Kapitel 12 einen neuen Index, um die Abweichung zwi-
schen Bedarf und Belieferung auf sehr kleinen Datenmen-
gen stochastisch robust zu schätzen. Aufbauend auf dieser
Schätzung schlagen wir eine adaptive Veränderung der Be-
lieferung vor. In Kapitel 13 wird eine Feldstudie, welche
die praktische Relevanz und Nützlichkeit dieser Methode
belegt, beschrieben.
Filiale S M L XL
1 1,23 2,32 3,21 0,71
2 3,71 6,52 7,79 2,50
3 0,38 1,47 1,63 0,41
4 1,73 3,18 3,08 1,68
5 0,81 1,94 4,32 1,13
6 1,57 3,08 2,94 1,45
7 1,21 2,31 3,22 0,72
8 1,25 2,27 3,35 0,83
9 3,41 5,79 6,37 3,21
Tabelle 1: Liste von Bedarfsvektoren.
Hat man einmal gute filialgenaue Schätzungen für den
zukünftigen Bedarf ermittelt, siehe Tabelle 1 für ein
Beispiel, so hat man ein anderes Problem zu lösen. Aus
Kostengründen ist die Belieferung unseres Partners lot-
basiert. Dies bedeutet, dass es eine endliche Menge an Lot-
typen wie z. B.
1
2
2
1
 ,

1
2
3
1
 ,

1
1
2
1
 ,

1
2
4
1

gibt. Der erste Vektor steht hierbei für einen Lottypen beste-
hend aus einem Artikel in Größe S, zwei Artikeln in Größe
M, zwei Artikeln in Größe L und einem Artikel in Größe
XL.
Weiter wird jede Filiale mit einem ganzzahligen
Vielfachen eines Lottypes beliefert. Um die Komplexität im
Warenlager zu reduzieren, werden dabei nur eine kleine An-
zahl κ an unterschiedlichen Lottypen verwendet. In Tabelle
Filiale

1
2
2
1


1
2
3
1


1
1
2
1


1
2
4
1
 ‖ · ‖1
1 1 1,05
2 3 2,94
3 1 2,11
4 2 2,33
5 1 1,70
6 1 2,16
7 1 1,02
8 1 1,04
9 3 1,20∑
15,55
Tabelle 2: Zuordnung und Multiplikator von Lottypen.
2 haben wir eine Zuordnung von Filialen zu Lottypen mit
zugehörigen Multiplikatoren für κ = 2 angegeben. Um
den Abstand zwischen Bedarf und geplanter Belieferung zu
messen, haben wir die Summe der absoluten Differenzen
‖ · ‖1 verwendet.
Wir erhalten ein diskretes Optimierungsproblem: Wähle
eine kleine Anzahl κ an Lottypen aus einer gegebenen Liste
aus Lottypen aus und weise jeder Filiale einen Lottyp und
einen Multiplikator zu, so dass die Summe der Abweichung-
en zwischen Bedarf und geplanter Belieferung minimiert
wird. Zusätzlich gibt es eine weitere Nebenbedingung aus
der Praxis: Die Gesamtstückzahl der Belieferung muss in
einem gegebenen Intervall
[
I, I
]
liegen. Falls wir in unserem
Beispiel das Intervall [100, 120] wählen, so ist die Zuord-
nung aus Tabelle 2 nicht mehr zulässig. In Tabelle 3 geben
wir eine zulässige Zuordnung an.
Filiale

1
2
3
1


1
2
2
1
 ‖ · ‖1
1 1 2,05
2 3 2,94
3 1 2,11
4 2 2,33
5 1 1,70
6 1 2,16
7 1 1,02
8 1 1,04
9 4 5,22∑
20,57
Tabelle 3: Zuordnung und Multiplikator von Lottypen
welche eine Kardinalitätsrestriktion berücksichtigt.
In Kapitel 14 beschreiben wir eine Modellierung dieses
Optimierungsproblems als ganzzahlig lineares Programm.
Neben diesem exakten Algorithmus entwickeln wir eine
158
sehr schnelle Heuristik, welche das Problem auf realen
Daten mit einer akzeptablen Optimalitätslücke löst.
5 Modellierung bzw. Optimierung
von Meinungsbildungsdynamiken
Eine weitere Anwendung, die als Motivation für diese
Arbeit gedient hat, kommt aus den Sozialwissenschaften.
Hier ist man beispielsweise daran interessiert, wie sich
die Meinung von Individuen in einer Gruppe über die
Zeit entwickelt. Eine Möglichkeit so eine Meinungsbil-
dungsdynamik zu modellieren ist das sogenannte Bounded-
Confidence-Modell. Im eindimensionalen Fall beschreibt
man die Meinung eines Individuums i zu einem (diskreten)
Zeitpunkt t durch eine reelle Zahl x(t)i . Grundannahme
des Modells ist, dass meine Meinung nur von Individuen
beeinflusst wird, deren Meinung nahe genung an der eige-
nen Meinung ist. Eine Möglichkeit dies zu formalisieren
ist die Einführung eines Konfidenzintervalls I
(
x
(t)
i
)
=[
x
(t)
i − ε, x
(t)
i + ε
]
mit einer reellen Zahl ε > 0. Hiermit
können wir die Meinung x(t+1)i von Individuum i zum Zeit-
punkt t+1 als das arithmetische Mittel aller Meinungen x(t)j
zum Zeitpunkt t von Individuen j, deren Meinung im Kon-
fidenzintervall I
(
x
(t)
i
)
liegt, definieren.
Für dieses Modell konnte von Hegselmann und Krause
festgestellt werden, dass die Meinungen der Individuen nach
einer endlichen Anzahl an Zeitschritten in einen stabilen Zu-
stand konvergiert sind.
Um die etwas philosophischere Frage nach der Suche
nach der Wahrheit zu untersuchen, haben Hegselmann und
Krause dieses Modell etwas erweitert. Zusätzlich gibt es
nun eine Wahrheit h ∈ R und Wahrheitssucher, die in
jedem Zeitschritt ihres Meinungsbildungsprozesses durch
einen positiven Faktor α in der arithmetischen Mittelung
von der Wahrheit angezogen werden. Die Autoren ver-
muteten, dass alle Wahrheitssucher mit ihrer Meinung Rich-
tung Wahrheit konvergieren.
In Kapitel 15 analysieren wir, unter welchen Voraus-
setzungen welche Art von Konvergenz im Hegselmann-
Krause-Modell vorliegt und beweisen ihre Vermutung. Er-
staunlicherweise ist die Konvergenz im allgemeinen Fall
nicht von so einfacher Gestalt, wie man zunächst vermuten
könnte, so dass eine evtl. existierende Ljapunov Funktion
ziemlich kompliziert sein muss. Wir beweisen die Vermu-
tung deswegen mit elementaren Hilfsmittel, was den Beweis
leider etwas technisch werden lässt.
Abgesehen vom sozialwissenschaftlichen Interesse an
Meinungsbildungsdynamiken, gibt es auch Interesse aus
dem Marketing. Das Hauptziel einer Marketingkampagne
ist es doch, eine Menge an Käufern davon zu überzeu-
gen, Produkte der werbenden Unternehmung zu kaufen.
Die Berücksichtigung einer Meinungsbildungsdynamik in
diesem Prozess ist ein sehr natürlicher Schritt. Das
Bounded-Confidence-Modell lässt sich in dieser Richtung
erweitern, indem man das Platzieren von Meinungen zu be-
stimmten Zeitpunkten erlaubt. Mathematisch ergibt sich ein
diskretes Steuerungsproblem: Positioniere die Meinungen
so, dass (nach einer gewissen Zeit) möglichst viele Indi-
viduen nahe einer vorgegebenen Wunschmeinung sind.
159

