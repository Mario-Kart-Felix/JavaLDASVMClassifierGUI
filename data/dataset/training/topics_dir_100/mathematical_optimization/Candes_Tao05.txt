IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005 4203
Decoding by Linear Programming
Emmanuel J. Candes and Terence Tao
Abstract—This paper considers a natural error correcting
problem with real valued input/output. We wish to recover an
input vector from corrupted measurements = + .
Here, is an by (coding) matrix and is an arbitrary and
unknown vector of errors. Is it possible to recover exactly from
the data ?
We prove that under suitable conditions on the coding matrix ,
the input is the unique solution to the 1-minimization problem
( := )
min
provided that the support of the vector of errors is not too large,
:= : = 0 for some 0. In short,
can be recovered exactly by solving a simple convex optimization
problem (which one can recast as a linear program). In addition,
numerical experiments suggest that this recovery procedure works
unreasonably well; is recovered exactly even in situations where
a significant fraction of the output is corrupted.
This work is related to the problem of finding sparse solutions to
vastly underdetermined systems of linear equations. There are also
significant connections with the problem of recovering signals from
highly incomplete measurements. In fact, the results introduced in
this paper improve on our earlier work. Finally, underlying the
success of 1 is a crucial property we call the uniform uncertainty
principle that we shall describe in detail.
Index Terms—Basis pursuit, decoding of (random) linear codes,
duality in optimization, Gaussian random matrices, 1 minimiza-
tion, linear codes, linear programming, principal angles, restricted
orthonormality, singular values of random matrices, sparse solu-
tions to underdetermined systems.
I. INTRODUCTION
A. Decoding of Linear Codes
THIS paper considers the model problem of recovering aninput vector from corrupted measurements
. Here, is an by matrix (we will assume throughout
the paper that ), and is an arbitrary and unknown vector
of errors. The problem we consider is whether it is possible to
recover exactly from the data . And if so, how?
Our problem has of course the flavor of error correction prob-
lems which arise in coding theory as we may think of as a
Manuscript received February 2005; revised September 2, 2005. The work
of E. J. Candes is supported in part by the National Science Foundation under
Grants DMS 01-40698 (FRG) and ACI-0204932 (ITR), and by an A. P. Sloan
Fellowship. The work of T. Tao is supported in part by a grant from the Packard
Foundation.
E. J. Candes is with the Department of Applied and Computational Mathe-
matics, California Institute of Technology, Pasadena, CA 91125 USA (e-mail:
emmanuel@acm. caltech.edu).
T. Tao is with the Department of Mathematics, University of California, Los
Angeles, CA 90095 USA (e-mail: tao@math.ucla.edu).
Communicated by M. P. Fossorier, Associate Editor for Coding Techniques.
Digital Object Identifier 10.1109/TIT.2005.858979
linear code; a linear code is a given collection of codewords
which are vectors —the columns of the ma-
trix . We would like to emphasize, however, that there is a
clear distinction between our real-valued setting and the finite
alphabet one which is more common in the information theory
literature. Given a vector (the “plaintext”) we can then
generate a vector in (the “ciphertext”); if has full rank,
then one can clearly recover the plaintext from the ciphertext
. But now we suppose that the ciphertext is corrupted by
an arbitrary vector giving rise to the corrupted cipher-
text . The question is then: given the coding matrix
and , can one recover exactly?
As is well known, if the fraction of the corrupted entries is too
large, then of course we have no hope of reconstructing from
; for instance, assume and consider two distinct
plaintexts , and form a vector by concatenating
the first half of together with the second half of . Then
where both and are supported on
sets of size at most . This simple example shows that
accurate decoding is impossible when the size of the support
of the error vector is greater or equal to a half of that of the
output . Therefore, a common assumption in the literature is
to assume that only a small fraction of the entries are actually
damaged
(1.1)
For which values of can we hope to reconstruct with prac-
tical algorithms? That is, with algorithms whose complexity is
at most polynomial in the length of the code ?
To reconstruct , note that it is obviously sufficient to recon-
struct the vector since knowledge of together with
gives , and consequently , since has full rank. Our ap-
proach is then as follows. We construct a matrix which annihi-
lates the matrix on the left, i.e., such that . This
can be done in an obvious fashion by taking a matrix whose
kernel is the range of in , which is an -dimensional sub-
space (e.g., could be the orthogonal projection onto the cok-
ernel of ). We then apply to the output and
obtain
(1.2)
since . Therefore, the decoding problem is reduced to
that of reconstructing a sparse vector from the observations
(by sparse, we mean that only a fraction of the entries of
are nonzero). Therefore, the overarching theme is that of the
sparse reconstruction problem, which has recently attracted a lot
of attention as we are about to see.
0018-9448/$20.00 © 2005 IEEE
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
4204 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005
B. Sparse Solutions to Underdetermined Systems
Finding sparse solutions to underdetermined systems of
linear equations is in general NP-hard. For example, the
sparsest solution is given by
subject to (1.3)
and to the best of our knowledge, solving this problem essen-
tially requires exhaustive searches over all subsets of columns
of , a procedure which clearly is combinatorial in nature and
has exponential complexity.
Formally, given an integer matrix and an integer
vector , the problem of deciding whether there is a vector
with rational entries such that , and with fewer than
a fixed number of nonzero entries is NP-complete, see [2,
Problem MP5]. In fact, the -minimization problem contains
the subset-sum problem. Assume, for instance, that
and , and consider the following set of vectors in
:
where are the usual basis vectors and
are integers. Now let be another integer and consider the
problem of deciding whether
is a -sparse linear combination of the above vectors (
-sparse is impossible). This is exactly the subset-sum problem,
i.e., whether one can write as a sum of a subset of .
It is well known that this is an NP-complete problem.
This computational intractability has recently led researchers
to develop alternatives to , and a frequently discussed ap-
proach considers a similar program in the -norm which goes
by the name of basis pursuit [3]
(1.4)
where we recall that . Unlike the -norm
which enumerates the nonzero coordinates, the -norm is
convex. It is also well known [4] that can be recast as a
linear program (LP).
Motivated by the problem of finding sparse decompositions
of special signals in the field of mathematical signal processing
and following upon the ground breaking work of Donoho and
Huo [5], a series of beautiful articles [6]–[9] showed exact
equivalence between the two programs and . In a
nutshell, this work shows that for by matrices ob-
tained by concatenation of two orthonormal bases, the solution
to both and are unique and identical provided that in
the most favorable case, the vector has at most
nonzero entries. This is of little practical use here since we are
interested in procedures that might recover a signal when a
constant fraction of the output is unreliable.
Using very different ideas and together with Romberg
[10], the authors proved that the equivalence holds with over-
whelming probability for various types of random matrices
provided that the number of nonzero entries in the vector be
of the order of [1], [11]. In the special case where
is an by random matrix with independent standard
normal entries, [12] proved that the number of nonzero entries
may be as large as , where is some very small and
unspecified positive constant independent of .
C. Innovations
This paper introduces the concept of a restrictedly almost
orthonormal system—a collection of vectors which behaves
like an almost orthonormal system but only for sparse linear
combinations. Thinking about these vectors as the columns
of the matrix , we show that this condition allows for the
exact reconstruction of sparse linear combination of these
vectors, i.e., . Our results are significantly different than those
mentioned above as they are deterministic and do not involve
any kind of randomization, although they can of course be
specialized to random matrices. For instance, we shall see
that a Gaussian matrix with independent entries sampled from
the standard normal distribution is restrictedly almost or-
thonormal with overwhelming probability, and that minimizing
the -norm recovers sparse decompositions with a number of
nonzero entries of size ; we shall actually give numerical
values for .
We presented the connection with sparse solutions to under-
determined systems of linear equations merely for pedagogical
reasons. There is a more direct approach. To recover from
corrupted data , we consider solving the following
-minimization problem:
(1.5)
Now is the unique solution of if and only if is the unique
solution of . In other words, and are equivalent
programs. To see why this is true, observe on the one hand that
since , we may decompose as so that
On the other hand, the constraint means that
for some and, therefore,
which proves the claim.
The program may also be re-expressed as an LP—hence,
the title of this paper. Indeed, the -minimization problem is
equivalent to
(1.6)
where the optimization variables are and (as
is standard, the generalized vector inequality means that
for all ). As a result, is an LP with inequality con-
straints and can be solved efficiently using standard optimiza-
tion algorithms, see [13].
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
CANDES AND TAO: DECODING BY LINEAR PROGRAMMING 4205
D. Restricted Isometries
In the remainder of this paper, it will be convenient to use
some linear algebra notations. We denote by the
columns of the matrix and by the linear subspace spanned
by these vectors. Further, for any , we let be the
submatrix with column indices so that
To introduce the notion of almost orthonormal system, we first
observe that if the columns of are sufficiently “degenerate,”
the recovery problem cannot be solved. In particular, if there
exists a nontrivial sparse linear combination of
the which sums to zero, and is any partition of
into two disjoint sets, then the vector
has two distinct sparse representations. On the other hand, linear
dependencies which involve a large number
of nonzero coefficients , as opposed to a sparse set of co-
efficients, do not present an obvious obstruction to sparse re-
covery. At the other extreme, if the are an orthonormal
system, then the recovery problem is easily solved by setting
.
The main result of this paper is that if we impose a “restricted
orthonormality hypothesis,” which is far weaker than assuming
orthonormality, then solves the recovery problem, even if
the are highly linearly dependent (for instance, it is pos-
sible for to be much larger than the dimension of the
span of the ’s). To make this quantitative we introduce the fol-
lowing definition.
Definition 1.1 (Restricted Isometry Constants): Let be the
matrix with the finite collection of vectors as
columns. For every integer , we define the -
restricted isometry constants to be the smallest quantity such
that obeys
(1.7)
for all subsets of cardinality at most , and all real co-
efficients . Similarly, we define the -restricted or-
thogonality constants for to be the smallest
quantity such that
(1.8)
holds for all disjoint sets of cardinality and
.
The numbers and measure how close the vectors
are to behaving like an orthonormal system, but only when
restricting attention to sparse linear combinations involving no
more than vectors. These numbers are clearly nondecreasing
in , . For , the value only conveys magnitude infor-
mation about the vectors ; indeed is the best constant such
that
for all (1.9)
In particular, if and only if all of the ’s have unit
length. Section II-C establishes that the higher control the
orthogonality numbers .
Lemma 1.1: We have
for all , .
To see the relevance of the restricted isometry numbers
to the sparse recovery problem, consider the following simple
observation.
Lemma 1.2: Suppose that is such that , and let
be such that . Let where is an arbitrary
vector supported on . Then is the unique minimizer to
so that can be reconstructed from knowledge of the vector
(and the ’s).
Proof: We prove that there is a unique with
and obeying . Suppose for the sake of contradiction
that had two distinct sparse representations
where and were supported on sets obeying .
Then
By construction is supported on of size less or
equal to . Taking norms of both sides and applying (1.7) and
the hypothesis we conclude that , contra-
dicting the hypothesis that the two representations were distinct.
E. Main Results
Note that the previous lemma is an abstract existence argu-
ment which shows what might theoretically be possible, but
does not supply any efficient algorithm to recover and from
and other than by brute-force search—as discussed
earlier. In contrast, our main theorem shows that, by imposing
slightly stronger conditions on , the -minimization pro-
gram recovers exactly.
Theorem 1.3: Suppose that is such that
(1.10)
and let be a real vector supported on a set obeying
. Put . Then is the unique minimizer to
Note from Lemma 1.1 that (1.10) implies , and is in
turn implied by . Thus, the condition (1.10)
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
4206 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005
is roughly “three times as strict” as the condition required for
Lemma 1.2.
Theorem 1.3 is inspired by our previous work [1], see also
[10], [11], but unlike those earlier results, our results here are de-
terministic, and thus do not have a nonzero probability of failure,
provided of course one can ensure that the system ver-
ifies the condition (1.10). By virtue of the previous discussion,
we have the companion result.
Theorem 1.4: Suppose is such that and let
be a number obeying the hypothesis of Theorem 1.3. Set
, where is a real vector supported on a set of size at
most . Then is the unique minimizer to
F. Gaussian Random Matrices
An important question is then to find matrices with good re-
stricted isometry constants, i.e., such that (1.10) holds for large
values of . Indeed, such matrices will tolerate a larger fraction
of output in error while still allowing exact recovery of the orig-
inal input by linear programming. How to construct such ma-
trices might be delicate. In Section III, however, we will argue
that generic matrices, namely, samples from the Gaussian uni-
tary ensemble obey (1.10) for relatively large values of .
Theorem 1.5: Assume and let be a by matrix
whose entries are independent and identically distributed (i.i.d.)
Gaussian with mean zero and variance . Then the condition
of Theorem 1.3 holds with overwhelming probability provided
that is small enough so that
where is given in (3.23). (By “with overwhelming
probability,” we mean with probability decaying exponentially
in .) In the limit of large samples, only depends upon the
ratio, and numerical evaluations show that the condition holds
for in the case where ,
when , and when .
In other words, Gaussian matrices are a class of matrices for
which one can solve an underdetermined systems of linear equa-
tions by minimizing provided, of course, the input vector has
fewer than nonzero entries with . We mentioned
earlier that this result is similar to [12]. What is new here is that
by using a very different machinery, one can obtain explicit nu-
merical values which were not available before.
In the context of error correcting, the consequence is that a
fraction of the output may be corrupted by arbitrary errors and
yet, solving a convex problem would still recover exactly—a
rather unexpected feat.
Corollary 1.6: Suppose is an by Gaussian matrix and
set . Under the hypotheses of Theorem 1.5, the
solution to is unique and equal to .
This is an immediate consequence of Theorem 1.5. The only
thing we need to argue is why we may think of the annihilator
(such that ) as a matrix with independent Gaussian
entries. Observe that the range of is a random space of dimen-
sion embedded in so that the data is the projection
of on a random space of dimension . The range of a by
matrix with independent Gaussian entries precisely is a random
subspace of dimension , which justifies the claim.
We would like to point out that the numerical bounds we de-
rived in this paper are overly pessimistic. We are confident that
finer arguments and perhaps new ideas will allow to derive ver-
sions of Theorem 1.5 with better bounds. The discussion section
will enumerate several possibilities for improvement.
G. A Notion of Capacity
We now develop a notion of “capacity;” that is, an upper
bound on the support size of the error vector beyond which
recovery is information-theoretically impossible. Define the
cospark of the matrix as
(1.11)
We call this number the cospark because it is related to another
quantity others have called the spark. The spark of a matrix
is the minimal number of columns from that are linearly de-
pendent [6], [7]. In other words
subject to
Suppose has full rank and assume that is any full rank
matrix such that , then , which
simply follows from
s. t.
since means that is in the range of and, therefore,
of the form where is nonzero since does not vanish.
Lemma 1.7: Suppose the fraction of errors obeys
(1.12)
then, exact decoding is achieved by minimizing .
Conversely, if , then accurate decoding is
not possible.
Proof: Suppose first that the number of errors obeys
and let be of full rank with .
Since minimizing is equivalent to finding the
shortest so that , and that the proof of Lemma 1.2
assures that is the unique vector with at most
nonzero entries, the recovery is exact.
The converse is immediate. Let be a vector such that
and write where both
and are less or equal to . Let be
any vector in and set . Then
and, therefore, and are indistinguishable.
Corollary 1.8: Suppose the entries of are independent
normal with mean and variance . Then with probability
, . As a consequence, one can
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
CANDES AND TAO: DECODING BY LINEAR PROGRAMMING 4207
theoretically recover any plaintext if and only if the fraction
error obeys
(1.13)
In other words, given a fraction of error , accurate decoding is
possible provided that the “rate” obeys .
This may help to establish a link between this work and other
information literature.
Proof: It is clear that as one can
find an so that the first entries of vanish. Fur-
ther, all the by submatrices of are invertible with prob-
ability . This follows from the fact that each by subma-
trix is invertible with probability , and that there is a finite
number of them. With probability one, therefore, it is impos-
sible to find such that has vanishing entries. This
gives .
H. Organization of the Paper
The paper is organized as follows. Section II proves our main
claim, namely, Theorem 1.3 (and hence Theorem 1.4) while
Section III introduces elements from random matrix theory to
establish Theorem 1.5. In Section IV, we present numerical ex-
periments which suggest that in practice, works unreason-
ably well and recovers the exactly from provided
that the fraction of the corrupted entries be less than about 17%
in the case where and less than about 34% in the case
where . Section V explores the consequences of our
results for the recovery of signals from highly incomplete data
and ties our findings with some of our earlier work. Finally, we
conclude with a short discussion section whose main purpose is
to outline areas for improvement.
II. PROOF OF MAIN RESULTS
Our main result, namely, Theorem 1.3 is proved by duality.
As we will see in Section II-A, is the unique minimizer if the
matrix has full rank and if one can find a vector with the
two properties
i) , for all ;
ii) and , for all ;
where is the sign of ( , for ).
The two conditions above say that a specific dual program is
feasible and is called the exact reconstruction property in [1],
see also [10]. The reader might find it helpful to see how these
conditions arise and we first informally sketch the argument (a
rigorous proof follows in Section II-A). Suppose we wish to
minimize subject to , and that is differentiable.
Together with , the classical Lagrange multiplier op-
timality condition (see [13]) asserts that there exists ( is a
Lagrange multiplier) such that
In a nutshell, for to be a solution, we must have
. In our case , and so
for , but is otherwise not smooth at zero. In this case,
we ask that be a subgradient of at the point [13], which
here means
if and otherwise.
Since by definition , conditions i) and ii) are
now natural.
A. Proof of Theorem 1.3
Observe first that standard convex arguments give that there
exists at least one minimizer to the problem .
We need to prove that . Since obeys the constraints of
this problem, obeys
(2.14)
Now take a obeying properties i) and ii) (see the remark fol-
lowing Lemma 2.2). Using the fact that the inner product
is equal to the sign of on and has absolute value strictly less
than one on the complement, we then compute
Comparing this with (2.14) we see that all the inequalities in the
above computation must in fact be equality. Since was
strictly less than for all , this in particular forces
for all . Thus,
Applying (1.7) (and noting from hypothesis that ) we
conclude that for all . Thus, as claimed.
For with obeying the hypothesis of Theorem 1.3,
has full rank since and thus, the proof simply consists
in constructing a dual vector ; this is the object of the next
section. This concludes the proof of our theorem.
B. Exact Reconstruction Property
We now examine the sparse reconstruction property and begin
with Lemma 2.1 which establishes that the coefficients ,
, are suitably bounded except for an exceptional set.
Lemma 2.2 strengthens this results by eliminating the excep-
tional set.
Lemma 2.1 (Dual Reconstruction Property, Version): Let
be such that , and be a real vector supported
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
4208 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005
on such that . Then there exists a vector
such that for all . Furthermore, there is an
“exceptional set” which is disjoint from , of size at
most
(2.15)
and with the properties
for all
and
where for short. In addition, for
some constant only depending upon .
Proof: Recall that is the linear transfor-
mation where (we use the
subscript in to emphasize that the input is a -dimen-
sional vector), and let be the adjoint transformation
Property (1.7) gives
where and are the minimum and maximum eigen-
values of the positive-definite operator . In particular,
since , we see that is invertible with
(2.16)
Also note that and set
to be the vector
it is then clear that , i.e., for all .
In addition, with .
Finally, if is any set in disjoint from with and
is any sequence of real numbers, then (1.8) and
(2.16) give
since was arbitrary, it follows from the variational definition
of the norm, , that
In other words
(2.17)
whenever and . In particular, if we set
then must obey , since otherwise we could con-
tradict (2.17) by taking a subset of of cardinality . The
claims now follow.
We now derive a solution with better control on the sup norm
of outside of , by iterating away the exceptional set
(while keeping the values on fixed). The proof of the fol-
lowing lemma is given in the Appendix.
Lemma 2.2 (Dual Reconstruction Property, Version): Let
be such that , and be a real vector
supported on obeying . Then there exists a vector
such that for all . Furthermore,
obeys
for all
(2.18)
Lemma 2.2 actually solves the dual recovery problem. In-
deed, our result states that one can find a vector obeying
both properties i) and ii) stated at the beginning of the section.
To see why ii) holds, observe that
and, therefore, (2.18) gives for all
provided that .
It is likely that one may push the condition
a little further. The key idea is as follows. Each vector in
the iteration scheme used to prove Lemma 2.2 was designed to
annihilate the influence of on the exceptional set .
But annihilation is too strong of a goal. It would be just as suit-
able to design to moderate the influence of enough
so that the inner product with elements in is small rather
than zero. However, we have not pursued such refinements as
the arguments would become considerably more complicated
than the calculations presented here.
C. Approximate Orthogonality
Lemma 1.1 gives control of the size of the principal angle
between subspaces of dimension and , respectively. This is
useful because it allows to guarantee exact reconstruction from
the knowledge of the numbers only.
Proof Proof of Lemma 1.1: We first show that
. By homogeneity it will suffice to show that
whenever , , , are disjoint, and
Now (1.7) gives
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
CANDES AND TAO: DECODING BY LINEAR PROGRAMMING 4209
together with
and the claim now follows from the parallelogram identity
It remains to show that . Again by homo-
geneity, it suffices to establish that
whenever and . To prove this
property, we partition as where and
and write and .
Equation (1.7) together with (1.8) give
and
Hence,
as claimed. (We note that it is possible to optimize this bound a
little further but will not do so here.)
III. GAUSSIAN RANDOM MATRICES
In this section, we argue that with overwhelming probability,
Gaussian random matrices have “good” isometry constants.
Consider a by matrix whose entries are i.i.d. Gaussian
with mean zero and variance and let be a subset of the
columns. We wish to study the extremal eigenvalues of .
Following upon the work of Marchenko and Pastur [14], Geman
[15], and Silverstein [16] (see also [17]) proved that
a.s.
a.s.
in the limit where and with
In other words, this says that loosely speaking and in the limit
of large , the restricted isometry constant for a fixed
behaves like
where
Restricted isometry constants must hold for all sets of car-
dinality less or equal to , and we shall make use of concentra-
tion inequalities to develop such a uniform bound. Note that for
, we obviously have and
and, therefore, attention may
be restricted to matrices of size . Now, there are large devia-
tion results about the singular values of [18]. For example,
letting (resp., ) be the largest singular value of
so that (resp.,
), Ledoux [19] applies the concentration inequality
for Gaussian measures, and for each fixed , obtains the de-
viation bounds
(3.19)
(3.20)
here the scaling of interest has constant, and is a
small term tending to zero as and which can be calcu-
lated explicitly, see [20]. For example, this last reference shows
that one can select in (3.19) as .
Lemma 3.1: Put and set
where is the entropy function
defined for . For each , the
restricted isometry constant of a by Gaussian matrix
obeys (for and large enough)
(3.21)
Proof: As discussed above, we may restrict our attention
to sets such that . Set for short and
let where the maximum is over all sets
of size , and similarly . Then
and
It will suffice to prove that
and
as for we have . Both statements are
proved in exactly the same way and we only include that for .
Denote by the -term appearing in (3.19). Observe that
From Stirling’s approximation
we have the well-known formula
which gives
We have
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
4210 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005
Fig. 1. Behavior of the upper bound  (r) for three values of the ratio p=m, namely, p=m = 3=4; 2=3;1=2.
and suppose and are large enough so that
Then
and, therefore,
For sufficiently large, the term is less than
, which concludes the proof.
Ignoring the ’s, Lemma 3.1 states that with overwhelming
probability
(3.22)
A similar conclusion holds for and and, therefore, we
established that with very high probability
(3.23)
with
In conclusion, Lemma 1.1 shows that the hypothesis of our main
theorem holds provided that the ratio is small so that
. In other words, in the limit of large samples,
may be taken as any value obeying which we
used to give numerical values in Theorem 1.5. Fig. 1 graphs the
function for several values of the ratio .
IV. NUMERICAL EXPERIMENTS
This section investigates the practical ability of to recover
an object from corrupted data , (or
equivalently to recover the sparse vector of errors from
the underdetermined system of equations ).
The goal here is to evaluate empirically the location of the break-
point as to get an accurate sense of the performance one might
expect in practice. In order to do this, we performed a series of
experiments designed as follows:
1) select (the size of the input signal) and so that with the
same notations as before, is an by matrix; sample
with independent Gaussian entries;
2) select as a percentage of ;
3) select a support set of size uniformly at
random, and sample a vector on with i.i.d. Gaussian
entries;1
4) make (the choice of does not matter as is
clear from the discussion and here, is also selected at
random), solve and obtain ;
5) compare to ;
6) repeat 100 times for each and ;
7) repeat for various sizes of and .
The results are presented in Figs. 2 and 3. Fig. 2 examines
the situation in which the length of the code is twice that of
the input vector , for and . Our
experiments show that one recovers the input vector all the time
1Just as in [11], the results presented here do not seem to depend on the actual
distribution used to sample the errors.
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
CANDES AND TAO: DECODING BY LINEAR PROGRAMMING 4211
Fig. 2. ` -recovery of an input signal from y = Af + e with A an m by n matrix with independent Gaussian entries. In this experiment, we “oversample” the
input signal by a factor 2 so that m = 2n. (a) Success rate of (P ) for m = 512. (b) Success rate of (P ) for m = 1024. Observe the similar pattern and cutoff
point. In these experiments, exact recovery occurs as long as about 17% or less of the entries are corrupted.
Fig. 3. ` -recovery of an input signal from y = Af + e with A an m by n matrix with independent Gaussian entries. In this experiment, we “oversample” the
input signal by a factor 4 so that m = 4n. In these experiments, exact recovery occurs as long as about 34% or less of the entries are corrupted.
as long as the fraction of the corrupted entries is below 17%.
This holds for (Fig. 2(a)) and (Fig. 2(b)).
In Fig. 3, we investigate how these results change as the length
of the codewords increases compared to the length of the input,
and examine the situation in which , with . Our
experiments show that one recovers the input vector all the time
as long as the fraction of the corrupted entries is below 34%.
It might be tempting to compare the empirical cutoff observed
in the figures with the theoretical limit calculated in Corollary
1.8. For example, for , Fig. 3 suggests a cutoff
near 35% while Corollary 1.8 gives a theoretical limit of
37.5%. One needs to apply caution, however, as
these two quantities refer to two distinct situations. On the one
hand, the limit guarantees that all signals
may be decoded exactly. On the other hand, the numerical sim-
ulations examine the case where both and the error vector
are chosen randomly, and does not search for the worst possible
pair. In this sense, the simulations are not really “testing” The-
orem 1.5. Under a probability model for the error pattern , say,
it is clear that information theoretically, one can tolerate a larger
fraction of errors if one wishes to be able to decode accurately
only for most as opposed to all error vectors.
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
4212 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005
V. OPTIMAL SIGNAL RECOVERY
Our recent work [1] developed a set of ideas showing that it is
surprisingly possible to reconstruct interesting classes of signals
accurately from highly incomplete measurements. The results
in this paper are inspired and improve upon this earlier work
and we now elaborate on this connection. Suppose we wish to
reconstruct an object in from the linear measurements
or (5.24)
with , the th row of the matrix . Of special interest is the
vastly underdetermined case , where there are many
more unknowns than observations. We choose to formulate the
problem abstractly but for concreteness, we might think of as
the coefficients of a digital signal or image in some
nice orthobasis, e.g., a wavelet basis, so that the information
about the signal is of the form .
Suppose now that the object of interest is compressible in the
sense that the reordered entries of decay like a power law; con-
cretely, suppose that the entries of , rearranged in decreasing
order of magnitude, , obey
(5.25)
for some . We will denote by the class of all sig-
nals obeying (5.25). The claim is that it is possible to
reconstruct compressible signals from only a small number of
random measurements.
Theorem 5.1: Let be the measurement matrix as in (5.24)
and consider the solution to
subject to (5.26)
Let such that and set .
Then obeys
(5.27)
To appreciate the content of the theorem, suppose one would
have available an oracle letting us know which coefficients ,
, are large (e.g., in the scenario we considered ear-
lier, the oracle would tell us which wavelet coefficients of are
large). Then we would acquire information about the largest
coefficients and obtain a truncated version of obeying
for generic elements taken from . Now (5.27) says
that not knowing anything about the location of the largest
coefficients, one can essentially obtain the same approxima-
tion error by nonadaptive sampling, provided the number of
measurements is increased by a factor . The larger , the
smaller the oversampling factor, and hence, the connection
with the decoding problem. Such considerations make clear
that Theorem 5.1 supplies a very concrete methodology for
recovering a compressible object from limited measurements
and as such, it may have a significant bearing on many fields of
science and technology. We refer the reader to [1] and [21] for
a discussion of its implications.
Suppose, for example, that is a Gaussian random matrix as
in Section III. We will assume the same special normalization
so that the variance of each individual entry is equal to .
Calculations identical to those from Section III give that with
overwhelming probability, obeys the hypothesis of the the-
orem provided that
for some positive constant . Now consider the statement
of the theorem; there is a way to invoke linear programming
and obtain a reconstruction based upon mea-
surements only, which is at least as good as that one would
achieve by knowing all the information about and selecting
the largest coefficients. In fact, this is an optimal statement
as (5.27) correctly identifies the minimum number of measure-
ments needed to obtain a given precision. In short, it is impos-
sible to obtain a precision of about with fewer than
measurements, see [1], [21].
Theorem 5.1 is stronger than our former result, namely, The-
orem 1.4 in [1]. To see why this is true, recall the former claim:
[1] introduced two conditions, the uniform uncertainty principle
(UUP) and the exact reconstruction principle (ERP). In a nut-
shell, a random matrix obeys the UUP with oversampling
factor if obeys
(5.28)
with probability at least for some fixed positive
constant . Second, a measurement matrix obeys the
ERP with oversampling factor if for each fixed subset of
size (5.28) and each “sign” vector defined on , there
exists with the same overwhelmingly large probability a vector
with the following properties:
i) , for all ;
ii) and , for all not in .
Note that these are the conditions listed at the beginning of Sec-
tion II except for the factor on the complement of . Fix
. [1] argued that if a random matrix obeyed the UUP
and the ERP both with oversampling factor , then
with inequality holding with the same probability as before.
Against this background, several comments are now in order.
• First, the new statement is more general as it applies to all
matrices, not just random matrices.
• Second, whereas our previous statement argued that for
each , one would be able—with high proba-
bility—to reconstruct accurately, it did not say anything
about the worst case error for a fixed measurement matrix
. This is an instance where the order of the quantifiers
plays a role. Do we need different ’s for different ob-
jects? Theorem 5.1 answers this question unambiguously;
the same will provide an optimal reconstruction for all
the objects in the class.
• Third, Theorem 5.1 says that the ERP condition is redun-
dant, and hence the hypothesis may be easier to check in
practice. In addition, eliminating the ERP isolates the real
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
CANDES AND TAO: DECODING BY LINEAR PROGRAMMING 4213
reason for success as it ties everything down to the UUP.
In short, the ability to recover an object from limited mea-
surements depends on how close is to an orthonormal
system, but only when restricting attention to sparse linear
combinations of columns.
We will not prove this theorem as this is a minor modification
of that of Theorem 1.4 in the aforementioned reference. The key
point is to observe that if obeys the hypothesis of our theorem,
then by definition obeys the UUP with probability one, but
also obeys the ERP, again with probability one, as this is the
content of Lemma 2.2. Hence, both the UUP and ERP hold and
therefore, the conclusion of Theorem 5.1 follows. (The fact that
the ERP actually holds for all sign vectors of size less than is
the reason why (5.27) holds uniformly over all elements taken
from , see [1].)
VI. DISCUSSION
A. Connections With Other Works
In our linear programming model, the plaintext and ciphertext
had real-valued components. Another intensively studied model
occurs when the plaintext and ciphertext take values in the finite
field . In recent work of Feldman et al. [22]–[25],
linear programming methods (based on relaxing the space of
codewords to a convex polytope) were developed to establish a
polynomial-time decoder which can correct a constant fraction
of errors, and also achieve the information-theoretic capacity of
the code. Our methods are restricted to real-valued texts, and
the work cited above requires texts in . Also, our error anal-
ysis is deterministic and is thus guaranteed to correct arbitrary
errors provided that they are sufficiently sparse. In summary,
there does not seem to be any explicit known connection with
this line of work but it would perhaps be of future interest to
explore if there is one.
The ideas presented in this paper may be adapted to recover
input vectors taking values from a finite alphabet. We hope to
report on work in progress in a followup paper.
B. Improvements
There is little doubt that more elaborate arguments will yield
versions of Theorem 1.5 with tighter bounds. Immediately fol-
lowing the proof of Lemma 2.2, we already remarked that one
might slightly improve the condition at
the expense of considerable complications. More to the point,
we must admit that we used well-established tools from random
matrix theory and it is likely that more sophisticated ideas might
be deployed successfully. We now discuss some of these.
Our main hypothesis reads but in
order to reduce the problem to the study of those numbers
(and use known results), our analysis actually relied upon the
more stringent condition instead, since
This introduces a gap. Consider a fixed set of size .
Using the notations of that Section III, we argued that
and developed a large deviation bound to quantify the depar-
ture from the right-hand side. Now let and be two dis-
joint sets of respective sizes and and consider :
is the cosine of the principal angle between the two
random subspaces spanned by the columns of and re-
spectively; formally
We remark that this quantity plays an important analysis in sta-
tistical analysis because of its use to test the significance of cor-
relations between two sets of measurements, compare the litera-
ture on canonical correlation analysis [26]. Among other things,
it is known [27] that
a.s.
as with and . In other words,
whereas we used the limiting behaviors
there is a chance one might employ instead
for , and
for , which are better estimates. Just as in
Section III, one might then look for concentration inequalities
transforming this limiting behavior into corresponding large de-
viation inequalities. We are aware of very recent work of John-
stone and his colleagues [28] which might be here of substantial
help.
Finally, tighter large deviation bounds might exist together
with more clever strategies to derive uniform bounds (valid for
all of size less than ) from individual bounds (valid for a
single ). With this in mind, it is interesting to note that our
approach hits a limit as
(6.29)
where .
Since is greater than if and only if , one would
certainly need new ideas to improve Theorem 1.5 beyond the
cutoff point in the range of about 2%. The lower limit (6.29) is
probably not sharp since it does not explicitly take into account
the ratio between and ; at best, it might serve as an indication
of the limiting behavior when the ration is not too small.
C. Other Coding Matrices
This paper introduced general results stating that it is pos-
sible to correct for errors by -minimization. We then explained
how the results specialize in the case where the coding matrix
is sampled from the Gaussian ensemble. It is clear, however,
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
4214 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 51, NO. 12, DECEMBER 2005
that one could use other matrices and still obtain similar results;
namely, that recovers exactly provided that the number
of corrupted entries does not exceed . In fact, our previous
work suggests that partial Fourier matrices would enjoy sim-
ilar properties [1], [11]. Other candidates might be the so-called
noiselets of Coifman, Geshwind, and Meyer [29]. These alter-
natives might be of great practical interest because they would
come with fast algorithms for applying or to an arbi-
trary vector and, hence, speed up the computations to find the
-minimizer.
APPENDIX
PROOF OF LEMMA 2.2
We may normalize . Write . Using
Lemma 2.1, we can find a vector and a set such
that
for all
for all
Applying Lemma 2.1 iteratively gives a sequence of vectors
and sets for all with the prop-
erties
for all
for all
for all
By hypothesis, we have . Thus, if we set
then the series is absolutely convergent and, therefore, is a
well-defined vector in . We now study the coefficients
(1.30)
for .
Consider first , it follows from the construction that
and for all , and hence,
for all
Second, fix with and let . Since
and are disjoint, we see that the integers in the set
are spaced at least two apart. Now if , then by definition
and, therefore,
In other words, the and terms in (1.30) cancel each other
out. Thus, we have
On the other hand, if and , then
and
which by the triangle inequality and the geometric series for-
mula gives
In conclusion
and since , the claim follows.
ACKNOWLEDGMENT
The authors wish to thank Rafail Ostrovsky for pointing
out possible connections between their earlier work and the
decoding problem. E. J. Candes would also like to acknowledge
inspiring conversations with Leonard Schulmann and Justin
Romberg.
REFERENCES
[1] E. J. Candes and T. Tao, “Near optimal signal recovery from random
projections: Universal encoding strategies?,” IEEE Trans. Inf. Theory.
Available on the AxXiv preprint server: math:CA=0410542, submitted
for publication.
[2] M. R. Garey and D. S. Johnson, Computers and Intractability: A Guide
the Theory of NP-Completeness. San Francisco, CA: Freeman, 1979.
[3] S. S. Chen, D. L. Donoho, and M. A. Saunders, “Atomic decomposition
by basis pursuit,” SIAM J. Sci. Comput., vol. 20, pp. 33–61, 1998.
[4] P. Bloomfield and W. Steiger, Least Absolute Deviations: Theory, Appli-
cations, and Algorithms. Boston, MA: Birkhäuser, 1983.
[5] D. L. Donoho and X. Huo, “Uncertainty principles and ideal atomic de-
composition,” IEEE Trans. Inf. Theory, vol. 47, no. 7, pp. 2845–2862,
Nov. 2001.
[6] R. Gribonval and M. Nielsen, “Sparse representations in unions of
bases,” IEEE Trans. Inf. Theory, vol. 49, no. 12, pp. 3320–3325, Dec.
2003.
[7] D. L. Donoho and M. Elad, “Optimally sparse representation in general
(nonorthogonal) dictionaries via ` minimization,” in Proc. Nat. Acad.
Sci. USA, vol. 100, 2003, pp. 2197–2202.
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.
CANDES AND TAO: DECODING BY LINEAR PROGRAMMING 4215
[8] M. Elad and A. M. Bruckstein, “A generalized uncertainty principle and
sparse representation in pairs of R bases,” IEEE Trans. Inf. Theory,
vol. 48, no. 9, pp. 2558–2567, Sep. 2002.
[9] J. A. Tropp, “Greed is good: Algorithmic results for sparse approxima-
tion,” IEEE Trans. Inf. Theory, vol. 50, no. 10, pp. 2231–2242, Oct. 2004.
[10] E. J. Candes, J. Romberg, and T. Tao, “Robust uncertainty principles:
Exact signal reconstruction from highly incomplete frequency informa-
tion,” IEEE Trans. Inf. Theory. Available on the ArXiV preprint server:
math:GM=0409186, submitted for publication.
[11] E. J. Candes and J. Romberg, “Quantitative robust uncertainty principles
and optimally sparse decompositions,” Found. Comput. Math.. Available
on the ArXiV preprint server: math:CA=0411273, to be published.
[12] D. L. Donoho, “For most large underdetermined systems of linear equa-
tions the minimal ` -norm solution is also the sparsest solution,” unpub-
lished manuscript, Sep. 2004.
[13] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge,
U.K.: Cambridge Univ. Press, 2004.
[14] V. A. Marchenko and L. A. Pastur, “Distribution of eigenvalues in certain
sets of random matrices” (in Russian), Mat. Sbornik (N.S.), vol. 72, pp.
407–535, 1967.
[15] S. Geman, “A limit theorem for the norm of random matrices,” Ann.
Probab., vol. 8, pp. 252–261, 1980.
[16] J. W. Silverstein, “The smallest eigenvalue of a large dimensional
Wishart matrix,” Ann. Probab., vol. 13, pp. 1364–1368, 1985.
[17] Z. D. Bai and Y. Q. Yin, “Limit of the smallest eigenvalue of a
large-dimensional sample covariance matrix,” Ann. Probab., vol. 21,
pp. 1275–1294, 1993.
[18] S. J. Szarek, “Condition numbers of random matrices,” J. Complexity,
vol. 7, pp. 131–149, 1991.
[19] M. Ledoux, The Concentration of Measure Phenomenon. Providence,
RI: Amer. Math. Soc., 2001, vol. 89, Mathematical Surveys and Mono-
graphs.
[20] N. El Karoui, “New results about random covariance matrices and sta-
tistical applications,” Ph. .D. dissertation, Stanford Univ., Stanford, CA,
2004.
[21] D. L. Donoho, “Compressed sensing,” unpublished manuscript, Sep.
2004.
[22] J. Feldman, “Decoding error-correcting codes via linear programming,”
Ph.D. dissertation, MIT, Cambridge, MA, 2003.
[23] , “LP decoding achieves capacity,” presented at the ACM-SIAM
Symp. Discrete Algorithms (SODA), Vancouver, BC, Canada, Jan.
2005.
[24] J. Feldman, T. Malkin, C. Stein, R. A. Servedio, and M. J. Wainwright,
“LP decoding corrects a constant fraction of errors,” in Proc. IEEE
Int. Symp. Information Theory (ISIT), Chicago, IL, Jun./Jul 2004, p.
68.
[25] J. Feldman, M. J. Wainwright, and D. R. Karger, “Using linear program-
ming to decode binary linear codes,” IEEE Trans. Inf. Theory, vol. 51,
no. 3, pp. 954–972, Mar. 2005.
[26] R. J. Muirhead, Aspects of Multivariate Statistical Theory. New York:
Wiley, 1982, Wiley Series in Probability and Mathematical Statistics.
[27] K. W. Wachter, “The limiting empirical measure of multiple discrimi-
nant ratios,” Ann. Statist., vol. 8, pp. 937–957, 1980.
[28] I. M. Johnstone, “Large covariance matrices (Third 2004 Wald Lec-
ture),” presented at the 6th World Congress of the Bernoulli Society and
67th Annual Meeting of the IMS, Barcelona, Spain, 2004.
[29] R. Coifman, F. Geshwind, and Y. Meyer, “Noiselets,” Appl. Comput.
Harmon. Anal., vol. 10, pp. 27–44, 2001.
Authorized licensed use limited to: University of Science and Technology of China. Downloaded on February 25, 2009 at 08:59 from IEEE Xplore.  Restrictions apply.

