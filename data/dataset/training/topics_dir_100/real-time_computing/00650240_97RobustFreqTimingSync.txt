IEEE TRANSACTIONS ON COMMUNICATIONS, VOL. 45, NO. 12, DECEMBER 1997 1613
Robust Frequency and Timing
Synchronization for OFDM
Timothy M. Schmidl and Donald C. Cox, Fellow, IEEE
Abstract— A rapid synchronization method is presented for
an orthogonal frequency-division multiplexing (OFDM) system
using either a continuous transmission or a burst operation over
a frequency-selective channel. The presence of a signal can be
detected upon the receipt of just one training sequence of two
symbols. The start of the frame and the beginning of the symbol
can be found, and carrier frequency offsets of many subchannels
spacings can be corrected. The algorithms operate near the
Cramér–Rao lower bound for the variance of the frequency
offset estimate, and the inherent averaging over many subcarriers
allows acquisition at very low signal-to-noise ratios (SNR’s).
Index Terms— Carrier frequency, orthogonal frequency-
division multiplexing, symbol timing estimation.
I. INTRODUCTION
IN AN orthogonal frequency-division multiplexing (OFDM)system, synchronization at the receiver is one important
step that must be performed. This paper describes a method
to acquire synchronization for either a continuous stream of
data as in a broadcast application or for bursty data as in
a wireless local area network (WLAN). In both cases the
receiver must continuously scan for incoming data, and rapid
acquisition is needed. The ratio of the number of overhead bits
for synchronization to the number of message bits must be kept
to a minimum, and low-complexity algorithms are needed.
Synchronization of an OFDM signal requires finding the
symbol timing and carrier frequency offset. Symbol timing
for an OFDM signal is significantly different than for a single
carrier signal since there is not an “eye opening” where a
best sampling time can be found. Rather there are hundreds or
thousands of samples per OFDM symbol since the number of
samples necessary is proportional to the number of subcarriers.
Finding the symbol timing for OFDM means finding an
estimate of where the symbol starts. There is usually some
tolerance for symbol timing errors when a cyclic prefix is
used to extend the symbol. Synchronization of the carrier
frequency at the receiver must be performed very accurately,
or there will be loss of orthogonality between the subsymbols.
OFDM systems are very sensitive to carrier frequency offsets
since they can only tolerate offsets which are a fraction of the
Paper approved by M. Luise, the Editor for Synchronization of the
IEEE Communications Society. Manuscript received April 16, 1996; revised
February 11, 1997. This work was supported in part by a National Science
Foundation Graduate Fellowship. This work was presented in part at the IEEE
International Conference on Communications (ICC), Dallas, TX, June 1996.
T. M. Schmidl is with DSP Research and Development Center at Texas
Instruments Incorporated, Dallas, TX 75243 USA (e-mail: schmidl@ti.com).
D. C. Cox is with the STAR Laboratory, Department of Electrical
Engineering, Stanford University, Stanford, CA 94305-4055 USA (e-mail:
dcox@nova.stanford.edu).
Publisher Item Identifier S 0090-6778(97)09083-1.
spacing between the subcarriers without a large degradation in
system performance [1].
There have been several papers on the subject of synchro-
nization for OFDM in recent years. Moose gives the maximum
likelihood estimator for the carrier frequency offset which is
calculated in the frequency domain after taking the FFT [2].
He assumes that the symbol timing is known, so he just has to
find the carrier frequency offset. The limit of the acquisition
range for the carrier frequency offset is the subcarrier
spacing. He also describes how to increase this range by using
shorter training symbols to find the carrier frequency offset.
For example shortening the training symbols by a factor of
two would double the range of carrier frequency acquisition.
This approach will work to a point, but the estimates get
worse as the symbols get shorter because there are fewer
samples over which to average, and the training symbols need
to be kept longer than the guard interval so that the channel
impulse response does not cause distortion when estimating
the frequency offset.
Nogami and Nagashima [4] present algorithms to find the
carrier frequency offset and sampling rate offset. They use
a null symbol where nothing is transmitted for one symbol
period so that the drop in received power can be detected to
find the beginning of the frame. The carrier frequency offset
is found in the frequency domain after applying a Hanning
window and taking the FFT. The null symbol is also used in
[11]. This extra overhead of using a null symbol is avoided by
using the technique described in this paper. If instead of a con-
tinuous transmission mode, a burst mode is used, it would be
difficult to use a null symbol since there would be no difference
between the null symbol and the idle period between bursts.
Van de Beek [3] describes a method of using a correlation
with the cyclic prefix to find the symbol timing. If this method
were used to find the symbol timing, while using one of the
previous methods to find the carrier frequency offset, there
would still be a problem of finding the start of the frame to
know where the training symbols are located.
Classen introduces a method which jointly finds both the
symbol timing and carrier frequency offset [5]. However, it
is very computationally complex because it uses a trial and
error method where the carrier frequency is incremented in
small steps over the entire acquisition range until the correct
carrier frequency is found. It is impractical to do the exhaustive
search and go through a large amount of computation at each
possible carrier frequency offset.
This paper introduces some modifications of Classen’s
method which both greatly simplify the computation necessary
for synchronization and extend the range for the acquisition
0090–6778/97$10.00  1997 IEEE
1614 IEEE TRANSACTIONS ON COMMUNICATIONS, VOL. 45, NO. 12, DECEMBER 1997
Fig. 1. Block diagram of OFDM transmitter.
Fig. 2. Block diagram of OFDM receiver.
of carrier frequency offset. The method in this paper avoids
the extra overhead of using a null symbol, while allowing
a large acquisition range for the carrier frequency offset. By
using one unique symbol which has a repetition within half a
symbol period, this method can be used for bursts of data to
find whether a burst is present and to find the start of the burst.
Acquisition is achieved in two separate steps through the
use of a two-symbol training sequence, which will usually
be placed at the start of the frame. First the symbol/frame
timing is found by searching for a symbol in which the
first half is identical to the second half in the time domain.
Then the carrier frequency offset is partially corrected, and
a correlation with a second symbol is performed to find
the carrier frequency offset.
II. OFDM PRINCIPLES
The OFDM signal is generated at baseband by taking the
inverse fast Fourier transform (IFFT) of quadrature amplitude
modulated (QAM) or phase-shift keyed (PSK) subsymbols
(Fig. 1). In the figure, the block P/S represents
a parallel-to-serial converter. An OFDM symbol has a useful
period and preceding each symbol is a cyclic prefix of length
, which is longer than the channel impulse response so
that there will be no intersymbol interference (ISI) [6]. The
frequencies of the complex exponentials are , and
the useful part for subcarriers is given by
(1)
The baseband signal is quadrature modulated, up-converted to
the radio frequency (RF) and transmitted through the channel.
At the receiver (Fig. 2), the signal is down-converted to an
intermediate frequency (IF), and quadrature demodulated. The
block S/P represents a serial-to-parallel converter. A carrier
frequency offset of causes a phase rotation of .
If uncorrected this causes both a rotation of the constellation
and a spread of the constellation points similar to additive
white Gaussian noise (AWGN). A symbol-timing error will
have little effect as long as all the samples taken are within
the length of the cyclically-extended OFDM symbol.
III. ESTIMATION OF SYMBOL TIMING
A. Symbol Timing Estimation Algorithm
The symbol timing recovery relies on searching for a
training symbol with two identical halves in the time do-
main, which will remain identical after passing through the
channel, except that there will be a phase difference be-
tween them caused by the carrier frequency offset. The two
halves of the training symbol are made identical (in time
order) by transmitting a pseudonoise (PN) sequence on the
even frequencies, while zeros are used on the odd frequen-
cies. This means that at each even frequency one of the
points of a QPSK constellation is transmitted. In order to
maintain an approximately constant signal energy for each
symbol the frequency components of this training symbol are
multiplied by at the transmitter, or the four points of
the QPSK constellation are selected from a larger constel-
lation, such as 64-QAM, so that points with higher energy
can be used. Transmitted data will not be mistaken as the
start of the frame since any actual data must contain odd
frequencies. Note that an equivalent method of generating
this training symbol is to use an IFFT of half the normal
size to generate the time domain samples. The repetition is
not generated using the IFFT, so instead of just using the
even frequencies, a PN sequence would be transmitted on
all of the subcarriers to generate the time domain samples
which are half a symbol in duration. These time-domain
samples are repeated (and properly scaled) to form the first
training symbol.
The second training symbol contains a PN sequence on the
odd frequencies to measure these subchannels, and another
PN sequence on the even frequencies to help determine
frequency offset. Table I illustrates the use of PN sequences
in the training sequence for an OFDM signal with nine
subcarriers with the points chosen from a subset of a 64-
QAM constellation. The selection of a particular PN sequence
should not have much effect on the performance of the
synchronization algorithms. Instead the PN sequence can be
chosen on the basis of being easy to implement or having a low
peak-to-average power ratio so that there is little distortion in
the transmitter amplifier.
Complex samples are taken by mixing the received
signal down to the IF, splitting the signal into two branches,
multiplying by both the in-phase and quadrature local oscil-
lators, and low-pass filtering and sampling to get baseband
in-phase and quadrature components (Fig. 2). This can be
expressed mathematically by writing the IF local oscillator
for the in-phase branch as
(2)
SCHMIDL AND COX: ROBUST FREQUENCY AND TIMING SYNCHRONIZATION FOR OFDM 1615
TABLE I
ILLUSTRATION OF USE OF PN SEQUENCES FOR TRAINING SYMBOLS
and the IF local oscillator for the quadrature branch at the
receiver as
(3)
Let the output of the mixer after down-conversion be . The
demodulated signal before the sampler can be expressed as
(4)
where means to low-pass filter the terms in the
argument. The output of the in-phase branch is considered to
be real and the output of the quadrature branch is considered to
be imaginary. This is a mathematical convention to represent
the in-phase and quadrature components as a complex number.
After sampling, the complex samples are denoted as .
Consider the first training symbol where the first half is
identical to the second half (in time order), except for a phase
shift caused by the carrier frequency offset. If the conjugate of
a sample from the first half is multiplied by the corresponding
sample from the second half ( seconds later), the effect of
the channel should cancel, and the result will have a phase
of approximately . At the start of the frame,
the products of each of these pairs of samples will have
approximately the same phase, so the magnitude of the sum
will be a large value.
Let there be complex samples in one-half of the first
training symbol (excluding the cyclic prefix), and let the sum
of the pairs of products be
(5)
which can be implemented with the iterative formula
(6)
Note that is a time index corresponding to the first sample in
a window of samples. This window slides along in time as
the receiver searches for the first training symbol. The received
energy for the second half-symbol is defined by
(7)
Fig. 3. Example of the timing metric for the AWGN channel (SNR = 10
dB).
which can also be calculated iteratively. may be used
as part of an automatic gain control (AGC) loop. A timing
metric can be defined as
(8)
Fig. 3 shows an example of the timing metric as a window
slides past coincidence for the AWGN channel for an OFDM
signal with 1000 subcarriers, a carrier frequency offset of 12.4
subcarrier spacings, and an signal-to-noise ratio (SNR) of 10
dB, where the SNR is the total signal (all the subcarriers) to
noise power ratio. The timing metric reaches a plateau which
has a length equal to the length of the guard interval minus
the length of the channel impulse response since there is no
ISI within this plateau to distort the signal. For the AWGN
channel, there is a window with a length of the guard interval
where the metric reaches a maximum, and the start of the frame
can be taken to be anywhere within this window without a loss
in the received SNR. For the frequency selective channels, the
length of the impulse response of the channel is shorter than
the guard interval by design choice of the guard interval, so
the plateau in the maximum of the timing metric is shorter
than for the AWGN channel.
This plateau leads to some uncertainty as to the start of
the frame. For the simulations in this paper, OFDM symbols
are generated with 1000 frequencies, 500 to 499. They are
slightly oversampled at a rate of 1024 samples for the useful
part of each symbol. In an actual hardware implementation, the
ratio of the sampling rate to the number of frequencies would
be higher to ease filtering requirements. The guard interval is
set to about 10% of the useful part, which is 102 samples.
B. Performance of Symbol Timing Estimator
There are two issues to consider when evaluating the
performance of the symbol timing estimator. First, since the
timing metric is also used to determine whether the training
sequence has been received, there is a probability of either
missing a training sequence and not detecting the signal or
falsely detecting a training sequence when none is there. In
this paper the distribution of the timing metric at the correct
start of the frame is calculated. Using this distribution, the
number of samples that need to be processed during the
detection phase can be determined and a threshold can be
1616 IEEE TRANSACTIONS ON COMMUNICATIONS, VOL. 45, NO. 12, DECEMBER 1997
set for this detection. Second, there is some degradation in
performance if the symbol timing estimate deviates from the
correct region. Simulations are performed to find the effect of
extra interference that is introduced by poor symbol timing
estimates for two types of channels.
1) Distribution of Timing Metric: Let each complex sam-
ple be made up of a signal and a noise
component. Let the variance of the real and imaginary com-
ponents be:
(9)
(10)
so that the SNR is . To find the mean and variance of the
estimator at the best symbol timing, first look at which
can be written as
(11)
At the correct symbol timing, this can be broken into parts that
are in-phase and quadrature to the product
which has phase . This is just another way of looking at
the problem with a new set of axes with one axis in the
direction and the other axis perpendicular to it. For usable
values of SNR, when the magnitude is taken the quadrature
part will be small compared to the in-phase part and can be
neglected, so
(12)
where means the component in the direction.
The quadrature part is neglected because the Rician distri-
bution can be approximated by a Gaussian when taking the
envelope of a dominant signal with Gaussian noise [8]. The
dominant in-phase part is so much larger than the quadrature
part that the envelope can be approximated by the in-phase
part. Note that the first term of is much larger
than the second term since the products
all have phase and add in-phase, while all the other terms
add with random phases. By the central limit theorem (CLT),
is Gaussian with mean since each of the
terms has an expected value of , and
all the other terms have an expected value of zero.
For , the magnitude of each term could be taken by
adding the squares of the real and imaginary parts. Instead,
we can define a new set of orthogonal axes in which one axis
is in the direction of the term and the other is
perpendicular to it.
(13)
Here, means to take the component in
the direction of . By the CLT, is also Gaussian
with mean . Note that for usable values of
SNR, the mean is much greater than the standard deviation.
Thus, for the Gaussian approximation, the probability of
is insignificantly small making the approximation
of the nonnegative by a Gaussian reasonable. Another
equivalent way of thinking about the distribution is that
is Rician with the mean much larger than the standard
deviation. In this case the Gaussian approximation may be
used [8].
Define the square root of to be
(see (14) at the bottom of the page).
Since the standard deviations of both the numerator and
denominator are much smaller than the means, the approx-
imation can be used.
Another way to explain this is that there is a Gaussian random
variable in the numerator and a Gaussian random variable in
the denominator, and since the standard deviation of both of
these Gaussian random variables is much smaller than their
mean values, the above approximation can be used to write
their ratio as a single Gaussian random variable. As long as
this approximation holds, is Gaussian with
(15)
This can be justified because linear operations on a Gauss-
ian random variable will result in another Gaussian random
variable [9].
When calculating the variance, note that
(16)
and
(14)
SCHMIDL AND COX: ROBUST FREQUENCY AND TIMING SYNCHRONIZATION FOR OFDM 1617
Since these terms are the same in both the numerator and
denominator, they do not contribute to the overall variance.
Then
(17)
is , which is the square of a Gaussian
random variable. Since the variance is much smaller than the
mean, this also can be approximated by a Gaussian random
variable since linear operations performed on a Gaussian ran-
dom variable will produce another Gaussian random variable:
(18)
where is used to denote a Gaussian random variable
with a mean of and a variance of .
The expected value is
(19)
and the variance is
(20)
At high SNR the mean is approximately 1 and the variance is
approximately .
The value of also can give an estimate of the SNR,
which is
(21)
This equation is derived from (19). This can be written as
. The denominator
is Gaussian, and its reciprocal will also be Gaussian since
the standard deviation is much smaller than the mean for low
values of SNR. Again, this is a linear operation on a Gaussian
random variable (after the approximation). Then
(22)
This estimator works well for the SNR below 20 dB. Above
this level, is so close to 1 that an accurate estimate of
the SNR can not be determined, but only that the SNR is high.
For example, if , then dB.
This can be used to set a threshold so that very weak signals
will not be decoded, or it can be used in a WLAN to feed back
to the transmitter to indicate what data rate will be supported
so that an appropriate constellation and code can be chosen. A
lookup table can be implemented based on , so that
no square roots or divisions need to be performed.
Even if there is a frequency selective channel, all the signal
energy will go into the signal component term except when
the length of the channel impulse response becomes so large
that it is longer than the cyclic prefix. At this point, the energy
located at longer delays becomes interference and would be
added to the noise terms.
At a position outside the first training symbol, the terms in
the sum add with random phases since there is not
a periodicity for samples spaced by samples. For the purpose
of computing the mean and variance of the timing metric, the
samples can be considered to be composed of just noise terms
since noise terms will also add with random phases, so the
statistics will be independent of the SNR. This assumption
is verified by the simulation results shown in Fig. 6 which
will be explained later in this section. The real and imaginary
parts of are Gaussian by the CLT. The sum of
the square of two zero-mean Gaussian random variables, each
with a variance of 1 is a chi-square random variable with
two degrees of freedom and is represented by the symbol .
The mean of is 2 and the variance is 4 [9]. To simplify
the computations, let the variance of the real and imaginary
components of be:
(23)
Both and are Gaussian-
distributed with zero mean and a variance of . Incor-
porating this scaling factor, we have
(24)
The mean and variance of are
(25)
(26)
The denominator has a Gaussian distribution by
the CLT, and its square is also Gaussian because the standard
deviation is much smaller than the mean. Again, this is a
linear operation on a Gaussian random variable (using the
approximation), so the result is also Gaussian. Thus,
(27)
where the operator means “is distributed.” The ratio of these
two random variables (after dividing both the numerator and
denominator by a constant) is
(28)
Here, the variance of the Gaussian random variable is propor-
tional to and can be neglected. The mean and variance
1618 IEEE TRANSACTIONS ON COMMUNICATIONS, VOL. 45, NO. 12, DECEMBER 1997
Fig. 4. Expected value of timing metric with L = 512. Dashed lines indicate
three standard deviations.
Fig. 5. Mean and variance at the correct timing point with L = 512 for the
exponential channel.
of the timing metric are
(29)
(30)
Fig. 4 shows a plot of the expected value of timing metric
versus SNR at both the best timing instant and a point
outside the training symbol. The dashed lines indicate three
standard deviations from each curve.
Figs. 5 and 6 show the results of simulations performed
on the exponential frequency selective channels with 1000
subcarriers for the correct timing and an incorrect timing,
respectively. The correct timing point was chosen at the
start of the useful part of the first training symbol, and the
incorrect timing point was chosen one symbol after that. For
each SNR value, the simulation was run 10 000 times, each
time generating different PN sequences, channels, and noise.
Note that the simulated variance is slightly higher than that
calculated by theory for the incorrect timing. This is caused
because there is a correlation between the signal terms
and , while the calculation assumes that they are
independent.
2) Probability of Missing the Training Sequence or of False
Detection: The probability distributions calculated in Section
Fig. 6. Mean and variance at an incorrect timing point with L = 512 for
the exponential channel.
III-B-1 can be used to determine both the probability of not
detecting a training sequence when one is present and of
falsely detecting a training sequence when one is not present.
As an example of how this can be done, let there be 1000
subchannels and let . If the system is designed to
detect a signal if the SNR is at least 10 dB, then from Eqs.
(19) and (20), when the signal is present the mean is 0.827
and the variance is , so the standard deviation is
at the correct timing. If no signal is present, then
from (28) the mean is and the standard deviation
is also . If the threshold is set at 0.1, then the
margin for error when the training signal is present is
standard deviations. (31)
Similarly, when the signal is not present, the margin for error is
standard deviations. (32)
If the desired probability of error of missing a training se-
quence is , this requires that the threshold be 3.1
standard deviations below the mean found with (19). When
computing the probability of false detection, note that the
training signal is not present for most of each frame. If there
are 100 OFDM symbols within one frame, then most of the
time the training symbol is not present. Since the sliding
windows for the symbol timing estimator are half a symbol
long, there can be about 200 uncorrelated values of the symbol
timing estimator within one frame. If the probability of false
detection within one frame is desired to be , then the
probability of false detection at any point in time should be
about . From [10] the cumulative distribution function
for is
(33)
To get a probability of error of requires to be
less than 24.4, which corresponds to
standard deviations. (34)
SCHMIDL AND COX: ROBUST FREQUENCY AND TIMING SYNCHRONIZATION FOR OFDM 1619
Fig. 7. Relationship of signal, noise, and interference power to the symbol
timing position for the AWGN channel. The shaded portion in the first plot
indicates the range where the synchronizer can estimate the start of the symbol
to maximize SNIR.
In this example, both the probabilities of missing a training
sequence or of false detection within one frame are less than
. This allows the threshold to be adjusted to operate
at a lower SNR if that is desired. Another option is to reduce
the amount of computation performed while searching for the
training sequence by not processing every sample. This could
be useful in a burst mode when data may not arrive very often.
3) Reduction in SNIR: Two channels are used in simula-
tions to measure the performance of the estimation algorithms.
First the AWGN channel is used to show how the algorithms
perform on a benign channel, and it is also used as a basis
for comparison. Then a frequency selective channel with an
exponential power delay profile is used to show that the
algorithms perform well in a more realistic environment.
Sixteen paths are chosen with path delays of 0, 4, 8, , 60
samples, so the impulse response of the channel is shorter than
the guard interval. The amplitude of each path is calculated
from the exponential distribution, so
(35)
where is the amplitude of the th path and is the delay
of the th path is samples. The phase of each path is chosen
from a uniform distribution from to .
The reduction in the signal-to-noise-plus-interference ratio
(SNIR) due to a symbol timing error can be calculated for the
simulated channels. SNIR can be defined as
(36)
where is the variance of the intersymbol interference (ISI)
added by incorrect symbol timing. Fig. 7 plots the average
signal, noise, and interference power levels versus time for an
AWGN channel. Note that interference here refers to the ISI
from symbols before and after the training symbol in the time
domain. The time from to is the length of the guard
interval, and the time from to is the length of the useful
part of the OFDM symbol. If the synchronizer estimates that
the useful part of the symbol starts at any time within the guard
interval, which is the shaded area in the first plot of Fig. 7,
then there is no reduction in SNIR due to incorrect symbol
timing. However, if the synchronizer estimates that the start
TABLE II
REDUCTION IN SNIR (dB) DUE TO ERRORS IN SYMBOL TIMING
of the symbol is outside the guard interval, there will be both
a decrease in signal energy and an increase in interference,
resulting in a lower SNIR. This occurs because samples from
the previous or next symbol are input into the FFT along with
samples from the current symbol. For example, if the start of
the symbol is estimated to be at either time or at time
, then the signal-to-interference ratio (SIR) is 10,
assuming that the interference level is the same as the signal
level, as would be the case with a continuous transmission
but not with bursts of data. The SNIR will be lower than
10 when the noise is included. For the simulations in this
paper, it is assumed that a continuous transmission format is
used because this represents the worst case in terms of self-
interference. With multipath delay spread, the symbol timing
tolerance window from to is reduced by the length of
the channel impulse response.
Two methods to determine the symbol timing are compared
on the basis of reduction in SNIR. The first method is to
simply find the maximum of the timing metric. The second
method is to find the maximum, find the points to the left and
right in the time domain, which are 90% of the maximum,
and average these two 90% times to find the symbol timing
estimate. The rationale behind this method is that the best
timing points typically lie in a plateau. By trying to determine
the center of this plateau, it is more likely that the estimate
will not fall slightly off the plateau. Table II compares the two
methods on the basis of reduction in SNIR for the AWGN and
frequency selective channel. For each type of channel, 10 000
simulations are run at each SNR, and in each run, different PN
sequences, channels, and noise are generated. The averaging
method performs significantly better than simply finding the
peak of the timing metric, and it involves only slightly more
computation. With a 40-dB SNR, a symbol timing offset of one
sample away from the plateau would result in about 10 dB in
degradation in SNIR for the AWGN channel. The averaging
method of finding the symbol time resulted in no degradation
in 10 000 runs for the AWGN channel and a degradation of just
under 0.06 dB for the exponential channel at an SNR of 40 dB.
IV. ESTIMATION OF CARRIER FREQUENCY OFFSET
A. Carrier Frequency Offset Estimation Algorithm
The main difference between the two halves of the first
training symbol will be a phase difference of
(37)
which can be estimated by
(38)
1620 IEEE TRANSACTIONS ON COMMUNICATIONS, VOL. 45, NO. 12, DECEMBER 1997
near the best timing point. If can be guaranteed to be less
than , then the frequency offset estimate is
(39)
and the even PN frequencies on the second training symbol
would not be needed. Otherwise, the actual frequency offset
would be
(40)
where is an integer. By partially correcting the frequency
offset, adjacent carrier interference (ACI) can be avoided,
and then the remaining offset of can be found. After
the two training symbols are frequency corrected by
(by multiplying the samples by ), let their
FFT’s be and , and let the differentially-modulated
PN sequence on the even frequencies of the second training
symbol be (as illustrated in Table I). The PN sequence
will appear at the output except it will be shifted by
positions because of the uncompensated frequency shift of
. Note that because there is a guard interval and there
is still a frequency offset, even if there were no differential
modulation between training symbols 1 and 2 (i.e., PN se-
quence ), there would still be a phase shift between
and of . Since at this point the
integer is unknown, this additional phase shift is unknown.
However, since the phase shift is the same for each pair
of frequencies, a metric similar to (8) can be used. Let
be the set of indices for the even frequency components,
. The
number of even positions shifted can be calculated by finding
to maximize
(41)
with integer spanning the range of possible frequency offsets
and being the number of even frequencies with the PN
sequence. Then the frequency offset estimate would be
(42)
B. Performance of Carrier Frequency Offset Estimator
Since the carrier frequency offset is found in two steps, by
finding the fractional and then integer part of the offset, there
are two issues to consider in evaluating the carrier frequency
offset estimator. First the variance of the estimator of the
fractional part of the frequency offset can be found. Second,
the distribution of the carrier offset metric can be found for
both the correct and incorrect integer offsets to determine the
probability of making an error in finding the integer part of
the carrier frequency offset.
1) Variance of Fractional Part of Carrier Frequency Offset
Estimator: Using the method in [2]
(43)
Since the carrier frequency offset estimate (in subcarrier
spacings) is made up of the sum of the initial estimate and
an even integer, the variance of the initial estimate, , will
be equal to the variance of the final estimate if the integer is
Fig. 8. Comparison of Moose’s method and new method of estimating
frequency offset.
equal to . The effect of the remaining frequency offset
on the system performance is discussed in [2] and will not be
discussed here. By using the method in [7], the Cramér–Rao
bound is found to be
(44)
This is not surprising because Moose shows that his estimator
is the maximum-likelihood estimator (MLE) of differential
phase, and Rife states that the Cramér–Rao bounds are almost
met by the MLE with high SNR. Since the frequency offset
estimate is made by averaging over hundreds or thousands of
subcarriers, the effective SNR is usually very high. To illustrate
that the frequency acquisition range is greatly widened with
this new method, Fig. 8 compares the error variance for
Moose’s frequency estimation methods (with two repeated
half-symbols) with the new method for 1000 carriers with an
SNR of 10 dB. The simulations were performed with 10 000
runs per frequency offset value. Since Moose’s method is
designed to work only with a very small frequency offset,
it fails for larger frequency offsets. In Fig. 8, the Cramér–Rao
bound is . Note that the simulation here for
Moose’s algorithm uses the shortened symbols as described
in [2], which results is a frequency acquisition range of 1
subchannel spacing.
Fig. 9 compares the error variance for the carrier frequency
offset estimate to the Cramér–Rao bound for different values
of SNR. In the simulation the carrier frequency offset was set
to 2.4 subcarrier spacings so the estimator has to get the integer
part correct and get a good estimate of the fractional part of
the carrier frequency offset to make a good overall estimate.
Again, 10000 trials were run at each SNR value.
2) Distribution of Frequency Offset Metric: The expected
values and variances of the estimator can be calculated
in a similar method as in Section III-B-2 to determine if
can be found reliably. At the correct frequency offset,
all the signal products have the
same phase and
(45)
(46)
SCHMIDL AND COX: ROBUST FREQUENCY AND TIMING SYNCHRONIZATION FOR OFDM 1621
Fig. 9. Comparison of carrier frequency offset estimate to Cramér–Rao
bound.
Fig. 10. Expected value of carrier frequency offset metric with W = 500.
Dashed lines indicate three standard deviations.
At high SNR the mean is approximately 1, and the variance
is approximately .
At an incorrect frequency offset the signal products no
longer add in phase, and has a chi-square dis-
tribution with two degrees of freedom with
(47)
(48)
Fig. 10 shows a plot of the expected value of frequency
offset metric versus SNR for both a correct and incorrect
frequency offset for the 1000 subcarrier OFDM signal. The
dashed lines indicate three standard deviations from each
curve.
V. CONCLUSION
A method has been presented for the rapid and robust
synchronization of OFDM signals, and acquisition is obtained
upon the receipt of just one training sequence. By averaging
over all the subchannels, it works well in frequency selective
channels. This method also gives very accurate estimates of
symbol timing and carrier frequency offset and provides a
very wide acquisition range for the carrier frequency offset.
It also provides an estimate of the SNR, and the probability of
false locks or missing the training symbols is very low. For a
wireless LAN, such a fast and low-overhead synchronization
process is necessary because there will be only one training
sequence transmitted in each burst for synchronization.
REFERENCES
[1] T. Pollet, M. Van Bladel, and M. Moeneclaey, “BER sensitivity of
OFDM systems to carrier frequency offset and Weiner phase noise,”
IEEE Trans. Commun., vol. 43, pt. 1, pp. 191–193, Feb.–Apr. 1995.
[2] P. Moose, “A technique for orthogonal frequency division multiplex-
ing frequency offset correction,” IEEE Trans. Commun., vol. 42, pp.
2908–2914, Oct. 1994.
[3] J.-J. van de Beek, M. Sandell, M. Isaksson, and P. Börjesson, “Low-
complex frame synchronization in OFDM systems,” in Proc. ICUPC,
Nov. 6–10, 1995, pp. 982–986.
[4] H. Nogami and T. Nagashima, “A frequency and timing period acquisi-
tion technique for OFDM systems,” Personal, Indoor and Mobile Radio
Commun. (PIRMC), pp. 1010–1015, Sept. 27–29, 1995.
[5] F. Classen and H. Meyr, “Synchronization algorithms for an OFDM
system for mobile communication,” ITG-Fachtagung, pp. 105–113, Oct.
26–28, 1994.
[6] B. Le Floch, R. Halbert-Lassalle, and D. Castelain, “Digital sound
broadcasting to mobile receivers,” IEEE Trans. Consumer Electron., vol.
35, pp. 493–503, Aug. 1989.
[7] D. Rife and R. Boorstyn, “Single-tone parameter estimation from
discrete-time observations,” IEEE Trans. Inform. Theory, vol. IT–20,
pp. 591–598, Sept. 1974.
[8] T. Rappaport, Wireless Communications: Principles and Practice. En-
glewood Cliffs, NJ: Prentice-Hall, 1996.
[9] R. Walpole and R. Myers, Probability and Statistics for Engineers and
Scientists. New York: Macmillan, 1985.
[10] W. Beyer, CRC Standard Mathematical Tables. New York: CRC Press,
1983.
[11] P. de Bot, B. Le Floch, V. Mignone, and H.-D. Schütte, “An overview
of the modulation and channel coding schemes developed for digital
terrestrial television broadcasting within the dTTb project,” in Int.
Broadcasting Conv., Sept. 16–20, 1994, pp. 569–576.
Timothy M. Schmidl received the B.S. degree
(with highest honors) in electrical engineering from
the University of Texas at Austin in 1992, and the
M.S. and Ph.D. degrees in electrical engineering
from Stanford University, Stanford, CA, in 1994 and
1997, respectively.
From 1993 to 1997, he was a Research Assistant
in the Information Systems Laboratory and the
STAR Laboratory at Stanford University. In 1997,
he joined the Digital Communication Technology
group of the Digital Signal Processing Solutions
Research & Development Center at Texas Instruments and is currently a
Member of the Technical Staff.
Donald C. Cox (S’58–M’61–SM’72–F’79), for photograph and biography,
see p. 884 of the July 1997 issue of this TRANSACTIONS.

