 
 
An Energy Balanced Algorithm of LEACH Protocol in WSN 
Chunyao FU1, Zhifang JIANG1, Wei WEI2and Ang WEI*3 
 
 1School of Natural Science, Nanjing University of Posts & Telecommunications, 
 Nanjing 210046, China 
 
2School of Computer Science and Engineering, XI ' an University of technology, 
 XI ' an 710048, China 
 
*3Institute of Advanced Materials, Nanjing University of Posts & Telecommunications,  
Nanjing 210046, China.  
 
 
Abstract 
In wireless sensor networks (WSNs), due to the limitation of 
nodes’ energy, energy efficiency is an important factor should 
be considered when the protocols are designing. As a typical 
representative of hierarchical routing protocols, LEACH Protocol 
plays an important role. In response to the uneven energy 
distribution that is caused by the randomness of cluster heads 
forming , this paper proposes a new improved algorithm of 
LEACH protocol (LEACH-TLCH) which is intended to balance 
the energy consumption of the entire network and extend the life 
of the network . The new algorithm is emulated by Matlab 
simulation platform, the simulation results indicate that both 
energy efficiency and the lifetime of the network are better than 
that of LEACH Protocol. 
Keywords: LEACH Protocol; Energy consumption; Network 
lifetime; Matlab simulation. 
1. Introduction 
As a new information acquisition and processing 
technology, wireless sensor network （WSN）has a wide 
range of applications in military, environmental monitoring, 
smart furniture and space exploration and so on [1]. 
Wireless Sensor Network can be described as an autonomy 
system consisting of lots of sensor nodes designed to 
intercommunicate by wireless radio ， and it can 
collaborate in real time monitoring, perceiving and 
collecting information of various environmental or 
monitoring objects and transfer this information to the base 
station．It does not need a fixed network support，and it 
has rapid employment, survivability and other 
characteristics，so it has a good application prospect． 
 
Until now the research on sensor network generally has 
gone through two stages, the first stage is primarily 
intended for node, the second one is for network-level 
issues, the main research works in this stage involve the 
network layer and MAC layer protocol based on energy 
optimization, node localization technology, clock 
synchronization technology and data fusion technology [2]. 
Study of routing protocols in wireless sensor networks is 
one of the hot topics at this stage. 
 
LEACH Protocol is the first protocol of hierarchical 
routings which proposed data fusion, it is of milestone 
significance in clustering routing protocols. Many 
hierarchical routing protocols are improved ones based on 
LEACH protocol [3]. So, when wireless sensor networks 
gradually go into our lives, it is of great significance to 
research on LEACH protocol.   
2. Brief Introduction to LEACH Protocol 
LEACH Protocol is a typical representative of hierarchical 
routing protocols. It is self adaptive and self-organized. 
LEACH protocol uses round as unit, each round is made 
up of cluster set-up stage and steady-state stage, for the 
purpose of reducing unnecessary energy costs, the steady-
state stage must be much longer than the set-up stage. The 
process of it is shown in Figure 1. 
Clusters formed
Set-up
Frame
Time
Slot for 
node i
Slot for 
node i
Steady-state
Fig.1  LEACH Protocol process. 
At the stage of cluster forming, a node randomly picks a 
number between 0 to 1, compared this number to the 
threshold values )(nt , if the number is less than )(nt , then 
it become cluster head in this round, else it become 
common node. Threshold )(nt  is determined by the 
following: 
 
IJCSI International Journal of Computer Science Issues, Vol. 10, Issue 1, No 1, January 2013 
ISSN (Print): 1694-0784 | ISSN (Online): 1694-0814 
www.IJCSI.org 354
Copyright (c) 2013 International Journal of Computer Science Issues. All Rights Reserved.
 
 










Gnif
Gnif
p
rp
p
n
0
)
1
mod(1)(t
                   (1) 
      Where p is the percentage of the cluster head no
des in all nodes, r is the number of the round, G is th
e collections of the nodes that have not yet been head
 nodes in the first 1/P rounds. Using this threshold, al
l nodes will be able to be head nodes after 1/P round
s. The analysis is as follows: Each node becomes a cl
uster head with probability p when the round begins, 
the nodes which have been head nodes in this round 
will not be head nodes in the next 1/P rounds, becaus
e the number of the nodes which is capable of head n
ode will gradually reduce, so, for these remain nodes,
 the probability of being head nodes must be increase
d. After 1/P-1 round, all nodes which have not been 
head nodes will be selected as head nodes with proba
bility 1, when 1/P rounds finished, all nodes will retu
rn to the same starting line. 
 
When clusters have formed, the nodes start to transmit the 
inspection data. Cluster heads receive data sent from the 
other nodes, the received data was sent to the gateway after 
fused. This is a frame data transmission. In order to reduce 
unnecessary energy cost, steady stage is composed of 
multiple frames and the steady stage is much longer than 
the set-up stage. 
3. A new improved algorithm based on 
LEACH Protocol (LEACH-TLCH) 
In LEACH protocol, due to the randomness of clusters 
forming, the energy of cluster head is very different, so do 
the distances between cluster heads and base station. 
Cluster heads are responsible not only for sending data to 
the base station but also for collecting and fusing the data 
from common nodes in their own clusters. In the process of 
data collection and transmission, the energy consumed by 
data transmission is greater than that of data fusion [4]. If 
the current energy of a cluster head is less or the distance 
to base station is much far, then the cluster head will be 
died quickly because of a heavy energy burden. To address 
these issues, this article proposes a new improved 
algorithm on how to balance the energy loads of these 
cluster heads.  
3.1 The idea of improved algorithm  
LEACH-TLCH (LEACH Protocol with Two Levels 
Cluster Head) is an improved one based on LEACH 
Protocol, the methods of cluster-head selection and 
clusters forming are same as LEACH protocol. If a cluster 
head’s current energy is less than the average energy, that 
is 
avecur EE  ,where 
N
curave iEE
1
)( is the average energy 
of all nodes in the network, or the distance between the 
cluster head and base station is longer than the average 
distance, that is 
avedd  , where 
N
iave dd
1
is the average 
distance of all nodes’ distance to base station, then the 
common node with maximum energy in this cluster will be 
selected as the secondary cluster head. If 
avecur EE  and 
avedd  ，it is unnecessary to select a secondary cluster 
head.  
 
In a cluster which has secondary cluster head, the 
secondary cluster head is responsible for receiving and 
fusing data collected from the member nodes and sending 
them to its cluster head, the cluster head is only 
responsible for transporting data to base station. In a 
cluster without secondary cluster head，the cluster head is 
responsible for collecting data from the member node and 
sending them to base station after the data was fused. It is 
clear from the first-order energy transfer model (Figure 3) 
that the energy consumption of data receiving and data 
fusion are less than that for data transferring [5] ，
especially for long distance data transferring,  so the life of 
clusters with secondary cluster heads will not be extended 
a lot so as to bring new energy imbalance of energy 
consumption of entire network. The network topology of 
the improved algorithm is shown in Figure 2.  
 
 
 
 
 
 
 
Fig.2 Network topology 
3.2 First-order wireless transmission model  
This article uses first-order wireless communication model, 
it is shown in Figure 3.  
 
 
 
 
 
Fig. 3 The wireless communication model 
transmitter 
 
Tx amplifier 
ETx (L,d) 
EelecL  vLd  EelecL  
receive circuit 
L bit data 
d 
L bit data 
Common Node    
Cluster Head 
     Secondary Cluster Head 
SINK
NK
NK 
IJCSI International Journal of Computer Science Issues, Vol. 10, Issue 1, No 1, January 2013 
ISSN (Print): 1694-0784 | ISSN (Online): 1694-0814 
www.IJCSI.org 355
Copyright (c) 2013 International Journal of Computer Science Issues. All Rights Reserved.
 
 
The total energy consumed in Figure 3 is calculated by 
formula (2) and (3) [6], 
 







0
4
mpelec
0
2
fselec
Tx
d,ddLεLE
d,ddLεLE
d)(LE ,
             (2) 
    
elecRx LELE )(                                       (3) 
Where elecE  represents the energy consumed to transmit 
or receive 1 bit message; fsε  is the amplification 
coefficient of free-space signal and mpε is the multi-path 
fading signal amplification coefficient, their value depend 
on the circuit amplifier model; d represents the distance 
between transmitter and receiver; L is the bit amount of 
sending information.   
3.3 The optimal number of cluster heads 
In LEACH Protocol, all nodes are divided into n clusters 
randomly, if the value of n is too small, each cluster head 
burdens so heavily that some clusters will die earlier due to 
energy draining, this will affect the network lifetime; If the 
value of n is too large, this also results in some 
unnecessary overhead because clusters need to send 
broadcast messages to all nodes. Suppose N nodes are 
randomly distributed within the square area of the edge 
length M, assuming that the base station locates in the 
centre of region, and the distance of each node or cluster-
head to the base station is less than or equal to 
0d ,where 
mp
fs
0d


 , we know by references [6] that the optimal 
number of cluster heads should be  
toBS
opt
d
MN
n
2
                                  (4) 
If some nodes’ distance to base station is greater than
0d ,    
we can also get formula (5) by the same method which was 
used in references [6] and [7]. 
 
toBSmp
fs
opt
d
MN
n


2
                               (5) 
                          
So the optimal probability for nodes to become cluster 
heads is 
N
n
p
opt
opt 
                                     (6) 
                  
By the formula (4) and (5) we know that the optimal 
number of cluster heads only relates to the number of 
network nodes N, the regional side length M, as well as the 
location of the base station. We can set these parameters in 
the network initialization. In this article, the optimal 
probability for nodes to become cluster heads is chosen as 
7% according to formula (6) and the parameters we have 
set. 
3.4 The description of improved algorithm  
The parameters need to be used in description of algorithm 
are as following: Threshold value, as shown in formula 
(1) ； Average energy of all nodes is 
N
ave iEE
1
)( ; 
Average distance between nodes and base station is 

N
ave idd
1
)( . 
 The stage of cluster forming 
First, a node choose a number between 0 to 1, if the 
number is less than )(nT , then the node becomes cluster 
head, else, normal nodes it becomes. Cluster 
heads broadcast their own information to other nodes, the 
other nodes will listen to the broadcasting messages. All 
normal nodes determine which cluster they should join in 
this round based on the strength of the signal they received. 
After determining which cluster they should belong, 
CSMA Protocol will be used to send a confirmation 
message to their cluster heads. At this point, the clusters 
forming stage is finished. 
 The selecting of secondary cluster head 
Each cluster head decides whether to set a secondary 
cluster head according to the current energy itself and the 
distance to the base station, if 
aveEiE )( or avedid )( , 
then these kinds of cluster heads should choose the node 
with maximum energy as secondary cluster head in its 
cluster, otherwise, the secondary cluster head is not 
required. 
 To create a transport schedule  
All clusters are divided into two categories, in clusters with 
secondary cluster heads, the secondary cluster head 
broadcasts message of being secondary cluster head to the 
other ordinary nodes and builds a schedule (uses TDMA 
access channel, a time slot is assigned to each node), 
informs the schedule to the other nodes. In clusters without 
secondary cluster head, the cluster heads distribute sending 
time slot to the others after get the join information of 
normal nodes. The stable stage begins when each node 
have gotten its sending time slot. 
 Data transferring 
IJCSI International Journal of Computer Science Issues, Vol. 10, Issue 1, No 1, January 2013 
ISSN (Print): 1694-0784 | ISSN (Online): 1694-0814 
www.IJCSI.org 356
Copyright (c) 2013 International Journal of Computer Science Issues. All Rights Reserved.
 
 
When clusters have formed and the TDMA schedule is 
determined, the nodes start to transfer the monitoring data. 
The secondary cluster heads receive data from the other 
nodes and fuse these data, these fused data was sent to the 
cluster heads, then cluster heads send these data to base 
station by single-hop method. In those clusters without 
secondary cluster head, the cluster heads receive the 
information from other nodes, fuse them and send them to 
base station. 
4. Simulation of improved algorithm 
This article uses Matlab7.0 as simulation platform to 
emulate LEACH protocol and the improved protocol 
(LEACH-TLCH), the improved algorithm aims at 
balancing the total energy consumption of nodes and 
extending the network's survival time. So we measure the 
improved protocol performance from two aspects: the 
lifetime and the total energy consumption of the network. 
The lifetime of network means the time from the beginning 
of simulation to the time when the last node died. As the 
energy of WSN is limited, so the energy consumption in its 
lifetime is a meaningful indicator to measure the 
performance of it. 
4.1 Simulation parameters 
Simulation scenarios in this article are:  
1. Sensor nodes are randomly distributed in a square 
region; 
2. Sensor nodes are homogeneous and have a unique ID 
number throughout the network, nodes energy is limited. 
The node’s location is fixed after deployed; 
3. The base station is in the center of region with fixed-
location; 
4. Nodes communicate with base station via single-hop or 
multi-hop; 
5. The wireless transmitter power is adjustable. 
Specific parameters are shown in table 1. 
Table1: Simulation environment parameters 
4.2 Analysis of simulation results 
200 nodes randomly distribute within the square area of 
the 200m*200m, the base station is located in the centre of 
the region, the base station coordinates is (100,100). It can 
be seen from the figure 4 that the nodes’ distribution are 
not very evenly.  
0 20 40 60 80 100 120 140 160 180 200
0
20
40
60
80
100
120
140
160
180
200
节点随机分布图
 
Fig. 4 Randomly distributed nodes 
4.2.1 The network lifetime  
The network lifetime in this article is defined as the time 
from the beginning of the simulation to the time when the 
last node died. In WSN, the network life is divided into 
stable and unstable period [6]. Stable period usually means 
the time from the beginning of the simulation to the time 
when the first node dies, the unstable period refers to the 
time from the death of first node to the end of simulation.  
 
If it happened that some nodes begin to die, the network 
operation may become unstable and unreliable data 
transferring will occur. Therefore, the longer the stable 
period is, the better the performance of the network. In 
LEACH Protocol, cluster heads are responsible not only 
for communicating with the base station, but for the data 
fusing. Randomly distributing the nodes and randomly 
selecting the cluster heads causes some cluster heads die 
earlier because of the low energy or the long distance to 
base station. Secondary cluster heads are set for these 
clusters to be responsible for the communication with 
common nodes and data fusing, this balances the energy 
load of cluster heads and avoids premature death of these 
cluster heads, so the stable period of network lifetime will 
be prolonged.  
 
Figure 5 is network lifetime in simulation, simulation 
results indicates that the network lifetime of the improved 
parameters parameters 
area                     200*200 Packet  size         4000bits 
Nodes number         200 Eelec                  50nJ/bit 
Initial energy           0.5J fs                 10pJ/bit/m2 
CH proportion        p=7% mp            0.0013pJ/bit/m4   
BS location        (100,100) EDA                   5nJ/bit 
IJCSI International Journal of Computer Science Issues, Vol. 10, Issue 1, No 1, January 2013 
ISSN (Print): 1694-0784 | ISSN (Online): 1694-0814 
www.IJCSI.org 357
Copyright (c) 2013 International Journal of Computer Science Issues. All Rights Reserved.
 
 
protocol and LEACH Protocol are about the same, the first 
node died in LEACH Protocol in round 561, the first node 
died in the improved Protocol in round 857. When 90% 
nodes died, the network reliability is extremely reduced 
and the running is almost meaningless. We may as well to 
define the time from the simulation beginning to the time 
90% nodes died as effective lifecycle, analyzing from 
figure 5, we know that the effective lifecycle of the 
improved algorithm is longer 9% than that of LEACH 
protocol. The percentage of stable period of lifecycle in 
LEACH Protocol is 28%, the one in the improved protocol 
is 43%, The percentage of stable period of lifecycle in 
improved algorithm increases 15%. This indicates that the 
running performance of improved protocol is much better 
than that of LEACH Protocol. The analysis of simulation 
results is consistent with the theoretical analysis. 
0 200 400 600 800 1000 1200 1400 1600 1800 2000 2200
0
20
40
60
80
100
120
140
160
180
200
Number of Rounds
N
u
m
b
e
r 
o
f 
N
o
d
e
s
 A
li
v
e
Life of Network
leach-TLCH
leach
 
Fig. 5 The network lifetime 
4.2.2 The total energy consumption  
 
Figure 6 is the energy consumption curve. Improved 
algorithm reduced the energy consumption of few cluster 
heads which has low energy or is far away to base station 
by setting secondary cluster heads reasonably. This 
balanced the energy consumption of the whole networks, 
extended the lifetime of cluster heads which may die 
earlier and optimized the performance of the network 
thereby reduced the total energy consumption of the 
effective lifecycle.  
 
From the analysis of Figure 6, we know that in the whole 
running of the network, the energy consumption of 
improved algorithm is much lower than that of LEACH 
Protocol at the same round of simulation. These results are 
consistent with the design purposes of improved algorithm. 
0 200 400 600 800 1000 1200 1400 1600 1800 2000 2200
0
5
10
15
20
25
30
35
40
45
50
55
Number of Rounds
E
n
e
rg
y
 C
o
n
s
u
m
p
ti
o
n
/J
Energy Consumption
leach
leach-2LCH
 
 Fig.6 The total energy consumption  
5.  Conclusions 
Electing cluster head randomly in LEACH protocol causes 
that the current energy of some cluster heads are less or 
their distances to base station are far, because of the heavy 
energy burden, these cluster heads will soon die. For this 
issue, this article proposed a new improved algorithm of 
LEACH protocol which is aim at balancing energy 
consumption of the whole network and extending the 
network lifetime by balancing the energy consumption of 
these cluster heads. The new improved algorithm is 
emulated by Matlab platform, the simulation results 
indicate that the energy efficiency and the lifetime of 
network are both better than that of LEACH Protocol. 
 
References 
[1] Akyildiz LF, Su W, Sankarasubramaniam Y, Cayirci E. A 
survey on sensor networks. IEEE Communications 
Magazine, 2002, 40(8): 102~114.Vol.25, No.4: 114-124. 
[2] R.A.Roseline and Dr.P.Sumathi, Energy Efficient Routing 
Protocol and Algorithms for Wireless Sensor Networks-A 
Survey. Global Journal of Computer Science and 
Technology, vol.11, December 2011. 
[3] Ian F. Akyildiz, Weilian Su, Yogesh Sankarasubramaniam, 
et al. Wireless Sensor Network: A survey [J]. Computer 
Networks, 2003, 38(4): 393-422. 
[4] Heinzelman W, Chandrakasan A, Balakrishnan H. Energy 
Efficient Communication Protocol for Wireless Microsensor 
Networks. In Proceedings of the 33rd Hawaii International 
Conference on System Sciences. Maui: IEEE Computer 
Society, 2000, Vol.2: 3005-3014. 
[5] Cui Li Ju, Hailing, Miao Yong, Li Tianpu, Liu Wei and 
Zhao Ze,Overview of Wireless Sensor Networks[J];Journal 
of Computer Research and Development;2005-01 
[6] Smaragdakis G.  Matta I.  Bestavros A. A Stable Election 
Protocol for Clustered Heterogeneous Wireless Sensor 
IJCSI International Journal of Computer Science Issues, Vol. 10, Issue 1, No 1, January 2013 
ISSN (Print): 1694-0784 | ISSN (Online): 1694-0814 
www.IJCSI.org 358
Copyright (c) 2013 International Journal of Computer Science Issues. All Rights Reserved.
 
 
Networks, Proceedings of the 2nd International Workshop 
on SANPA 2004,Massachusetts, U.S, 2004:1-11 
[7] WANG Jin-wei, 2,SUN Hua-zhi, SUN De-bing, Research 
on the Number of Optimal Cluster Heads of Wireless Sensor 
Networks Based on Energy Consumption. Journal of 
Computer Research and Development, 2008,03. 
[8] Estrin D, Govindan R, Heidemann J, Kumar S. Next century 
challenges: Scalable coordinate in sensor network. In 
Proceedings of the 5th ACM/IEEE International Conference 
on Mobile Computing and Networking. Seattle: IEEE 
Computer Society, 1999, 263~270. 
 
Chunyao FU received her BS degree in Mathematics from 
Shaanxi Normal University and MS degree in computer science 
from Nanjing University of Posts and Telecommunications. She is 
now an assistant professor in College of Science in Nanjing 
University of Posts and Telecommunications. Her main research 
work is related to computer technology and mathematics. 
 
Zhifang JIANG is an associate professor in College of Science in 
Nanjing University of Posts and Telecommunications. She 
received her BS degree in Mathematics from East China Normal 
University and MS degree in applied mathematics from Nanjing 
University. Her main research is algebra. 
 
Wei WEI received the PhD and MS degrees from Xi’an Jiaotong 
University in 2011 and 2005, respectively. He is now an assistant 
professor at Xi’an University of Technology. His academic 
interests in the following areas: Wireless Networks and Wireless 
Sensor Networks Application, Mobile Computing, Wireless 
Network Security, Image Processing, Distributed Computing. 
 
Ang WEI received the PhD degree from Fudan University in 2006. 
He is an associate professor at Nanjing University of Posts and 
Telecommunications. His academic interests are sensor device, 
nano materials and wireless sensor networks. 
IJCSI International Journal of Computer Science Issues, Vol. 10, Issue 1, No 1, January 2013 
ISSN (Print): 1694-0784 | ISSN (Online): 1694-0814 
www.IJCSI.org 359
Copyright (c) 2013 International Journal of Computer Science Issues. All Rights Reserved.

