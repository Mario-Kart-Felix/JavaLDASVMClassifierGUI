On conditional parity as a
notion of non-discrimination in
machine learning
Ya‚Äôacov Ritov, Yuekai Sun, and Ruofei Zhao
University of Michigan
Abstract. We identify conditional parity as a general notion of non-
discrimination in machine learning. In fact, several recently proposed
notions of non-discrimination, including a few counterfactual notions,
are instances of conditional parity. We show that conditional parity is
amenable to statistical analysis by studying randomization as a general
mechanism for achieving conditional parity and a kernel-based test of
conditional parity.
1. NON-DISCRIMINATION IN MACHINE LEARNING
As automated decision systems permeate our world, the problem of implicit
biases in these systems have become more serious. Machine learning algorithms
are routinely used to make decisions in credit, criminal justice, and education, all
of which are domains protected by anti-discrimination law. Although automated
decision systems seem to eliminate the biases of a human decision maker, they
may perpetuate or even exacerbate biases in the data.
For example, consider an advertising platform which uses demographic infor-
mation of visitors to a website to decide which credit card offers to show first-time
visitors. If the system is trained on historical data where minority visitors were
given less advantageous offers, the system may steer similar visitors to less ad-
vantageous offers, which is illegal (Steel and Angwin, 2010).
In response, the scientific community has proposed several formal definitions
of non-discrimination and various approaches to ensure algorithms are non-dis-
criminatory. Unfortunately, the myriad of definitions and approaches hinders the
adoption of this work by practitioners: they must choose from the growing list of
definitions and approaches, and there is often no clear choice.
In light of this plethora of definitions, we identify a general notion of non-
discrimination in Section 2 that not only includes many recently proposed defini-
tions but also suggests new definitions. In Sections 3 and 4, we study randomiza-
tion as a general mechanism for achieving conditional parity and a kernel-based
test of conditional parity. Finally, in Section 5, we apply this test to determine
whether insurance companies charge higher premiums to insure cars in minority
neighborhoods.
1
ar
X
iv
:1
70
6.
08
51
9v
1 
 [
st
at
.M
L
] 
 2
6 
Ju
n 
20
17
2 RITOV, SUN, ZHAO
Table 1
A graphical representation of the groups implicit in the gender discrimination example.
a = female a = male
z = analyst
z = associate
...
z = VP
2. CONDITIONAL PARITY: A NOTION OF NON-DISCRIMINATION
Intuitively, any claim of discrimination or non-discrimination depends on a
comparison: a comparison between the outcome of two groups that differ only by
a sensitive attribute. For instance, a claim of gender discrimination by a female
employee of a consulting firm implies she was treated differently from male em-
ployees of the company in her position. Here the two groups are female and male
employees that share her position. By only comparing herself to male employees
in her position, she is implicitly permitting the firm to treat male employees in
other positions differently. In other words, the firm is allowed to discriminate on
an employee‚Äôs position (eg. paying senior employees higher salaries). We see that
in order to fully specify the two groups, we must not only specify the protected
attribute (eg. gender) but also specify the discriminatory attribute (eg. position).
Definition 2.1 (conditional parity (CP)). A random variable x satisfies pa-
rity with respect to a conditioned on z = z if the distribution of x | a, {z = z} is
constant in a:
L(x | a = a, z = z) = L(x | a = a‚Ä≤, z = z) for any a, a‚Ä≤ ‚àà A.
Similarly, x satisfies parity with respect to a conditioned on z (without specifying
a value of z) if it satisfies parity with respect to a conditioned on z = z for any
z ‚àà Z.
In terms of independence, conditional parity is x ‚ä• a | {z = z}. Table 1 is
a graphical representation of the groups in the running gender discrimination
example. As we shall see, many existing notions of non-discrimination such as
demographic parity, equalized odds, equalized opportunity, and counterfactual
fairness are all instances of CP. We remark that the definition of CP is invariant
under post-processing: if x satisfies CP with respect to a conditioned on z = z,
then so does f(x) for an arbitrary function f . This is especially desirable because
it leads to a simple way of eliminating bias in machine learning algorithms.
The intuition of identical conditional distributions that Definition 2.1 formal-
izes extends easily to yield approximate notions of non-discrimination. To keep
things simple, we assume a is discrete.
CONDITIONAL PARITY 3
Definition 2.2 (-conditional parity). Let d be a metric on distributions.1 A
random variable x satisfies -conditional parity with respect to a ‚àà A conditioned
on z = z if
maxa,a‚Ä≤‚ààAd(L(x | a = a, z = z),L(x | a = a‚Ä≤, z = z)) ‚â§  for any a, a‚Ä≤ ‚àà A.
To wrap up, we compare CP to two other notions of non-discrimination: func-
tional blindness and individual fairness.
Definition 2.3 (functional blindness). A decision rule Œ¥ : A √ó Z ‚Üí X
satisfies functional blindness with respect to a iff
Œ¥(a, z) = Œ¥(a‚Ä≤, z) for any a, a‚Ä≤ ‚àà A and z ‚àà Z.
In other words, the decision rule has no functional dependence on the protected
attribute.
Functional blindness, also known as fairness through unawareness, is a rudi-
mentary but widely used notion of non-discrimination. Although intuitive, it is
a weak notion that is easily circumvented because it does not rule out implicit
dependence of the decision on the protected attribute.
For decades, insurance companies have charged drivers in predominantly mi-
nority neighborhoods higher premiums than drivers in majority white neighbor-
hoods. Although insurers have justified their pricing by citing a higher risk of
accidents in minority neighborhoods, consumer advocates suspect the practice
is merely a way around laws that ban discriminatory rate-setting: a driver‚Äôs zip
code is a good proxy for his or her race in segregated areas.
We remark that functional blindness implies parity conditioned on z. However,
if z includes attributes that are proxies for the protected attribute (eg. zip code
is a proxy for race in the preceding example), enforcing CP is vacuous. After all,
by including an attribute in z, we are allowing the decision rule to discriminate
based on it.
Definition 2.4 (individual fairness (Dwork et al., 2012)). Let d be a metric
on distributions and D be a metric on the space of individuals X . A (possibly
randomized) decision rule Œ¥ satisfies -individual fairness iff it is -Lipschitz in
x:
d(L(Œ¥(x1)),L(x2)) ‚â§ D(x1, x2) for any x1, x2 ‚àà X .
Individual fairness is based on the principle that two similar individuals should
be treated similarly by the decision rule. The precise definition of individual
fairness depends crucially on the choice of the metrics d and D. Dwork et al.
(2012) suggest the metrics be chosen by a regulatory body or proposed by civil
rights organizations and left open to discussion and continual refinement.
Both CP and individual fairness formalize the intuition that similar individuals
should be treated similarly. In CP, similar individuals are those that share dis-
criminatory attributes. In individual fairness, similar individuals are determined
1Formally, the metric must satisfy d(P,Q) = d(Q,P) and d(P,Q) ‚â• 0 for any pair of distri-
butions P and Q as well as d(P,P) = 0 for any distribution P.
4 RITOV, SUN, ZHAO
by the choice of the the metric on individuals. Although Dwork et al. (2012) does
not distinguish between disriminatory and protected attributes, it is possible to
encode the distinction into the choice of metric on X .
2.1 Demographic parity and equalized odds
In this subsection, we describe several factual (as opposed to counterfactual)
notions of non-discrimination and show that they are instances of CP.
Definition 2.5 (demographic parity (DP)). The outcome x satisfies demo-
graphic parity if
L(x | a = a) = L(x | a = a‚Ä≤) for any a, a‚Ä≤ ‚àà A.
As we can see, there is no discriminatory attribute in DP, and it is required
that individuals from the group {a = a} has to be treated equally as individuals
from the group {a = a‚Ä≤}. Although in general, DP seems too coarse a notion of
non-discrimination, there are some scenarios where it is suitable. For example, in
the allocation of public resources, DP is a fitting notion of non-discrimination. A
concrete example is public secondary school admission. Due to the public service
nature of public secondary education, parents should be allowed to send their
children to any school in their neighborhood, regardless of their background. In
reality, such goal is often attained by lottery, meaning that random selections in
the pool of applicants are made.
Example 2.6 (War on Drugs). According to the American Civil Liberties
Union (ACLU), ‚Äúan African American adult is 2.8 times as likely to have a mis-
demeanor cannabis charge filed against him or her than does an Anglo American
adult‚Äù in Washington State (Jensen and Roussell, 2016). By comparing the like-
lihood of being charged without stratifying the population (eg. by prevalence of
cannabis consumption), the ACLU is claiming the War on Drugs violates DP.
This is an example where DP is not a suitable notion of non-discrimination: the
disparity between the likelihood of being charged may be due to disparities between
prevalence of cannabis consumption. Thus it is incorrect to conclude the targeting
of African Americans by law enforcement from violation of DP.
To avoid the problems of DP, we first segment the population by certain dis-
criminatory attributes (eg. prevalence of cannibis consumption in the War on
Drugs example) and then apply DP to each segment of the population. This led
us to the notion of CP. In supervised learning, a natural instantiation of CP is
equalized odds, which appeared in Hardt et al. (2016) and Zafar et al. (2017).
Definition 2.7 (equalized odds (EO) Hardt et al. (2016)). A prediction yÃÇ of
y ‚àà Y satisfies equalized odds with respect to protected attribute a and outcome
y if
L(yÃÇ | a = a,y = y) = L(yÃÇ | a = a‚Ä≤,y = y) for any a, a‚Ä≤ ‚àà A and y ‚àà Y.
In terms of CP, EO is equivalent to the prediction yÃÇ satisfying parity with
respect to the protected attributed a conditioned on the outcome y. In other
words, EO requires the individuals with the same y but differing a to be treated
CONDITIONAL PARITY 5
equally. If both y and yÃÇ are binary, then in standard terminology, EO means that
the probabilities of false alarms and the detection probabilities are the same under
all possible values of a. Note that typically the optimal ROC curve depends on
the value of a, and oftentimes, we sacrifice some efficiency to achieve EO through
randomization Hardt et al. (2016).
Example 2.8 (Example 2.6 continued). In the War on Drugs example, yÃÇ is
whether an individual is charged, a is an individual‚Äôs race, and y may be whether
an individual consumes cannabis. If there is a discrepancy between the prevalence
of cannibis consumption among African and Anglo Americans, then EO is more
suitable notion of non-discrimination in law enforcement. Since y depends on a,
even perfect prediction yÃÇ = y violates DP, but it is hardly discriminatory for law
enforcement to charge anyone who consumes cannabis with a misdemeanor. On
the other hand, it is easy to check that the perfect predictor satisfies EO.
In some applications, one of the outcomes y ‚àà Y is considered ‚Äúadvantaged‚Äù.
For example, consider the use of historical repayment data to predict default. If
the historical data contains biases against minority groups, the prediction system
may echo the bias in its predictions. A possible relaxation of EO is to require
people who will not default to have equal chance of getting a loan, regardless of
their race.
Definition 2.9 (equal opportunity Hardt et al. (2016)). Let y = 1 be the
‚Äúadvantaged‚Äù outcome. A prediction yÃÇ satisfies equalized opportunity with respect
to protected attribute a and outcome y if
L(yÃÇ | a = a,y = 1) = L(yÃÇ | a = a‚Ä≤,y = 1) for any a, a‚Ä≤ ‚àà A.
It is easy to see how equalized odds leads to the more general notion of CP.
The key idea of comparing segments of the population that share discriminatory
attributes but differ in the protected attribute is clear. In classification, there is a
natural discriminatory attribute: the outcome y. However, it is worth considering
other ways of segmenting the population, even in supervised learning.
Example 2.10 (gender bias in UC Berkeley admissions Bickel, Hammel and
O‚ÄôConnell (1977)). In the autumn of 1973, the graduate division of UC Berkeley
admitted 44% of male applicants but only 35% of female applicants, prompting
allegations of gender bias in the admissions process. However, adjusting the ad-
missions outcome by department reveals a ‚Äúsmall but statistically significant bias
in favor of women‚Äù. Bickel, Hammel and O‚ÄôConnell (1977) concluded that women
tended to apply to highly competitive departments, which admit a smaller percent-
age of applicants, while men tended to apply to less competitive departments. In
this example, including department as a discriminatory attribute leads to a qual-
itatively different conclusion.
As an aside, this example also shows that CP generally does not imply DP.
Even if the admission rates of male and female applicants are identical in all
departments, the admission rates to the graduate division may still differ if male
and female applicants apply to departments at different rates. Conversely, even
6 RITOV, SUN, ZHAO
if the admission rates of male and female applicants to the graduate division are
identical, the admission rates to each department may differ. This reveals another
problem of DP: it permits disparate treatment within segments of the population
as long as the disparities ‚Äúcancel out‚Äù on average. Although this is rare in practice,
we point it out to emphasize CP and DP are generally incomparable.
Finally, to highlight the generality of CP, we describe an application of CP in
representation learning. In machine learning, feature or representation learning
is the task of learning a transformation of raw data to a feature vector that is
amenable to machine learning algorithms. By letting x ‚àà Rd be the learned fea-
ture vector, CP readily leads to a notion of non-discrimination in representation
learning:
L(x | a = a, z = z) = L(x | a = a‚Ä≤, z = z) for any a, a‚Ä≤ ‚àà A and z ‚àà Z.
As we shall see, this notion of non-discrimination has been implicitly used in
natural language processing (NLP).
To wrap up, we describe a post-processing method that returns a new feature
vector that satisfies CP. To keep things simple, we assume x ‚àà Rd, a ‚àà Rk1 , and
z ‚àà Rk2 are jointly Gaussian. Without loss of generality, let
T = xT ‚àí zTB ‚àí aTŒì,
where B ‚àà Rk2√ód and Œì ‚àà Rk1√ód are chosen so that E
[
 | z,a
]
= 0. Rearranging,
we have
xT = aTB + zTŒì + T .
A new feature vector x‚Ä≤ that satisfies x‚Ä≤ ‚ä• a | z is
x‚Ä≤ = (Id ‚àí PB)x, PB = BT (BT )‚Ä†.
One way to estimateR(BT ) is to select a subset of feature vectors that are similar
in z and compute their principal components. This is essentially the approach
proposed by Bolukbasi et al. (2016) to remove gender bias in word embeddings.
Example 2.11 (debiasing word embeddings (Bolukbasi et al., 2016)). A word
embedding is a representation of words by vectors in Rd. Word embeddings en-
able machine learning algorithms to reason semantically by performing arithmetic
operations on the word embeddings; eg.
grandfather ‚àíman + woman = grandmother.
They are learned from text corpus and inherit implicit biases in the texts. For
example, according to the the popular word2vec embedding, which is trained on a
corpus of Google News articles, we have
engineer ‚àíman + woman = homemaker.
To remove gender bias in word embeddings, Bolukbasi et al. (2016) propose a
method that identifies a gender subspace and projects the embedding onto the
orthocomplement of the gender subspace to obtain a debiased word embedding.
To identify the gender subspace, the method takes pairs of words whose meanings
differ only in gender (eg. (actor, actress), (father, mother)) and estimates the
principal compoments of the pairwise differences.
CONDITIONAL PARITY 7
By the invariance of CP under post-processing, the output of a machine learn-
ing algorithm based on features that satisfy CP inherits the property. This sug-
gests using non-discriminatory features as a simple approach to eliminating bias
in machine learning algorithms.
2.2 Counterfactual notions of non-discrimination
In order to work with counterfactuals, we must impose some modeling assump-
tions on the data generating process. In the rest of this subsection, we assume
the data is generated by a structural equations model (SEM). A SEM consists
of (i) a set of random variables, (ii) a set of (deterministic) equations that assign
values to some random variables, (iii) a probability distribution that assigns val-
ues to the rest of the variables. The variables whose values are assigned by the
probability distribution are called exogenous.
SEM‚Äôs are conveniently represented as directed acyclic graphs (DAG). The
nodes represent random variables, and the edges represent direct causal relation-
ships between variables: there is an edge from node i to node j if the equation
that assigns value to variable j takes variable i as input. The nodes that have no
parents represent the exogenous variables.
To sample from an SEM, we start by assigning values to the root nodes by
sampling from the probability distribution and recursively assign values to the
other nodes by the equations. Thus the nodes whose values are assigned by equa-
tions are random variables on the probability space ‚Äúgenerated by‚Äù the exogenous
variables. In this setting, counterfactuals are defined as random variables whose
values are assigned by a modified SEM, where the equations and/or the prob-
ability distribution are modified according to the premise of the counterfactual.
We wrap up our brief overview of counterfactuals with an example and refer to
Pearl, Glymour and Jewell (2016), Chapter 4 for further details.
Example 2.12. Consider the intervention a‚Üê a and the counterfactual ya‚Üêa
in the SEM depicted in Figure 1a. The counterfactual is the counterpart of y in
the modified SEM depicted on the right of Figure 1b, in which the equation that
assigns the value of a is replaced by the equation a = a. We see that the value of
ya‚Üêa ultimately depends on the values of the exogeneous variables in the SEM,
making it a random variable on the same probability space as y. Thus it is pos-
sible to evaluate ‚Äúcross-SEM‚Äù probabilities such as L(ya‚Üêa | y = y). We remark
that this SEM formalism allows us to study the effects of more sophisticated in-
terventions such as a ‚àº Pa (cf. Figure 1c).
In the rest of this subsection, we describe two counterfactual notions of non-
discrimination. The first was proposed recently by Kusner et al. (2017), while
the second is suggested by CP. To keep things simple, we specialize to supervised
learning and focus on prediction.
Definition 2.13 (counterfactual fairness (CF) Kusner et al. (2017)). A pre-
diction yÃÇ is counterfactually fair with respect to sensitive attribute a in light of
evidence {e = e} iff
(2.1) L(yÃÇa‚Üêa | e = e) = L(yÃÇa‚Üêa‚Ä≤ | e = e) for any a, a‚Ä≤ ‚àà A.
If (2.1) holds for all e ‚àà E, yÃÇ is counterfactually fair with respect to sensitive
attribute a in light of evidence e.
8 RITOV, SUN, ZHAO
u
a z
y
(a)
u
a za‚Üêa
ya‚Üêa
(b)
u
aa‚àºPa za‚àºPa
ya‚àºPa
(c)
In Definition 2.13, e is the evidence we observe in the real world. Although it
plays the part of z in CP, we call it evidence and denote it by e to emphasize it
is observed. To see that CF is an instance of CP, let yÃÇa, aa be the counterparts
of yÃÇ, a in a modified SEM, where the step that assigns value to a is replaced by
a ‚àº unif(A), and note that (2.1) is equivalent to
(2.2) L(yÃÇa | e = e,aa = a) = L(yÃÇa | e = e,aa = a‚Ä≤) for any a, a‚Ä≤ ‚àà A,
We remark that the law of the intervention is unimportant because we condition
on the value of a. We pick a ‚àº unif(A) to keep things concrete.
The notion of CF is best illustrated by the following case on employment dis-
crimination. In (1996), the judges wrote ‚Äúthe central question in any employment-
discrimination case is whether the employer would have taken the same action
had the employee been of a different race (age, sex, religion, national origin, etc.)
and everything else had been the same‚Äù. In other words, to ascertain whether
discrimination occurred, the judges compared the employee with his counterpart
in a counterfactual world, rather than a similar employee in the real world.
We remark that it may not be possible to follow the judges directive literally
and keep all other attributes the same: the intervention a ‚Üê a may propagate
in the modified SEM and lead to discrepancies with the evidence. For example,
consider a female employee who is homosexual. In a counterfactual world where
she is male, it is not possible to keep both her sexual orientation and the gender
she is attracted the same as hers in the real world.
As we saw, CF is an instance of CP where we segment the population by
observable evidence. A related notion of non-discrimination is equalized coun-
terfactual odds (ECO): it is an instance of CP that segments the population by
counterfactual attributes. It is motivated by Example 2.14.
Example 2.14. Consider a system that predicts a driver‚Äôs accident risk from
his or her driving record. The prediction yÃÇ depends directly on a driver‚Äôs driving
record z, which in turn depends on the driver‚Äôs driving ability u. Driving ability
also directly affects a driver‚Äôs accident risk y and whether he or she is disabled
a (poor drivers tend to get into accidents, which cause disabilities). Figure 2 is a
DAG that depicts the functional dependencies among the variables.
This example does not satisfy EO: the path a ‚Üê u ‚Üí z ‚Üí yÃÇ between a and yÃÇ
is not blocked. However, yÃÇ is intuitively non-discriminatory: there is only depen-
dence between a and yÃÇ because driving ability is a parent of disability and driving
CONDITIONAL PARITY 9
u
za y
yÃÇ
Fig 2: SEM of accident risk prediction (Example 2.14)
record. the prediction yÃÇ has no causal dependence on a does not penalize good
drivers that happen to be disabled.
We see that EO is too stringent a condition in this scenario. It not only pro-
hibits the prediction from treating disabled drivers differently because of their dis-
ability, but also prohibits the prediction from happening to put disabled drivers in
an disadvantaged position due to the presence of a confounder. In this scenario,
disabled people happen to have worse driving records because driving ability affects
one‚Äôs driving record and causes disability.
Example 2.14 shows that EO is too stringent because it prohibits probabilistic
dependence between yÃÇ and a, which may arise due to confounding. The notion of
equalized counterfactual odds is an amendment of EO that only prohibits causal
relationships between yÃÇ and a.
Definition 2.15 (equalized counterfactual odds (ECO)). A prediction yÃÇ of
y ‚àà Y satisfies equalized counterfactual odds with respect to protected attribute a
conditioned on ya = y iff
(2.3) L(yÃÇa | ya = y,aa = a) = L(yÃÇa | ya = y,aa = a‚Ä≤) for all a, a‚Ä≤ ‚àà A.
If (2.3) holds for all y ‚àà Y, we say yÃÇ satisfies equalized counterfactual odds with
respect to a.
In a nutshell, ECO is EO on a modified SEM, in which the step that assigns
value to a is replaced by a ‚àº Pa. The graph of the modified SEM is identical
to that of the original SEM, except all the edges that point to a are removed.
This removes all back door paths between yÃÇ and a, which typically represent
the effects of confounders. Thus ECO only prohibits probabilistic dependence
between yÃÇ and a in the original SEM through front door paths. This leads to a
simple way of verifying ECO.
Lemma 2.16. A prediction yÃÇ of y satisfies ECO with respect to protected
attribute a if any front door paths from a to yÃÇ are blocked by y.
ECO is also closely related to CF: both compare the law of the counterfactual
prediction yÃÇa on segments of the population. ECO segments the population by
the counterfactual target ya, while CF segments the population by (observable)
10 RITOV, SUN, ZHAO
u
za yÃÇ
Fig 3: SEM of priest hiring process (Example 2.17)
evidence e. In practice, CF is a fairly stringent notion of non-discrimination. As
Kusner et al. (2017) point out, there are instances in which perfect prediction
does not satisfy CF. On the other hand, perfect prediction always satisfies ECO.
To wrap up, we present another example that highlights the difference between
the two notions.
Example 2.17. Consider an SEM of a church‚Äôs priest hiring process. The
church‚Äôs hiring decision yÃÇ = 1{z ‚â• 1.8} depends on an applicants score z = au,
where u ‚àº unif(0, 2) is the applicant‚Äôs propensity for priest work and a ‚àà {0, 1} is
whether the applicant is Christian. Figure 3 depicts an SEM of the priest hiring
process.
Consider an atheist applicant whose talents are well-suited to priest work (eg.
charismatic, persuasive, u = 1.9). He applied for the position, but was rejected.
Since he would have been hired if he was a Christian, the hiring process is not
counterfactually fair with respect to a in light of evidence z. Graphically, condi-
tioning on z in the unmodified SEM does not block the path between aa and yÃÇa
in the graph of the modified SEM. On the other hand, the hiring process clearly
satisfies ECO: z blocks the only front door path between a and yÃÇ in the graph of
the (unmodified) SEM.
Before moving on, we mention a few recently proposed counterfactual notions
of non-discrimination. Zhang, Wu and Wu (2016) and Nabi and Shpitser (2017)
formalize discrimination as the presence of path specific effects (cf. Pearl (2009),
¬ß4.5.3). Although path-specific notions of non-discrimination are also instances
of CP, we skip the details here. Kilbertus et al. (2017) addresses the difficulty
of modeling and determining the effect of intervening on protected attributes by
considering non-discrimination with respect to proxies of protected attributes.
To wrap up, we cite a few related works on non-discrimination in machine
learning. DP as a notion of non-discrimination was studied in Zemel et al. (2013).
Friedler, Scheidegger and Venkatasubramanian (2016) extends the notion of in-
dividual fairness to distinguish between constructs, which are unobservable at-
tributes (eg. intelligence), and observations (eg. score on IQ test), which are prox-
ies of constructs that enter into the algorithm. Berk et al. (2017) reviews various
notions of non-discrimination in the criminal justice system.
3. CONDITIONAL PARITY BY RANDOMIZATION
In supervised learning, we observe realizations of (a, s,y), where a ‚àà {0, 1}
is the protected attribute, s ‚àà Rd is a score, y is the outcome. In general, s
is dependent on a. If we wish to obtain a prediction that does not depend on
the protected attribute we have to sacrifice some efficiency and use a randomized
CONDITIONAL PARITY 11
procedure. In this section we consider the construction of a (randomized) decision
rule yÃÇ = yÃÇ(s,a) such that L(yÃÇ | a = a,y = y) does not depend on a.
Assume for simplicity that s is discrete. In that case let fya be the probability
vector corresponding to L(s | a = a,y = y). A non-discriminatory randomization
is a pair of Markov kernels, K0,K1 ‚àà Rk√ók1 satisfying
fy1K1 = fy0K0, y ‚àà {0, 1}
K0(i, j),K1(i, j) ‚â• 0, i = 1, . . . , k, j = 1, . . . , k1
k1‚àë
j=1
Km(i, j) = 1, i = 1, . . . , k,m = 0, 1.
(3.1)
The minor difficulty is due to the fact that the conditional density given y should
be checked, while the randomization cannot depend on y which is unobserved at
the time of the randomization.
Lemma 3.1. In general, we need to randomize the score of both categories to
achieve EO.
Proof. The lemma follows from the fact that a Markov kernel is a contraction
in two measures, and in general they are unrelated. Consider two sets of densities
such that ‚Äñf10‚àí f00‚Äñ1  ‚Äñf11‚àí f01‚Äñ1, but on a small interval, small enough such
that it has a little contribution to the L1 distance, f10(x)/f00(x) f11(x)/f01(x).
If it was that fy0K = fy1
‚Äñf11 ‚àí f01‚Äñ1 =
‚àë
j
‚à£‚à£‚à£‚àë
i
(
f10(i)‚àí f00(i)
)
K1(i, j)
‚à£‚à£‚à£
‚â§
‚àë
i
‚à£‚à£f11(i)‚àí f01(i)‚à£‚à£‚àë
j
K(i, j) = ‚Äñf11 ‚àí f01‚Äñ1.
which contradict the assumption. On the other hand, if it was that fy1K = fy0
max
j
f10(j)
f00(j)
= max
j
‚àë
i f11(i)K1(i, j)‚àë
i f01(i)K1(i, j)
= max
j
‚àë
i
f11(i)
f01(i)
f01(i)K1(i, j)‚àë
i f01(i)K1(i, j)
‚â§ max
i
f11(i)
f01(i)
,
which contradict the other assumption. Hence neither it is that fy0K = fy1 nor
that fy0K = fy1.
The set (3.1) has 2(k + k1 ‚àí 1) equality constraints with 2kk1 undefined pa-
rameters. It always has the trivial solution. Adding a linear cost function, eg.
(3.2)
‚àë
m
‚àë
i
‚àë
j
ci|j ‚àí j(i)|Œ±Km(i, j),
12 RITOV, SUN, ZHAO
(a) (b)
Fig 4: (a) The conditional densities given y and a. (b) P (yÃÇ = 1|z) vs. z. Among
two candidates with the same latent ability, the one who comes from the weaker
group gets on the average a smaller Bayes decision.
for example j(i) = dik1/ke, turns the feasibility problem into a linear program.
To avoid sparse solutions, we add another set of constraints
(3.3)
‚àë
j
jKm(i, j) is monotone non-decreasing in i for m = 1, 2.
That is, the rows of Km are increasing in the mean.
Example 3.2. Consider the following model in which there is a never ob-
served latent variable z
a ‚àà {0, 1}
z | a = a ‚àº N(¬µza, œÑ2z )
s | a = a, z = z ‚àº N(z + ¬µsa, œÉ2s)
y ‚àà {0, 1}
P (y = 1 | a, s, z) = pz(z).
In words z is the ability of the random subject, the two groups are of different
ability. Let assume that ¬µz, ¬µs ‚â• 0 We have a noisy observations s which is biased
in favor of the stronger group. Since
z | a = a, s = s ‚àº N( œÉ
2
s
œÉ2s + œÑ
2
z
a¬µz +
œÑ2z
œÉ2s + œÑ
2
z
(s‚àí a¬µs),
œÉ2sœÑ
2
z
œÉ2s + œÑ
2
z
),
if we have ¬µs = (œÉ
2
s/œÑ
2
z )¬µz then the Bayes estimator of z given a, s is the same
for the two groups. In reality, biasing the score of the stronger group is not done
explicitly. However, in order to improve the Bayes estimator, a culturally depen-
dent criteria may be introduced, which in effect biases the score. This situation
may seem fair. The score (e.g., the SAT) is used in the same way independently
of the attribute and it is the optimal way to use the score as it is Bayes. Removal
of the bias would result in an inferior selection procedure.
However, this is a discriminatory policy by other criteria. In Figure 4 we
present the situation. The score distributions of the two groups are different, but
worse, between two subjects with the same latent ‚Äúability‚Äù, z, the subject from the
stronger group gets, on the average, a higher score s.
CONDITIONAL PARITY 13
Fig 5: The Bayes estimator and the solution of the linear program non-
discrimantory algorithm.
Table 2
The (minimal) impact of the type of decision on the Breir score
Decision a = 0 a = 1
Bayes decision 0.1898 0.1820
Bayes decision based on 2 categories 0.2064 0.1990
The non-discrimantory decision 0.2092 0.2001
The minimizer of (3.2) subject to the (3.1) and (3.3) constraints is presented
in Figure 5. The Breir score is presented in Table 2.
Finally, in Figure 6 we present the output distribution of the Markov kernel
when k1 = 500.
The situation is more complicated when the outcome is more than binary
valued, or continuous. However, it is simple enough if the outcome and raw pre-
diction are jointly normal conditioned on the protected attribute. Consider, for
example, the situation of Example 3.2. The concluding model is that s | y,a ‚àº
N (¬µa +Aay,Œ£a).
Lemma 3.3. Suppose s ‚àà Rns, y ‚àà Rny and Aa ‚àà Rns√óny , a ‚àà {0, 1}, are
(a) (b)
Fig 6: The output of the linear program. (a) The conditional density given y;
(b) The expected value of the output given s conditional on a and the Bayes
estimator, which is independent of a.
14 RITOV, SUN, ZHAO
full rank. Then, without loss of generality, we can assume ¬µa = 0, a = {0, 1},
and A0 = A1. A minimal randomized procedure that equates the conditional dis-
tribution of s is given by yÃÇ|a, s = N (s, Ta), where Ta =
‚àë
(a/2‚àí1)Œªi<0 ŒªiŒæiŒæ
‚Ä≤
i, and
(Œª1, Œæ1), . . . , (Œªns , Œæns) is an orthonormal eigen-system of Œ£1 ‚àí Œ£0.
Proof. We can always transform s when a = 0 by the transformation
s‚Üí
{
A1A
‚Ä†
0(s‚àí ¬µ0), if a = 0
s‚àí ¬µ1 if a = 1,
which equate the conditional mean of s under a ‚àà {0, 1}.
Now, since T0 ‚àí T1 = Œ£1 ‚àí Œ£0, L(yÃÇ | y,a = a) does not depend on a. Finally,
since A1 has a full rank, E
(
K1(s, ¬∑)‚àíK0(s, ¬∑) | y) = 0, iff K1 ‚àíK0 = 0 (the shift
is a complete sufficient statistics in the multivariate normal distribution. This is
achieved by the randomization given above.
4. TESTING CONDITIONAL PARITY
In this section, we describe a kernel-based approach to testing CP developed
by Zhang et al. (2012). We begin by characterizing the conditional independence
condition x ‚ä• a | z in terms of cross-covariance operators. Let kx, ka, and kz be
positive definite kernels on X , A, and Z respectively and Hx, Ha, and Hz be the
respective reproducing kernel Hilbert spaces (RKHS). Throughout this section,
we assume the kernels satisfy
E
[
kx(x,x)
]
<‚àû, E
[
ka(a,a)
]
<‚àû, E
[
kz(z, z)
]
<‚àû.
For any probability distribution on X , its RKHS embedding is the unique ¬µx ‚àà
Hx such that
„Äà¬µx, f„Äâx = E
[
f(x)
]
for any f ‚àà Hx
for any f ‚àà Hx. It is well-defined because the assumptions on kx imply f ‚Üí
E
[
f(x)
]
is a bounded linear functional. By the reproducing property, we see that
¬µx has the explicit form
¬µx(x) = „Äàkx(x, ¬∑), ¬µx„Äâx = E
[
kx(x, x)
]
.
The cross-covariance operator of (x,a) is an operator from Ha to Hx such that
„Äàf,Œ£x,ag„Äâx = cov
[
f(x), g(a)
]
for any f ‚àà Hx and g ‚àà Ha.
It is the functional analogue of the covariance matrix a pair of random vectors.
In terms of the kernel and the RKHS embeddings of the marginal distributions
of x and a, it has the form
„Äàf,Œ£x,ag„Äâx = E
[
„Äàf, kx(x, ¬∑)‚àí ¬µx„Äâx„Äàka(a, ¬∑)‚àí ¬µa, g„Äâa
]
.
Letting f = k(x, ¬∑), we see that Œ£x,ag is
(Œ£x,ag)(x) = „Äàk(x, ¬∑),Œ£x,ag„Äâx = E
[
(kx(x, x)‚àí ¬µx(x))
(
g(a)‚àí E
[
g(a)
])]
.
CONDITIONAL PARITY 15
The cross-covariance operator of (x,x) is a positive self-adjoint operator and is
called the covariance operator of x. The conditional cross-covariance operator of
(x,a) given z is
Œ£x,a|z = Œ£x,a ‚àí Œ£x,zŒ£‚àí1z,zŒ£z,a.
Under some technical conditions, Fukumizu et al. (2008) show that it is an oper-
ator from Ha to Hx such that
„Äàf,Œ£x,a|zg„Äâx = E
[
cov
[
f(x), g(a) | z
]]
.
Before we state the functional characterization of conditional independence,
we define some additional notation. The tensor product Hx ‚äó Ha is an RKHS
equipped with the inner product
„Äàf ‚äó g, x‚äó y„Äâ = „Äàf, x„Äâx„Äàg, y„Äâa.
We extend this inner product to all of Hx ‚äó Ha by bilinearity. We see that the
representer of evaluation in Hx ‚äóHa is the outer product of the representers of
evaluation in Hx and Ha:
„Äàk(x, ¬∑)‚äó k(y, ¬∑), f ‚äó g„Äâ = f(x)g(y),
and the kernel is the pointwise product of kx and ky:
(kx ¬∑ ky)((x1, y1), (x2, y2)) = „Äàk(x1, ¬∑)‚äó k(y1, ¬∑), k(x2, ¬∑)‚äó k(y2, ¬∑)„Äâ
= kx(x1, x2)ky(y1, y2).
We are ready to state the functional characterization of conditional independence
by Fukumizu et al. (2008).
Theorem 4.1 (Fukumizu, Bach and Jordan (2004); Fukumizu et al. (2008)).
Let kx,z := kx ¬∑ kz be a kernel on X √ó Z and Hx ‚äóHz be its RKHS. As long as
kx,z ¬∑ka is a characteristic kernel 2 on X √óZ √óA and Hz‚äïR is dense in L2(Pz),
where ‚äï denotes direct sum and R is the space of constant functions, we have
Œ£(x,z),a|z = 0 ‚áê‚áí x ‚ä• a | z.
The non-trivial implication in Theorem 4.1 is the ‚Äúonly if‚Äù implication. If
Œ£(x,z),a|z = 0, we have
0 = E
[
cov
[
f(x)h(z), g(a) | z
]]
= E
[
cov
[
f(x), g(a) | z
]
h(z)
]
for any h ‚àà Hz, which implies cov
[
f(x), g(a) | z
]
= 0 as long as Hz is rich enough.
The assumption Hz + R is dense in L2(Pz) ensures Hz is rich enough.
In light of Theorem 4.1, a natural test statistic is the Hilbert-Schmidt (HS)
norm of a plug in estimator of the conditional cross-covariance operator. Let the
empirical cross-covariance operator of (x,a) be
Œ£ÃÇx,a :=
1
n
n‚àë
i=1
kx(xi, ¬∑)‚äó ka(ai, ¬∑)‚àí ¬µÃÇx ‚äó ¬µÃÇa,
2We call kernel is characteristic if the RKHS embedding P‚Üí EP
[
k(x, ¬∑)
]
is injective. In other
words, EP
[
f(x)
]
= EQ
[
f(x)
]
for all f ‚àà H implies P = Q.
16 RITOV, SUN, ZHAO
where ¬µÃÇx :=
1
n
‚àën
i=1 kx(xi, ¬∑) (resp. ¬µÃÇa). The empirical conditional cross-covari-
ance operator is
Œ£ÃÇ(x,z),a|z := Œ£ÃÇ(x,z),a ‚àí Œ£ÃÇ(x,z),z(Œ£ÃÇz,z + ŒªIz)‚àí1Œ£ÃÇz,a,
where Œª > 0 is a regularization parameter. It is possible to express its HS norm
in terms of the kernel matrices Gx, Ga, Gz, where
[
Gx
]
i,j
= kx(xi,xj) (resp.
Ga, Gz).
Lemma 4.2. We have
‚ÄñŒ£ÃÇ(x,z),a|z‚Äñ2HS =
1
n2
tr(Kx,zKa)‚àí
2
n2
tr(Kx,zKz(Kz + ŒªMn)
‚Ä†Ky)
+
1
n2
tr((Kz + ŒªMn)
‚Ä†KzKx,zKz(Kz + ŒªMn)
‚Ä†Ky),
where Kx,z = Kx ¬∑Kz.
Zhang et al. (2012) show that the test statistic is asymptotically a mixture of
independent œá21 random variables
n‚ÄñŒ£ÃÇ(x,z),a|z‚Äñ2HS
d‚Üí
‚àë‚àû
i=1 Œªiz
2
i , , zi
i .i .d .‚àº N (0, 1),
and proposed two ways to approximate the asymptotic distribution. We refer to
their paper for the details.
5. DO MINORITY NEIGHBORHOODS PAY HIGHER INSURANCE
PREMIUMS?
It has been observed that drivers from predominantly minority zip codes are
often charged higher insurance premiums than drivers from non-minority zip
codes (Feltner and Heller, 2015). The insurance industry has justified the higher
premiums by arguing that drivers from minority neighborhoods have higher risk
of accidents. In this section, we examine the claim of the insurance industry using
the proposed framework and the data obtained by Jeff Larson (2017).
Before presenting the results, we briefly describe the data, which was obtained
by Jeff Larson (2017) from Quadrant Information Services and S&P Global Inc.
It consists of 98,441 insurance quotes for drivers fitting a single profile: A 30-
year-old female teacher with a bachelor‚Äôs degree, excellent credit, no accidents
or moving violations, and who is purchasing a policy for $100,000 of property
damage coverage and $100,000 to cover medical bills per person up to $300,000
per accident for the first time. She drives a 2016 Toyota Camry, has a 15 mile
daily commute, and drives 13,000 miles a year. The quotes are associated with
the zip code of the driver, and by fixing the profile and letting zip code change,
we control for factors outside of geography.
The risk of drivers in a zip code is measured by the ratio of dollars paid out
for liability claims to the number of insured cars. In California, this ratio is
called average loss and is a measure of the cost to the insurer of insuring a
car in a zip code. Ideally, we would have data on the claims from drivers that
fit aforementioned profile, but, unfortunately, we do not have such fine-grained
data. We refer to Jeff Larson (2017) for further details regarding the data.
CONDITIONAL PARITY 17
Table 3
Table of p-values for 9 major insurance companies in California
Company H1 p-value H2 p-value
Allstate < 0.001 < 0.001
Berkshire Hathaway 0.488 0.456
Farmers < 0.001 < 0.001
Liberty Mutual < 0.001 < 0.001
Mercury 0.925 0.648
Nationwide < 0.001 < 0.001
Progressive < 0.001 0.365
State Farm < 0.001 < 0.001
USAA < 0.001 < 0.001
We tested two hypotheses in California: the quotes were independent of the
percent minority population given the risk in the associated zip codes (H1); the
quotes were independent of whether the associated zip code is underserved given
the risk (H2). The California Department of Insurance defines ‚Äúunderserved‚Äù zip
codes as zip codes where (i) the fraction of uninsured drivers exceeds the statewide
average by at least 10%, (ii) the per capita income is below the statewide me-
dian, (iii) minorities are at least two-thirds of the population. Among the 1,648
Californian zip codes recorded in the data, there are 145 such underserved zip
codes. The results are reported in Table 3.
We examine the data on Progressive Group more closely because there is a
discrepancy between the results of the test of H1 (its quotes are independent of
the percent minority population given the risk) and that of H2 (its quotes are
independent of whether the associated zip code is underserved given the risk).
To comprehend this discrepancy, we redefine underserved zip codes as zip codes
where the percent minorities population is at least q for various values of q and
test H2 again. The results are reported in Table 4. We see that although the
percentage of minority population, as a continuous variable, does not pass the
conditional independence test at 0.05 level, the minority indicator derived from
it sometimes does.
Mathematically, the discrepancy between the tests is unsurprising: x 6‚ä• a does
not generally imply f(x) 6‚ä• y. However, its practical implication is noteworthy
because it exposes one problem of thresholding a continuous protected attribute.
Thresholding tolerates discrimination within subgroups (discrimination within
the minority/non-minority subgroup), as long as there is no discrimination across
different subgroups. We also note that the p-value when q = 0.6 in 4 is quite
different from that for H1 in 3. This is because only 33% of the zip codes where
minority percentage exceeds 60% are truly underserved.
In Illinois and Texas, we tested the hypothesis that the quotes were indepen-
dent of the percent minority population given the risk in the associated zip codes.
In Illinois, we excluded the zip codes in Chicago because Chicago has a law that
require insurers to charge the same price for bodily injury insurance. The results
are reported in Table 5.
Finally, we apply the randomization procedure described in Section 3 to adjust
the premium. We concentrate on one insurer (Garrison Property and Casualty
Insurance Company) and only on the property damage policy premium. There
are two protected group. The white-non-Hispanics and the rest. However, this
18 RITOV, SUN, ZHAO
Table 4
Table of p-values for Progressive Group
Threshold (q) p-value
0.1 0.297
0.2 0.778
0.3 0.698
0.4 0.002
0.5 < 0.001
0.6 0.010
0.7 0.110
0.8 0.061
0.9 0.009
Table 5
Table of p-values for 9 major insurance companies in Illinois and Texas
Insurance group Illinois Texas
Allstate < 0.001 < 0.001
American Family < 0.001
Auto Owners < 0.001
Berkshire Hathaway < 0.001 < 0.001
Country Financial < 0.001
Erie < 0.001
Farmers < 0.001 < 0.001
Hartford Fire < 0.001
Liberty Mutual < 0.001 < 0.001
Metropolitan < 0.001
Nationwide < 0.001
Pekin < 0.001
Progressive < 0.001 < 0.001
State Farm < 0.001 < 0.001
Traverlers < 0.001
USAA < 0.001 < 0.001
CONDITIONAL PARITY 19
(a) (b)
Fig 7: Car insurance premium distribution before and after correction. The red
broken line is for the white-non-Hispanic group. The blue full line are the rest.
attribute is not given (to the insurer and in the data) and is derived from the
proportions of the the two groups within any zip-code area.
Let x be the premium in the zip code, z the state defined risk and q the pro-
portion of whites (non-Hispanic) within the zip code area. Linear regression of
x on z, q, and q ¬∑ z finds all coefficients to be significant at the 0.001 level. To
proceed we make the (clearly unrealistic) assumption that all zip code areas have
the same number of car insured by the discussed insurer. Under this assumption
the distribution of the excess premiums paid by the two group (after controling
for the risk) is plotted in Figure 7(a). In this semi-artificial setup, a white cus-
tomer pays, on the average 1.54 USD less than predicted, while a minority group
members pays 1.65 USD more with standard deviations equal to 25.7 and 29.2
USD respectively.
Since the group membership is concealed from the insurer, this cannot be cor-
rected directly. We suggest that in such a situation a cross-subsidization between
zip code areas, where the premium would have a component which is proportional
to the deviation of q from its mean and a randomized component proportional
to q. Practically, randomization can be achieved by making the premium depend
slightly on hardly relevant information about the customer or the location. In
Figure 7(b) we present the result of this process. Both the white and non-white
groups have the same mean and standard deviation (0.0 and 29.8 USD respec-
tively).
6. SUMMARY AND DISCUSSION
We identified conditional parity as a general notion of non-discrimination in
machine learning. It formalizes the implicit comparison in claims of discrimina-
tion and is applicable beyond supervised learning. It also includes many recently
proposed notions of non-discrimination, including counterfactual ones.
The main takeaway for practitioners is the necessity of specifying not only
protected attribute but also discriminatory ones in any rigorous notion of non-
discrimination. Ignoring the discriminatory attributes may lead to ambiguous
definitions. Consider the recent debate on whether no sex-based discrimination
implies no discrimination based on sexual orientation (Thayer, 2017). In Hively
v. Ivy Tech, the majority opinion expressed ‚Äúcommon-sense reality [is] that it
is actually impossible to discriminate on the basis of sexual orientation without
discriminating on the basis of sex‚Äù. However, by letting the gender to which one
20 RITOV, SUN, ZHAO
Table 6
a = female a = male
z = female homosexual
female
heterosexual
male
z = male heterosexual
female
homosexual
male
is attracted to be the discriminatory attribute, we see that it is indeed possible to
discriminate on sexual orientation but not on gender. The ambiguity in the pro-
hibition of sex-based discrimination is in the non-specification of discriminatory
attributes.
Example 6.1. Let a be gender and z be the gender to which one is attracted
to. Intuitively, no discrimination based on the gender requires the segments of the
population on the same row of Table 6 be treated equally, while no discrimination
based on sexual orientation requires the segments on the same column be treated
equally.
Finally, we mention that CP is amenable to statistical analysis. We studied
randomization as a general approach to achieving CP, as well as a kernel-based
approach to check whether the output of a black-box machine learning algorithm
satisfies CP. Most prior work on non-discrimination in machine learning has fo-
cused on designing non-discriminatory machine learning algorithms. However, to
enforce non-discrimination, methods to detect violations are crucial, and we look
forward to developments in future work.
APPENDIX A: PROOF OF AUXILIARY LEMMAS
Proof of Lemma 4.2. To keep things simple, we evaluate ‚ÄñŒ£ÃÇx,a|z‚Äñ2HS instead
of ‚ÄñŒ£ÃÇ(x,z),a|z‚Äñ2HS. To obtain an expression of ‚ÄñŒ£ÃÇ(x,z),a|z‚Äñ2HS, simply replace Kx by
Kx,z = Kx ¬∑Kz. We also abuse notation and denote linear combinations of the
form
‚àën
i=1 Œ±ikx(xi, ¬∑) by XŒ±, where
X =
Ô£ÆÔ£∞ | |kx(x1, ¬∑) . . . kx(xn, ¬∑)
| |
Ô£πÔ£ª
is an ‚Äúinfinite matrix‚Äù. In this notation, we have
Œ£ÃÇx,a =
1
n
n‚àë
i=1
(kx(xi, ¬∑)‚àí ¬µÃÇx)‚äó ((ka(ai, ¬∑)‚àí ¬µÃÇa))
=
1
n
n‚àë
i=1
(X(ei ‚àí 1n1n))‚äó (A(ei ‚àí
1
n1n))
=
1
n
n‚àë
i=1
(XMnei)‚äó (AMnei),
where Mn := In ‚àí 1n1n1
T
n . The (squared) HS norm of the Œ£ÃÇ(x,z),a|z is
(A.1)
„ÄàŒ£ÃÇx,a|z, Œ£ÃÇx,a|z„ÄâHS = „ÄàŒ£ÃÇx,a, Œ£ÃÇx,a„ÄâHS ‚àí 2„ÄàŒ£ÃÇx,y, Œ£ÃÇx,z(Œ£ÃÇz,z + ŒªI)‚àí1Œ£ÃÇz,a„ÄâHS
+ „ÄàŒ£ÃÇx,z(Œ£ÃÇz,z + ŒªI)‚àí1Œ£ÃÇz,a, Œ£ÃÇx,z(Œ£ÃÇz,z + ŒªI)‚àí1Œ£ÃÇz,a„ÄâHS.
CONDITIONAL PARITY 21
For now, we focus on evaluating the first term. Since Œ£ÃÇx,a is a mapping from
a subspace Sa of Ha to an subspace Sx of Hx, we may restrict to the subspaces.
Let {ui}ni=1 be an orthonormal basis of Sa. We have
ui =
n‚àë
j=1
Œ±i,j(ka(ai, ¬∑)‚àí ¬µÃÇa) = A(In ‚àí 1n1n1
T
n )Œ±i = AMnŒ±i,
where Œ±i =
[
Œ±i,1 . . . Œ±i,n
]T
, and
Œ£ÃÇx,aui = (
1
n
‚àën
j=1(XMnej)‚äó (AMnej))(AMnŒ±i)
=
1
n
n‚àë
j=1
((XMnej)‚äó (AMnej))(AMnŒ±j)
=
1
n
n‚àë
j=1
„ÄàAMnej ,AMnŒ±i„Äâa(XMnej).
By the reproducing property, we have
„ÄàAŒ±,AŒ≤„Äâa =
n‚àë
i=1
n‚àë
j=1
Œ±iŒ≤j„Äàka(ai, ¬∑), ka(aj , ¬∑)„Äâa
=
n‚àë
i=1
n‚àë
j=1
Œ±iŒ≤jka(ai,aj)
= Œ±TGaŒ≤,
where Ga is the Gram matrix whose entries are
[
G
]
i,j
= k(ai,aj), for any Œ±, Œ≤ ‚àà
Rn. Thus
Œ£ÃÇx,aui =
1
n
n‚àë
j=1
(eTj MnGaMnŒ±i)(XMnej) =
1
n
XMnGaMnŒ±i =
1
n
XKaŒ±i,
where Ka := MnGaMn is the centered Gram matrix. The first term in (A.1) is
„ÄàŒ£ÃÇx,a, Œ£ÃÇx,a„ÄâHS =
n‚àë
i=1
„ÄàŒ£ÃÇx,aui, Œ£ÃÇx,aui„Äâx
=
1
n2
n‚àë
i=1
„ÄàXKaŒ±i,XKaŒ±i„Äâx,
=
1
n2
Œ±Ti KaGxKaŒ±i
=
1
n2
Œ±Ti KaKxKaŒ±i,
where the third step is a consequence of the reproducing property and the fourth
step is a consequence of R(Ka) ‚äÇ R(Mn). Recall {ui}ni=1 is an orthonormal basis
of Sa:
„Äàui, ui„Äâa = „ÄàAMnŒ±i,AMnŒ±j„Äâa = Œ±Ti KaŒ±j =
{
1 i = j
0 i 6= j
,
22 RITOV, SUN, ZHAO
We see that {K
1
2
aŒ±i}ni=1 is an orthonormal basis of Rn, which implies
„ÄàŒ£ÃÇx,a, Œ£ÃÇx,a„ÄâHS =
1
n2
tr(K
1
2
aKxK
1
2
a ) =
1
n2
tr(KxKa).
By similar calculations, it is possible to show that the second and third terms are
„ÄàŒ£ÃÇx,a, Œ£ÃÇx,z(Œ£ÃÇz,z + ŒªIz)‚àí1Œ£ÃÇz,a„ÄâHS
=
1
n2
tr(KxKz(Kz + ŒªMn)
‚Ä†Ky),
„ÄàŒ£ÃÇx,z(Œ£ÃÇz,z + ŒªIz)‚àí1Œ£ÃÇz,y, Œ£ÃÇx,z(Œ£ÃÇz,z + ŒªIz)‚àí1Œ£ÃÇz,a„ÄâHS
=
1
n2
tr((Kz + ŒªMn)
‚Ä†KzKxKz(Kz + ŒªMn)
‚Ä†Ka).
REFERENCES
Berk, R., Heidari, H., Jabbari, S., Kearns, M. and Roth, A. (2017). Fairness in Criminal
Justice Risk Assessments: The State of the Art. arXiv preprint arXiv:1703.09207.
Bickel, P. J., Hammel, E. A. and O‚ÄôConnell, J. W. (1977). Sex bias in graduate admissions:
Data from Berkeley. Statistics and public policy 113‚Äì130.
Bolukbasi, T., Chang, K.-W., Zou, J. Y., Saligrama, V. and Kalai, A. T. (2016). Man
is to computer programmer as woman is to homemaker? debiasing word embeddings. In
Advances in Neural Information Processing Systems 4349‚Äì4357.
Dwork, C., Hardt, M., Pitassi, T., Reingold, O. and Zemel, R. (2012). Fairness through
awareness. In Proceedings of the 3rd Innovations in Theoretical Computer Science Conference
214‚Äì226. ACM.
Feltner, T. and Heller, D. (2015). High price of mandatory auto insurance in predominantly
African American communities Technical Report, Consumer Federation of America.
Friedler, S. A., Scheidegger, C. and Venkatasubramanian, S. (2016). On the (im) pos-
sibility of fairness. arXiv preprint arXiv:1609.07236.
Fukumizu, K., Bach, F. R. and Jordan, M. I. (2004). Dimensionality reduction for supervised
learning with reproducing kernel Hilbert spaces. Journal of Machine Learning Research 5 73‚Äì
99.
Fukumizu, K., Gretton, A., Sun, X. and SchoÃàlkopf, B. (2008). Kernel measures of condi-
tional dependence. In Advances in neural information processing systems 489‚Äì496.
Hardt, M., Price, E., Srebro, N. et al. (2016). Equality of opportunity in supervised learning.
In Advances in Neural Information Processing Systems 3315‚Äì3323.
Jeff Larson, L. K. S. M. D. H. M. S. K. N.-S. A. C. M. R. Julia Angwin (2017). How
We Examined Racial Discrimination in Auto Insurance Prices. ProPublica.
Jensen, E. L. and Roussell, A. (2016). Field observations of the developing legal recreational
cannabis economy in Washington State. International Journal of Drug Policy 33 96‚Äì101.
Kilbertus, N., Rojas-Carulla, M., Parascandolo, G., Hardt, M., Janzing, D. and
SchoÃàlkopf, B. (2017). Avoiding Discrimination through Causal Reasoning. arXiv preprint
arXiv:1706.02744.
Kusner, M. J., Loftus, J. R., Russell, C. and Silva, R. (2017). Counterfactual Fairness.
arXiv preprint arXiv:1703.06856.
Nabi, R. and Shpitser, I. (2017). Fair Inference On Outcomes. arXiv preprint
arXiv:1705.10378.
Pearl, J. (2009). Causality. Cambridge university press.
Pearl, J., Glymour, M. and Jewell, N. P. (2016). Causal inference in statistics: a primer.
John Wiley & Sons.
Steel, E. and Angwin, J. (2010). On the webs cutting edge, anonymity in name only. The
Wall Street Journal 4.
Thayer, D. (2017). Hively v Ivy Tech Community College of Indiana (No 15-1720): United
States Circuit Court of Appeals for the Seventh Circuit (en banc): Wood CJ, Posner,
CONDITIONAL PARITY 23
Flaum, Easterbrook, Ripple, Rovner, Williams, Hamilton JJ (majority); Posner J (concur-
ring); Flaum J joined by Ripple J (concurring); Sykes J joined by Bauer and Kanne JJ
(dissenting): 4 April 2017. Oxford Journal of Law and Religion.
(1996). Carson v. Bethlehem Steel Corp.
Zafar, M. B., Valera, I., Rogriguez, M. G. and Gummadi, K. P. (2017). Fairness Con-
straints: Mechanisms for Fair Classification. In Artificial Intelligence and Statistics 962‚Äì970.
Zemel, R., Wu, Y., Swersky, K., Pitassi, T. and Dwork, C. (2013). Learning fair represen-
tations. In Proceedings of the 30th International Conference on Machine Learning (ICML-13)
325‚Äì333.
Zhang, L., Wu, Y. and Wu, X. (2016). A causal framework for discovering and removing
direct and indirect discrimination. arXiv preprint arXiv:1611.07509.
Zhang, K., Peters, J., Janzing, D. and SchoÃàlkopf, B. (2012). Kernel-based conditional
independence test and application in causal discovery. arXiv preprint arXiv:1202.3775.

