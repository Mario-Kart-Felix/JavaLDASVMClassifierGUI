IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004 2231
Greed is Good: Algorithmic Results for
Sparse Approximation
Joel A. Tropp, Student Member, IEEE
Abstract—This article presents new results on using a greedy al-
gorithm, orthogonal matching pursuit (OMP), to solve the sparse
approximation problem over redundant dictionaries. It provides
a sufficient condition under which both OMP and Donoho’s basis
pursuit (BP) paradigm can recover the optimal representation of
an exactly sparse signal. It leverages this theory to show that both
OMP and BP succeed for every sparse input signal from a wide
class of dictionaries. These quasi-incoherent dictionaries offer a
natural generalization of incoherent dictionaries, and the cumu-
lative coherence function is introduced to quantify the level of in-
coherence. This analysis unifies all the recent results on BP and
extends them to OMP.
Furthermore, the paper develops a sufficient condition under
which OMP can identify atoms from an optimal approximation of
a nonsparse signal. From there, it argues that OMP is an approx-
imation algorithm for the sparse problem over a quasi-incoherent
dictionary. That is, for every input signal, OMP calculates a sparse
approximant whose error is only a small factor worse than the min-
imal error that can be attained with the same number of terms.
Index Terms—Algorithms, approximation methods, basis pur-
suit (BP), iterative methods, linear programming, orthogonal
matching pursuit (OMP).
I. INTRODUCTION
SOME signals cannot be represented efficiently in anorthonormal basis. For example, neither impulses nor
sinusoids adequately express the behavior of an intermixture
of impulses and sinusoids. In this case, two types of structures
appear in the signal, but they look so radically different that nei-
ther one can effectively mimic the other. Although orthonormal
bases have a distinguished service record in approximation
theory, examples like this have led researchers to enlist more
complicated techniques.
The most basic instrument of approximation projects each
signal onto a fixed -dimensional linear subspace. A familiar
example is interpolation by means of fixed-knot polynomial
splines. For some types of signals, this elementary procedure
works quite well. Later, various nonlinear methods were de-
veloped. One fundamental technique is to project a signal
onto the best linear subspace spanned by elements of a
fixed orthonormal basis. This type of approximation is quite
easy to perform due to the rigid structure of an orthonormal
Manuscript received March 21, 2003; revised June 6, 2004. This work was
supported by a National Science Foundation Graduate Fellowship.
The author was with the Institute for Computational Engineering and Sci-
ences (ICES), The University of Texas at Austin, Austin, TX 78712 USA. He
is now with the Mathematics Department, University of Michigan, Ann Arbor,
MI 48109 USA (e-mail: jtropp@umich.edu).
Communicated by G. Battail, Associate Editor At Large.
Digital Object Identifier 10.1109/TIT.2004.834793
system. In comparison with the linear method, it may yield a
significant improvement in the approximation error [1], [2].
But, as noted, some signals just do not fit into an orthonormal
basis. To deal with this problem, researchers have spent the last
15 years developing redundant systems, called dictionaries,
for analyzing and representing complicated signals. A Gabor
dictionary, for example, consists of complex exponentials
smoothly windowed to short time intervals. It is used for joint
time–frequency analysis [3].
The problem of approximating a signal with the best linear
combination of elements from a redundant dictionary is
called sparse approximation or highly nonlinear approxima-
tion. The core algorithmic question is the following.
For a given class of dictionaries, how does one design a fast
algorithm that provably calculates a nearly optimal sparse
representation of an arbitrary input signal?
Unfortunately, it is quite difficult to answer. At present, there
are two major approaches, orthogonal matching pursuit (OMP)
and basis pursuit (BP). OMP is an iterative greedy algorithm that
selects at each step the dictionary element best correlated with
the residual part of the signal. Then it produces a new approxi-
mant by projecting the signal onto the disctionary elements that
have already been selected. This technique extends the trivial
greedy algorithm that succeeds for an orthonormal system. BP
is a more sophisticated approach that replaces the original sparse
approximation problem by a linear programming problem. Em-
pirical evidence suggests that BP is more powerful than OMP
[4]. The major advantage of OMP is that it admits simple, fast
implementations [5], [6].
A. Major Results
We begin with a résumé of the major results. Fix a (redun-
dant) dictionary of elementary signals, which are called atoms.
A representation of a signal is a linear combination of atoms that
equals the signal. Every signal has an infinite number of distinct
representations over a redundant dictionary. The EXACT-SPARSE
problem is to identify the representation of the input signal that
uses the least number of atoms, i.e., the sparsest one.
Our first result is a sufficient condition for OMP and BP to
solve EXACT-SPARSE. To state the theorem, we need a little nota-
tion. Given an input signal, form a matrix whose columns
are the atoms that make up the optimal representation of the
signal. The pseudoinverse of this matrix is defined as
. The notation indicates the vector
norm, which returns the absolute sum of a vector’s components.
0018-9448/04$20.00 © 2004 IEEE
2232 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004
Theorem A: Suppose that
(ERC)
where the maximization occurs over atoms that do not par-
ticipate in the optimal representation of the signal. It follows
that the sparsest representation of the signal is unique. More-
over, both OMP and BP identify the optimal atoms and their
coefficients.
This result encapsulates Theorem 3.1, Theorem 3.3, and
discussion from Section III-E. Theorem A is essentially the
best possible for OMP (Theorem 3.10), and it is also the best
possible for BP in certain cases (Section III-D). It is remarkable
that (ERC) is a natural sufficient condition for such disparate
techniques to resolve sparse signals. This fact suggests that
EXACT-SPARSE has tremendous structure.
Theorem A would not be very useful without a technique
for checking when the condition (ERC) holds. To that end, we
define the coherence parameter , which equals the maximum
absolute inner product between two distinct atoms. This quantity
reflects how much atoms look alike. A generalization of the
coherence parameter is the cumulative coherence function
which equals the maximum absolute sum of inner
products between a fixed atom and other atoms. If the
cumulative coherence function grows slowly, we say that the
dictionary is quasi-incoherent.
Theorem B: The condition (ERC) holds for every signal with
an -term representation provided that
or, more generally, whenever
Suppose that the dictionary consists of concatenated or-
thonormal bases. The condition (ERC) is in force if
Theorem B is a restatement of Theorem 3.5, Corollary 3.6,
and Corollary 3.9. Note that Theorems A and B unify all of the
recent results for BP [7]–[9] and extend them to OMP as well.
Our second problem, SPARSE, requests the best approxima-
tion of a general signal using a linear combination of atoms,
where the approximation error is measured with the Euclidean
norm . Although EXACT-SPARSE and SPARSE are related,
the latter is much harder to solve. Nevertheless, OMP is a prov-
ably good approximation algorithm for the sparse problem over
a quasi-incoherent dictionary.
Theorem C: Suppose that . For every input signal
, OMP will calculate an -term approximant that satisfies
where is an optimal -term approximant of the input
signal.
Theorem C is Corollary 4.4 of the sequel. It extends the
work of Gilbert, Muthukrishnan, and Strauss [6]. Significantly
stronger results for OMP have recently been announced in [10],
[11].
II. BACKGROUND
A. Important Definitions
The standard sparse approximation problem is set in the fi-
nite-dimensional1 inner-product space , which is called the
signal space. We use angle brackets to denote the usual Hermi-
tian inner product: , where represents the com-
plex-conjugate transpose. The Euclidean norm is defined via the
inner product: .
A dictionary for the signal space is a finite collection of
unit-norm vectors that spans the whole space. The members of
the dictionary are called atoms, and they are denoted by ,
where the parameter is drawn from an index set . The in-
dices may have an interpretation such as the time–frequency or
time–scale localization of an atom, or they may simply be labels
without an underlying meaning. Thus,
The letter will indicate the size of the dictionary. Clearly,
, where returns the cardinality of a set.
A representation of a signal is a linear combination of atoms
that equals the signal. Without loss of generality, we assume that
all the coefficients in a representation are nonzero. Naturally, an
-term representation is a representation that involves atoms.
Identifying the atoms and coefficients that appear in the sparsest
representation of a signal will be referred to as recovering the
sparsest representation or, equivalently, recovering the signal.
B. Sparse Approximation Problems
The fundamental problem is to approximate a given signal
using a linear combination of atoms. Since is taken to
be much smaller than the dimension of the signal space, the
approximant is sparse. Specifically, we seek a solution to the
minimization problem
(1)
where the index set and is a collection of complex
coefficients. For a fixed , the inner minimization of (1) can
be accomplished with the usual least-squares techniques. The
real difficulty lies in the optimal selection of , since the naïve
strategy would involve sifting through all possibilities.
The computational problem (1) will be called -
SPARSE. Note that it is posed for an arbitrary input signal with
respect to a fixed dictionary and sparsity level. One reason for
posing the problem with respect to a specific dictionary is to re-
duce the time complexity of the problem. If the dictionary were
an input parameter, then an algorithm would have to process the
entire dictionary as one of its computational duties. It is better
1We work in a finite-dimensional space because infinite-dimensional vectors
do not fit inside a computer. Nonetheless, the theory carries over with appro-
priate modifications to an infinite-dimensional setting.
TROPP: ALGORITHMIC RESULTS FOR SPARSE APPROXIMATION 2233
to transfer this burden to a preprocessing stage because we are
likely to use the same dictionary for many approximations.
A second reason is that solving or even approximating the
solution of (1) is NP-hard if the dictionary is unrestricted [5],
[12]. Nevertheless, it is not quixotic to seek algorithms for the
sparse problem over a particular dictionary.
We will also consider a second problem called -
EXACT-SPARSE, where the input signal is required to have a
representation using atoms or fewer from . There are
several motivations. Although natural signals are not perfectly
sparse (Proposition 4.1), one might imagine applications in
which a sparse signal is constructed and transmitted without
error. EXACT-SPARSE models just this situation. Second, anal-
ysis of the simpler problem can provide lower bounds on the
computational complexity of SPARSE; if the first problem is
NP-hard, the second one is too. Finally, we might hope that
understanding EXACT-SPARSE will lead to insights on the more
general case.
C. Algorithms
In this subsection, we will describe some of the basic algo-
rithms for sparse approximation. The methods come in two fla-
vors. Greedy methods make a sequence locally optimal choices
in an effort to determine a globally optimal solution. Convex
relaxation methods replace the combinatorial sparse approxima-
tion problem with a related convex program. We begin with the
greedy techniques.
1) Matching Pursuit (MP): If the dictionary is orthonormal,
the sparse approximation problem admits a straightforward al-
gorithm. It is possible to build a solution one term at a time by
selecting at each step the atom that correlates most strongly with
the residual signal. Matching pursuit (MP) extends this idea to
other types of dictionaries.
MP begins by setting the initial residual equal to the input
signal and making a trivial initial approximation. That is,
and
At step , MP chooses another index by solving an easy
optimization problem
(2)
Then it calculates a new approximation and a new residual
and
(3)
The residual can also be expressed as .
When the dictionary is an orthonormal basis, the approximant
is always an optimal -term representation of the signal.
For general dictionaries, Jones has shown that the norm of the
residual converges to zero [13]. In fact, it converges exponen-
tially when the signal space is finite dimensional [5].
MP was developed in the statistics community under the cog-
nomen Projection Pursuit Regression [14]. It was introduced to
the signal processing community by [15] and independently by
[16]. In the approximation communitity, MP is known as the
Pure Greedy Algorithm [2]. For more history, theory, and a list
of references, see Temlyakov’s monograph [2].
2) OMP: OMP adds a least-squares minimization to each
step of MP to obtain the best approximation over the atoms that
have already been chosen. This revision significantly improves
the behavior of the algorithm.
OMP is initialized the same way as MP, and at each step,
a new atom is selected according to the same rule as MP, via
(2). But the approximants are calculated differently. Let
list the atoms that have been chosen at step .
Then the th approximant is
subject to (4)
This minimization can be performed incrementally with stan-
dard least-squares techniques. As before, the residual is calcu-
lated as .
Note that OMP never selects the same atom twice because
the residual is orthogonal to the atoms that have already been
chosen. In consequence, the residual must equal zero after
steps.
OMP was developed independently by many researchers. The
earliest reference appears to be a 1989 paper of Chen, Billings,
and Luo [17]. The first signal processing papers on OMP arrived
around 1993 [18], [19].
3) Weak Greedy Algorithms: OMP has a cousin called weak
OMP (WOMP) that makes a brief appearance in this paper. In-
stead of selecting the optimal atom at each step, WOMP settles
for one that is nearly optimal. Specifically, it finds an index
so that
(5)
where is a fixed weakness parameter. Once the new
atom is chosen, the approximation is calculated as before, via
(4).
4) Basis Pursuit (BP): Convex relaxation offers another ap-
proach to sparse approximation. The fundamental idea is that
the number of terms in a representation can be approximated
by the absolute sum of the coefficients. This absolute sum is a
convex function, and so it can be minimized in polynomial time.
BP is a convex relaxation method designed for -
EXACT-SPARSE [4]. Given an input signal , the BP problem is
subject to
where is a collection of complex coefficients. One hopes
that the nonzero coefficients in the solution of the BP problem
will identify the atoms in the optimal representation of the input
signal and their coefficients.
Strictly speaking, BP is not an algorithm but a principle. At
least two algorithms have been proposed for solving the BP
problem. The original paper advocates interior-point methods
of linear programming [4]. Sardy, Bruce, and Tseng have sug-
gested another procedure called Block Coordinate Relaxation
[20]. Both techniques are computationally intensive.
2234 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004
D. Dictionary Analysis
To prove some of our major results, we need a way to sum-
marize the behavior of the dictionary. The coherence parameter
and the cumulative coherence function perform this duty.
1) Coherence: The most fundamental quantity associated
with a dictionary is the coherence parameter . It equals the
maximum absolute inner product between two distinct atoms
Roughly speaking, this number measures how much two atoms
can look alike. Coherence is a blunt instrument since it only
reflects the most extreme correlations in the dictionary. Never-
theless, it is easy to calculate, and it captures well the behavior
of uniform dictionaries. Informally, we say that a dictionary is
incoherent when we judge that is small.
It is obvious that every orthonormal basis has coherence
. A union of two orthonormal bases has coherence .
This bound is attained, for example, by the Dirac–Fourier dictio-
nary, which consists of impulses and complex exponentials. A
dictionary of concatenated orthonormal bases (ONB) is called
a multi-ONB. For some , it is possible to build a multi-ONB
that contains or even bases yet retains the minimal
possible coherence [21]. For general dictionaries, a
lower bound on the coherence is
If each atomic inner product meets this bound, the dictionary is
called an equiangular tight frame. See [22] for more details.
The idea of using the coherence parameter to summarize a
dictionary has a distinguished pedigree. Mallat and Zhang intro-
duced it as a quantity of heuristic interest for MP [15]. The first
theoretical developments appeared in Donoho and Huo’s paper
[23]. Stronger results for BP, phrased in terms of coherence,
were provided in [7]–[9]. Gilbert, Muthukrishnan, and Strauss
have recently exhibited an approximation algorithm for sparse
problems over suitably incoherent dictionaries [6].
2) The Cumulative Coherence: The coherence parameter
does not characterize a dictionary very well since it only reflects
the most extreme correlations between atoms. When most of
the inner products are tiny, the coherence can be downright
misleading. A wavelet packet dictionary exhibits this type
of behavior. To remedy this shortcoming, we introduce the
cumulative coherence function, which measures the maximum
total coherence between a fixed atom and a collection of other
atoms. In a sense, the cumulative coherence indicates how
much the atoms are “speaking the same language.” It is much
simpler to distinguish Russian from English than it is to distin-
guish Russian from Ukrainian. Likewise, if the vectors in the
dictionary are foreign to each other, they are much easier to tell
apart. The cumulative coherence function will arise naturally
in the analysis. Although it is more difficult to compute than
the coherence, it is a sharper scalpel. Donoho and Elad have
defined a similar notion of generalized incoherence, but they
did not develop it sufficiently for present purposes [8].
For a positive integer , the cumulative coherence function
is defined as
(6)
where the vector ranges over the atoms indexed by .
We place the convention that . The subscript in the
notation serves to distinguish the cumulative coherence function
from the coherence and to remind us that it is an absolute sum.
When the cumulative coherence of a dictionary grows slowly,
we say informally that the dictionary is quasi-incoherent.
Inspection of the definition (6) shows that and that
is a nondecreasing function of . The next proposition pro-
vides more evidence that the cumulative coherence generalizes
the coherence parameter.
Proposition 2.1: If a dictionary has coherence , then
for every natural number .
Proof: Calculate that
3) An Example: For a realistic dictionary where the atoms
have analytic definitions, the cumulative coherence function is
not too difficult to compute. As a simple example, let us study
a dictionary of decaying atoms. To streamline the calculations,
we work in the infinite-dimensional Hilbert space of square-
summable complex-valued sequences.
Fix a parameter . For each index , define an atom
by
.
A specimen appears in Fig. 1. It can be shown that the atoms
span , so they form a dictionary. The absolute inner product
between two atoms is
In particular, each atom has unit norm. It also follows that the
coherence of the dictionary equals .
Here is the calculation of the cumulative coherence function
in detail:
The maximum occurs, for example, when and
TROPP: ALGORITHMIC RESULTS FOR SPARSE APPROXIMATION 2235
Fig. 1. The atom ' with parameter  = 0:75.
The exact form of the cumulative coherence function depends
on the parity of . For even
while for odd
Notice that for all . On the other hand,
the quantity grows without bound. Later, we will return to
this example to demonstrate how much the cumulative coher-
ence function improves on the coherence parameter.
4) Uniqueness: The cumulative coherence can be used
to develop conditions under which -term representations
are unique. The material in this subsection is not essential to
understand most of the paper.
The spark of a dictionary is the least number of atoms that
form a linearly dependent set [8]. The following theorem from
[8], [9] is fundamental.
Theorem 2.2 (Donoho–Elad, Gribonval–Nielsen): A neces-
sary and sufficient condition for every linear combination of
atoms to have a unique -term representation is that
.
We can use the cumulative coherence function and the co-
herence parameter to develop lower bounds on the spark of a
dictionary. Let be a matrix whose columns are distinct
atoms, indexed . The following lemma and its proof
are essentially due to Donoho and Elad [8].
Lemma 2.3: The squared singular values of exceed
.
Proof: Consider the Gram matrix . The
Gershgorin Disc Theorem [24] states that every eigenvalue of
lies in one of the discs
The normalization of the atoms implies that . The sum
is bounded above by
The result follows since the eigenvalues of equal the squared
singular values of .
If the singular values of are nonzero, then the atoms
that comprise the matrix are linearly independent. Lower
bounds on the spark follow instantly.
Theorem 2.4 (Donoho–Elad [8]): The spark of a dictionary
satisfies the bounds
1) spark and
2) spark
The second bound also appears in [9].
If the dictionary has additional structure, it may be possible
to refine these estimates.
2236 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004
Theorem 2.5 (Gribonval–Nielsen [9]): If is a -coherent
dictionary consisting of orthonormal bases
E. Related Work
This subsection contains a brief survey of other major results
on sparse approximation, but it makes no pretense of being com-
prehensive. We will pay close attention to theory about whether
or not each algorithm is provably correct.
1) Structured Dictionaries: Early computational techniques
for sparse approximation concentrated on specific dictionaries.
For example, Coifman and Wickerhauser designed the best
orthogonal basis (BOB) algorithm to calculate sparse approx-
imations over wavelet packet and cosine packet dictionaries,
which have a natural tree structure. BOB minimizes an entropy
function over a subclass of the orthogonal bases contained in
the dictionary. Then it returns the best -term approximation
with respect to the distinguished basis [25]. Although BOB fre-
quently produces good results, it does not offer any guarantees
on the quality of approximation. Later, Villemoes developed
an algorithm that produces provably good approximations over
the Haar wavelet packet dictionary [26].
2) OMP and the Sparse Problem: Gilbert, Muthukrishnan,
and Strauss have shown that OMP is an approximation algo-
rithm for -SPARSE, provided that the dictionary is suit-
ably incoherent [6]. One version of their result is the following.
Theorem 2.6 (Gilbert–Muthukrishnan–Strauss [6]): Let
have coherence , and assume that . For an
arbitrary signal , OMP generates an -term approximant
that satisfies
where is an optimal -term approximation of .
This theorem is a progenitor of the results in the current paper,
although the techniques differ significantly.
3) Basis Pursuit (BP): For BP, there is a sequence of attrac-
tive results on - EXACT-SPARSE. In their seminal paper
[23], Donoho and Huo established a connection between uncer-
tainty principles and sparse approximation. Using this link, they
proved a recovery theorem for BP.
Theorem 2.7 (Donoho–Huo [23]): Let be a union of two
orthonormal bases with coherence . If , then
BP recovers every signal that has an -term representation.
In [7], Elad and Bruckstein made some improvements to the
bounds on , which turn out to be sharp [27]. More recently, the
theorem of Donoho and Huo has been extended to multi-ONBs
and arbitrary incoherent dictionaries [8], [9]. Donoho and Elad
have also developed a generalized notion of incoherence that is
equivalent to the cumulative coherence function defined in this
paper. We will discuss these results in more detail later.
Very recently, BP has been modified to solve sparse approxi-
mation problems for general input signals. These results appear
in [10], [11].
III. RECOVERING SPARSE SIGNALS
In this section, we consider the restricted problem -
EXACT-SPARSE. The major result is a single sufficient condition
under which both OMP and BP recover a linear combination
of atoms from the dictionary. We also develop a method for
checking when this condition is in force for an arbitrary -term
superposition. Together, these results prove that OMP and BP
are both correct algorithms for EXACT-SPARSE over quasi-inco-
herent dictionaries.
A. The Exact Recovery Condition
Suppose that a given signal can be written as a linear com-
bination of atoms and no fewer. Thus,
where is a subset of with cardinality . Without loss
of generality, assume that the atoms in are linearly inde-
pendent and that the coefficients are nonzero. Otherwise, the
signal has a representation using fewer than atoms.
Let be the matrix whose columns are the atoms
listed in
where . (The order of the indices is
unimportant, so long as it is fixed.) Then the signal can also be
expressed as
where is a vector of complex coefficients. Since the
optimal atoms are linearly independent, has full column-
rank. Define a second matrix whose columns are the
atoms indexed by . Thus, contains the atoms
that do not participate in the optimal representation.
Theorem 3.1 (Exact Recovery for OMP): A sufficient condi-
tion for OMP to recover the sparsest representation of the input
signal is that
(ERC)
where ranges over the columns of .
A fortiori, OMP is a correct algorithm for -EXACT-
SPARSE so long as the condition (ERC) holds for every signal
with an -term representation.
The tag (ERC) abbreviates the phrase “Exact Recovery Con-
dition.” It guarantees that no spurious atom can masquerade as
part of the signal well enough to fool OMP. Theorem 3.10 of
TROPP: ALGORITHMIC RESULTS FOR SPARSE APPROXIMATION 2237
the sequel shows that (ERC) is essentially the best possible for
OMP. Incredibly, (ERC) also provides a natural sufficient con-
dition for BP to recover a sparse signal, which we will discover
in Section III-B.
Proof: Suppose that, after the first steps, OMP has com-
puted an approximant that is a linear combination of atoms
listed in . Recall that the residual is defined as .
We would like to develop a condition to guarantee that the next
atom is also optimal.
Observe that the vector lists the inner products
between the residual and the optimal atoms. So the expression
gives the largest magnitude attained among the
inner products, where denotes the vector norm. Simi-
larly, expresses the largest inner product between
the residual and any nonoptimal atom. In consequence, to see
whether the largest inner product occurs at an optimal atom, we
just need to examine the quotient
(7)
On account of the selection criterion (2), we see that a greedy
choice2 will recover another one of the optimal atoms if and only
if .
Notice that the ratio (7) bears a suspicious resemblance to
an induced matrix norm. Before we can apply the usual norm
bound, the term must appear in the numerator. Since
and both lie in the column span of , so does the residual
. The matrix is a projector onto the column span
of , and so we may calculate that
We use to denote the induced norm for linear operators
mapping into itself. Since equals the max-
imum absolute row sum of its argument and equals the
maximum absolute column sum of its argument, we take a con-
jugate transpose and switch norms. Continuing the calculation
where the maximimation occurs over the columns of , the
nonoptimal atoms.
2In case that (r ) = 1, an optimal atom and a nonoptimal atom both at-
tain the maximal inner product. The algorithm has no provision for determining
which one to select. In the sequel, we make the pessimistic assumption that a
greedy procedure never chooses an optimal atom when a nonoptimal atom also
satisfies the selection criterion. This convention forces greedy techniques to fail
for borderline cases, which is appropriate for analyzing algorithmic correctness.
In summary, assuming that lies in the column span of ,
the relation will obtain whenever
(ERC)
Suppose that (ERC) holds. Since the initial residual lies in
the column span of , a greedy selection recovers an optimal
atom at each step. Each residual is orthogonal to the atoms that
have already been selected, so OMP will never choose the same
atom twice. It follows that steps of OMP will identify all
atoms that make up the optimal representation of . Therefore,
.
An immediate consequence of the proof technique is a result
for WOMP.
Corollary 3.2: A sufficient condition for WOMP to re-
cover the sparsest representation of the input signal is that
(8)
where ranges over the columns of .
Gribonval and Nielsen have pointed out that the proofs here
also apply to MP [28].
B. Recovery Via BP
It is even easier to prove that the Exact Recovery Condition
is sufficient for BP to recover a sparse signal. This theorem will
allow us to unify all the recent results about BP. We retain the
same notation as before.
Theorem 3.3 (Exact Recovery for BP): A sufficient condition
for BP to recover the sparsest representation of the input signal
is that
(ERC)
where ranges over the atoms that do not participate in .
A fortiori, BP is a correct algorithm for -EXACT-
SPARSE whenever (ERC) holds for every signal that has an
-term representation.
We require a simple lemma about norms.
Lemma 3.4: Suppose that is a vector with nonzero compo-
nents and that is a matrix whose columns do not have identical
norms. Then .
We omit the easy proof and move on to the demonstration of
the theorem.
Proof: Suppose that is an input signal whose sparsest
representation can be written as . Assume that the
Exact Recovery Condition holds for the input signal.
Let be a different representation with nonzero
coefficients. It follows that has at least one column
that does not appear in . According to (ERC), we have
. Meanwhile, for every other
atom , optimal or nonoptimal.
2238 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004
Assume that the columns of do not have identical
norms. We may use the lemma to calculate that
If perchance the columns of all have the same
norm, that norm must equal , which is strictly less
than one. Repeat the calculation. Although the first inequality
is no longer strict, the second inequality becomes strict in com-
pensation. We reach the same conclusion.
In words, any set of nonoptimal coefficients for representing
the signal has strictly larger norm than the optimal coeffi-
cients. Therefore, BP will recover the optimal representation.
C. Cumulative Coherence Estimates
Since we are unlikely to know the optimal atoms a priori,
Theorems 3.1 and 3.3 may initially seem useless. But for many
dictionaries, the Exact Recovery Condition holds for every
-term signal, so long as is not too large.
Theorem 3.5: Suppose that is the cumulative coherence
function of . The Exact Recovery Condition holds whenever
(9)
Thus, OMP and BP are correct algorithms for -SPARSE
whenever (9) is in force. In other words, this condition guar-
antees that either procedure will recover every signal with an
-term representation.
One interpretation of this theorem is that the Exact Recovery
Condition holds for sparse signals over quasi-incoherent dictio-
naries. The present result for BP is slightly stronger than the
most general theorem in [8], which is equivalent to Corollary
3.6 of the sequel.
Proof: Begin the calculation by expanding the pseudo-
inverse
Then apply the usual norm bound
(10)
The cumulative coherence function offers a tailor-made esti-
mate of the second factor on the right-hand side of (10)
(11)
Bounding the first factor on the right-hand side of (10) requires
more sophistication. We develop the inverse as a Neumann se-
ries and use Banach algebra methods to estimate its norm. First,
notice that has a unit diagonal because all atoms are
normalized. So the off-diagonal part satisfies
Each column of lists the inner products between one atom
of and the remaining atoms. By definition of the
cumulative coherence function
Whenever , the Neumann series converges
to the inverse [29]. In this case, we may compute
(12)
Introduce the bounds (11) and (12) into inequality (10) to obtain
We reach the result by applying Theorems 3.1 and 3.3.
A weaker corollary follows directly from basic facts about the
cumulative coherence function.
Corollary 3.6: OMP and BP both recover every superposi-
tion of atoms from whenever one of the following condi-
tions is satisfied:
(13)
or
(14)
The incoherence condition is the best possible. It would fail
for any atoms chosen from an equiangular tight
frame with vectors. The bound (8) appears in both
[8] and [9] with reference to BP. The bound (14) also appears in
[8].
To see the difference between the two conditions in Corol-
lary 3.6, let us return to the dictionary of decaying atoms from
Section II-D3. Recall that
and
TROPP: ALGORITHMIC RESULTS FOR SPARSE APPROXIMATION 2239
Set . Then the incoherence condition (13) requires that
. On the other hand, for every . Therefore,
(14) shows that OMP or BP can recover any (finite) linear com-
bination of decaying atoms!
D. Structured Dictionaries
If the dictionary has special form, better estimates are
possible.
Theorem 3.7: Suppose that consists of concatenated
orthonormal bases with overall coherence . Suppose that the
input signal can be written as a superposition of atoms from
the th basis, . Without loss of generality, assume
that . The Exact Recovery Condition
holds whenever
(15)
in which case, both OMP and BP recover the optimal represen-
tation of the signal.
The proof of Theorem 3.7 is quite delicate. We refer the in-
terested reader to the technical report [31].
The major theorem of Gribonval and Nielsen’s paper [9] is
that (15) is a sufficient condition for BP to succeed in this set-
ting. When , we retrieve the major theorem of Elad and
Bruckstein’s paper [7].
Corollary 3.8: Suppose that consists of two orthonormal
bases with overall coherence , and suppose that the input signal
has a representation using atoms from the first basis and
atoms from the second basis, where . The Exact Recovery
Condition holds whenever
(16)
Feuer and Nemirovsky have shown that the bound (16) is
the best possible for BP [27]. It follows by contraposition that
Corollary 3.8 is the best possible result on the Exact Recovery
Condition for a two-ONB.
For an arbitrary -term superposition from a multi-ONB, re-
visit the calculations of Gribonval and Nielsen [9] to discover
the following corollary.
Corollary 3.9: If is a -coherent dictionary comprised of
orthonormal bases, the condition
is sufficient to ensure that the Exact Recovery Condition holds
for every signal with an -term representation.
The bound in Corollary 3.9 is the best possible when
on account of [27], but Donoho and Elad have pointed out that
the result can be improved when .
E. Uniqueness and Recovery
Theorem 3.1 has another important consequence. If the Exact
Recovery Condition holds for every linear combination of
atoms, then all -term superpositions are unique. Otherwise,
the Exact Recovery Theorem states that OMP would simultane-
ously recover two distinct -term representations of the same
signal, a reductio ad absurdum. Therefore, the conditions of
Theorem 3.5, Corollary 3.6, and Corollary 3.9 ensure that all
-term representations are unique. On the other hand, Theorem
2.2 shows that the Exact Recovery Condition must fail for some
linear combination of atoms whenever .
That a signal has a unique -term representation does not
guarantee the Exact Recovery Condition holds. For a union of
two orthonormal bases, Theorem 2.5 implies that all -term
representations are unique whenever . But the dis-
cussion in the last section demonstrates that the Exact Recovery
Condition may fail for . Within this pocket3
lie uniquely determined signals that cannot be recovered by
OMP, as this partial converse of Theorem 3.1 shows.
Theorem 3.10 (Exact Recovery Converse for OMP): Assume
that all -term representations are unique but that the Exact Re-
covery Condition fails for a signal with optimal synthesis ma-
trix . Then there are signals in the column span of that
OMP cannot recover.
Proof: If the Exact Recovery Condition fails, then
(17)
By the uniqueness of -term representations, every signal that
has a representation using the atoms in yields the same two
matrices and . Next, choose to be a vector
for which equality holds in the bound
Optimal synthesis matrices have full column rank, so maps
the column span of onto . Therefore, the column span
of contains a signal for which .
Working backward from (17) through the proof of the Exact Re-
covery Theorem, we discover that . In conclusion, if
we run OMP with as input, it chooses a nonoptimal atom in
the first step. Since provides the unique -term represen-
tation of , the initial incorrect selection damns OMP from
obtaining an -term representation of .
IV. RECOVERING GENERAL SIGNALS
The usual goal of sparse approximation is the analysis or
compression of natural signals. But the assumption that a signal
has a sparse representation is completely academic on account
of the following result.
Proposition 4.1: If , the collection of signals that
have an exact representation as a linear combination of atoms
forms a set of Lebesgue measure zero in .
Proof: The signals that lie in the span of distinct atoms
form an -dimensional subspace, which has measure zero.
There are ways to choose atoms, so the collection
of signals that have a representation over atoms is a finite
3See the paper of Elad and Bruckstein [7] for a very enlightening graph that
delineates the regions of uniqueness and recovery for two-ONB dictionaries.
2240 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004
union of -dimensional subspaces. This union has measure
zero in .
It follows that a generic signal does not have a sparse
representation. Even worse, the optimal -term approxi-
mant is a discontinuous, multivalent function of the input
signal. In consequence, proving that an algorithm succeeds
for -EXACT-SPARSE is very different from proving that
it succeeds for -SPARSE. Nevertheless, the analysis in
Section III-A suggests that OMP may be able to recover atoms
from the optimal representation even when the signal is not
perfectly sparse.
A. OMP as an Approximation Algorithm
Let be an arbitrary signal, and suppose that is an op-
timal -term approximation of . That is, is a solution to
the minimization problem (1). Note that may not be unique.
We write
for an index set of size . Once again, denote by the
matrix whose columns are the atoms listed in . We
may assume that the atoms in form a linearly independent
set because any atom that is linearly dependent on the others
could be replaced by a linearly independent atom to improve
the quality of the approximation. Let be the matrix whose
columns are the remaining atoms.
Now we may formulate a condition under which OMP re-
covers optimal atoms.
Theorem 4.2 (General Recovery): Assume that ,
and suppose that is a linear combination of atoms from .
At step , OMP will recover another atom from
provided that
(18)
We will call (18) the General Recovery Condition. It says
that a greedy algorithm makes absolute progress whenever
the current -term approximant compares unfavorably with an
optimal -term approximant. Theorem 4.2 has an important
structural implication: every optimal representation of a signal
contains the same kernel of atoms. This fact follows from
the observation that OMP selects the same atoms irrespective
of the optimal approximation that appears in the calculation.
But the principal corollary of Theorem 4.2 is that OMP is
an approximation algorithm for -SPARSE.
Corollary 4.3: Assume that , and let be a com-
pletely arbitrary signal. Then OMP produces an -term approx-
imant that satisfies
(19)
where is an optimal -term approximant. We may estimate
the constant as
Proof: Imagine that (18) fails at step . Then, we
have an upper bound on the -term approximation error as a
function of the optimal -term approximation error. If we con-
tinue to apply OMP even after exceeds , the approximation
error will only continue to decrease.
Although OMP may not recover an optimal approximant
, it always constructs an approximant whose error lies
within a constant factor of optimal. One might argue that an
approximation algorithm has the potential to inflate a moderate
error into a large error. But a moderate error indicates that the
signal does not have a good sparse representation over the dic-
tionary, and so sparse approximation may not be an appropriate
tool. In practice, if it is easy to find a nearly optimal solution,
there is no reason to waste a lot of time and resources to reach
the ne plus ultra. As the French say, “The best is the enemy of
the good.”
Placing a restriction on the cumulative coherence function
leads to a simpler statement of the result, which generalizes and
improves the work in [6].
Corollary 4.4: Assume that or, more generally,
that . Then OMP generates -term approximants
that satisfy
(20)
The constant here is not small, so it is better to regard this
as a qualitative theorem on the performance of OMP. See [32]
for another greedy algorithm with a much better constant of ap-
proximation. Significantly better results for OMP have also been
announced in [10], [11].
Let us return again to the example of Section II-D3. This time,
set . The coherence condition of Corollary 4.4 suggests
that we can achieve the approximation constant only
if . But the cumulative coherence condition demon-
strates that, in fact, the approximation constant is never more
than .
Another consequence of the analysis is a corollary for
WOMP.
Corollary 4.5: Weak orthogonal matching pursuit with pa-
rameter calculates -term approximants that satisfy
As an example, assume that . Then WOMP has
an approximation constant that does not exceed .
B. Proof of the General Recovery Theorem
Proof: Suppose that, after steps, OMP has produced an
approximant that is a linear combination of atoms listed
TROPP: ALGORITHMIC RESULTS FOR SPARSE APPROXIMATION 2241
in . The residual is , and the condition for
recovering another optimal atom is
We may divide the ratio into two pieces, which we bound
separately
(21)
The term has vanished from the denominator
since is orthogonal to the column span of .
To bound , repeat the arguments of Section III-C, mutatis
mutandis. This yields
(22)
Meanwhile, has the following simple estimate:
(23)
Since has full column rank, is nonzero.
Now we can develop a concrete condition under which OMP
retrieves optimal atoms. In the following calculation, assume
that . Combine inequalities (21)–(23). Then estimate
the singular value with Lemma 2.3. We discover that
whenever
Some algebraic manipulations yield the inequality
Since the vectors and are orthogonal, we
may apply the Pythagorean Theorem to reach
If this relation is in force, then a step of OMP will retrieve an-
other optimal atom.
Remark 4.6: The term is an unpleasant aspect of (23),
but it cannot be avoided without a more subtle approach. When
the atoms in our optimal representation have approximately
equal correlations with the signal, the estimate of the infinity
norm is reasonably accurate. An assumption on the relative size
of the coefficients in might improve the estimate, but this
is a severe restriction. An astute reader could whittle the factor
down to , but the subsequent analysis would not realize
any benefit. It is also possible to strengthen the bound if one
postulates a model for the deficit . If, for example,
the nonsparse part of the signal were distributed “uniformly”
across the dictionary vectors, a single atom would be unlikely
to carry the entire error. But we will retreat from a battle that
should be fought on behalf of a particular application.
ACKNOWLEDGMENT
This paper would never have been possible without the en-
couragement and patience of Anna Gilbert, Martin Strauss, and
Muthu Muthukrishnan.
REFERENCES
[1] R. A. DeVore, “Nonlinear approximation,” Acta Num., pp. 51–150,
1998.
[2] V. Temlyakov, “Nonlinear methods of approximation,” Foundations of
Comp. Math., vol. 3, no. 1, pp. 33–107, July 2003.
[3] K. Gröchenig, Foundations of Time-Frequency Analysis. Boston, MA:
Birkhäuser, 2001.
[4] S. S. Chen, D. L. Donoho, and M. A. Saunders, “Atomic decomposition
by basis pursuit,” SIAM J. Sci. Comput., vol. 20, no. 1, pp. 33–61, 1999.
[5] G. Davis, S. Mallat, and M. Avellaneda, “Greedy adaptive approxima-
tion,” J. Constr. Approx., vol. 13, pp. 57–98, 1997.
[6] A. C. Gilbert, M. Muthukrishnan, and M. J. Strauss, “Approximation of
functions over redundant dictionaries using coherence,” in Proc. 14th
Annu. ACM-SIAM Symp. Discrete Algorithms, Baltimore, MD, Jan.
2003, pp. 243–252.
[7] M. Elad and A. M. Bruckstein, “A generalized uncertainty principle and
sparse representation in pairs of bases,” IEEE Trans. Inform. Theory,
vol. 48, pp. 2558–2567, Sept. 2002.
[8] D. L. Donoho and M. Elad, “Maximal sparsity representation via `
minimization,” Proc. Natl. Acad. Sci., vol. 100, pp. 2197–2202, Mar.
2003.
[9] R. Gribonval and M. Nielsen, “Sparse representations in unions of
bases,” IEEE Trans. Inform. Theory, vol. 49, pp. 3320–3325, Dec. 2003.
[10] J. A. Tropp. (2004, Feb.) Just Relax: Convex Programming Methods
for Subset Selection and Sparse Approximation, Univ. Texas at Austin,
ICES Rep. 04-04, submitted for publication. [Online]. Available:
http://www.ices.utexas.edu/reports/2004.html
[11] D. L. Donoho, M. Elad, and V. N. Temlyakov. (2004, Feb.) Stable
Recovery of Sparse Overcomplete Representations in the Presence
of Noise, submitted for publication. [Online]. Available: http://www.
cs.technion.ac.il/~elad/
[12] B. K. Natarajan, “Sparse approximate solutions to linear systems,” SIAM
J. Comput., vol. 24, pp. 227–234, 1995.
[13] L. K. Jones, “On a conjecture of Huber concerning the convergence of
projection pursuit regression,” Ann. Statist., vol. 15, no. 2, pp. 880–882,
1987.
2242 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 10, OCTOBER 2004
[14] J. H. Friedman and W. Stuetzle, “Projection pursuit regressions,” J.
Amer. Statist. Soc., vol. 76, pp. 817–823, 1981.
[15] S. Mallat and Z. Zhang, “Matching pursuits with time-frequency dictio-
naries,” IEEE Trans. Signal Processing, vol. 41, pp. 3397–3415, Dec.
1993.
[16] S. Qian and D. Chen, “Signal representation using adaptive normalized
Gaussian functions,” Signal Processing, vol. 36, pp. 329–355, 1994.
[17] S. Chen, S. A. Billings, and W. Luo, “Orthogonal least squares methods
and their application to nonlinear system identification,” Intl. J. Contr.,
vol. 50, no. 5, pp. 1873–1896, 1989.
[18] Y. C. Pati, R. Rezaiifar, and P. S. Krishnaprasad, “Orthogonal matching
pursuit: Recursive function approximation with applications to wavelet
decomposition,” in Proc. 27th Annu. Asilomar Conf. Signals, Systems
and Computers, Nov. 1993.
[19] G. Davis, S. Mallat, and Z. Zhang, “Adaptive time-frequency decompo-
sitions,” Opt. Eng., vol. 33, no. 7, pp. 2183–2191, July 1994.
[20] S. Sardy, A. G. Bruce, and P. Tseng, “Block coordinate relaxation
methods for nonparametric wavelet denoising,” Comp. and Graph.
Statist., vol. 9, no. 2, 2000.
[21] R. Heath, T. Strohmer, and A. J. Paulraj, “On quasi-orthogonal signa-
tures for CDMA systems,” in Proc. 2002 Allerton Conf. Communica-
tion, Control and Computers.
[22] T. Strohmer and R. W. Heath, “Grassmannian frames with applications
to coding and communication,” Appl. Comp. Harmonic Anal., vol. 14,
no. 3, pp. 257–275, May 2003.
[23] D. L. Donoho and X. Huo, “Uncertainty principles and ideal atomic de-
composition,” IEEE Trans. Inform. Theory, vol. 47, pp. 2845–2862, Nov.
2001.
[24] R. A. Horn and C. R. Johnson, Matrix Analysis. Cambridge, U.K.:
Cambridge Univ. Press, 1985.
[25] R. R. Coifman and M. V. Wickerhauser, “Entropy-based algorithms for
best-basis selection,” IEEE Trans. Inform. Theory, vol. 38, pp. 713–718,
Mar. 1992.
[26] L. F. Villemoes, “Best approximation with Walsh atoms,” Constr. Ap-
prox., vol. 13, pp. 329–355, 1997.
[27] A. Feuer and A. Nemirovsky, “On sparse representation in pairs of
bases,” IEEE Trans. Inform. Theory, vol. 49, pp. 1579–1581, June 2003.
[28] R. Gribonval and M. Nielsen, “On the Exponential Convergence of
Matching Pursuits in Quasi-Incoherent Dictionaries,” Univ. Rennes I,
Rennes, France, IRISA Rep. 1619, 2004.
[29] E. Kreyszig, Introductory Functional Analysis With Applications. New
York: Wiley, 1989.
[30] D. L. Donoho and M. Elad, “On the stability of Basis Pursuit in the
presence of noise,” working draft.
[31] J. A. Tropp. (2003, Feb.) Greed is Good: Algorithmic Results for Sparse
Approximation, Univ. of Texas at Austin, ICES Rep. 03-04. [Online].
Available: http://www.ices.utexas.edu/reports/2003.html
[32] J. A. Tropp, A. C. Gilbert, S. Muthukrishnan, and M. J. Strauss,
“Improved sparse approximation over quasi-incoherent dictionaries,” in
Proc. 2003 IEEE Int. Conf. Image Processing, vol. 1, Barcelona, Spain,
Sept. 2003, pp. I-37–I-40.

