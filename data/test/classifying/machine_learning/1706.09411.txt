ar
X
iv
:1
70
6.
09
41
1v
2 
 [
st
at
.M
L
] 
 3
0 
Ju
n 
20
17
GENERALIZED NOTIONS OF SPARSITY AND RESTRICTED
ISOMETRY PROPERTY. PART II: APPLICATIONS
MARIUS JUNGE AND KIRYUNG LEE
Abstract. The restricted isometry property (RIP) is a universal tool for data recovery.
We explore the implication of the RIP in the framework of generalized sparsity and
group measurements introduced in the Part I paper [JL17]. It turns out that for a
given measurement instrument the number of measurements for RIP can be improved
by optimizing over families of Banach spaces. Second, we investigate the preservation
of difference of two sparse vectors, which is not trivial in generalized models. Third,
we extend the RIP of partial Fourier measurements at optimal scaling of number of
measurements with random sign to far more general group structured measurements.
Lastly, we also obtain RIP in infinite dimension in the context of Fourier measurement
concepts with sparsity naturally replaced by smoothness assumptions.
1. Introduction
The restricted isometry property (RIP) has been used as a universal tool in data recovery.
In a companion Part I paper [JL17], we introduced the generalized notion of sparsity and
provided a far reaching generalization of the RIP theory by Rudelson and Vershynin [RV08]
and subsequent improvements [Rau10, Dir15] in a unified framework. In this paper we
explore how the RIP results on generalized sparsity models in the Part I paper [JL17]
apply to challenging scenarios not covered by existing theory. Specifically, we illustrate
our findings with the examples below.
1.1. Optimizing RIP with families of Banach spaces.
The first example considers the RIP for the canonical sparsity model in RN , which is
determined by counting the number of nonzero elements. Here measurements are obtained
as inner products with functionals ηkl for (k, l) ∈ ZN×ZN , which are given as the translates
of the quantum Fourier transform of a fixed measurement instrument η ∈ RN expressed
by
ηkl(j) = e
2πilj
N ηj−k .
The special case of η = [1, . . . , 1]⊤ ∈ RN has been well studied as partial Fourier mea-
surements (see e.g. [CT06, RV08]). We are interested in a scenario where each spectral
measurement is taken with a finitely supported window having a specific decaying pattern.
The following theorem, obtained as a consequence of the main results in the part I paper
1
2 MARIUS JUNGE AND KIRYUNG LEE
[JL17], shows how the number of measurements for the RIP can be optimized over a choice
of Banach spaces.
Theorem 1.1. Let 2 < q′ ≤ ∞. Suppose that ‖η‖2 =
√
N . Then
sup
‖x‖0≤r
∣∣∣ 1
m
m∑
i=1
|(ηki,li , x)|2 − ‖x‖22
∣∣∣ ≤ δ‖x‖22
holds with high probability for independently chosen random pairs (ki, li) provided
(1) m ≥ cδ−2(1 + lnm)3(q′)3r1−2/q′‖η‖2q′ .
By optimizing m in (1) over q′, one obtains the assertion if
m ≥ cδ−2(1 + lnm)3spη(r) ,
where the sparsity parameter spη(r) is defined by
spη(r) := inf
2<q′≤∞
(q′)3r1−2/q
′‖η‖2q′ .
For the flat vector η = [1, . . . , 1]⊤ ∈ RN the choice q′ = ∞ appears optimal. However,
for a short window η such that the magnitudes show a polynomial decay of order α for
some α < 1/2, the optimal choice is given by q′ = 1/α. Our main tool in this analysis is
a flexible framework that derives the RIP for various sparsity models defined by a family
of Banach spaces [JL17]. We recall that x ∈ RN is (K, r)-sparse if
‖x‖X ≤
√
r‖x‖2 ,
whereX is a Banach space with unit ballK. For X = ℓN1 , we see that r-sparse vectors are
(BN1 , k)-sparse and more generally (B
N
q , r
2/q−1)-sparse for 1 ≤ q < 2, where BNq denotes
the unit ball of ℓNq . We derive Theorem 1.1 with X = ℓ
N
q , where (q, q
′) is a conjugate pair
such that 1/q + 1/q′ = 1.
1.2. Preserving distance of sparse vectors in generalized models.
The conventional notion of sparsity is given by the geometry of a union of subspaces
and provides a special feature that the sparsity level is sub-additive. Unfortunately, this
property does not hold for our modified sparsity model, which is given by a nonconvex
cone. Particularly, compared to the conventional sparsity model, a central drawback in
the generalization is that the difference x − y of two (K, s)-sparse vectors x and y is no
longer (K, 2s)-sparse. In fact, the adversarial instance of x− y can attain the maximum
(trivial) sparsity level. Therefore the RIP does not necessarily imply that the distance of
sparse vectors is preserved and one may not distinguish two generalized sparse vectors from
their images in low dimension. Instead, we provide a weaker substitute for the generalized
model that allows to preserve the distance in certain sense.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 3
Here we adopt the group action arguments to generate measurements [JL17]. Let G be a
finite group with an affine isotropic representation σ : G→ ON (see Section 3 for a precise
definition, but we may work with the transformations given by shifts and modulations as
above).
Theorem 1.2. Let G and σ be as above. Let g1, . . . , gm be independent copies of a Haar-
distributed random variable on G. Let η ∈ RN with ‖η‖2 =
√
N . Suppose that
m ≥ cδ−2s(1 + lnm)3(1 + ln ‖Id : ℓn2 → X‖)‖η‖2X∗ .
Then for all ǫ > 0
∣∣∣ 1
m
m∑
j=1
|〈η, σ(gj)(x− y)〉|2 − ‖x− y‖22
∣∣∣ ≤ min
(‖x− y‖22
1 + ǫ
,
√
2δ(‖x‖2 + ‖y‖2)‖x− y‖2
)
holds with high probability for all (K, s)-sparse vectors x and y such that
‖x− y‖X ≤
√
s‖x− y‖2√
2(1 + ǫ)δ
.
Moreover, the following results hold with high probability for all unit-norm and (K, s)-
sparse vectors x and y. If
1
m
m∑
j=1
|〈η, σ(gj)(x− y)〉|2 ≥ 32δ2 ,
then
(
1− 1√
2
) 1
m
m∑
j=1
|〈η, σ(gj)(x− y)〉|2 ≤ ‖x− y‖22 ≤
(
1 +
1√
2
) 1
m
m∑
j=1
|〈η, σ(gj)(x− y)〉|2 .
Otherwise, ‖x− y‖2 ≤ 8δ.
The first part of Theorem 1.2 shows that two (K, s)-sparse vectors may be distinguished
from a small number of their measurements if the difference is sparse up to a certain level
(much higher than s for small δ). On the other hand, the second part of Theorem 1.2
implies that one can distinguish two sparse unit-norm vectors if the distance between their
measurements is larger than a certain threshold. Otherwise, the vectors are contained in
a neighborhood of radius 8δ. These results are weaker than the analogous versions with
the subadditivity of the sparsity level, but they can be still useful in some applications
such as locality-sensitive hashing.
4 MARIUS JUNGE AND KIRYUNG LEE
1.3. Improving group structured measurements with further randomization.
In the third illustration, we discuss variations of group structured measurements com-
bined with further randomization. The number of group structured measurements for
the RIP, derived in the Part I paper [JL17], may scale worse compared to the optimal
subgaussian case given by Gordon’s lemma [Gor88]. In fact, this was the case with the
low-rank tensor example. We propose two different ways to improve the RIP results for
group structured measurements with more randomness.
The first approach uses the composition of the group structure measurement system
followed by a subgaussian matrix, where the second step further compresses the data. An
application of Rosenthal’s inequality shows that this composition system also achieves the
same optimal scaling as one by a pure subgaussian measurement system. In fact, the group
structured measurement system has already reduced the data dimension significantly and
the subsequent system given as a small subgaussian matrix requires much less computation
compared to the case of applying a single large subgaussian matrix.
The second approach, inspired by a recent RIP result by Oymak et al. [ORS15], achieves
the optimal scaling by preprocessing the data with multiplication with a random sign
pattern before applying the group structured measurement system. This composition
system is also interpreted as a single group structured measurement system that employs
a larger group for the group actions.
We compare the RIP results for the modified group structured measurements in the
example of low-rank tensors. Here the Banach space defining a sparsity model is given as
the d-fold tensor product of ℓn2 with the largest tensor norm, which is a natural extension
of the bilinear sparsity model given by Schatten 1-class.
1.4. RIP for infinite dimensional sparsity models.
Lastly, we illustrate the RIP for infinite dimensional sparsity models, which are moti-
vated by compressive Fourier imaging. Our goal in this example is to construct a sparsity
model in the function space without discretization and establish the RIP theory on this
model. In Fourier imaging, the measurements (yk)k∈Z are obtained as
yk =
∫ ∞
−∞
ψk(t)f(t)dt, k ∈ Z ,
where (ψk)k∈Z denotes the complex sinusoid defined by ψk(t) = e2πikt for t ∈ [0, 1) and f
is a signal in L2(0, 1). When the support of f is restricted to [0, 1), the sequence (yk)k∈Z
corresponds to the Fourier series (f̂(k))k∈Z and the map from f to (f̂(k))k∈Z is bijective.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 5
We consider measurements in the form of
(2)
N−1∑
k=−N
τ̂tf(k) =
N−1∑
k=−N
e−2πiktf̂(k) ,
where τt denotes the circular shift operator. We would like to preserve the ℓ2 norm
of (f̂(k))−N≤k<N by measurements from m translates of f , which are given in (2) for
t = t1, . . . , tm. Ideally, in the noise-free case, m = 2N shifts can provide unique identifica-
tion of (f̂(k))−N≤k<N . However, in this case, the measurement system is ill-conditioned.
However, as we show in the following theorem, a sparsity model in L2(0, 1) allows that
the ℓ2-norm of the subsequence (f̂(k))−N≤k<N is preserved by fewer measurements.
Theorem 1.3. Let ‖ · ‖2,w be a seminorm on L2(0, 1) defined by
‖f‖2,w =
( N−1∑
k=−N
|f̂(k)|2
)1/2
and
Kρ,γ = {f ∈ L2(0, 1) ∩ C1 | ‖f ′‖ ≤ ρ‖f‖L2 , λ(supp(f)) ≤ γ}
for ρ ≤ N/2 and γ ∈ (0, 1), where λ(·) denote the Lebesgue measure. Suppose that
t1, . . . , tm are independent copies of a uniform random variable on (0, 1). Then m =
O(δ−2γ(N2 + ρ2) ln7N) suffices to satisfy
sup
f∈Kρ,γ , ‖f‖2,w=1
∣∣∣ 1
m
m∑
j=1
∣∣∣
N−1∑
k=−N
e−2πiktj f̂(k)
∣∣∣
2
− ‖f‖22,w
∣∣∣ ≤ max(δ, δ2)
with high probability.
The sparsity model Kρ,γ is determined by two parameters ρ and γ. Sparsity is measured
as the relative occupancy 0 < γ < 1 in the Lebesgue measure and smoothness is measured
by the other parameter ρ. The seminorm ‖f‖2,w is preserved by fewer translates for smaller
γ. Particularly, the number of measurements m can be sublinear for γ = o(1/N).
Our theory improves on existing results in several ways described below. First, unlike
the conventional compressed Fourier imaging (e.g., [CRT06]), our measurement model does
not involve any discretization and is consistent with the physics in acquisition systems.
Second, our setup employs a more flexible sparsity model and considers a realistic scenario
where only finitely many measurements are available. Sub-Nyquist sampling of multiband
signals [FB96, Fen98, ME09, MEE11] is considered as compressed sensing of analog sparse
signals. The multiband sparse signal model in f ∈ L2(0, 1) is defined so that the support
is restricted to be on a few active blocks of [0, 1). This is far more restrictive than our
infinite dimensional sparsity model.
6 MARIUS JUNGE AND KIRYUNG LEE
1.5. Organization. Thus far we have demonstrated snapshots of our results in their
simplified forms. Full results in detail on each topic are presented in later sections as
follows. Section 2 discusses how the main results in the Part I paper [JL17] can be utilized
to optimize the number of measurements for the RIP over the choice of Banach spaces and
1-homogeneous functions. This result is illustrated with the example of partial windowed
Fourier transform and its noncommutative version. Section 3 provides a general framework
that preserves the distance of sparse vectors without the subadditivity of the sparsity
level. Section 4 proposes two ways to further improve the number of group structured
measurements for the RIP with more randomness. Obtained results are compared over the
low-rank tensor example. Lastly, in Section 5, we illustrate how (semi)norms are preserved
by finitely many measurements using various infinite dimensional sparsity models and
identify the number of measurements in each scenario.
1.6. Notation. In this paper, the symbols c, c1, c2, . . . and C,C1, C2, . . . will be reserved
for numerical constants, which might vary from line to line. We will use notation for
various Banach spaces and norms. The norm of a Banach space X is denoted by ‖ · ‖X .
For example, ‖ · ‖Lq denote the norm that defines Lq(0, 1). We will use the shorthand
notation ‖ · ‖p for the ℓp-norm for 1 ≤ p ≤ ∞. The operator norm will be denoted by
‖ · ‖. For N ∈ IN, the unit ball in ℓNp will be denoted by BNp . The identity operator will
be denoted by Id.
2. Optimizing Restricted Isometry Property
In this section, we present two examples where one can optimize the number of mea-
surements for the RIP with respect to given conventional sparsity models. Specifically,
we consider the canonical sparsity model and low-rank matrix model. In the literature,
relaxation of these models with corresponding Banach spaces (ℓn1 for the canonical spar-
sity model and Sn1 for the low-rank matrix model) provided the RIP from a near optimal
number of incoherent measurements. However, in practice, there exist physical constraints
on designing the measurement system and ideally incoherent instruments are not always
available. In this situation, we demonstrate that the number of measurements for the RIP
can be optimized via our general framework in the Paper I [JL17].
2.1. RIP of subsampled short-time discrete Fourier transform.
The first example provides the RIP of a partial short-time Fourier transform, which can
be considered as a non-ideal version of a partial Fourier operator. Let h : ZN → C be a
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 7
window function. The windowed discrete Fourier transform of f : ZN → C is given by
(3) c(t, k) =
N−1∑
ℓ=0
f(ℓ)h(ℓ− t)e−i2πkℓ/N , ∀t, k ∈ ZN ,
where the time indices are modulo N . Let σ : ZN×ZN → ON , where ON is the orthogonal
group, be an isotropic affine representation given by
σ(t, k) = ΛtShk,
where Λ is the usual modulation defined by
Λ(el) = e
i2πl/Nel, ∀l = 1, . . . , N ,
and Sh is the circular shift modulo N such that
Sh(el) =



el+1 1 ≤ l ≤ N − 1 ,
e1 l = N .
Here, e1, . . . ,eN are the standard basis vectors in R
N . Let η = [h[0], . . . , h[N − 1]]⊤
and x = [f [0], . . . , f [N − 1]]⊤. Then the windowed DFT coefficient in (3) is a group
measurement given by
c(t, k) = 〈η, σ(t, k)x〉, ∀t, k ∈ ZN .
In signal processing, particularly for large N , it is usual to take a spectral measurement
from a finite block of the signal f . Then the resulting measurements correspond to short-
time discrete Fourier transform (STDFT) of f with a given window function h. Typically,
to avoid the leakage due to the discontinuity at the boundary, windows are designed with
decaying magnitudes.
We consider the RIP of subsampled STDFT measurements on k-sparse signals with
respect to the canonical sparsity model, i.e. on the set S = {x ∈ CN | ‖x‖0 ≤ k}, where
‖ · ‖0 counts the number of nonzero elements. In our generalized notion of sparsity, there
exist convex sets K ⊂ BN2 such that every k-sparse vector x in S is (K, s)-sparse, i.e.
‖x‖X ≤
√
s‖x‖2, where X is the Banach space with unit ball K. For example, one can
choose X = ℓN1 with s = k but this is not the only choice. By using our general framework
from the Part I paper [JL17], it is possible to optimize the number of measurements for
the RIP on S over the choice of the convex set K and the parameter s as shown in the
following theorem.
Theorem 2.1 (Partial STDFT with a decaying window). Let (t1, k1), . . . , (tm, km) be
independent copies of a uniform random variable on ZN × ZN . For η = [η1, . . . , ηN ]⊤, let
8 MARIUS JUNGE AND KIRYUNG LEE
(η↓j )1≤j≤N denotes the rearrangement of (|ηj |)1≤j≤N in the non-increasing order. Suppose
that
η↓j =



cα,N,Nηj
−α j ≤ Nη ,
0 j < Nη .
for 0 < α < 1/2 and Nη < N , where cα,N,Nη is a constant such that ‖η‖2 =
√
N . Then
there exists a numerical constant c such that
(4) P

 sup
‖x‖0≤k, ‖x‖2=1
∣∣∣ 1
m
m∑
j=1
∣∣∣〈σ(tm, km)η, x〉
∣∣∣
2
− ‖x‖22
∣∣∣ ≥ δ

 ≤ ζ
provided
m ≥
cδ−2kmax(α−3(1 + lnm)3, ln(ζ−1))N2αη (1 + lnNη)
2αN
k2αNη(1−N−1+2αη )
.
Remark 2.2. Alternatively, applying [JL17, Theorem 5.1] with X = ℓN1 provides the
same RIP as in Theorem 2.1 for
(5) m ≥
cδ−2kmax((1 + lnm)3(1 + lnN), ln(ζ−1))N2αη N
Nη(1−N−1+2αη )
.
Note that the optimized number of measurements for the RIP in Theorem 2.1 is smaller
than that in (5) by factor k2α.
Proof of Theorem 2.1. Let 1 ≤ q < 2 and X = ℓNq . Then it follows that since X∗ = ℓNq′ ,
where 2 < q′ < ∞, is of type 2 and the type 2 constant T2(X∗) is upper bounded by√
q′ [Car85, Lemma 3]. Let s = k1−2/q
′
. Then each k-sparse x satisfies ‖x‖q ≤
√
s‖x‖2.
Therefore, by [JL17, Theorem 5.3], the assertion in (4) holds if
(6) m ≥ cδ−2k1−2/q′ max((q′)3(1 + lnm)3, ln(ζ−1))‖η‖X∗ .
It remains to compute ‖η‖X∗ . First of all, the normalization constant cα,N,Nη satisfies
N = ‖η‖22 = c2α,N,Nη
Nη∑
j=1
j−2α ≥ c2α,N,Nη (N1−2αη − 1).
Next we compute k1−2/q
′‖η‖2q′ in the following three cases for r′.
Case 1: q′α < 1
k1−2/q
′‖η‖2q′ = k1−2/q
′
c2α,N,Nη


Nη∑
j=1
j−q
′α


2/q′
≤ k
1−2/q′NN2/q
′−2α
η
N1−2αη − 1
= k
(
Nη
k
)2/q′ N
Nη(1−N−1+2αη )
.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 9
Case 2: q′α = 1
(7) k1−2/q
′‖η‖2q′ ≤
k1−2αN(1 + lnNη)2α
N1−2αη − 1
= k
(
Nη
k
)2α N(1 + lnNη)2α
Nη(1−N−1+2αη )
.
Case 3: q′α > 1
k1−2/q
′‖η‖2q′ ≤
Ck1−2/q
′
N
N1−2αη − 1
= Ck1+2α−2/q
′
(
Nη
k
)2α N
Nη(1−N−1+2αη )
.
Note that the second case has the smallest upper bound. Applying (7) to (6) completes
the proof. 
2.2. Deterministic instrument for Schatten classes.
Next, we show an analogous result in the noncommutative case. Here, we consider the
RIP of the group structured measurements restricted to the set of rank-r matrices, where
the affine representation corresponds to the double quantum Fourier-transform, i.e.
σ(k, j, k′, j′)(a) = Λk Shj a(Shj
′
)∗Λ−k
′
, ∀a ∈Mn .
Let g be a Haar-distributed random variable on Z4n. Then
∫
Z4n
σ(g)Tσ(g)∗dµ(g) =
tr(T )
n2
Id
holds for all linear operator T on Mn. Hence the affine representation is isotropic.
We first recall the RIP result for an arbitrary instrument η in this case.
Proposition 2.3. Let 1 ≤ q ≤ 2 and η ∈ Snq′ be a fixed vector such that ‖η‖S2 = n. Then
P
(
sup
‖a‖Sq≤
√
s, ‖a‖S2=1
∣∣∣ 1
m
m∑
l=1
|〈σ(gl)(η), a〉|2 − ‖a‖2S2
∣∣∣ ≥ δ
)
≤ ζ
holds provided
m
(q′)3(1 + lnm)3 + ln(ζ−1)
≥ cδ−2s‖η‖2Sq′ .
Proof. The Schatten class Sq′ has type 2 with constant c1
√
q′ [TJ89]. Therefore the main
technical result in [JL17, Theorem 5.3] applies here with p = 2. 
Moreover, for a rank-r matrix we always have
‖x‖Sq ≤ r1/q−1/2‖x‖S2
and hence may apply the previous result for s = r2/q−1 and get the following corollary.
10 MARIUS JUNGE AND KIRYUNG LEE
Corollary 2.4. Let η ∈Mn be a fixed vector such that ‖η‖S2 = n. Then
P
(
sup
rk(a)≤r, ‖a‖S2=1
∣∣∣ 1
m
m∑
l=1
|〈σ(gl)(η), a〉|2 − ‖a‖2S2
∣∣∣ ≥ δ
)
≤ ζ
holds provided
m ≥ cδ−2spη(r)
(
(1 + lnm)3 + ln(ζ−1)
)
,
where
spη(r) := inf
q′≥2
r1−2/q
′
(q′)3‖η‖2Sq′ .
The parameter spη(r) in Corollary 2.4 denotes the optimized sparsity level, which is
determined by the rank r and the instrument η. Next we demonstrate the number of group
structured measurements for the RIP given by Corollary 2.4 for particular choices of the
instrument η. The first example considers an ideal instrument that generates incoherent
measurements.
Example 2.5. Let η =
√
n1Mn , where 1Mn is the n-by-n identity matrix. Then ‖ξ‖S2 = n.
For this particular choice of η, we also have
σ(k, j, k′, j′)(η) = Λk Shj−j
′
Λ−k
′
η = e
i2π(j−j′)k′
n Λk−k
′
Shj−j
′
η .
Therefore, the number of distinct elements in the orbit of η is n2 instead of n4. In other
words, we sample from n2 possible measurements. On the other hand, since ‖ξ‖2Sq′ =
n1+2/q
′
, choosing q′ = 1+ lnn gives spη(r) = O(rn(1 + lnn)
3). The factor n accounts for
geometry of the Schatten class and will disappear in the commutative case.
Similar to the partial STFT example in the commutative case, the second example
considers a non-ideal instrument with fast decaying singular values.
Example 2.6. Let η satisfy ‖η‖S2 = n and
sj(η) = cα,nj
−α, ∀j = 1, . . . , n
for α < 1/2, where sj(η) denotes the jth singular value of η in the non-increasing order.
Similar to the proof of Theorem 2.1, we show
r1−2/q
′
(q′)3‖η‖2S′q ≤



rn(q′)3
(
n
r
)2/q′ 1
1−n−1+2α q
′α < 1 ,
rn(q′)3
(
n
r
)2α (1+lnn)2α
1−n−1+2α q
′α = 1 ,
Crn(q′)3r2α−2/q
′
(
n
k
)2α 1
1−n−1+2α q
′α > 1 .
We see that the function (n/r)2/q
′
is decreasing for q′ < α−1 and the function r2α−2/q
′
is
increasing for q′ > α−1. Thus q = α−1 is the best choice and we deduce that spη(r) =
O(α−3rn(n/r)2α(1 + lnn)2α). This upper bound on the number of measurements for RIP
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 11
is smaller than the choice of q′ = 1 + lnn. Unlike the previous example, the instrument
produces less incoherent measurements, which can be compensated with a penalty in the
number of measurements for small r.
3. RIP on difference of sparse vectors
In the conventional sparsity models given by a union of subspaces, the sparsity level
measured by either the number of nonzeros or the rank satisfies the sub-additivity. An
important implication is that the difference of two sparse vectors is still sparse up to
the sum of the sparsity levels of each sparse vector. However, this is not the case for
generalized sparsity models given by a nonconvex cone. Therefore, the RIP does not auto-
matically preserve the distance between sparse vectors in the general setup. However, with
some careful arguments, one can show that the distance is still preserved in some weaker
sense. In this section, we will discuss this problem using the notion of the multiresolution
restricted isometry property (MRIP).
The MRIP was originally proposed for the canonical sparsity model by Oymak et al.
[ORS15]. We generalize it to general sparsity models with a slight modification. Let H
be a Hilbert space and X be a Banach space with unit ball K ⊂ BH , where BH denotes
the unit ball in H. Note that if K has a non-empty interior there exists a number
(8) smax(K) = ‖Id : X → H‖−1/2
such that ‖x‖X ≤
√
smax(K)‖x‖H holds for all x. For example, if H = ℓN2 and X = ℓN1 ,
then smax(K) = N . Given the definition of smax(K), we state the definition of the MRIP
as follows.
Definition 3.1 (Multiresolution restricted isometry property). Let H be a Hilbert space,
K ⊂ H be a convex set, X be a Banach space with unit ball K, and smax(K) be a constant
defined in (8). We say that A : H → ℓm2 satisfies the MRIP with distortion δ > 0 at
sparsity level s ≥ 1 if
sup
‖x‖X≤
√
2ls, ‖x‖H=1
|‖Ax‖22 − ‖x‖2H | ≤ 2l/2 max(2l/2δ, 2lδ2)
holds for all ⌊− log2 s⌋ ≤ l ≤ ⌈log2(smax(K)/s)⌉.
The following lemma shows that the MRIP can preserve the distance of two sparse
vectors when the sparsity level of the difference is below a certain threshold.
Lemma 3.2. Let H, K, X, and smax(K) be defined as above, δ > 0, and s ∈ IN. Suppose
that A : H → ℓm2 satisfies the MRIP with distortion δ at sparsity level s. Then for all
12 MARIUS JUNGE AND KIRYUNG LEE
x, y ∈ H
|‖Ax−Ay‖22 − ‖x− y‖2H | ≤ max
(√2δ‖x− y‖X‖x− y‖H√
s
,
2δ2‖x− y‖2X
s
)
.
Moreover for any ǫ > 0
(9) |‖Ax−Ay‖22 − ‖x− y‖2H | ≤ min
(‖x− y‖2H
1 + ǫ
,
√
2δ(‖x‖H + ‖y‖H)‖x− y‖H
)
provided that x, y are (K, s)-sparse and
‖x− y‖X ≤
√
s‖x− y‖H√
2(1 + ǫ)δ
.
Remark 3.3. Lemma 3.2 preserves the distance of two (K, s)-sparse vectors x, y by (9)
if the sparsity level of x− y is below the threshold s/2(1 + ǫ)δ2, which is higher than the
sparsity levels s of x and y for small δ. The estimate in (9) implies that the distortion is
strictly less than ‖x− y‖2H , which implies a local injectivity.
Since the Hilbert space norm ‖·‖H is preserved by the RIP up to a small distortion δ, we
can always compare two spare vectors after normalization. Suppose that ‖x‖H = ‖y‖H =
1. Then (9) also implies that the distortion is no bigger than 2
√
2δ‖x−y‖H . Although this
distortion bound is more conservative than δ‖x − y‖2H , which is available if the sparsity
level is subadditive, it can be still useful for certain applications. For example, similar
deviation bounds have been used in the analysis of iterative optimization algorithms for
matrix completion (see [CW15, Lemma 5] and [ZL16, Lemma 8]). We expect that this
weak preservation of the difference of two sparse vectors can be useful in generalizing
existing theory to a wider class of sparsity model.
Proof of Lemma 3.2. Let h = x− y denote the difference between x and y. We may find
l such that ⌊− log2 s⌋ ≤ l ≤ ⌈log2(smax(K)/s)⌉ and
2ls <
‖h‖2X
‖h‖2H
≤ 2l+1s .
Then h is sl+1-sparse, where sl+1 = 2
ls, and hence
|‖Ah‖22 − ‖h‖2H | ≤ max{δl+1, δ2l+1}‖h‖2H ,
where δl+1 = 2
(l+1)/2δ. Let us first assume that δl+1 < 1. Then we get
(10) δl+1‖h‖2H = 2(l+1)/2δ‖h‖2H ≤
√
2δs−1/2‖h‖X‖h‖H .
In case δl+1 ≥ 1 we get
(11) δ2l+1‖h‖2H = 2l+1δ2‖h‖2H ≤ 2δ2s−1‖h‖2X .
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 13
This proves the first assertion. Next, for the second assertion, we assume that x, y are
(K, s)-sparse. Then we have
(12) ‖h‖X ≤ ‖x‖X + ‖y‖X ≤
√
s(‖x‖H + ‖y‖H) .
If h = x− y additionally satisfies
‖h‖X ≤
√
s√
2(1 + ǫ)δ
‖h‖H ,
then
2ls <
‖h‖2X
‖h‖2H
≤ s
2(1 + ǫ)2δ2
,
which implies δl+1 = 2
(l+1)/2δ ≤ 11+ǫ < 1. Therefore, we apply the estimate in (10) with
the upper bound in (12). 
The following corollary of Lemma 3.2 shows that two unit-norm and (K, s)-sparse vec-
tors can be distinguished if they are well separated in the measurement domain. Other-
wise, x and y are close in the original space. This result is weaker than the preservation
of the distance but applies to a wider class of models. This result can be used in some
applications such as locality-sensitive hashing.
Corollary 3.4. Suppose the hypothesis of Lemma 3.2. Let x, y be unit-norm and (K, s)-
sparse vectors. If
(13) ‖Ax−Ay‖2 ≥ 4
√
2δ,
then
(14)
(
1− 1√
2
)
‖Ax−Ay‖22 ≤ ‖x− y‖2H ≤
(
1 +
1√
2
)
‖Ax−Ay‖22.
Otherwise,
‖x− y‖H ≤ 8δ.
Proof. Let h = x− y. Then by Lemma 3.2, we have
(15)
|‖Ah‖22 − ‖h‖2H | ≤ max
(√2δ‖x− y‖X‖x− y‖H√
s
,
2δ2‖x− y‖2X
s
)
≤ max{2
√
2δ‖h‖H , 8δ2} .
We proceed the proof in the following two complementary cases.
Case 1: ‖h‖H ≥ ‖Ah‖2.
It follows that 2
√
2δ‖h‖H ≥ 16δ2 and the maximum in (15) is attained in the first term.
Thus by (13) and (15), we have
‖h‖2H − ‖Ah‖22 ≤ 2
√
2δ‖h‖H ≤
‖h‖2H
2
,
14 MARIUS JUNGE AND KIRYUNG LEE
which implies ‖h‖H ≤
√
2‖Ah‖2. Then by (13) and (15) we have
|‖Ah‖22 − ‖h‖2H | ≤ 4δ‖Ah‖2 ≤
‖Ah‖22√
2
,
which implies (14).
Case 2: ‖h‖H ≤ ‖Ah‖2.
By (15) and the upper estimate for δ ≤ ‖Ah‖
4
√
2
δ we deduce
|‖Ah‖22 − ‖h‖2H | ≤ 2
√
2δ‖Ah‖2 ≤
‖Ah‖22
2
,
which implies (14). Thus the first part is proved.
For the second part, we suppose that ‖Ah‖2 < 4
√
2δ and ‖h‖H > 8δ hold simultane-
ously. By (15) and the fact that the first term achieves the maximum in in (15),
‖h‖2H − ‖Ah‖22 ≤ 2
√
2δ‖h‖H ≤
‖h‖2H
2
√
2
.
Then it follows that
‖h‖2H ≤
2
√
2
2
√
2− 1
‖Ah‖22 < 64δ2 < ‖h‖2H ,
which is a contradiction. Therefore, ‖Ah‖2 < 4
√
2δ implies ‖h‖H ≤ 8δ. This completes
the proof. 
Remark 3.5. We did not optimize the constants in Corollary 3.4. More generally, we
find a conditional RIP property below. Fix α > 2
√
2. Let β > 0 satisfy α2 < β(β − 2
√
2).
If ‖Ah‖2 ≥ αδ, then

1− 2
√
2√
α(α− 2
√
2)

 ‖Ah‖22 ≤ ‖h‖2H ≤

1 + 2
√
2√
α(α − 2
√
2)

 ‖Ah‖22 .
Otherwise, ‖h‖H ≤ βδ. One can optimize the constants α and β to tighten the estimate.
Remark 3.6. Corollary 3.4 implies that if the distance between Ax and Ay for two unit-
norm sparse vectors x and y is larger than 4
√
2δ, then the distance between x and y in H
is equivalent to ‖Ax− Ay‖2 up to a constant factor. In other words, one can distinguish
x and y from their linear measurements. However, if Ax and Ay are close by satisfying
‖Ax − Ay‖2 < 4
√
2δ, then Corollary 3.4 only confirms that ‖x − y‖H is less than 8δ,
i.e. one cannot distinguish two similar sparse vectors x and y from their measurements.
Note that we did not optimize the constants in Corollary 3.4. Obviously, this result is
weaker than the uniform preservation of distance of any two sparse vectors (regardless of
the amount of distance) given by RIP with respect to an exact sparsity model. However,
this weak property will be still useful in applications. For example, in clustering sparse
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 15
vectors, if the centroids of clusters are well separated via the dimensionality reduction via
A, then one can compute clustering in the compressed domain.
Remark 3.7. Corollary 3.4 provides a recovery guarantee by a nonconvex programming.
Suppose that x satisfies ‖x‖H = 1 and ‖x‖X ≤
√
s. Let x̂ be the solution to
(16) min
x̃
‖x̃‖X subject to Ax̃ = Ax and ‖x̃‖H = 1 .
Since x is feasible for the program in (16), we have ‖x̂‖X ≤ ‖x‖X ≤
√
s. Moreover, x̂ also
satisfies ‖x̂‖H = 1. Therefore, by Corollary 3.4, it follows that ‖x̂ − x‖H ≤ 8δ. Without
the unit-norm constraint, the optimization in (16) becomes a convex program. We will
pursue a guarantee for this convex program in a future work.
Remark 3.8. We may even replace this by
min ‖x̃‖X subject to ‖Ax̃−Ax‖ < Kδ ‖x̃‖H = 1 .
Then we conclude that ‖x̂ − x‖H ≤ (K + 2
√
2)δ, and hence we can allow small random
errors.
Next we show that the MRIP holds for group structured measurements. To avoid re-
dundancy, we illustrate a single example where the sparsity model is given with a polytope
K.
Lemma 3.9. Let H = ℓN2 and K be an absolute convex hull of M points, and K have
enough symmetry with an isotropic affine representation σ : G → ON , X be the Banach
with unit ball K, g1, . . . , gm be independent copies of a Haar-distributed random variable g
on G, smax(K) be defined in (8), and u : X → ℓd2 satisfy tr(u∗u) = N . Then there exists a
numerical constant c such that A = 1√
m
(uσ(gj))1≤j≤m satisfies the MRIP with distortion
δ̃ at level s̃ with probability 1− ζ provided
m ≥ cδ̃−2s̃(1 + lnN)(1 + ln(ζ−1))(1 + lnm)3(1 + ln(smax(K)))‖u : X → ℓd2‖2 .
Proof. Let l ∈ IN. Note that
2ls̃
2lδ̃2
=
s̃
δ̃2
.
Therefore, by [JL17, Theorem 5.1],
P

 sup
‖x‖0≤2l s̃, ‖x‖2=1
∣∣∣ 1
m
m∑
j=1
‖u(σ(gj)x)‖22 − ‖x‖22
∣∣∣ ≥ max(2l/2δ̃, 2lδ̃2)

 ≤ ζ⌈log2(N/s̃)⌉
holds provided
m ≥ cδ̃−2s̃(1 + lnN)max
(
(1 + lnm)3, ln(ζ−1)
)
‖u : X → ℓd2‖2 .
16 MARIUS JUNGE AND KIRYUNG LEE
Since l was arbitrary, applying the union bound over all l satisfying ⌊− log2 s⌋ ≤ l ≤
⌈log2(smax(K)/s)⌉ gives the assertion. 
4. Group structured measurements with further randomization
In the Part I paper [JL17], we have shown that the number of randomly sampled group
structured measurements m for the RIP scales near optimally for certain sparsity models
(e.g., sparsity models with respect to Banach spaces X = ℓN1 or X = S
n
1 ). However, in
general, one needs a larger number of measurements for the group structured case than
that for Gaussian measurements. In this section, we propose two different ways to improve
the sample complexity for the RIP of randomly sampled group structured measurements.
To this end, we first recall the optimal result on the number of Gaussian measurements for
the RIP. Gordon’s lemma [Gor88] shows that a minimal number of Gaussian measurements
provide the dimensionality reduction of an arbitrary set D consisting of unit-norm vectors.
Lemma 4.1 (Gordon’s escape through the mesh [Gor88]). Let 0 < δ < 1, D be a subset
of the unit sphere SN−1, and ξ1, . . . , ξm be independent copies of a standard Gaussian
random vector ξ ∼ N (0, IN ). Then
P

sup
x∈D
∣∣∣ 1
m
m∑
j=1
|〈ξj , x〉|2 − ‖x‖22
∣∣∣ ≥ δ

 ≤ ζ
holds provided
m ≥ δ−2
(
ℓ(D) +
√
2 ln(2/ζ)
)2
,
where ℓ(D) denotes the Gaussian width of D defined by
(17) ℓ(D) := E sup
x∈D
〈ξ, x〉 .
Remark 4.2. The Gaussian width in (17) satisfies ℓ(D) = ℓ(absconvD), where absconvD
denotes the absolute convex hull of D. It also coincides with the Gaussian-summing norm
[DJT95] (also known as the ℓ-norm) of the identity operator from ℓN2 to Y , where Y is the
Banach space with unit ball absconvD. Our notation for the Gaussian width is motivated
by this interpretation.
In the remainder of this section, we consider D = Ks =
√
sK ∩ SN−1 for a fixed convex
body K ⊂ BN2 . Then it follows that ℓ(D) ≤ ℓ(
√
sK) =
√
sℓ(K).
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 17
4.1. Group structured measurements followed by a small subgaussian matrix.
Suppose that K has enough symmetries with an isotropic, affine representation σ on a
compact group G. Let X be the Banach with unit ball K. A fixed map u : X → ℓd2 can
be viewed as an instrument to probe data from X.
We consider a situation where a sufficient number of group structured measurements
are stored in a data bank but the original data is no longer accessible. We can further
reduce the amount of data by applying a small Gaussian matrix to the vectors with the
obtained measurements. The next result shows that the measurements obtained by the
two-step approach by the composition operator provide dimensionality reduction, which
is as good as that by pure Gaussian measurements in Gordon’s lemma.
Theorem 4.3. Let 1 ≤ p ≤ 2. Let K, X, G, σ, and u be as above. Let vj = uσ(gj)
for j = 1, . . . ,M , where g1, . . . , gM are independent copies of a Haar-distributed random
variable in G, and ξ1, . . . , ξm be independent copies of a standard Gaussian random vector
ξ ∼ N (0, IM ). Let αd be an 1-homogeneous and G-invariant function on B(X, ℓd2). Then
there exists a numerical constant c such that A = 1√
M
(vj)1≤j≤M satisfies
P
(
sup
x∈Ks
∣∣∣ 1
m
m∑
l=1
|〈ξl, Ax〉|2 − ‖x‖22
∣∣∣ ≥ max(δ, δ2)
)
≤ ζ
provided that
m ≥ 3δ−2
(√
sℓ(K) +
√
2 ln(2/ζ)
)2
(18)
M
1 + ln(NMd)
≥ c‖u‖2S∞(19)
M1/p
(1 + lnM)e(p)/2
≥ cMp,αd(K)
√
sδ−1αd(u)(20)
M ≥ cδ−2s ln(ζ−1)‖u : X → ℓd2‖2 ,(21)
where e(·) is defined by e(p) = 1 for 1 ≤ p < 2 and e(p) = 3 for p = 2.
In particular for a large enough M a low dimensional image of K with “Gordon optimal
number of measurements” can be reproduced by group translations of a given instrument
u.
In general, the number of group translations, M , determined by Theorem 4.3 is larger
than the number of measurements, m, at the final stage. However, M is still significantly
smaller than the ambient dimension N and the size of the Gaussian matrix, m-by-M , is
small compared to the size m-by-N , of a pure Gaussian measurement matrix. Since group
structured measurement operators often have fast implementation (e.g., partial Fourier
18 MARIUS JUNGE AND KIRYUNG LEE
[FS03] and partial Gabor [Søn12]), the composition measurement system is scalable and
can be useful for high dimensional data in particular with a sparse u.
The proof of Theorem 4.3 consists of a sequence of supporting lemmas. For the first
lemma, we need a standard application of Rosenthal’s inequality.
Lemma 4.4. Let σ : G→ ON be an affine isotropic representation, where ON denotes the
orthogonal group, g1, . . . , gM be independent copies of a Haar-distributed random variables
g in G, and u : CN → Cd be a linear map such that tr(u∗u) = N . Then
E
∥∥∥ 1
M
M∑
j=1
σ(gj)
∗u∗uσ(gj)−Id
∥∥∥
S∞
≤ C‖u‖S∞
√
1 + ln(NMd)√
M
(
1+
‖u‖S∞
√
1 + ln(NMd)√
M
)
for a numerical constant C.
Proof. Since the action is isotropic, we see that Eσ(g)u∗uσ(g)∗ = Id and
Eσ(g)u∗uσ(g)σ(g)∗u∗uσ(g) = Eσ(g)u∗uu∗uσ(g) =
tr(u∗uu∗u)
N
Id .
With the help of the noncommutative Rosenthal inequality (see [JZ13, Theorem 0.4]) this
implies
E
∥∥∥
M∑
j=1
σ(gj)
∗u∗uσ(gj)− Eσ(gj)∗u∗uσ(gj)
∥∥∥
Sp
≤ CpM1/p‖u∗u‖Sp + C
√
pM‖Egu∗uu∗ug‖1/2Sp/2
≤ Cp(Md)1/p‖u‖2S∞ + C(pM/N)1/2N1/p‖u‖2S4
≤ Cp(Md)1/p‖u‖2S∞ + C(pM/N)1/2N1/p‖u‖S∞‖u‖S2
≤ C‖u‖S∞(pM)1/2N1/p(
√
pM−1/2(Md/N)1/p‖u‖S∞ + 1) .
In case Md/N ≤ 1, we choose p = lnN and find
E
∥∥∥ 1
M
M∑
j=1
σ(gj)
∗u∗uσ(gj)− IN
∥∥∥
S∞
≤ C‖u‖S∞
√
1 + lnN√
M
(
1 +
‖u‖S∞
√
1 + lnN√
M
)
.
For Md/N ≥ 1 we simply choose p = 1 + ln(Md/N) + lnN and get
E
∥∥∥ 1
M
M∑
j=1
σ(gj)
∗u∗uσ(gj)− IN
∥∥∥
S∞
≤ C‖u‖S∞
√
1 + ln(Md)√
M
(
1 +
‖u‖S∞
√
1 + ln(Md)√
M
)
.
Then the assertion follows. 
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 19
Corollary 4.5. Let u, K, A be as in Theorem 4.3. Suppose that (19) holds. Then A is
invertible on its range and in particular satisfies
ℓ(A(K)) ∼√
3
ℓ(K) .
Proof. By Lemma 4.4, there exists c > 0 such that the assumption implies
‖A∗A− Id‖S∞ <
1
2
.
Then A is injective. Furthermore it follows that ‖A‖S∞ ≤
√
3/2 and ‖A†‖S∞ ≤
√
2, where
A† denotes the Penrose-Moore pseudo inverse of A. Therefore ℓ(A(K)) ∼√3 ℓ(K). 
Now by combining the above lemmas, we prove Theorem 4.3.
Proof of Theorem 4.3. First, by [JL17, Theorem 5.1], there exists a numerical constant c
such that A satisfies the RIP on Ks with constant δ with probability 1 − ζ/2 provided
that (20) and (21) hold. Next, due to Lemma 4.5, we may assume that ‖A‖S∞ ≤
√
3/2.
Therefore Lemma 4.1 applies to A(K) and we find that (18) implies
P
(
sup
x∈Ks
∣∣∣∣∣
1
m
m∑
l=1
|〈ξl, Ax〉|2 − ‖Ax‖22
∣∣∣∣∣ ≥ max(δ/2, δ
2/4)
)
≤ ζ .
Then the triangle inequality implies the assertion. 
4.2. Group structured measurement with random sign.
Here we demonstrate that one can reduce the number of group structured measurements
for the RIP by certain choices of groups so that it is comparable to the (widely accepted
optimal) result by Gaussian measurements. More precisely, adopting the multiresolu-
tion RIP result by Oymak et al. [ORS15], we show that the combination of the group
structured measurement operator and the diagonal operator with random sign achieves
the “Gordon optimal number of measurements”. We start with the observation that the
group structured measurement generalizes the partial Fourier measurement and satisfies
the multiresolution RIP. Here, we use the original definition of the multiresolution RIP
[ORS15], which is a special case of Definition 3.1.
Definition 4.6 (Multiresolution RIP [ORS15]). We say that A : ℓN2 → ℓm2 satisfies the
Multiresolution Restricted Isometry Property (MRIP) with distortion δ > 0 at sparsity
level s ≥ 1 if
sup
‖x‖0≤2ls
|‖Ax‖22 − ‖x‖22| ≤ max(2l/2δ, 2lδ2)
for all l = 0, 1, . . . , ⌈log2(N/s)⌉.
20 MARIUS JUNGE AND KIRYUNG LEE
We fix a group G with an isotropic affine representation σ : G → ON such that σ(g) is
an isometry on ℓN1 and ℓ
N
2 simultaneously for all g ∈ G.
Theorem 4.7. Let G be a group action with an affine representation σ : G → ON such
that σ(g) is an isometry on both ℓN1 and ℓ
N
2 for all g ∈ G. Let η ∈ ℓN2 be a vector of
‖η‖2 =
√
N , g1, . . . , gm be independent copies of a Haar-distributed random variable g in
G, and vj : ℓ
N
1 → C be given by vjx = 〈σ(gj)∗η, x〉 for j = 1, . . . ,m. Suppose in addition
that Dε ∈ RN×N is a diagonal matrix whose diagonal entries are from a Rademacher
sequence (εj)1≤j≤N . Let T ⊂ SN−1. Then there exists a numerical constant c such that
P

sup
x∈T
∣∣∣ 1
m
m∑
j=1
|〈Dεσ(gj)∗η, x〉|2 − ‖x‖22
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ(22)
provided
m ≥ cδ−2ℓ(T )2(1 + ln(ζ−1))(1 + lnN)max
(
(1 + lnm)3, (1 + ln(ζ−1))
)
‖η‖2∞ .
Proof of Theorem 4.7. The assertion follows by combining Lemma 3.9 for K = BN1 and
[ORS15, Theorem 3.1] for s̃ = C1(1 + ln(ζ
−1)) and δ̃ = δC2ℓ(T ) with some numerical
constants C1 and C2. 
Corollary 4.8. Under the hypothesis of Theorem 4.7, suppose in addition that K ⊂ BN2
is convex. Let Ks =
√
sK ∩ SN−1. Then there exists a numerical constant c such that
P

 sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈Dεσ(gj)∗η, x〉|2 − ‖x‖22
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ
holds provided
(23) m ≥ cδ−2sℓ(K)2(1 + ln(ζ−1))(1 + lnN)max
(
(1 + lnm)3, (1 + ln(ζ−1))
)
‖η‖2∞ .
Proof. This follows from ℓ(Ks) ≤
√
sℓ(K). 
Remark 4.9. One may improve Corollary 4.8 by considering a better estimate on ℓ(Ks)
given by
ℓ(Ks) = E sup
x∈Ks
|〈ξ, x〉| ≤ inf
Id=a+b
‖a‖S2 + ℓ(b(Ks)) ,
which is smaller than
√
sℓ(K).
Indeed, for some unconditional Banach sequence space norms, the diagonal operator
with random sign can be absorbed into the group action, which is stated in the following
corollary.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 21
Corollary 4.10. Consider an affine representation σ̃ of G̃ = {−1, 1}N ⋊ZN via diagonal
matrices and shift matrices. Suppose that g̃1, . . . , g̃m are independent copies of a random
variable g̃ in G̃ with respect to the Haar measure and K ⊂ BN2 is G̃-invariant. Let
Ks =
√
sK ∩ SN−1. Then there exists a numerical constant c such that
P

 sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈σ̃(g̃j)∗η, x〉|2 − ‖x‖22
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ
provided that the condition in (23) holds.
Proof. In [JL17, Section 4], we have shown that σ̃ is an isotropic affine representation of
G̃. Then we note that thanks to the group invariance for all r ∈ N
(
E
G̃m
sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈σ̃(g̃j)η, x〉|2 − ‖x‖2
∣∣∣
r)1/r
=
(
EεEGm sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈Dεσ(gj)η, x〉|2 − ‖x‖2
∣∣∣
r)1/r
=
(
EGmEε sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈σ(gj)η,Dεx〉|2 − ‖x‖2
∣∣∣
r)1/r
.
Now it suffices to apply Corollary 4.8. 
Remark 4.11. Note that one can use use different kinds of randomness and have dif-
ferent degree of generality for group structured measurements. In i) we can work with
an arbitrary group G and are not using good concentration inequalities. In ii) we have
to restrict to subgroups of isometries of ℓN1 , and that can be very restrictive. It is also
interesting to consider the sampling sets in i) and ii). In i) we sample from the orbit
σ(G)∗η
of cardinality at most |G|, and ii) from
{−1, 1}Nσ(G)∗η
of cardinality at most 2N |G|. With respect to this criterion Fourier sampling only uses
N vectors to choose from for G = Z2N with the affine representation. The particular
η = [1, . . . , 1]⊤ ∈ RN also produces only an orbit of N vectors. We suspect that our
methods can be modified to other type of randomness where a random set is chosen out of
the orbit. Although the gaussian case provides the “best” estimate it requires considerably
more “randomness”. From this perspective, the improvement given by Corollary 4.10 for
a nice group G̃ = {−1, 1}N ⋊ ZN over the choice of Z2N comes at a penalty that the
22 MARIUS JUNGE AND KIRYUNG LEE
cardinality of the orbit is larger (|G̃m| = 2NmNm versus |Gm| = N2m). This may increase
the cost of implementation.
Finally, we conclude this section with an application of Corollary 4.8 to low-rank tensors.
Let Ks denote the set of rank-s tensors in (ℓ
n
2 )
⊗dπ . In the Part I paper [JL17, Theorem 7.3],
we showed that the group structured measurement with a standard Gaussian instrument
ξ satisfies
P

 sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈σ(gj)∗ξ, x〉|2 − ‖x‖22
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ
provided
m ≥ cδ−2s(1 + lnm)3(1 + 3nd(1 + ln d) + ln(ζ−1))2 .
We compare this estimate to that by the group structured measurement operator after
applying random sign. Let (εj)1≤j≤N be a Rademacher sequence and Dε be the corre-
sponding diagonal operator with random sign. Then applying the fact that a standard
Gaussian ξ ∈ RN satisfies
P
(
‖ξ‖∞ ≥
√
2(1 + lnN + ln(ζ−1))
)
≤ ζ
to Corollary 4.8, it follows that
P

 sup
x∈Ks
∣∣∣ 1
m
m∑
j=1
|〈Dεσ(gj)∗ξ, x〉|2 − ‖x‖22
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ
provided
m ≥ cδ−2snd(1+ln d)(1+ln(ζ−1))(1+d ln n)((1+lnm)3+ln(ζ−1))(1+d ln n+ln(ζ−1)) .
To simplify the expressions for the number of measurements, let us choose ζ not too
small so that ln(ζ−1) is dominated by the other logarithmic terms and then ignore the
logarithmic terms. In Table 1, we compare different measurement operators in terms of
the simplified number of measurements up to a logarithmic factor that provide the RIP
on Ks with high probability.
Then the number of group structured measurements for RIP is roughly snd3 whereas the
one without random sign is sn2d2. Usually, d is smaller than n and the random sign reduces
the number of measurements in this case. For the group structured measurement operator
after random sign, m can be further reduced by factor d if a deterministic vector (e.g.,
η = [1, . . . , 1]⊤ ∈ RN ) is used instead. The Gaussian measurement case has optimal scaling
of snd. But its implementation may be impractical for high dimensional data. Recall
that in this comparison the group structured measurements also used random instrument.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 23
Table 1. Number of measurements for the RIP on rank-s tensors in (ℓn2 )
⊗πd .
Measurement type m up to a log factor size of orbit by group actions
Pure Gaussian measurements snd
Group structured measurements
sn2d2 n2d
by a random generator
Group structured measurements
snd3 2n
d
ndby a random generator
with random sign
However, the requirement on this random instrument is rather mild and does not require
strong concentration property of the Gaussian matrix.
On the other hand, note here that the transformations σ(g) preserve both the convex
body K and the ℓ2-norm. However, although the diagonal operator Dε also preserves
the ℓ2-norm, unlike σ(g), Dε does not preserve K in general. Also note that there are
applications where random sign cannot be implemented.
5. RIP in infinite dimension
In this section, we present the RIP on infinite dimensional sparsity models. A general
version is described below in the Fourier analysis framework, followed by illustrations on
two specific examples of the model.
5.1. RIP on infinite dimensional sparsity models.
We will consider various (semi-) norms on L2(0, 1) defined by using the Fourier series
representation. Let (f̂(k))k∈Z denote the Fourier series of the periodization of f ∈ L2(0, 1),
i.e.
f̂(k) = 〈ψk, f〉 =
∫ 1
0
ψk(t)f(t)dt, k ∈ Z ,
where ψks are complex sinusoid functions defined by
(24) ψk(t) = e
2πikt, t ∈ [0, 1) .
Let w = (wk)k∈Z be a nonnegative sequence and define a weighted (semi)norm
(25) ‖f‖22,w =
∑
k∈Z
wk|f̂(k)|2 .
This weighted (semi)norm is reminiscent of usual Besov norms. For example, if wk = k
for k ∈ Z, then it follows that ‖f‖2,w = ‖f ′‖L2 for all f ∈ C1. Let Hw denote the
(semi)normed space equipped with ‖ · ‖2,w. If wk > 0 for all k ∈ Z, then ‖ · ‖2,w is a valid
24 MARIUS JUNGE AND KIRYUNG LEE
norm and Hw is a Hilbert space. But we are also interested in the case where w is finitely
supported and ‖ · ‖2,w is just a seminorm.
In the Part I paper [JL17], we defined that a vector x ∈ H is (K, s)-sparse if ‖x‖X ≤√
s‖x‖H for a Hilbert space H and a Banach space X induced from a convex set K ⊂ H
such that the unit ball in X is K. One may note that the main results there were derived
without using the fact that the Hilbert space norm is definite, i.e. ‖x‖H = 0 implies
x = 0, and remain valid when the Hilbert space H is replaced by a seminormed space
Hw. In particular, [JL17, Theorem 2.1] applies to an infinite dimensional sparsity model
in L2(0, 1) defined by a Banach space Lq(0, 1) and a (semi)normed space Hw as follows.
Definition 5.1. Let 1 < q ≤ 2 and fix a weight sequence w = (wk)k∈Z. We say that
f ∈ L2(0, 1) is s-sparse with respect to (Hw, Lq(0, 1)) if
‖f‖Lq ≤
√
s‖f‖2,w .
As in the Part I paper [JL17], we consider random group structured measurements. Let
τt be a group action on L2(0, 1) that maps f to its translation to the right by t ∈ [0, 1)
modulo 1 and u : L2(0, 1) → ℓd2 be a linear operator that takes a Hilbert space valued
measurement. Then group structured measurements of f are generated as (u(τtjf))
m
j=1
where t1, . . . , tm are independent copies of a uniform random variable on [0, 1).
We are interested in a specific Hw with the weight sequence determined by u as
(26) wk = ‖u(ψk)‖22, k ∈ Z .
Then it follows that
(27) E‖u(τtjf)‖22 = ‖f‖2,w, ∀j = 1, . . . ,m .
Indeed, since
E〈ψk, (τtu∗uτt)ψj〉 =
∫ 1
0
e−2πi(k−j)t〈ψk, (u∗u)(ψj)〉dt = δkj〈ψk, (u∗u)(ψj)〉 ,
where δkj denotes the Kronecker delta, it follows that Eτ
∗
t u
∗uτt is a Fourier multiplier
such that
(Eτ∗t u
∗uτt)(f) =
∑
k∈Z
wkψk〈ψk, f〉, f ∈ L2(0, 1) .
In this setup, the main theorem in the Part I paper [JL17, Theorem 2.1] provides the
following corollary.
Corollary 5.2. Let 1 < q ≤ 2, 0 < ζ < 1, and δ > 0. Let ‖ · ‖2,w be defined by (25)
where (wj)j∈Z is given from u as (26). Suppose that t1, . . . , tm are independent copies of
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 25
a uniform random variable on [0, 1). Then there exists a numerical constant c such that
(28) P

 sup
‖f‖Lq≤
√
s
‖f‖2,w=1
∣∣∣ 1
m
m∑
j=1
‖u(τtjf)‖22 − ‖f‖22,w
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ
provided
m ≥ cδ−2smax
(
(q′)3(1 + ln d)3(1 + lnm)3, ln(ζ−1)
)∥∥∥
( d∑
l=1
|u∗(el)|2
)1/2∥∥∥
2
Lq′
.
Here, e1, . . . ,ed denote the standard basis vectors in R
d.
Proof. The proof is similar to that of [JL17, Theorem 5.3] and consists of verifying the
conditions of [JL17, Theorem 2.1]. We apply [JL17, Theorem 2.1] to Hw (instead of H)
with p = 2 and the 1-homogeneous function αd(·) given by
αd(u) =
∥∥∥
( d∑
l=1
|u∗(el)|2
)1/2∥∥∥
Lq′
.
First, instead of the isotropy, from (27) it follows that
E
1
m
m∑
j=1
‖u(τtjf)‖22 = ‖f‖2,w .
Second, Lq(0, 1) is a lattice and the complexity of its unit ball K is upper bounded by
[JL17, Theorem 3.8], where the type 2 constant of Lq′(0, 1) is no larger than
√
q′ [Car85,
Lemma 3]. Lastly we note
‖u‖ = sup
‖f‖Lq≤1
( d∑
l=1
|〈el, u(f)〉|2
)1/2
= sup
‖f‖Lq≤1
( d∑
l=1
|〈u∗(el), f〉|2
)1/2
≤ sup
‖f‖Lq≤1
〈( d∑
l=1
|u∗(el)|2
)1/2
, f
〉
= αd(u) .
Then the assertion follows from [JL17, Theorem 2.1]. 
If wk = 1 for all k ∈ Z, the weighted norm reduces to the usual L2-norm and Hw
becomes the Hilbert space L2(0, 1). However, since (26) is not satisfied for this weight
sequence with d < ∞, Corollary 5.2 does not apply to this case. However, there exist
interesting instances of Hw where Corollary 5.2 provides efficient compression of data in
infinite dimension. In the remainder of this section, we will illustrate Corollary 5.2 for two
specific Hws with motivating applications.
26 MARIUS JUNGE AND KIRYUNG LEE
5.2. Preserving truncated seminorms.
In the first example of Hw, we consider ‖ · ‖w,2 given as a truncated seminorm with the
weight sequence w = (wk)k∈Z given by
(29) wk =



1 −N ≤ k < N ,
0 otherwise .
In this setup, Corollary 5.2 implies that group structured measurements preserve the ℓ2-
norm of a subsequence of the Fourier series of f restricted to [−N,N) ∩ Z. This result
combined with the arguments in Section 3.2 shows that a subsequence of the Fourier
series within the given interval can be reconstructed from the described group structured
measurements.
We will apply Corollary 5.2 to specific measurement maps u : Lq(0, 1) → ℓd2 such that
the weight sequence (wk)k∈Z from u by (26) satisfies (29). Before discussing the number
of measurements for the RIP, we elaborate on the sparsity model to get a meaningful
physical interpretation of the sparsity level.
5.2.1. Smooth and sparse signals. In the canonical sparsity model in Rn, where the sparsity
level counts the number of nonzero entries, the ratio of the sparsity level s of an instance
to the dimension of the ambient space n takes a value in the unit interval [0, 1] and clearly
indicates how sparse the instance is. However, the sparsity level s of f ∈ L2(0, 1) in
Definition 5.1 with the weight sequence in (29) does not provide such an interpretation.
Here we will derive a subset of the sparsity model involving two interpretable parameters.
First let us indicate that the new notion of sparsity can be viewed as combination of two
sparsity conditions.
Lemma 5.3. Let 1 < q ≤ 2. Suppose that f ∈ L2(0, 1) satisfies
i) ‖f‖L2 ≤ α‖f‖2,w;
ii) f is supported on a set of measure γ;
Then f is s-sparse with respect to (Hw, Lq(0, 1)) with sparsity level s = α
2γ2/q−1.
Proof. Let E be the support of f and 1E(t) be the indicator function of E. Then we have
‖f‖qLq ≤
∫
1E(t)|f(t)|qdt ≤ λ(E)1−q/2
(∫
|f(t)|q(2/q)dt
)q/2
.
This implies
‖f‖Lq ≤ γ1/q−1/2‖f‖L2 ≤ γ1/q−1/2α‖f‖2,w .
Thus by definition the sparsity level s is at most γ2/q−1α2. 
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 27
When ‖ · ‖w,2 is given by the weight sequence in (29), the first condition in Lemma 5.3
implies that the Fourier coefficients within [−N,N) ∩ Z consume a fraction of the L2-
norm of f . Due to the Heisenberg uncertainty principle, f ∈ L2(0, 1) cannot have small
support in both the time and Fourier domains simultaneously. However, a certain notion
of sparsity can imply the concentration of a fraction of the L2 norm within a small support
in the Fourier domain. This is shown in the following lemma.
Lemma 5.4. Let 1 < q ≤ 2, N ∈ IN, (wk)k∈Z be defined in (29), and Hw be defined as
above. Define
(30) Kρ,γ = {f ∈ L2(0, 1) ∩ C1 | ‖f ′‖ ≤ ρ‖f‖L2 , λ(supp(f)) ≤ γ} ,
where λ denotes the normalized Lebesgue measure on (0, 1). Suppose that ρ ≤ N/2. Then
f ∈ Kρ,γ implies
‖f‖Lq ≤
√
s‖f‖2,w
for s = (1 + 4ρ2/N2)γ2/q−1.
Proof. Note that
∑
|k|≥N
|f̂(k)|2 ≤ N−2
∑
k
|kf̂(k)|2 ≤ N−2‖f ′‖L2 .
Without loss of generality, we may assume ‖f‖L2 = 1, and deduce that
1 = ‖f‖2L2 ≤ ‖f‖22,w +
ρ2
N2
and hence (1 − ρ2/N2) ≤ ‖f‖22,w. Since (1 − t)−2 ≤ (1 + 4t) for 0 < t ≤ 1/4, by the
assumption N ≥ 2ρ, it follows that
‖f‖L2 ≤ (1− ρ2/N2)−1‖f‖2,w ≤ (1 + 4ρ2/N2)1/2‖f‖2,w .
Let α = (1 + 4ρ2/N2)1/2. Furthermore, since f is supported on a set of measure γ, the
assertion follows from Lemma 5.3. 
The next lemma provides concrete examples that belong to Kρ,γ .
Lemma 5.5. Let φ be a positive smooth and differentiable function with φ(0) = 1 and
support contained in [−1/2, 1/2]. Let φT (x) = Tφ(Tx) and t1, . . . , tl with distance strictly
bigger than 1/T . Then
fT (t) =
l∑
j=1
αjφT (t− tj)
satisfies
i) λ(supp(fT )) ≤ lT ,
28 MARIUS JUNGE AND KIRYUNG LEE
ii) ‖fT ‖Lp = ‖φ‖LpT 1/p
′
(
∑l
j=1 |αj |p)1/p,
iii) ‖f ′T ‖L2 =
‖φ′‖L2
‖φ‖L2
T‖fT ‖L2
Proof. We just note that fT is a sum of disjointly supported functions. This proves i) and
moreover
‖fT ‖pLp =
n∑
j=1
|αj |p‖φT ‖pLp =
n∑
j=1
|αj |pT p−1‖φ‖pLp .
Indeed, we deduce from a change of variable that
‖φT ‖pLp = T
p−1
∫
|φ(Tx)|pTdx = T p−1‖φ‖pLp .
This yields ii). Note that φ′T is also disjointly supported, and hence
‖f ′T ‖pLp =
∑
j
|αj |p‖φ′T ‖pLp .
Then we note that∫
|φ′T (x)|pdx = T 2p−1
∫
|φ′(x)|pdx = T 2p−1‖φ′‖pLp .
This implies
‖f ′T ‖Lp =
( n∑
j=1
|αj |p
)1/p
T 2−1/p‖φ′‖Lp =
‖φ′‖Lp
‖φ‖Lp
T‖fT ‖Lp .
Assertion iii) is a special case. 
The signal model in Lemma 5.5 is given as a superposition of shifts of a given function φ
with finite support and is considered as a generalization of the cardinal B-spline [Uns99].
The shifts in Lemma 5.5 are not necessarily on a grid whereas the knots in the cardinal
B-spline are integer valued.
Next we illustrate how Corollary 5.2 implies the RIP on the model in Lemma 5.4 for
two specific choices of u that satisfies (26) for (wk) given by (29).
5.2.2. Deterministic instrument for measurements. Note that u : L2(0, 1) → ℓd2 is de-
scribed by h1, . . . , hd ∈ L2(0, 1) that satisfy hl = u∗(el) for all l = 1, . . . , d. Suppose that
2N = Ld holds for some L ∈ IN. (This requirement is not a strong restriction in designing
a measurement system.) Here we consider a deterministic u with h1, . . . , hd given by
(31) 〈hl, f〉 =
L∑
j=1
f̂(−N + (l − 1)L+ j − 1), f ∈ L2(0, 1) ,
or equivalently
hl =
L∑
j=1
ψ−N+(l−1)L+j−1 ,
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 29
where (ψk)k∈Z are complex sinusoids defined in (24).
Note that 〈hl, f〉 is a local average of (f̂(k))−N≤k<N on an interval of size L. These
measurements are obtained by applying an ideal low-pass filter supported of bandwidth
L, followed by subsampling by factor L in the Fourier domain. The corresponding weight
sequence w = (wk)k∈Z satisfies (29). For this deterministic u, Corollary 5.2 provides the
RIP result shown in the following proposition.
Proposition 5.6. Let u be defined as above with (hl)1≤l≤d satisfying (31), t1, . . . , tm be
independent copies of a uniform random variable on (0, 1), and w be defined by (29).
Suppose that 2N = Ld and ρ ≤ N/2. Then
P

 sup
f∈Kρ,γ
∣∣∣ 1
m
m∑
j=1
‖u(τtjf)‖22 − ‖f‖22,w
∣∣∣ ≥ max(δ, δ2)

 ≤ ζ
holds provided
m ≥ cδ−2(1+4ρ2/N2)max
(
(2+| ln γL|)4(1+ln d)3(1+lnm)3, (2+| ln γL|) ln(ζ−1)
)
γNL .
Proof of Proposition 5.6. Lemma 5.4 implies that every f ∈ Kρ,γ satisfies
‖f‖Lq ≤
√
s‖f‖2,w
for s = (1 + 4ρ2/N2)γ2/q−1.
Using the Khintchine inequality and type 2, we obtain
αd(u) =
∥∥∥
( d∑
l=1
|hl|2
)1/2∥∥∥
Lq′
≤
√
2
π
E
∥∥∥
d∑
l=1
εlhl
∥∥∥
Lq′
≤
√
2q′d
π
‖h1‖Lq′ ≤ C
√
q′dL1−1/q
′
,
where 1/q + 1/q′ = 1.
Then by Corollary 5.2, it suffices to satisfy
m ≥ cδ−2(1 + 4ρ2/N2)γL2 max
(
(q′)4(1 + ln d)3(1 + lnm)3, q′ ln(ζ−1)
)
d(γ2L2)−1/q
′
.
We chose q′ = max{2, | ln γL|}. 
Remark 5.7. The result in Proposition 5.6 implies that the number of shifts to recover
the ℓ2-norm of the Fourier series restricted to [−N,N) ∩ Z can be as small as γNL up to
a logarithmic factor. The total number of measurements is γN2. In this particular case,
if γ = o(1/N), then the number of measurements scales sublinearly in the dimension 2N
of the reconstruction space ℓ2N2 . Unlike the finite dimensional case, such small γ can be
still interesting in this infinite dimensional setup. In particular, Proposition 5.6 applies to
a sparse function with nonzero measure whereas the existing theory [VMB02] only applies
to a finite superposition of Dirac’s Delta or derivatives, which corresponds to a special case
30 MARIUS JUNGE AND KIRYUNG LEE
of function with measure zero. We leave it as an open problem to determine the optimal
sample rate for this infinite dimensional sparsity model. Nevertheless, as we show in the
next section, the number of measurements for a deterministic u can be improved using
incoherent measurements with a random instrument u.
5.2.3. Randomized instrument for incoherent measurements. Next we consider a random
instrument u for the measurements. Again we suppose that 2N = Ld holds for some L ∈
IN. Let (Jl)dl=1 be d non-overlapping ordered sets of size L such that ∪dl=1Jl = [−N,N)∩Z
and Jl∩Jl′ = ∅ for all l 6= l′. Let kl,j denote the jth element in Jl, i.e. Jl = (kl,1, . . . , kl,L)
for l = 1, . . . , d. Then we consider u with random h1, . . . , hd given by
(32) hl =
L∑
j=1
εjψkl,j
with a Rademacher sequence (εj)1≤j≤L. Then, by construction, the corresponding weight
sequence satisfies (29).
Randomness in (hl)1≤l≤d makes the measurements incoherent and reduce the number
of translations for the RIP as shown in the following proposition.
Proposition 5.8. Let u be defined by random (hl)1≤l≤d satisfying (32), t1, . . . , tm be
independent copies of a uniform random variable on (0, 1), and w be defined by (29).
Suppose that 2N = Ld and ρ ≤ N/2. Then
P

 sup
f∈Kρ,γ
∣∣∣ 1
m
m∑
j=1
‖u(τtjf)‖22 − ‖f‖22,w
∣∣∣ ≥ max(δ, δ2)

 ≤ 2ζ
holds provided
m ≥ cδ−2(1 + 4C2/N2)max
(
(1 + | ln γ|)4(1 + lnmd)3, (1 + | ln γ|) ln(ζ−1)
)
γN .
Proof of Proposition 5.8. We first compute a tail bound on
αd(u) =
∥∥∥
( d∑
l=1
|hl|2
)1/2∥∥∥
Lq′
.
Let (ε′l)1≤l≤d be a Rademacher sequence independent of (εj)1≤j≤L. Then
(33) Eε,ε′
∥∥∥
d∑
l=1
ε′lhl
∥∥∥
q′
Lq′
= Eε,ε′
∥∥∥
d∑
l=1
ε′l
L∑
j=1
εjψkl,j
∥∥∥
q′
Lq′
≤ Eε′′
∥∥∥
N−1∑
k=−N
ε′′kψk
∥∥∥
q′
Lq′
,
where (ε′′k)−N≤k<N is a Rademacher sequences independent of everything else. By applying
Khintchine’s inequality to the upper bound given in (33), we obtain
(
Eε,ε′
∥∥∥
d∑
l=1
ε′lhl
∥∥∥
q′
Lq′
)1/q′
≤ c
√
q′N
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 31
for a numerical constant c.
Moreover, by applying Kahane’s inequality (see [KW92]), we obtain
(
E
∥∥∥
( d∑
l=1
|hl|2
)1/2∥∥∥
r
Lq′
)1/r
≤
√
2
π
(
E
∥∥∥
d∑
l=1
ε′lhl
∥∥∥
r
Lq′
)1/r
≤
√
2
π
max
(
1,
√
r − 1
q′ − 1
)(
E
∥∥∥
d∑
l=1
ε′lhl
∥∥∥
q′
Lq′
)1/q′
≤
√
2
π
max
(
1,
√
r − 1
q′ − 1
)√
q′N1/2
≤ cmax{√r,
√
q′}N1/2 .
Then, by a consequence of Markov’s inequality [Dir15, Lemma A.1],
(34) P
(
αd(u) ≥
√
eN(
√
2 ln(ζ−1) +
√
q′)
)
≤ ζ .
Under the event when (34) is satisfied, for the RIP on Kρ,γ with probability 1 − ζ, it
suffices to satisfy
m ≥ cδ−2(1 + 4ρ2/N2)γLdγ−2/q′ max
(
(q′)3(1 + ln d)3(1 + lnm)3, ln(ζ−1)
)
(q′ + ln(ζ−1)) .
The incoherence due to randomness in (hl)1≤l≤d from the Rademacher sequence (εj)1≤j≤L
reduces the number of random translations by factor of L1−2/q
′
. To optimize m, we choose
q′ = (1 + | ln γ|). 
5.3. Preserving valid norms.
In general, one cannot recover a sparse signal in an infinite dimensional space from
finitely many measurements. For example, when unknown sparse signal f ∈ L2(0, 1) is
supported on a set of nonzero measure, at least a subsequence of the Fourier series at the
Landau rate is necessary [Lan67]. Known exceptions include the case where the unknown
f corresponds to a point measure, that is a superposition of finitely many Dirac’s delta
(e.g., [VMB02, CFG14, TBSR13].
In this section, we demonstrate a similar exception but for f with nonzero measure. As
for another application of Corollary 5.2, we demonstrate that a set of group structured
measurements preserve the weighted norm of a sparse f ∈ L2(0, 1) according to Defini-
tion 5.1 up to a small distortion. The recoverability follows as we combine this with the
arguments in Section 3.2. Specifically, we consider a weighted norm defined by the weight
sequence w = (wk)k∈Z given as
(35) wk =
1
max(k2, 1)
, ∀k ∈ Z .
32 MARIUS JUNGE AND KIRYUNG LEE
Unlike the previous example with a truncated seminorm, ‖ · ‖2,w given by (35) is a valid
norm. Moreover, it admits a sparsity model on antiderivatives determined by “smooth-
ness”.
Let g be an antiderivative of f such that f = g′ and ĝ(0) = 0. Such g is uniquely
determined and satisfies
‖f‖2,w = ‖g′‖2,w = ‖g‖L2 .
Therefore there is an one-to-one correspondence between
{f ∈ L2(0, 1) | ‖f‖Lq ≤
√
s‖f‖2,w}
and
(36) {g ∈ L2(0, 1) | ‖g′‖Lq ≤
√
s‖g‖2, ĝ(0) = 0} .
We will show two examples of group structured measurements (u(τtjg
′))mj=1 that preserve
the L2-norm of g for all g in the set in (36). Bote that the sparsity level s in (36) is clearly
interpreted as a measure of smoothness of g.
Remark 5.9. In fact, it is easy to extend the result without requiring ĝ(0) = 0. We
modify the set of smooth signals by
{g ∈ L2(0, 1) | ‖g′‖Lq ≤
√
s(‖g‖L2 − |ĝ(0)|2)} .
In this case, we need just one more measurement for ĝ(0).
5.3.1. Sampling in the time domain. The first example considers clever scalar-valued mea-
surements. The following theorem shows that one can approximate the L2-norm of a
smooth function from evaluation at finitely many points in the time domain.
Theorem 5.10. Let 1 < q ≤ 2 and 0 < s < ∞. Suppose that t1, . . . , tm are independent
copies of a uniform random variable on (0, 1). Then
P

 sup
‖g′‖Lq≤
√
s, ‖g‖L2=1
ĝ(0)=0
∣∣∣ 1
m
m∑
j=1
|g(tj)|2 − ‖g‖2L2
∣∣∣ ≥ δ

 ≤ ζ
holds provided
(37) m ≥ C(q)δ−2smax((q′)3(1 + lnm)3, ln(ζ−1)) .
Moreover, (37) also implies
P

 sup
‖g′‖Lq≤
√
s, ‖g‖L2−|ĝ(0)|2=1
∣∣∣ 1
m
m∑
j=1
(|g(tj)− ĝ(0)|2 + |ĝ(0)|2)− ‖g‖2L2
∣∣∣ ≥ δ

 ≤ ζ .
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 33
Proof. Let f = g′ for g satisfying ĝ(0) = 0. Then ‖f‖2,w = ‖g‖L2 .
We apply Corollary 5.2 with d = 1 and u : L2(0, 1) → C given by
u(f) = 〈h, f〉 , f ∈ L2(0, 1) ,
where
h =
∑
j∈Z\{0}
ψj
j
.
The Hausdorff-Young inequality implies that
αd(u) = ‖h‖Lq′ ≤
∥∥∥
(1
j
)
j∈Z\{0}
∥∥∥
ℓq(Z\{0})
≤ C(q) .
By Corollary 5.2 (37) implies
P

 sup
‖f‖Lq≤
√
s, ‖f‖2,w = 1
∣∣∣ 1
m
m∑
j=1
|u(τ−tjf)|2 − ‖f‖22,w
∣∣∣ ≥ δ

 ≤ ζ .
It remains to show u(τ−tjf) = u(τ−tjg
′) = g(tj) for j = 1, . . . ,m. Note that for every g
with ĝ(0) = 0 satisfies
∑
j∈Z\{0}
ĝ′(j)
j
=
∑
j∈Z\{0}
ĝ(j) = g(0) .
Here the last assertion is obtained by approximation with trigonometric polynomials.
Therefore
∑
j∈Z\{0}
̂(τ−tj (g))
′(j)
j
= (τ−tjg)(0) = g(tj) .
The second assertion follows from Remark 5.9. 
5.3.2. Taking local measurements in the Fourier domain. In the previous example, we
considered measurements given as time samples. In certain applications, data are ac-
quired sequentially in the Fourier domain. In this situation, before acquiring the full
Fourier series, one cannot evaluate time samples. In the second example, we demonstrate
a similar result for the measurements obtained as linear combinations of the Fourier series
coefficients on finitely supported windows.
Our strategy to get the RIP result on this example consists of the following two steps:
First, given a particular partition of Z, we consider infinitely many measurements of
random shifts of the signal, where each measurement is taken as the sum over the corre-
sponding block in the partition; Second, we show that due to the fast decay of the weight
sequence truncating the measurements to within first few dominant ones does not incur
any further significant distortion.
34 MARIUS JUNGE AND KIRYUNG LEE
We start with the first step. Note that Corollary 5.2 does not immediately apply for a
map u : L2(0, 1) → ℓ2 with an infinite dimensional range. Instead of working directly on
u, we approximate u with a sequence of operators (ul)l∈Z with finite dimensional ranges
and apply Corollary 5.2 to each ul. Let (Jl)l∈Z be a collection of disjoint intervals that
partition Z. Then we define (ul)l∈Z by
(38) (ul(f))(j) =



(u(f))(j) j ∈ Jl ,
0 otherwise .
Then the range of each ul has finite dimension and we also have
‖u(f)‖22 =
∑
l∈Z
‖ul(f)‖22 .
Lemma 5.11. Let t1, . . . , tm be independent copies of a uniform random variable on (0, 1),
(ul)l∈Z be defined by (38), ‖ · ‖2,w be a weighted norm defined by (25) with (wk)k∈Z given
by
(39) wk =
∑
l∈Z
‖ul(ψk)‖22, k ∈ Z .
Suppose that there exists a sequence (bl)l∈Z such that
∥∥∥
(∑
j∈Jl
|u∗l (ej)|2
)1/2∥∥∥
Lq′
≤ bl , ∀l ∈ Z .
Then
P

 sup
‖f‖Lq≤
√
s, ‖f‖2,w=1
∣∣∣ 1
m
m∑
j=1
∑
l∈Z
‖ul(τtj (f))‖22 − ‖f‖22,w
∣∣∣ ≥ max{δ, δ2}

 ≤ ζ
holds provided
m ≥ cδ−2smax
(
(q′)3
∑
l∈Z
(1 + ln dl)
3(1 + lnm)3b2l , ln(ζ
−1)
∑
l∈Z
b2l
)
.
Proof. Let (ulτtj )1≤j≤m : Lq(0, 1) → ℓm∞(ℓdl2 ) denote the composite map such that
(ulτtj )1≤j≤m(f) = (ul(τtjf))1≤j≤m, f ∈ Lq(0, 1) .
Let r ∈ N and ξ1, . . . , ξm be independent copies of ξ ∼ N (0, 1). Conditioned on t1, . . . , tm,
by the triangle inequality together, we have
(
E sup
f∈D
∣∣∣ 1
m
m∑
j=1
∑
l∈Z
ξj‖ul(τtjf)‖22
∣∣∣
r)1/r
≤
∑
k∈Z
(
E sup
f∈D
∣∣∣ 1
m
m∑
j=1
ξj‖ul(τtjf)‖22
∣∣∣
r)1/r
.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 35
By applying [JL17, Lemma 2.4] to each summand, we continue as
(
E sup
f∈D
∣∣∣ 1
m
m∑
j=1
∑
l∈Z
ξj‖ul(τtjf)‖22
∣∣∣
r)1/r
≤ C1
√
s
∑
l∈Z
(
sup
f∈D
m∑
j=1
‖ul(τtjf)‖22
)1/2(
E2,1((ulτtj )1≤j≤m) +
√
r‖(ulτtj )1≤j≤m‖
)
≤ C2
√
s
(
sup
f∈D
m∑
j=1
∑
l∈Z
‖ul(τtjf)‖22
)1/2((∑
l∈Z
E22,1((ulτtj )1≤j≤m)
)1/2
+
√
r
(∑
l∈Z
‖(ulτtj )1≤j≤m‖2
)1/2)
,
for numerical constants C1 and C2, where the last step follows from the Cauchy-Schwartz
inequality.
Therefore, similarly to the proof of [JL17, Proposition 2.6], it suffices to satisfy
√
sC3√
m
max
((∑
l∈Z
E22,1((ulτtj )1≤j≤m)
)1/2
,
(∑
l∈Z
ln(ζ−1)‖(ulτtj )1≤j≤m‖2
)1/2)
≤ δ .
Moreover, similarly to the proof of Corollary 5.2, we have
E2,1((ulτtj )1≤j≤m) ≤ c1(
√
q′)3(1 + ln dk)
3/2(1 + lnm)3/2bl
and
‖(ulτtj )1≤j≤m‖ ≤ bl
for all l ∈ Z.
Applying the upper bounds on the E2,1-norm and the operator norm of (ulτtj )1≤j≤m to
the above inequality completes the proof. 
Next we consider a specific collection (ul)l∈Z such that the corresponding weight se-
quence (wk)k∈Z given by (39) satisfies the decaying property in (35).
Example 5.12. Let h0 = ψ0 and
hl =
∑
2l−2<|k|≤2l−1
ψk
k
, ∀l ∈ IN ,
where (ψk)k∈Z denote complex sinusoids defined in (24). Define a sequence of maps that
generate scalar measurements by
ul(f) =



〈hl, f〉 l ≥ 0 ,
0 l < 0 .
Then (wk)k∈Z given by (39) satisfies (35).
Now we apply Lemma 5.11 with Jl = {l} for all l ∈ Z. In this setup, we have
∥∥∥
(∑
j∈Jl
|u∗l (ej)|2
)1/2∥∥∥
Lq′
= ‖hl‖Lq′ .
36 MARIUS JUNGE AND KIRYUNG LEE
Furthermore, by the Hausdorff-Young inequality, we have Note that
‖hl‖Lq′ =
∥∥∥
∑
2l−2<|k|≤2l−1
ψk
k
∥∥∥
Lq′
≤ 2
( ∑
k ≥ 2l
k−q
)1/q
≤ 2C1(q)2−l/q
′
.
Let g be an antiderivative of f such that f = g′ and ĝ(0) = 0. Then ‖f‖2,w = ‖g‖L2 .
Lemma 5.11 implies
P

 sup
‖g′‖Lq≤
√
s, ‖g‖L2=1
ĝ(0)=0
∣∣∣ 1
m
m∑
j=1
‖u(τtjg′)‖22 − ‖g‖22
∣∣∣ ≥ δ

 ≤ ζ
holds provided
m ≥ C3(q)δ−2smax((q′)3(1 + lnm)3, ln(ζ−1)) .
Here m denotes the number of translations for the RIP.
Note that by the chain rule τtjg
′ = (τtjg)
′. Moreover, the shift in the time domain
becomes a multiplication with a complex exponential in the Fourier domain. Therefore,
(40) ul(τtjg
′) =
∑
2l−2<|k|≤2l−1
τ̂tjg(k) =
∑
2l−2<|k|≤2l−1
e−2πiktj ĝ(k) .
This implies that each scalar measurement is computed as a linear combination of the
Fourier series coefficients of g in a given window. This type of measurements are preferred
over time samples in certain applications.
Example demonstrated a sufficient number of translates for the RIP. However, there we
took infinitely many measurements for each translate. However, when the weight sequence
(wj)j∈Z\{0} is given as in (35), the L2 norm of f that satisfies ‖f‖Lq ≤
√
s‖f‖2,w is highly
concentrated on a finite interval in the Fourier domain. Therefore, one can approximate
the L2-norm of a smooth function from finitely many measurements, which is stated in
the following theorem.
Theorem 5.13. Let 1 < q ≤ 2, s > 0, I0 = {0}, and Il = {k | 2l−2 < |k| ≤ 2l−1} for
l ∈ IN. Let t1, . . . , tm be independent copies of a uniform random variable on (0, 1). Then
there exists a constant C(q) that depends only on q such that
P

 sup
‖g′‖Lq≤
√
s, ‖g‖L2=1
ĝ(0)=0
∣∣∣ 1
m
m∑
j=1
∑
0≤l≤l0
∣∣∣
∑
k∈Il
e−2πiktj ĝ(k)
∣∣∣
2
− ‖g‖2L2
∣∣∣ ≥ δ

 ≤ ζ
provided
l0 ≥ max{1, C(q)(1 + | ln(s/δ)|)}
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 37
and
m ≥ C(q)δ−2smax((q′)3(1 + lnm)3, ln(ζ−1)) .
Proof. We repeat the arguments in Example 5.3.2 for δ/2. Let us consider g ∈ L2(0, 1)
such that ĝ(0) = 0 and f = g′, then automatically f̂(0) = 0 and hence
P

 sup
‖f‖Lq≤
√
s, ‖f‖2,w≤1
∣∣∣ 1
m
m∑
j=1
‖u(τtjf)‖2 − ‖f‖22,w
∣∣∣ ≥ δ/4

 ≤ ζ .
Let us recall that
‖f‖22,w =
∑
j∈Z\{0}
k−2|f̂(k)|2 =
∑
j∈Z\{0}
k−2|ĝ′(k)|2 = ‖g‖2L2 .
On the other hand for ul(f) =
∑
k∈Il f̂(k)/k we have
∑
l ≥ l0
‖ul(f)‖22 =
∑
l ≥ l0
∣∣∣
〈∑
k∈Il
ψk
k
, f
〉∣∣∣
2
≤
∑
l ≥ l0
‖f‖2Lq
∥∥∥
∑
k∈Il
ψk
k
∥∥∥
2
Lq′
≤ s
∑
l ≥ l0
(∑
k∈Il
k−q
)2/q
≤ C1(q)s
∑
l ≥ l0
2−2l/q
′ ≤ C2(q)s2−2l0/q
′
.
Thus the assertion follows by choosing l0 so that 2
−2l0/q′ ≤ δ2C2(q)s is satisfied. 
Remark 5.14. Now the number of measurements per translate reduced to a finite number
l0 and the total number of scalar measurements is l0m. Note that the oversampling factor
l0 compared to the number of translations m is just in the order of C(q) ln(s/δ), which is
a mild requirement. Here sparsity is implied by a smoothness condition.
Acknowledgement
This work was supported in part by NSF grants IIS 14-47879 and DMS 15-01103. The
authors thank Yihong Wu and Yoram Bresler for helpful discussions.
References
[Car85] Bernd Carl. Inequalities of Bernstein-Jackson-type and the degree of compactness of operators
in Banach spaces. In Annales de l’institut Fourier, volume 35, pages 79–118, 1985.
[CFG14] Emmanuel J Candès and Carlos Fernandez-Granda. Towards a mathematical theory of super-
resolution. Communications on Pure and Applied Mathematics, 67(6):906–956, 2014.
38 MARIUS JUNGE AND KIRYUNG LEE
[CRT06] Emmanuel J Candès, Justin Romberg, and Terence Tao. Robust uncertainty principles: Ex-
act signal reconstruction from highly incomplete frequency information. IEEE Transactions on
information theory, 52(2):489–509, 2006.
[CT06] Emmanuel J Candes and Terence Tao. Near-optimal signal recovery from random projections:
Universal encoding strategies? Information Theory, IEEE Transactions on, 52(12):5406–5425,
2006.
[CW15] Yudong Chen and Martin J Wainwright. Fast low-rank estimation by projected gradient descent:
General statistical and algorithmic guarantees. arXiv preprint arXiv:1509.03025, 2015.
[Dir15] Sjoerd Dirksen. Tail bounds via generic chaining. Electronic Journal of Probability, 20, 2015.
[DJT95] Joe Diestel, Hans Jarchow, and Andrew Tonge. Absolutely summing operators, volume 43.
Cambridge University Press, 1995.
[FB96] Ping Feng and Yoram Bresler. Spectrum-blind minimum-rate sampling and reconstruction of
multiband signals. In Acoustics, Speech, and Signal Processing, 1996. ICASSP-96. Conference
Proceedings., 1996 IEEE International Conference on, volume 3, pages 1688–1691. IEEE, 1996.
[Fen98] Ping Feng. Universal minimum-rate sampling and spectrum-blind reconstruction for multiband
signals. PhD thesis, University of Illinois at Urbana-Champaign, 1998.
[FS03] Jeffrey A Fessler and Bradley P Sutton. Nonuniform fast fourier transforms using min-max
interpolation. IEEE Transactions on Signal Processing, 51(2):560–574, 2003.
[Gor88] Yehoram Gordon. On Milman’s inequality and random subspaces which escape through a mesh
in Rn. In Geometric Aspects of Functional Analysis, pages 84–106. Springer, 1988.
[JL17] Marius Junge and Kiryung Lee. Generalized notions of sparsity and restricted isometry property.
Part I: A unified framework. arXiv preprint arXiv:1706.09410, 2017.
[JZ13] Marius Junge and Qiang Zeng. Noncommutative Bennett and Rosenthal inequalities. The An-
nals of Probability, 41(6):4287–4316, 2013.
[KW92] S. Kwapień and W.A. Woyczyński. Random series and stochastic integrals: single and multiple.
Number v. 1991 in Probability and its applications. Birkhäuser, 1992.
[Lan67] HJ Landau. Necessary density conditions for sampling and interpolation of certain entire func-
tions. Acta Mathematica, 117(1):37–52, 1967.
[ME09] Moshe Mishali and Yonina C Eldar. Blind multiband signal reconstruction: Compressed sensing
for analog signals. IEEE Transactions on Signal Processing, 57(3):993–1009, 2009.
[MEE11] Moshe Mishali, Yonina C Eldar, and Asaf J Elron. Xampling: Signal acquisition and processing
in union of subspaces. IEEE Transactions on Signal Processing, 59(10):4719–4734, 2011.
[ORS15] Samet Oymak, Benjamin Recht, and Mahdi Soltanolkotabi. Isometric sketching of any set via
the restricted isometry property. arXiv preprint arXiv:1506.03521, 2015.
[Rau10] Holger Rauhut. Compressive sensing and structured random matrices. Theoretical foundations
and numerical methods for sparse recovery, 9:1–92, 2010.
[RV08] Mark Rudelson and Roman Vershynin. On sparse reconstruction from Fourier and Gaussian
measurements. Communications on Pure and Applied Mathematics, 61(8):1025–1045, 2008.
[Søn12] Peter L Søndergaard. Efficient algorithms for the discrete gabor transform with a long fir win-
dow. Journal of Fourier Analysis and Applications, 18(3):456–470, 2012.
[TBSR13] Gongguo Tang, Badri Narayan Bhaskar, Parikshit Shah, and Benjamin Recht. Compressed
sensing off the grid. IEEE Transactions on Information Theory, 59(11):7465–7490, 2013.
GENERALIZED NOTIONS OF SPARSITY AND RIP. PART II: APPLICATIONS 39
[TJ89] Nicole Tomczak-Jaegermann. Banach-Mazur distances and finite-dimensional operator ideals,
volume 38. Longman Sc & Tech, 1989.
[Uns99] Michael Unser. Splines: A perfect fit for signal and image processing. IEEE Signal processing
magazine, 16(6):22–38, 1999.
[VMB02] Martin Vetterli, Pina Marziliano, and Thierry Blu. Sampling signals with finite rate of innova-
tion. IEEE transactions on Signal Processing, 50(6):1417–1428, 2002.
[ZL16] Qinqing Zheng and John Lafferty. Convergence analysis for rectangular matrix completion using
burer-monteiro factorization and gradient descent. arXiv preprint arXiv:1605.07051, 2016.

