Attacks on Copyright Marking SystemsFabien A.P. Petitcolas, Ross J. Anderson, and Markus G. KuhnUniversity of Cambridge, Computer LaboratoryPembroke Street, Cambridge CB2 3QG, UKfapp2,rja14,mgk25cl.cam.ac.ukhttpwww.cl.cam.ac.ukResearchSecurityDavid Aucsmith, Ed., Second workshop on information hiding, in vol. 1525 of LectureNotes in Computer Science, Portland, Oregon, USA, 1417 April, 1998, pp. 218238.ISBN 3540653864.Abstract. In the last few years, a large number of schemes have beenproposed for hiding copyright marks and other information in digitalpictures, video, audio and other multimedia objects. We describe somecontenders that have appeared in the research literature and in the fieldwe then present a number of attacks that enable the information hiddenby them to be removed or otherwise rendered unusable.1 Information Hiding ApplicationsThe last few years have seen rapidly growing interest in ways to hide information in other information. A number of factors contributed to this. Fears thatcopyright would be eroded by the ease with which digital media could be copiedled people to study ways of embedding hidden copyright marks and serial numbers in audio and video concern that privacy would be eroded led to work onelectronic cash, anonymous remailers, digital elections and techniques for making mobile computer users harder for third parties to trace and there remainthe traditional military concerns about hiding ones own traffic while makingit hard for the opponent to do likewise.The first international workshop on information hiding 3 brought thesecommunities together and a number of hiding schemes were presented theremore have been presented elsewhere. We formed the view that useful progressin steganography and copyright marking might come from trying to attack allthese first generation schemes. In the related field of cryptology, progress wasiterative cryptographic algorithms were proposed, attacks on them were found,more algorithms were proposed, and so on. Eventually, theory emerged fastcorrelation attacks on stream ciphers and differential and linear attacks on blockciphers, now help us understand the strength of cryptographic algorithms inmuch more detail than before. Similarly, many cryptographic protocols wereproposed and almost all the early candidates were broken, leading to conceptsof protocol robustness and techniques for formal verification 7. The first author is grateful to Intel Corporation for financial support under the grantRobustness of Information Hiding Systems The third author is supported by a European Commission MarieCurie grant218So in this paper, we first describe the copyright protection context in whichmost recent schemes have been developed we then describe a selection of theseschemes and present a number of attacks, which break most of them. We finallymake some remarks on the meaning of robustness in the context of steganographyin general and copyright marking in particular.1.1 Copyright Protection IssuesDigital recording media offer many new possibilities but their uptake has beenhindered by widespread fears among intellectual property owners such as Hollywood and the rock music industry that their livelihoods would be threatenedif users could make unlimited perfect copies of videos, music and multimediaworks.One of the first copy protection mechanisms for digital media was the serialcopy management system SCMS introduced by Sony and Phillips for digitalaudio tapes in the eighties 34. The idea was to allow consumers to make adigital audio tape of a CD they owned in order to use it say in their car, butnot to make a tape of somebody elses tape thus copies would be limited tofirst generation only. The implementation was to include a Boolean marker inthe header of each audio object. Unfortunately this failed because the hardwareproduced by some manufacturers did not enforce it.More recently the Digital Video Disk, also known as Digital Versatile DiskDVD consortium called for proposals for a copyright marking scheme to enforceserial copy management. The idea is that the DVD players sold to consumerswill allow unlimited copying of home videos and timeshifted viewing of TVprogrammes, but cannot easily be abused for commercial piracy 21, 46. Theproposed implementation is that videos will be unmarked, or marked nevercopy, or copy once only compliant players would not record a video markednever copy and when recording one marked copy once only would change itsmark to never copy. Commercially sold videos would be marked never copy,while TV broadcasts and similar material would be marked copy once only andhome videos would be unmarked.Electronic copyright management schemes have also been proposed by European projects such as Imprimatur and CITED 47, 68, 69, and American projectssuch as the proposed by the Working Group on Intellectual Property Rights 71.1.2 ProblemsAlthough these schemes might become predominant in areas where they can beimposed from the beginning such as DVD and videoondemand, they sufferfrom a number of drawbacks. Firstly, they rely on the tamperresistance of consumer electronics  a notoriously unsolved problem 5. The tamperresistancemechanisms being built into DVD players are fairly rudimentary and the history of satellite TV piracy leads us to expect the appearance of rogue playerswhich will copy everything. Electronic copyright management schemes also conflict with applications such as digital libraries, where fair use provisions are219strongly entrenched. According to Samuelson, Tolerating some leakage may bein the long run of interest to publishers ... For educational and research works,payperuse schemes may deter learning and deep scholarship 58. A Europeanlegal expert put it even more strongly that copyright laws are only toleratedbecause they are not enforced against the large numbers of petty offenders 35.Similar issues are debated within the software industry some people argue,for example, that a modest level of amateur software piracy actually enhancesrevenue because people may try out software they have borrowed from a friendand then go on to buy it or the next update.For all these reasons, we may expect leaks in the primary copyright protectionmechanisms and wish to provide independent secondary mechanisms that canbe used to trace and prove ownership of digital objects. It is here that markingtechniques are expected to be most important.2 Copyright MarksThere are two basic kinds of mark fingerprints and watermarks. One may thinkof a fingerprint as an embedded serial number while a watermark is an embeddedcopyright message. The first enables us to trace offenders, while the second canprovide some of the evidence needed to prosecute them. It may also, as in theDVD proposal, form part of the primary copy management system but it willmore often provide an independent backup to a copy management system thatuses overt mechanisms such as digital signatures.In 8, we discussed the various applications of fingerprinting and watermarking, their interaction, and some related technologies. Here, we are concerned withthe robustness of the underlying mechanisms. What sort of attacks are possibleon marking schemes What sort of resources are required to remove marks completely, or to alter them so that they are read incorrectly What sort of effectdo various possible removal techniques have on the perceptual quality of theresulting audio or videoWe will use the terminology agreed at the first international workshop onInformation Hiding 54. The information to be hidden watermark, fingerprint,or in the general case of steganography, a secret message is embedded in a coverobject a cover CD, a cover video, a cover text, etc. giving a stego object, whichin the context of copyright marking we may also call a marked object CD, video,etc. The embedding is performed with the help of a key, a secret variable thatis in general known to the objects owner. Recovery of the embedded mark mayor may not require a key if it does the key may be equal to, or derived from,the key used in the embedding process.In the rest of this section, we will first discuss simple hiding methods andthe obvious attacks on them. We will then present, as an example of the stateof the art, robustness requirements that appeared in a recent music industryrequest for proposals 1. We will then present the main contending techniquesused in currently published and fielded systems. Attacks on these systems willthen be presented.2202.1 Simple Hiding MethodsThe simplest schemes replace all the bits in one or more of the less significant bitplanes of an image or audio sample with the hidden information 12, 26, 39, 67.This is particularly easy with pictures even when the four least significant bits ofthe cover image are replaced with the four most significant bits of the embeddedimage, the eye cannot usually tell the difference 39. Audio is slightly harder, asthe randomisation of even the least significant bit of 8bit audio adds noise that isaudible during quiet passages of music or pauses in speech. Nonetheless, severalsystems have been proposed they include embedding, in the regular channelsof an audio CD, another sound channel 27, 70 and a steganographic system inwhich secret messages are hidden in the digitised speech of an ISDN telephoneconversation 26.However, bitplane replacement signals are not only easy to detect. Theyviolate Kerckhoffs principle that the security of a protection system should notrely on its method of operation being unknown to the opponent, but rather onthe choice of a secret key 36. Better approaches use a key to select some subsetof pixels or sound samples which then carry the mark.An example of this approach is Chameleon 6, a system which enables abroadcaster to send a single ciphertext to a large population of users, each ofwhich is supplied with a slightly different decryption key the effect of this isto introduce a controlled number of leastsignificantbit errors into the plaintextthat each user decrypts. With uncompressed digital audio, the resulting noiseis at an acceptably low level and then Chameleon has the advantage that thedecrypted audio is fingerprinted automatically during decryption without anyrequirement that the consumer electronic device be tamperresistant.In general, schemes which use a key to choose some subset of least significantbits to tweak may provide acceptable levels of security in applications where thedecrypted objects are unlikely to be tampered with. However, in many applications, a copyright pirate may be able and willing to perform significant filteringoperations and these will destroy any watermark, fingerprint or other messagehidden by simple bit tweaking. So we shall now consider what it means for amarking scheme to be robust.2.2 Robustness RequirementsThe basic problem is to embed a mark in the digital representation of an analogueobject such as a film or sound recording in such a way that it will not reducethe perceived value of the object while being difficult for an unauthorised personto remove. A first pass at defining robustness in this context may be found in arecent request for proposals for audio marking technology from the InternationalFederation for the Phonographic Industry, IFPI 1. The goal of this exercise wasto find a marking scheme that would generate evidence for antipiracy operations,track the use of recordings by broadcasters and others and control copying. TheIFPI robustness requirements are as follows221 the marking mechanism should not affect the sonic quality of the soundrecording the marking information should be recoverable after a wide range of filteringand processing operations, including two successive DA and AD conversions, steadystate compression or expansion of 10, compression techniquessuch as MPEG and multiband nonlinear amplitude compression, addingadditive or multiplicative noise, adding a second embedded signal using thesame system, frequency response distortion of up to 15 dB as applied bybass, mid and treble controls, group delay distortions and notch filters there should be no other way to remove or alter the embedded informationwithout sufficient degradation of the sound quality as to render it unusable given a signaltonoise level of 20 dB or more, the embedded data channelshould have a bandwidth of 20 bits per second, independent of the signallevel and type classical, pop, speech.Similar requirements could be drawn up for marking still pictures, videosand multimedia objects in general. However, before rushing to do this, we willconsider some systems recently proposed and show attacks on them that willsignificantly extend the range of distortions against which designers will have toprovide defences, or greatly reduce the available bandwidth, or both.2.3 General TechniquesWe mentioned schemes that modify the least significant bits of digital mediaby repeating such marks, or employing more robust encoding methods, we cancounter some filtering attacks. We can also combine coding with various transform techniques DCT, wavelet and so on.The Patchwork algorithm 11, for instance, successively selects random pairsof pixels it makes the brighter pixel brighter and the duller pixel duller andthe contrast change in this pixel subset encodes one bit. To maintain reasonablerobustness against filtering attacks, the bandwidth of such systems has to belimited to at most a few hundred bits per image 40, 41. In a similar way, markscan be embedded in audio by increasing the amplitude contrast of many pairsof randomly chosen sound samples and using a suitable filter to minimise theintroduction of highfrequency noise.More sophisticated variants on this theme involve spreadspectrum techniques. Although these have been used since the midfifties in the militarydomain because of their antijamming and lowprobabilityofintercept properties 61, their applicability to image watermarking has only been noticed recentlyby Tirkel et al. 66. Since then a number of systems based on this techniquehave been proposed 67, 72, 73 typically a maximal length sequence is addedto the signal in the spatial domain and the watermark is detected by using thespatial crosscorrelation of the sequence and the watermarked image.Another kind of marking technique embeds the mark in a transform domain,typically one that is widely used by compression algorithms. Thus when marking sound one could add a pseudorandom sequence to the excitation signal in222an LPC or CELP coded audio signal 45 and when marking an image one coulduse the DCT domain. Langelaar et al. remove certain high frequency DCT coefficients 41 Cox et al. modulate the 1000 largest DCT coefficients of an imagewith a random vector 19 Koch et al. change the quantisation of the DCT coefficients and modify some of them in such a way that a certain property orderin size is verified 37 while O Ruanaidh et al. modulate the DCT coefficientwith a bidirectional coding 49.Techniques of this kind are fairly robust against various kinds of signal processing and may be combined with exploitation of the perceptual masking properties of the human auditory system in 16, 17 and of the human vision systemin 28, 65, 64. The basic idea here is to amplify the mark wherever the changeswill be less noticeable and also to embed it in the perceptually significant components of the signal 20. Masking may also be used to avoid placing marks inplaces such as the large expanses of pure colour found in cartoons the colourhistogram of such images has sharp peaks, which are split into twin peaks bysome nave marking methods as the colour value c is replaced by c  and c ,thus allowing the mark to be identified and removed 44.3 AttacksThis leads us to the topic of attacks and here we present some quite generalkinds of attack that destroy, or at least reveal significant limitations of, severalmarking schemes PictureMarc 1.51 24, 56, SysCoP 37, 74, 75, JK PGS EPFLalgorithm, part of the European TALISMAN project, SureSign 63, EIKONAmark 25, 55, Echo Hiding, and the NEC method 19. We suspect that systemsthat use similar techniques are also vulnerable to our attacks.3.1 The Jitter AttackOur starting point in developing a systematic attack on marking technology wasto consider audio marking schemes that tweak low order bits whose locationis specified by a key. A simple and devastating attack on these schemes is toadd jitter to the signal. In our first implementation, we split the signal intochunks of 500 samples, either duplicated or deleted a sample at random in eachchunk resulting in chunks of 499 or 501 samples long and stuck the chunksback together. This turned out to be almost imperceptible after filtering, evenin classical music but the jitter prevents the marked bits from being located.In a more sophisticated implementation, we resample these chunks at a loweror higher frequency. This relies on the properties of the ears pitch resolutionIn pitch perception experiments in the midaudio frequency range,subjects are able to perceive changes in frequency of pure tones of approximately 0.1. ... At frequencies above 4 kHz pitch discriminationreduces substantially. ... In the case of complex signals, such as speech,it is very much less clear what the capabilities and processes of the auditory system are. ... There is evidence that peaks in the spectrum of223the audio signal are detected more easily than features between spectralpeaks. J.N. Holmes 33If ni is the number of samples in the ith chunk, ni the number of samplesafter resampling and  the maximum relative change of frequency allowed then,in the midaudio range, we are roughly limited, for pure tones, by ni  nibecause  is small, where ni  ni1  ni. This can be simplified as 0 k  n2 when the ni are equal and when the number k of removed or addedsamples is constant for each chunk. This is the approach we chose it allowed usto introduce a long jitter. Then the strategy for choosing k and n depends onthe input signal. With this technique we were able to tweak up to one sample in50 of a 44 kHz sampled voice recording without any perceptible effect.We also applied a similar attack to SysCoP Demo 1.0. In that case we simplydeleted columns of pixels and duplicated others in order to preserve the imagesize. Fig. 1 gives an example of this attack.Of course, there are much more subtle distortions that can be applied. Forinstance, in 30, Hamdy et al. present a way to increase or decrease the lengthof a music performance without changing the pitch this was developed to enable radio broadcasters to slightly increase or decrease the playing time of amusical track. As such tools become widely available, attacks involving soundmanipulation will become easy. Most simple spreadspectrum based techniquesare subject to this kind of attacks. Indeed, although spreadspectrum signal arevery robust to distortion of their amplitude and to noise addition, they do notsurvive timing errors synchronisation of the chip signal is very important andsimple systems fail to recover this synchronisation properly.3.2 StirMarkFollowing this attack and after evaluating some watermarking software, it became clear that although many of the seriously proposed schemes could survivebasic manipulations  that is, manipulations that can be done easily with standard tools, such as rotation, shearing, resampling, resizing and lossy compression  they would not cope with combinations of them. This motivated us toimplement StirMark.StirMark is a generic tool developed for simple robustness testing of imagemarking algorithms and other steganographic techniques. In its simplest version,StirMark simulates a resampling process, i.e. it introduces the same kind of errorsinto an image as printing it on a high quality printer and then scanning it againwith a high quality scanner. It applies a minor geometric distortion the imageis slightly stretched, sheared, shifted andor rotated by an unnoticeable randomamount1 Fig. 2  middle drawing and then resampled using either bilinear or1 If A, B, C and D are the corners of the image, a point M of the said image can beexpressed as M  A  1 D  1  B  1  C where 0  ,   1are the coordinates of M relatively to the corners. The distortion is done by movingthe corners by a small random amount in both directions. The new coordinates ofM are given by the previous formula, keeping ,  constant.224a bbash imageread demo watermarked.ppmKeyNo certificate file.A valid watermark found  estimated correction percentage is  100Retrieved Secret Label string  SysCoPTMcbash imageread demo jitter.ppmKeyNo certificate file.Cannon find valid watermark  failed.Image jitter.ppm has been tampered or has not beenwatermarked.de fFig. 1. A successful jitter attack on SysCoP. We used the demo software release 1.0available on SysCoPs Web site 76. a shows an image watermarked with SysCoPand b the same image but after the attack. In the first case the software detectsthe watermark correctly c but the check fails on the modified image d. Here, theattack simply consists in deleting and duplicating some columns of pixels such thatthe original size of the picture is conserved. e shows the columns which have beendeleted  and duplicated . Finally, f is a magnified view of the white rectanglein e the bottom part corresponds to the original image.225Nyquist interpolation. In addition, a transfer function that introduces a smalland smoothly distributed error into all sample values is applied. This emulatesthe small nonlinear analogdigital converter imperfection typically found inscanners and display devices. StirMark introduces a practically unnoticeablequality loss in the image if it is applied only once. However after a few iteratedapplications, the image degradation becomes noticeable.With those simple geometrical distortions we could confuse most markingsystems available on the market. More distortions  still unnoticeable  can beapplied to a picture. We applied a global bending to the image in addition tothe general bilinear property explained previously a slight deviation is appliedto each pixel, which is greatest at the center of the picture and almost nullat the borders. On top of this a higher frequency displacement of the form sinxx sinyy nx, y  where n is a random number  is added. In orderfor these distortions to be most effective, a medium JPEG compression is appliedat the end.Fig. 2. We exaggerate here the distortion applied by StirMark to still pictures. Thefirst drawing corresponds to the original picture the others show the picture afterStirMark has been applied  without and with bending and randomisation.For those unfamiliar with digital image signal processing we shall now summarise briefly the main computation steps. Apart from a few simple operationssuch as rotations by 90 or 180 degrees, reflection and mirroring, image manipulation usually requires resampling when destination pixels do not line up withsource pixels. In theory, one first generates a continuous image from the digitalone, then modifies the continuous image, finally samples this to create a newdigital image. In practice, however, we compute the inverse transform of a newpixel and evaluate the reconstruction function at that point.There are numerous reconstruction filters. In a first version of the software wesimply used a linear interpolation but, as foreseen, this tended to blur the imagetoo much, making the validity of the watermark removal arguable. Then weimplemented the sinc function as a reconstruction filter, which gives theoreticallyperfect reconstruction for photo images and can be described as follows. If x, yare the coordinates of the inverse transform  which, in our case is a distortion ofthe picture  of a point in the new image and f the function to be reconstructed,226then, an estimate of f at x, y is given by fx, y ninnjn sincx isincy  jfi,j . This gives very much better results than the simple filter anexample of the removal of an NEC watermark is given in Fig. 3.We suggest that image watermarking tools which do not survive StirMark with default parameters  should be considered unacceptably easy to break. Thisimmediately rules out the majority of commercial marking schemes.a bFig. 3. Kings College Chapel, courtesy of John Thompson, JetPhotographic, Cambridge. For this example we watermarked a picture with NECs algorithm 19. Weused the default parameters suggested by their paper N  1000 and   0.1. a isthe watermarked image. We then applied StirMark b and tested the presence of thewatermark. The similarity between the original watermark and the extracted watermark was 3.74 instead of 21.08. This is well below the decision threshold.One might try to increase the robustness of a watermarking system by tryingto foresee the possible transforms used by pirates one might then use techniquessuch as embedding multiple versions of the mark under suitable inverse transforms for instance O Ruanaidh and Pereira suggest to use the FourierMellintransform2 to cope with rotation and scaling 50. However, the general themeof the attacks we have developed and described above is that given a targetmarking scheme, we invent a distortion or a combination of distortions thatwill remove it or at least make it unreadable, while leaving the perceptual valueof the previously marked object undiminished. We are not limited in this processto the distortions produced by common analogue equipment, or considered inthe IFPI request for proposals cited above.2 The FourierMellin transform is equivalent to the Fourier transform on a logpolarmap x, y ,  with x  e cos  and y  e sin .227As an analogy, one might consider the chosen protocol attack on authentication schemes 60. It is an open question whether there is any marking schemefor which a chosen distortion attack cannot be found.3.3 The Mosaic AttackThis point is emphasised by a presentation attack, which is of quite generalapplicability and which possesses the initially remarkable property that a markedimage can be unmarked and yet still rendered pixel for pixel in exactly the sameway as the marked image by a standard browser.The attack was motivated by a fielded automatic system for copyright piracydetection, consisting of a watermarking scheme plus a web crawler that downloads pictures from the net and checks whether they contain a watermark.It consists of chopping an image up into a number of smaller subimages, whichare embedded in a suitable sequence in a web page. Common web browsersrender juxtaposed subimages stuck together, so they appear identical to theoriginal image Fig. 4. This attack appears to be quite general all markingschemes require the marked image to have some minimal size one cannot hide ameaningful mark in just one pixel. Thus by splitting an image into sufficientlysmall pieces, the mark detector will be confused 53. The best that one can hopefor is that the minimal size could be quite small and the method might thereforenot be very practical.Fig. 4. Screenshot of a web browser while downloading an image after the mosaicattack. This attack chops a watermarked image into smaller images which are stuckback together when the browser renders the page. We implemented software that readsa JPEG picture and produces a corresponding mosaic of small JPEG images as well asthe necessary HTML code automatically 53. In some cases downloading the mosaic iseven faster than downloading the full image In this example we used a 350280pixelimage watermarked using PictureMarc 1.51.228There are other problems with such crawlers. Java applets, ActiveX controls,etc. can be embedded to display a picture inside the browser the applet couldeven descramble the picture in real time. Defeating such techniques would entailrendering the web page, detecting pictures and checking whether they contain amark. An even more serious problem is that much current piracy is of picturessold via many small services, from which the crawler would have to purchasethem using a credit card before it could examine them. A crawler that providedsuch guaranteed sales would obviously become a target.3.4 Attack on Echo HidingOne of the few marking schemes to be robust against the jitter attack is echohiding, which hides information in sound by introducing echoes with very shortdelays. Echo hiding 29 relies on the fact that we cannot perceive short echoessay 1 ms and embeds data into a cover audio signal by introducing an echocharacterised by its delay  and its relative amplitude . By using two types ofecho it is possible to encode ones and zeros. For this purpose the original signal isdivided into chunks separated by spaces of pseudorandom length each of thesechunks will contain one bit of information.The echo delays are chosen between 0.5 and 2 milliseconds and the bestrelative amplitude of the echo is around 0.8. According to its creators, decodinginvolves detecting the initial delay and the autocorrelation of the cepstrum ofthe encoded signal is used for this purpose.The obvious attack on this scheme is to detect the echo and then remove itby simply inverting the convolution formula the problem is to detect the echowithout knowledge of either the original object or the echo parameters. Thisis known as blind echo cancellation in the signal processing literature and isknown to be a hard problem in general.We tried several methods to remove the echo. Frequency invariant filtering 51, 59 was not very successful. Instead we used a combination of cepstrumanalysis and brute force search.The underlying idea of cepstrum analysis is presented in 15. Suppose thatwe are given a signal yt which contains a simple single echo, i.e. yt  xt xt  . If we note xx the power spectrum of x then yyf  xxf1 2 cos2f 2 whose logarithm is approximately log yyf  log xxf 2 cos2f. This is a function of the frequency f and taking its power spectrumraises its quefrency  , that is the frequency of cos2f. The autocovarianceof this later function emphasises the peak that appears at quefrency  Fig. 5.To remove the echos, we need a method to detect the echo delay  . For this,we used a slightly modified version of the cepstrum C    ln  where C isthe autocovariance function3,  the power spectrum density function and  thecomposition operator. Experiments on random signals as well as on music showthat this method returns quite accurate estimators of the delay Fig. 6 whenan artificial echo has been added to the signal. In the detection function we only3 Cx  Ex xx x.2290 0.005 0.01 0.015 0.02 0.0250.60.40.200.20.40.60.8Delay  sCepstrum of a signal without echoa0 0.005 0.01 0.015 0.02 0.0250.80.60.40.200.20.40.60.8Delay  sCepstrum of a signal with echo d0.02, 1bFig. 5. Graph a represents the cepstrum of a signal without echo. Graph b is thecepstrum of the same signal with a 20 ms echo which is emphasised by the very clearpeak at 0.02 s.consider echo delays between 0.5 and 3 milliseconds. Below 0.5 ms the functiondoes not work properly and above 3 ms the echo becomes too audible.Our first attack was to remove an echo with random relative amplitude,expecting that this would introduce enough modification in the signal to preventwatermark recovery. Since echo hiding gives best results for  greater than 0.7we could use   an estimation of   drawn from, say a normal distributioncentred on 0.8. It was not really successful so our next attack was to iteratewe reapply the detection function and vary  to minimise the residual echo.We could obtain successively better estimators of the echo parameters and thenremove this echo. When the detection function cannot detect any more echo,we have got the correct value of  as this gives the lowest output value ofthe detection function. Results obtained using this algorithm are presented inFig. 6.3.5 Protocol ConsiderationsThe main threat addressed in the literature is an attack by a pirate who tries toremove the watermark directly. As a consequence, the definition commonly usedfor robustness includes only resistance to signal manipulation cropping, scaling,resampling, etc.. Craver et al. show that this is not enough by exhibiting aprotocol level attack 22.The basic idea is that many schemes provide no intrinsic way of detectingwhich of two watermarks was added first the process of marking is often additive, or at least commutative. So if the owner of the document d encodes awatermark w and publishes the marked version dw and has no other proof ofownership, a pirate who has registered his watermark as w can claim that thedocument is his and that the original unmarked version of it was d  w  w.Their paper 23 extends this idea to defeat a scheme which is noninvertiblean inverse needs only be approximated.2300.20.40.60.810.511.52x 1030.40.60.811.21.41.61.822.2x 103Detected delay in a random signala0.20.40.60.810.511.52x 1030.40.60.811.21.41.61.822.2x 103Detected delay in a piece of musicbFig. 6. Performances of the echo detector. We added different echoes characterised bytheir relative amplitude  and their delay  to a signal and each time we used our echodetector to find an estimation  of  . These graphs show the detected echo delay as afunction of  and  for random signals a and for a piece of music b.Craver et al. argue for the use of informationlosing marking schemes whoseinverses cannot be approximated closely enough. However, our alternative interpretation of their attack is that watermarking and fingerprinting methods mustbe used in the context of a larger system that may use mechanisms such astimestamping and notarisation to prevent attacks of this kind.Registration mechanisms have not received very much attention in the copyright marking literature to date. The existing references such as 18, 32, 31, 52mainly focus on protecting the copyright holder and do not fully address therights of the consumers who might be fooled by a crooked reseller.3.6 Implementation ConsiderationsThe robustness of embedding and retrieving techniques is not the only issue.Most attacks on fielded cryptographic systems have come from the opportunisticexploitation of loopholes that were found by accident cryptanalysis was rarelyused, even against systems that were vulnerable to it 2.We cannot expect copyright marking systems to be any different and the pattern was followed in the first attack to be made available on the Internet againstthe most widely used picture marking scheme, PictureMarc, which is bundledwith Adobe Photoshop and Corel Draw. This attack 13 exploited weaknessesin the implementation rather than the underlying marking algorithms, even although these are weak the marks can be removed using StirMark.Each user has an ID and a twodigit password, which are issued when sheregisters with Digimarc and pays for a subscription. The correspondence betweenIDs and passwords is checked using obscure software in the implementation andalthough the passwords are short enough to be found by trial and error, the231attack first uses a debugger to break into the software and disable the passwordchecking mechanism.We note in passing that IDs are public, so either password search or disassembly can enable any user to be impersonated.A deeper examination of the program also allows a villain to change the ID,thus the copyright, of an already marked image as well as the type of use suchas adult versus general public content. Before embedding a mark, the programchecks whether there is already a mark in the picture, but this check can bebypassed fairly easily using the debugger with the result that it is possible tooverwrite any existing mark and replace it with another one.Exhaustive search for the personal code can be prevented by making it longer,but there is no obvious solution to the disassembly attack. If tamper resistantsoftware 9 cannot give enough protection, then one can always have an onlinesystem in which each user shares a secret embedding key with a trusted partyand uses this key to embed some kind of digital signature. Observe that thereare two separate keyed operations here the authentication which can be donewith a signature and the embedding or hiding operation.Although we can do publickey steganography  hiding information so thatonly someone with a certain private key can detect its existence 4  we still donot know how to do the hiding equivalent of a digital signature that is, to enablesomeone with a private key to embed marks in such a way that anyone with thecorresponding public key can read them but not remove them. One problem isthat a public decoder can be used by the attacker he can remove a mark byapplying small changes to the image until the decoder cannot find it anymore.This was first suggested by Perrig in 52. In 42 a more theoretical analysisof this attack is presented as well as a possible countermeasure randomisatingthe detection process. One could also make the decoding process computationally expensive. However neither approach is really satisfactory in the absence oftamperresistant hardware.Unless a breakthrough is made, applications that require the public verifiability of a mark such as DVD appear doomed to operate within the constraintsof the available tamper resistance technology, or to use a central mark readingservice. This is evocative of cryptographic key management prior to the inventionof public key techniques.4 ConclusionWe have demonstrated that the majority of copyright marking schemes in theliterature are vulnerable to attacks involving the introduction of subperceptuallevels of distortion. In particular, many of the marking schemes in the marketplace provide only a limited measure of protection against attacks. Most of themare defeated by StirMark, a simple piece of software that we have placed in thepublic domain 38. We have also shown a specific attack on the one seriousexception to this rule echo hiding.232This experience confirms our hypothesis that steganography would go throughthe same process of evolutionary development as cryptography, with an iterativeprocess in which attacks lead to more robust systems.Our experience in attacking the existing marking schemes has convinced usthat any system which attempted to meet all the accepted requirements formarking such as those set out by IFPI would fail if it met the robustnessrequirements then its bandwidth would be quite insufficient. This is hardly surprising when one considers that the information content of many music recordingis only a few bits per second, so to expect to embed 20 bits per second againstan opponent who can introduce arbitrary distortions is very ambitious.Our more general conclusion from this work is that the marking problemhas been overabstracted there is not one marking problem but a whole constellation of them. We do not believe that any general solution will be found. Thetradeoffs and in particular the critical one between bandwidth and robustness,will be critical to designing a specific system.We already remarked in 8 on the importance of whether the warden wasactive or passive  that is, whether the mark needed to be robust against distortion. In general, we observe that most real applications do not require all ofthe properties in the IFPI list. For example, when auditing radio transmissions,we only require enough resistance to distortion to deal with naturally occurringeffects such as multipath. Many applications will also require supporting protocol features, such as the timestamping service that we mentioned in the contextof reversible marks.So we do not believe that the intractability of the marking problem is areason to abandon this field of research. On the contrary practical schemes formost realistic application requirements are probably feasible and the continuingprocess of inventing schemes and breaking them will enable us to advance thestate of the art rapidly.Finally, we suggest that the real problem is not so much inserting the marksas recognising them afterwards. Thus progress may come not just from devising new marking schemes, but in developing ways to recognise marks that havebeen embedded using the obvious combinations of statistical and transform techniques and thereafter subjected to distortion. The considerable literature onsignal recognition may provide useful starting points.AcknowledgementsSome of the ideas presented here were clarified by discussion with Roger Needham, David Wheeler, John Daugman, Peter Rayner, David Aucsmith, StewartLee, Scott Craver, Brian Moore, Mike Roe, Peter Wayner, Jon Honeyball, ScottMoskowitz and Matt Blaze.233References1. Request for proposals  Embedded signalling systems issue 1.0. International Federation of the Phonographic Industry, 54 Regent Street, London W1R 5PJ, June1997.2. Ross J. Anderson. Why cryptosystems fail. Communications of the ACM,37113240, November 1994.3. Ross J. Anderson, editor. Information hiding first international workshop, volume1174 of Lecture Notes in Computer Science, Isaac Newton Institute, Cambridge,England, May 1996. SpringerVerlag, Berlin, Germany.4. Ross J. Anderson. Stretching the limits of steganography. In IH96 3, pages 3948.5. Ross J. Anderson and Markus G. Kuhn. Tamper resistance  A cautionary note.In Second USENIX Workshop on Electronic Commerce, pages 111, Oakland, CA,USA, November 1996.6. Ross J. Anderson and Charalampos Manifavas. Chameleon  a new kind of streamcipher. In Biham 14, pages 107113.7. Ross J. Anderson and Roger M. Needham. Programming satans computer. InJ.van Leeuwen, editor, Computer Science Today  Commemorative Issue, volume1000 of Lecture Notes in Computer Science, pages 426441. SpringerVerlag, Berlin,Germany, 1995.8. Ross J. Anderson and Fabien A. P. Petitcolas. On the limits of steganography.IEEE Journal of Selected Areas in Communications, 164474481, May 1998.Special Issue on Copyright  Privacy Protection.9. David Aucsmith. Tamper resistant software An implementation. In Anderson 3,pages 317333.10. David Aucsmith, editor. Information Hiding Second International Workshop, volume 1525 of Lecture Notes in Computer Science, Portland, Oregon, USA, 1998.SpringerVerlag, Berlin, Germany.11. Walter Bender, Daniel Gruhl, and Norishige Morimoto. Techniques for data hiding.In Niblack and Jain 48, pages 164173.12. Walter Bender, Daniel Gruhl, Norishige Morimoto, and Anthony Lu. Techniquesfor data hiding. IBM Systems Journal, 353  4313336, 1996.13. Anonymous zguan.bbsbbs.ntu.edu.tw. Learn cracking IV  another weakness of PictureMarc. newstw.bbs.comp.hacker mirrored on httpwww.cl.cam.ac.ukfapp2watermarkingimagewatermarkingdigimarccrack.html,August 1997. Includes instructions to override any Digimarc watermark usingPictureMarc.14. Eli Biham, editor. Fast Software Encryption  4th International Workshop,FSE97, volume 1267 of Lecture Notes in Computer Science, Haifa, Israel, January 1997. SpringerVerlag, Germany.15. Bruce P. Bogert, M.J.R. Healy, and John W. TEnglandey. The quefrency alanysisof time series for echoes Cepstrum, pseudoautocovariance, crossceptstrum andsaphe cracking. In M. Rosenblatt, editor, Symposium on Time Series Analysis,pages 209243, New York, NY, USA, 1963. John Wiley  Sons, Inc.16. Laurence Boney, Ahmed H. Tewfik, and Khaled N. Hamdy. Digital watermarks foraudio signals. In European Signal Processing Conference, EUSIPCO 96, Trieste,Italy, September 1996.17. Laurence Boney, Ahmed H. Tewfik, and Khaled N. Hamdy. Digital watermarks foraudio signals. In International Conference on Multimedia Computing and Systems,pages 473480, Hiroshima, Japan, 1723 June 1996. IEEE.23418. Marc Cooperman and Scott A. Moskowitz. Steganographic method and device.US Patent 5,613,004, March 1995.19. Ingemar J. Cox, Joe Kilian, Tom Leighton, and Talal Shamoon. A secure, robustwatermark for multimedia. In Anderson 3, pages 183206.20. Ingemar J. Cox and Matt L. Miller. A review of watermarking and the importanceof perceptual modeling. In Rogowitz and Pappas 57.21. Ingemar J. Cox and Kazuyoshi Tanaka. NEC data hiding proposal. Technicalreport, NEC Copy Protection Technical Working Group, July 1997. Response tocall for proposal issued by the Data Hiding SubGroup.22. Scott Craver, Nasir Memon, BoonLock Yeo, and Minerva M. Yeung. Can invisiblewatermark resolve rightful ownerships In Sethin and Jain 62, pages 310321.23. Scott Craver, Nasir Memon, BoonLock Yeo, and Minerva M. Yeung. Resolvingrightful ownerships with invisible watermarking techniques Limitations, attacks,and implications. IEEE Journal of Selected Areas in Communications, 164573586, May 1998. Special Issue on Copyright  Privacy Protection. ISSN 07338716.24. Digimarc home page. httpwww.digimarc.com, April 1997.25. Eikonamark. Alpha Tec Ltd., httpwww.generation.netpitassign.html,October 1997.26. Elke Franz, Anja Jerichow, Steffen Moller, Andreas Pfitzmann, and Ingo Stierand.Computer based steganography how it works and why therefore any restrictionon cryptography are nonsense, at best. In Anderson 3, pages 721.27. Michael A. Gerzon and Peter G. Graven. A highrate burieddata channel for audioCD. Journal of the Audio Engineering Society, 4312322, JanuaryFebruary1995.28. Francois Goffin, JeanFrancois Delaigle, Christophe De Vleeschouwer, BenotMacq, and JeanJacques Quisquater. A low cost perceptive digital picture watermarking method. In Sethin and Jain 62, pages 264277.29. Daniel Gruhl, Walter Bender, and Anthony Lu. Echo hiding. In Anderson 3,pages 295315.30. Khaled N. Hamdy, Ahmed H. Tewfik, Ting Chen, and Satoshi Takagi. Timescalemodification of audio signals with combined harmonic and wavelet representations. In International Conference on Acoustics, Speech and Signal Processing ICASSP 97, volume 1, pages 439442, Munich, Germany, April 1997. IEEE, IEEEPress. Session on Hearing Aids and Computer Music.31. Alexander Herrigel, Joseph J. K. O Ruanaidh, Holger Petersen, Shelby Pereira,and Thierry Pun. Secure copyright protection techniques for digital images. InAucsmith 10, pages 169190.32. Alexander Herrigel, Adrian Perrig, and Joseph J. K. O Ruanaidh. A copyrightprotection environment for digital images. In Verlaliche ITSysteme 97, AlbertLudwigs Universitat, Freiburg, Germany, October 1997.33. J.N. Holmes. Speech Synthesis and Recognition, chapter 3.6 Analysis of simple andcomplex signals, pages 4748. Aspects of Information Technology. Chapman Hall, London, England, 1988.34. International Electrotechnical Commission, Geneva, Switzerland. Digital audiointerface, IEC 60958, February 1989.35. Alastair Kelman. Electronic copyright management  the way ahead. SecuritySeminars, University of Cambridge, February 1997.36. A. Kerckhoffs. La Cryptographie Militaire. Journal des Sciences Militaires, 9538,January 1883.23537. E. Koch and J. Zhao. Towards robust and hidden image copyright labeling. InWorkshop on Nonlinear Signal and Image Processing, pages 452455, Neos Marmaras, Greece, June 1995. IEEE.38. Markus G. Kuhn and Fabien A. P. Petitcolas. StirMark. httpwww.cl.cam.ac.ukfapp2watermarkingstirmark, November 1997.39. Charles Kurak and John McHugh. A cautionary note on image downgrading.In Computer Security Applications Conference, pages 153159, San Antonio, TX,USA, December 1992.40. Gerrit C. Langelaar, Jan C.A van der Lubbe, and J. Biemond. Copy protection formultimedia data based on labeling techniques. In 17th Symposium on InformationTheory in the Benelux, Enschede, The Netherlands, May 1996.41. Gerrit C. Langelaar, Jan C.A. van der Lubbe, and Reginald L. Lagendijk. Robustlabeling methods for copy protection of images. In Sethin and Jain 62, pages298309.42. JeanPaul M.G. Linnartz and Marten van Dijk. Analysis of the sensitivity attackagainst electronic watermarks in images. In Aucsmith 10, pages 258272.43. Mark Lomas, Bruno Crispo, Bruce Christianson, and Mike Roe, editors. SecurityProtocols Proceeding of the 5th International Workshop, volume 1361 of LectureNotes in Computer Science, Ecole Normale Superieure, Paris, France, April 1997.University of Cambridge, Isaac Newton Institute, SpringerVerlag, Berlin, Germany.44. Maurice Maes. Twin peaks The histogram attack on fixed depth image watermarks. In Aucsmith 10, pages 290305.45. Kineo Matsui and Kiyoshi Tanaka. Videosteganography How to secretly embed a signature in a picture. Journal of the Interactive Multimedia AssociationIntellectual Property Project, 11187205, January 1994.46. Norishige Morimoto and Daniel Sullivan. IBM DataHiding proposal. Technicalreport, IBM Corporation, September 1997. Response to call for proposal issued bythe Data Hiding SubGroup.47. Peter Nancarrow. Digital technology  Bane or boon for copyright ComputerLaboratory Seminars, University of Cambridge, November 1997.48. Wayne Niblack and Ramesh C. Jain, editors. Storage and Retrieval for Image andVideo Database III, volume 2420, San Jose, California, USA, February 1995. IST,The Society for Imaging Science and Technology and SPIE, The InternationalSociety for Optical Engineering, SPIE.49. Joseph J. K. O Ruanaidh, W. J. Dowling, and F. M. Boland. Watermarkingdigital images for copyright protection. IEE Proceedings on Vision, Signal andImage Processing, 1434250256, August 1996.50. Joseph J. K. O Ruanaidh and Shelby Pereira. A secure robust digital image watermark. In International Symposium on Advanced Imaging and Network Technologies  Conference on Electronic Imaging Processing, Printing and Publishingin Colour, Europto, Zurich, Switzerland, May 1998. International Society for Optical Engineering, European Optical Society, Commission of the European Union,Directorate General XII.51. Alan V. Oppenheim and Ronald W. Schafer. DiscreteTime Signal Processing,chapter 12, pages 768834. PrenticeHall International, Inc., Englewood Cliffs,NJ, USA, international edition, 1989.52. Adrian Perrig. A copyright protection environment for digital images. Diplomadissertation, Ecole Polytechnique Federale de Lausanne, Lausanne, Switzerland,February 1997.23653. Fabien A. P. Petitcolas. Weakness of existing watermarking schemes. httpwww.cl.cam.ac.ukfapp2watermarkingimagewatermarking, October 1997.54. Birgit Pfitzmann. Information hiding terminology. In Anderson 3, pages 347350.Results of an informal plenary meeting and additional proposals.55. I. Pitas. A method for signature casting on digital images. In International Conference on Image Processing, volume 3, pages 215218, September 1996.56. Geoffrey B. Rhoads. Steganography methods employing embedded calibrationdata. US Patent 5,636,292, June 1997.57. Bernice E. Rogowitz and Thrasyvoulos N. Pappas, editors. Human Vision andElectrtonic Imaging II, volume 3016, San Jose, CA, USA, February 1997. IST,The Society for Imaging Science and Technology and SPIE, The InternationalSociety for Optical Engineering, SPIE.58. Pamela Samuelson. Copyright and digital libraries. Communications of the ACM,3841521, 110, April 1995.59. Ronald W. Schafer. Echo removal by discrete generalized linear filtering. TechnicalReport 466, Massachusetts Institute of Technology, February 1969.60. Bruce Schneier. Protocol interactions and the chosen protocol attack. In Lomaset al. 43, pages 91104.61. Robert A. Scholtz. The origins of spreadspectrum communications. IEEE Transactions on Communications, 305822853, May 1982.62. Ishwar K. Sethin and Ramesh C. Jain, editors. Storage and Retrieval for Image andVideo Database V, volume 3022, San Jose, CA, USA, February 1997. IST, TheSociety for Imaging Science and Technology and SPIE, The International Societyfor Optical Engineering, SPIE.63. Signum Technologies  SureSign digital fingerprinting. httpwww.signumtech.com, October 1997.64. Mitchell D. Swanson, Bin Zhu, and Ahmed H. Tewfik. Transparent robust imagewatermarking. In International Conference on Image Processing, volume III, pages211214. IEEE, 1996.65. Mitchell D. Swanson, Bin Zu, and Ahmed H. Tewfik. Robust data hiding forimages. In 7th Digital Signal Processing Workshop DSP 96, pages 3740, Loen,Norway, September 1996. IEEE.66. A.Z. Tirkel, G.A. Rankin, R.M. van Schyndel, W.J. Ho, N.R.A. Mee, and C.F.Osborne. Electronic watermark. In Digital Image Computing, Technology andApplications  DICTA 93, pages 666673, Macquarie University, Sidney, 1993.67. R.G. van Schyndel, A.Z. Tirkel, and C.F. Osborne. A digital watermark. InInternational Conference on Image Processing, volume 2, pages 8690, Austin,Texas, USA, 1994. IEEE.68. Georges Van Slype. Natural language version of the generic CITED model  ECMSElectronic Copyright Management System design for computer based applications. Report 2, European Commission, ESPRIT II Project, Bureau Vam Dijk,Brussel, Belgium, May 1995.69. Georges Van Slype. Natural language version of the generic CITED model  Presentation of the generic model. Report 1, European Commission, ESPRIT II Project,Bureau Vam Dijk, Brussel, Belgium, May 1995.70. A. Werner, J. Oomen, Marc E. Groenewegen, Robbert G. van der Waal, and Raymond N.J. Veldhuis. A variablebitrate burieddata channel for compact disc.Journal of the Audio Engineering Society, 43122328, JanuaryFebruary 1995.71. The Working Group on Intellectual Property Rights is part of the US InformationInfrastructure Task Force, formed in February 1993.23772. Raymond B. Wolfgang and Edward J. Delp. A watermark for digital images. InInternational Conference on Images Processing, pages 219222, Lausanne, Switzerland, September 1996. IEEE.73. Raymond B. Wolfgang and Edward J. Delp. A watermarking technique for digitalimagery further studies. In International Conference on Imaging, Systems, andTechnology, pages 279287, Las Vegas, NV, USA, 30 June3 July 1997. IEEE.74. J. Zhao and E. Koch. Embedding robust labels into images for copyright protection. In International Congress on Intellectual Property Rights for SpecialisedInformation, Knowledge and New Technologies, Vienna, Austria, August 1995.75. Jian Zhao. A WWW service to embed and prove digital copyright watermarks. InEuropean Conference on Multimedia Applications, Services and Techniques, pages695710, LouvainlaNeuve, Belgium, May 1996.76. Jian Zhao. The syscop home page. httpsyscop.igd.fhg.de or httpwww.crcg.edusyscop, February 1997.238
