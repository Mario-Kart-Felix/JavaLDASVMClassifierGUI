184  InternatIonal Journal of Computer SCIenCe  teChnologyIJCST Vol. 2, SP 1, DeCember 2011 ISSN  09768491Online    ISSN  22294333Printw w w . i j c s t . c o mAbstractInternet Protocol IP trace back system is the enabling technology to control Internet Crime. In this paper, we present a novel and practical IP trace back system called Neural Network Based Packet Marking NNPM.The NNPM shows to calculate time for better tracing performance compare with FDPM and the NNPM Algorithm provides innovative features to trace the source of IP packets and can obtain better tracing capability compare with FDPM.It also adaptively changes its marking rate according to the load of the participating router by flexible flowbased marking scheme. Evaluations on both simulation and real system implementation demonstrate that NNPM requires a moderately small number of packets to complete the trace back process. The motivation of this trace back system is from DDoS defencse.It has been used to not only trace DDoS attacking packets but also DDoS Detection. It has a wide array of applications for other security systems. And comparison the algorithms on the basis of the timeKeywordsFiltering DDoS neural network trace back packet marking, DDoS attacks, IP trace back, performance evaluation, routers, security.I. IntroductionDistributed Denial of Service DDoS attacks have been a serious problem on todays Internet. A DDoS attack is characterized by an explicit attempt from an attacker to prevent legitimate users from using the desired resources 8. Many defense approaches have been proposed to fight against DDoS attacks, such as filtering 9, trace back 1, congestion control 2 and replication 3. However, it is still difficult to solve the notorious problem ultimately. The reasons lie in two facts. One is the DDoS tools are easy to get and use, thus even an inexperienced hacker can launch the attack effortlessly. The other reason is that it is difficult to separate the attack traffic from legitimate traffic, and then remove the attack traffic.  Recently many researchers focus their interests on IP trace back. IP trace back is the ability to trace IP packets to their origins without relying on the source address field in the IP header it provides a system with the ability to identify true sources of the IP packets. This ability is beneficial to locate the attackers and provide judicial evidences for forensics. Many trace back schemes have been proposed, such as link testing 5, 7, messaging 3, logging 9 and packet marking 9, 4.Packet marking trace back overwrites some fields in the IP header, which are called marks. In particular, an improved DPM scheme, Flexible Deterministic Packet Marking FDPM 5, requires a small number of IP packets to find out more sources than other schemes, and has a builtin overload prevention mechanism to intelligently mark packets when system is overloaded in highspeed networks. Instead of investigating trace back schemes, we present a markaided distributed filtering approach in this paper, which utilizes the marks of DPMFDPM to filter out attack traffic. According to experimental results, we find this system can sensitively and accurately detect anomalies caused by DDoS, thus provides high legitimate traffic throughput and reduce attack traffic throughput. Our contributions in this paper are that we propose an effective DDoS defense mechanism to differentiate the legitimate traffic and attack traffic which can offer most of network resources to legitimate users explore the effectiveness of using trace back technique to filter DDoS attack traffic and apply neural network in finding network anomalies.Given the widespread use of automated attack tools, attacks against Internetconnected systems are now so commonplace that Internet crime has become a ubiquitous phenomenon. Although a number of countermeasures and legislations against Internet crime have been proposed and developed, Internet crime is still on the rise. One critical reason is that researchers and law enforcement agencies still cannot answer a simple question easily who or where is the real source of Internet attacks Unless this question is fully addressed, effective defense systems and legislations against such crime would only be blusterous ornaments because knowing where the DDoS attacking packets come from, where a suspect intruder is located, where a malicious email is originated, or where a terrorism website is hosted is the key to identify, track, report, arrest, and punish criminals. The dynamic, stateless, and anonymous nature of the Internet makes it extremely difficult to trace the sources of Internet crime, since the attacker can forge the source address field in an Internet Protocol IP packet. To find the real source of Internet attacks, we must possess the capability of discovering the origin of IP packets without relying on the source IP address field. This capability is called IP trace back. IP trace back systems provide a means to identify true sources of IP packets without relying on the source IP address field of the packet header, and are the major technique to find the real attack sources 1. Although currently there have been many publications on IP trace back, some key issues that are essential to make an IP trace back scheme into a really usable trace back system were not solved, such as how many sources can be traced in one trace back process, how large is the false positive rate, how many packets are needed to trace one source, and how to alleviate the load of participating routers. In this paper, a novel and practical IP trace back system, Flexible Deterministic Packet Marking FDPM, is presented. FDPM belongs to the packet marking family of IP trace back systems. The novel characteristics of FDPM are in its flexibility first, it can adjust the length of marking field according to the network protocols deployed flexible mark length strategy second, it can also adaptively change its marking rate according to the load of the participating router by a flexible flowbased marking scheme. These two novels Characteristics of FDPM Internet Protocol trace back System for Tracing Sources of DDoS Attacks and DDoS Detection in Neural Network Packet Marking1T. Ravi Kumar, 2T Padmaja, 3P. Samba Siva Raju1,3Sri Venkateswara Institute of Science  Information Technology, Tadepalligudem, AP, India2Bhimavaram Institute of Engineering  Technology, Pennada, Bhimavaram, AP, India InternatIonal Journal of Computer SCIenCe  teChnology 185IJCST Vol. 2, SP 1, DeCember 2011ISSN  09768491Online    ISSN  22294333Printw w w . i j c s t . c o mmake it more practical than other current trace back systems in terms of compatibility and performance. Both simulation and real system implementation prove that FDPM can be used in real network environments to trace a large number of real sources, with low false positive rates, and with low resource requirement on routers.The rest of this paper is organized as follows Section II surveys previous work on IP trace back research. In Section III, the existing system, Section IV describes the simulation on how results Section V conclusion and reference.II. Existing SystemA. Problem DescriptionLet Ai, i 2 0 n be the attackers and V be the victim. The attackers and victim are linked by various routers Rj, j 2 1m. The main objective of IP trace back problem is to identify the n routers directly connected to Ai. The key issue here is to completely identify the n routers with low false positive rates in a single trace back process conducted by the same trace back point, e.g., V , for a certain period because correlating the data in different trace back processes is not only extremely difficult but also meaningless for tracing a timedependent event. In 3, it was stated that a practical IP trace back system should be able to identify a few hundred 102 sourcesrouters out of 1 million routers. Some trace back schemes not only identify the n routers directly connected to Ai but also find the routes between the n routers to victim V . In this paper, we only deal with the problem of finding these n routers not the routes. In fact, the packets starting from the same origin and arriving at the same destination still may take different routes because of the dynamic nature of the Internet. Therefore, considering routes may not have direct benefits to identify the real source of attacks.B. Current IP Trace back SchemesThere are some survey papers discussing the tradeoffs of different IP trace back schemes, such as 4, 5, and 6. Current IP trace back schemes can be classified into five categories link testing, messaging, logging, packet marking, and hybrid schemes. The main idea of the link testing scheme is to start from the victim to trace the attack to upstream links, and then determine which one carries the attack traffic 7, 8. It consumes huge amount of resources, introduces additional traffic, and possibly causes denial of service when the number of sources needed to be traced increases. Messaging schemes use routers to send ICMP messages from the participating routers to destinations. For a high volume flow, the victim will eventually receive ICMP packets from all the routers along the path back to the source, revealing its location 9, 10, 8. The disadvantages of messaging schemes are that the additional ICMP traffic would possibly be filtered by some routers, and huge numbers of packets are required by the victim to identify the sources. Logging schemes include probabilistic sampling and storing transformed information. Logging schemes maintain a database for all the traffic at every router within the domain and to query the database to identify the sources of an IP packet. Hash function or Bloom filter is used to reduce the data stored. The main disadvantage of logging schemes is that they heavily overload the participating routers by requiring them to log information about every packet passing by, although it is claimed that it needs only a single packet to find its origin 1,35. Packet marking schemes insert trace back data into an IP packet header to mark the packet on its way through the various routers from the attack source to the destination then the marks in the packets can be used to deduce the sources of packets or the paths of the traffic 2,68, 19. As this method overwrites some rarely used fields in IP header, it does not require modification of the current Internet infrastructure. This property makes it a promising trace back scheme to be part of DDoS defense systems 2. However, the space in IP header that can be utilized is limited. Thus, the information that one packet can carry is also limited. Therefore, many challenges for this category of trace back schemes are raised. For example, the number of sources that can be traced could be limited, the number of packets required to find one source could be large, and the load of the trace back router could be heavy. C. Probabilistic Packet Marking SchemesProbabilistic Packet Marking PPM 16 is one stream of the packet marking methods. The assumption of PPM is that  the attacking packets are much more frequent than the normal packets. It marks the packets with path information in a probabilistic manner and enables the victim to reconstruct the attack path by using the marked packets. PPM encodes the information in rarely used 16bit Fragment ID field in the IP header. To reduce the data that is to be stored in 16 bits, the compressed edge fragment sampling algorithm is used. Although PPM is simple and can support incremental deployment, it has many shortcomings that can seriously prevent it from being widely used. First, the path reconstruction process requires high computational work, especially when there are many sources. For example, a 25source path reconstruction will take days, and thousands of false positives could happen 18. Second, when there are a large number of attack sources, the possible rebuilt path branches are actually useless to the victim because of the high false positives. Therefore, the routers that are far away from the victim have a very low chance of passing their identification to the victim because the information has been lost due to overwriting by the intermediate routers.D. Deterministic Packet Marking SchemesAnother stream of packet marking methods, which does not use the above probabilistic assumption and stores the source address in the marking field, is in the category known as the deterministic approaches, such as Deterministic Packet Marking DPM 67, our FDPM the first version of FDPM was published in 8, and Deterministic Bit Marking 9. Recently, in 10, the DPM scheme was modified to reduce false positive rates by adding redundant information into the marking fields. Unlike PPM, deterministic approaches only keep the first ingress edge routers information in the marks but not the whole path. Moreover, they record marks in a deterministic manner but not a probabilistic manner as in PPM. This category of schemes has many advantages over others, including simple implementation, no additional bandwidth requirement, and less computation overhead. However, enough packets must be collected to reconstruct the attack path e.g., in the best case, at least two packets are required to trace one IP source with any of the above schemes. Importantly, all previous works neither perform well in terms of, nor have addressed the problems of, the maximum number of sources that the trace back system can trace in a single trace back process, the number of packets needed to trace one source, and the overload prevention on 186  InternatIonal Journal of Computer SCIenCe  teChnologyIJCST Vol. 2, SP 1, DeCember 2011 ISSN  09768491Online    ISSN  22294333Printw w w . i j c s t . c o mparticipating routers.III. Proposed SystemIn the existing system discuss about the Current IP Trace back Schemes, 3 Probabilistic Packet Marking Schemes, Deterministic Packet Marking Schemes and these algorithms identify the   packet attacks is slow on the basis of time complexity and we propose the Neural Network for DDoS Defense scheme and prove the which one is best in proposed systemA. System Outlinewe have a brief look at the FDPM 5, the encoding module is deployed at the edge routers that are close to the attack source end. When packets enter the network, they are dynamically marked by the encoding modules, which  ill change marking rate depending on the load of routers. The marks comprise of protocol control bits, address bits, address digest bits and segment number. When the packets reach the victim end, the source IP addresses of entry points can be reconstructed. In the marks that FDPM uses, the address digest bits in different IP packets are always the same for one entry point. If the attacker sends attack packets, in a large traffic volume, or in a certain rate eg. 300KBps, through one entry point, there will be a special pattern of marked packets with the same destination IP address and address digest bits. Therefore, in a global view, there will be a pattern with several groups of packets with corresponding address digest bits, and the same destination IP address. The pattern reflexes clearly the character of DDoS traffic that come from multiple sources and aggregate at one destination. This information is especially beneficial to Find out attack traffic and Remove them from legitimate traffic.Fig. 1 System architectureOur system utilizes the marks of FDPM, and is deployed between the source end one hop behind FDPM encoding module and victim end. The system has two parts, Offline Training System OTS and Online Filtering System OFS. The Offline Training System OTS is a lightweight neural network with backpropagation algorithm 10. This offline system collects traffic characteristics and trains the neural network without influencing the normal operation of the network. It is usually deployed close to the victim end, in order to obtain better training result. Actually, it can be deployed at any point in the protected network. To save the computation time, trained neural networks can also be serialized and be shared for different Online Filtering Systems OFSs. In this neural network program, a serialized file is from 100kb to 330kb, which is convenient to be exchanged periodically to other OFSs. The OFS provides the fast decision making function to find the attack signals. Just as the OTS, it can be deployed at any point in the protected network. If it is deployed close to the attack source end, it can protect even better the rest of network from it to victim, because the attack traffic has been removed before it travels to the victim, without causing overall network congestion. When the attack is confirmed, those packets with the same address digest bits are filtered out.B. Design of neural networkAlthough current Internet traffic resembles a stochastic manner, we may still have prior knowledge to the traffic status relevant to traffic classification problems. This prior knowledge has also been applied in many anomaly detection methods, such as statistical method 16 and CUSUM 18. The high nonlinearity of the Internet traffic makes it difficult to apply these methods to describe precisely and regulate the traffic. Neural network is one of the tools that allow an anomaly detection system to learn the nonlinearity and at the same time, implement linear discriminates. We apply one of the most popular methods for training based on gradient descent in error, backpropagation algorithm to detect traffic anomalies. There are 3 layers in this neural network, input layer, hidden layer and output layer. The number of the units in the input layer is dictated by the dimensionality of the input vectors features of traffic. There is one unit in the output layer, representing a value between 0 and 1 legitimate and attack traffic, respectively. The number of hidden units that governs the expressive power of the net will be introduced in the later part. Here we only apply one hidden layer because it suffices the requirement of preciseness and efficiency. The input layer is a linear layer and the other two are sigmoid layer with transfer functionC. Online Filtering System OFSThe Online Filtering System OFS detects network anomalies and find the attack traffic according to the trained neural network. When the attack is confirmed, those packets with specific marks as the attack packets are filtered out. We test the incoming packets by the trained neural network. If the output indicates anomalies, we further investigate the composition of marked packets. If the number of packets that have the same address digest bits exceeds a threshold Ndrop this value is  InternatIonal Journal of Computer SCIenCe  teChnology 187IJCST Vol. 2, SP 1, DeCember 2011ISSN  09768491Online    ISSN  22294333Printw w w . i j c s t . c o mdecided by experience, this flow of packets will be filtered. Here flow means the packets have the same destination IP address and digest bits. This twostep design can not only protect legitimate traffic that shares a large portion of bandwidth but also punish entirely the attack traffic. First, because the anomaly detection is performed by a nonlinear neural network classifier with the assistance of concentration of the packets of same digest bits, the legitimate traffic will be less likely decided as an anomaly than by other coarse granite classifier such as statistical model. Second, once the attack traffic flow is identified, this flow can be totally filtered by differentiating the identity  digest bits that FDPM marks.D. DDoS simulationCurrently there is very few data that can describe the whole profile of a DDoS attack. Therefore, besides the MIT and UCLA data sets, we also use the data generated by SSFNet 21 simulator and the embedded DDoS tools 7 in project Distributed Denial of Service Simulators at Deakin University. The reasons of choosing simulator to generate data are first, to obtain control hardware resources such as hosts and networks could be very expensive second, although to launch DDoS attacks in a laboratory or in real world network and collect data could be direct, it might not be legal third, it is not easy to  change real network topology to create different scenarios and  finally, it is difficult to control the attack process in a real environment because there are too many factors that can affect the result. In the above project, two DDoS tools, TFN2K and Trinoo, are adopted and integrated into SSFNet to create virtual DDoS networks to simulate the attacks. The TFN2K and Trinoo are originally written in C language. They are ported to Java to be embedded into SSFNet. By the DDoS simulators, we can launch any DDoS attack with different features such as duration, protocol, attack rate.IV. Experiments and EvaluationIn this paper we discuss about the mainly DDoS neural network trace back packet marking, DDoS attacks, IP trace back, performance evaluation Of the algorithms on the basis of time complexity and prove the witch one is best.Fig. 2 performance evolution of NNPM  and FDPM 19,FDPM 16,FDPM 24Fig. 3 BAR CHART performance evolution of NNPM,FDPM 16,FDPM19,FDPM24Fig. 4 IP packets attacksFig. 5 DDOS attacks sketch flow V. ConclusionsFDPM is suitable for not only tracing sources of DDoS attacks but also DDoS detection. The main characteristic of DDoS is to use multiple attacking sources to attack a single victim the aggregation characteristic. Therefore, at any point in the network, if there is a sudden surge in the number of packets with the same destination address and with the same group of digest marks, it can be a sign of a DDoS attack. NNPM effectively detects when compare to FDPM.By using NNPM can be identifying the attacking sources in less time compare with FDPM.References1 H. Farhat, Protecting TCP Services from Denial of Service Attacks, Proc. ACM SIGCOMM Workshop LargeScale Attack Defense LSAD 06, pp. 155160, 2006.188  InternatIonal Journal of Computer SCIenCe  teChnologyIJCST Vol. 2, SP 1, DeCember 2011 ISSN  09768491Online    ISSN  22294333Printw w w . i j c s t . c o m2 H. Wang, C. Jin, K.G. Shin, Defense against Spoofed IP Traffic Using HopCount Filtering,  IEEEACM Trans. Networking, vol. 15, no. 1, pp. 4053, 2007.3 M.T. Goodrich, Efficient Packet Marking for LargeScale IP Trace back, Proc. Ninth ACM Conf. Computer and Comm. Security CCS 02, pp. 117126, 2002.4 H. Aljifri, IP Trace back A New DenialofService Deterrent, IEEE Security and Privacy, vol. 1, no. 3, pp. 2431, 2003.5 A. Belenky, N. Ansari, On IP Trace back, IEEE Comm., vol. 41, no. 7, pp. 142153, 2003.6 H. Aljifri, IP Trace back A New DenialofService Deterrent, IEEE Security  Privacy, Vol.1, No.3, 2003, pp.2431.7 W. H. Allen, G. A. Marin, The LoSS Technique for Detecting New Denial of Service Attacks, Proc. of IEEE Southeast on 2004, pp.302 309.8 S. M. Bellovin, ICMP Trace back Messages, Internet Draft, Network Working Group, 2000. 9 A. Belenky, N. Ansari, IP Trace back With Deterministic Packet Marking, IEEE Communications Letters, Vol.7, No.4, 2003, pp.162 164.10 S. Haykin, Neural Networks. A Comprehensive Foundation, 2nd Edition, Prentice Hall, 1998.11 Y. Huang, J. M. Pullen, Countering DenialofService Attacks Using Congestion Triggered Packet Sampling and Filtering, Proc. of the Tenth International Conference on Computer Communications and Networks, 2001, pp.490494.
