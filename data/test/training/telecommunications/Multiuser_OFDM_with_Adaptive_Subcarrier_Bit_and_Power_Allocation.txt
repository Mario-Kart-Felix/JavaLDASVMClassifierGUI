IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER 1999
Multiuser OFDM with Adaptive
Subcarrier, Bit, and Power Allocation
Cheong Yui Wong, Roger S. Cheng, Member, IEEE
Khaled Ben Letaief, Senior Member, IEEE, and Ross D. Murch, Senior Member, IEEE
Abstract—Multiuser orthogonal frequency division multiplex
ing (OFDM) with adaptive multiuser subcarrier allocation and
adaptive modulation is considered. Assuming knowledge of the
instantaneous channel gains for all users, we propose a mul
tiuser OFDM subcarrier, bit, and power allocation algorithm
to minimize the total transmit power. This is done by assigning
each user a set of subcarriers and by determining the number
of bits and the transmit power level for each subcarrier. We
obtain the performance of our proposed algorithm in a multiuser
frequency selective fading environment for various time delay
spread values and various numbers of users. The results show that
our proposed algorithm outperforms multiuser OFDM systems
with static time-division multiple access (TDMA) or frequency
division multiple access (FDMA) techniques which employ fixed
and predetermined time-slot or subcarrier allocation schemes
We have also quantified the improvement in terms of the overall
required transmit power, the bit-error rate (BER), or the area of
coverage for a given outage probability
Index Terms—Adaptive modulation, frequency selective fading
channel, multiaccess communication, multiuser channel, orthog
onal frequency division multiplexing (OFDM), resource manage
ment
I. INTRODUCTION
RECENTLY, intense interest has focused on modulationtechniques which can provide broadband transmission
over wireless channels for applications including wireless mul
timedia, wireless Internet access, and future-generation mobile
communication systems. One of the main requirements on
the modulation technique is the ability to combat intersymbol
interference (ISI), a major problem in wideband transmission
over multipath fading channels. There are many methods pro
posed to combat the ISI, e.g., [1]–[3]. Multicarrier modulation
techniques, including orthogonal frequency division multiplex
(OFDM), (e.g., [4]) are among the more promising solutions
to this problem
Assuming that the transmitter knows the instantaneous
channel transfer functions of all users, many papers
have demonstrated that significant performance improvement
can be achieved if adaptive modulation is used with OFDM. In
Manuscript received October 15, 1998; revised March 27, 1999. This work
is supported in part by the Hong Kong Telecomm Institute on Information
Technology and the Hong Kong Research Grant Council
The authors are with the Department of Electrical and Electronic Engi
neering, Hong Kong University of Science and Technology, Clear Water
Bay, Hong Kong (e-mail: eeyui@ust.hk; eecheng@ust.hk; eekhaledusthk
andeermurchusthk
Publisher Item Identifier S
particular, subcarriers with large channel gains employ higher
order modulation to carry more bits/OFDM symbol, while
subcarriers in deep fade carry one or even zero bitssymbol
Integrated design of forward error correcting code and adap
tive modulation has also been studied using BCH code and
trellis coded modulation (TCM) in [8] and [9], respectively
Although both references considered only time-varying flat
fading channels, the same coded adaptive modulation design
can be easily applied to OFDM systems. As different subcar
riers experience different fades and transmit different numbers
of bits, the transmit power levels must be changed accordingly
The problem of optimal power allocation has also been studied
in
In this paper, we consider extending OFDM with adaptive
modulation to multiuser frequency selective fading environ
ments. When OFDM with adaptive modulation is applied in a
frequency selective fading channel, a significant portion of the
subcarriers may not be used. These are typically subcarriers
which experience deep fade and are not power efficient to
carry any information bit. In multiuser systems using static
time-division multiple access (TDMA) or frequencydivision
multiple access (FDMA) as multiaccess schemes, each user
is allocated a predetermined time slot or frequency band to
apply OFDM with adaptive modulation. Consequently, these
unused subcarriers (as a result of adaptive modulation) within
the allocated time slot or frequency band of a user are wasted
and are not used by other users. However, the subcarriers
which appear in deep fade to one user may not be in deep
fade for other users. In fact, it is quite unlikely that a subcarrier
will be in deep fade for all users, as the fading parameters for
different users are mutually independent. This motivates us to
consider an adaptive multiuser subcarrier allocation scheme
where the subcarriers are assigned to the users based on
instantaneous channel information. This approach will allow
all the subcarriers to be used more effectively because a
subcarrier will be left unused only if it appears to be in deep
fade to all users
We consider a multiuser subcarrier, bit, and power allo
cation scheme where all users transmit in all the time slots
Our objective is to minimize the overall transmit power by
allocating the subcarriers to the users and by determining
the number of bits and the power level transmitted on each
subcarrier based on the instantaneous fading characteristics of
all users. In this paper, we formulate the multiuser subcarrier
bit, and power allocation problem and propose an iterative
algorithm to perform the multiuser subcarrier allocation. Once
0733–8716/99$10.00  1999 IEEE
1748 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER
the subcarrier allocation is determined, the bit and power
allocation algorithm can be applied to each user on its al
located subcarriers. We also compare the performance of our
proposed solution to various other static subcarrier allocation
schemes
The results of the work can be applied, for instance, to
the downlink transmission in a time division duplex TDD
wireless communication system to improve the downlink
capacity. In such a system, the base station (BS) can estimate
the instantaneous channel characteristics of all the BSto
mobile links based on the received uplink transmissions. The
multiuser subcarrier, bit, and power allocation can then be
used. It is clear that there is a certain amount of transmission
overhead as the BS has to inform the mobiles about their
allocated subcarriers and the number of bits assigned to
each subcarrier.1 However, this overhead can be relatively
small, especially if the channels vary slowly (e.g., in an
indoor low mobility environment), and the assignment is done
once every many OFDM symbols. To further reduce the
overhead, we can assign a contiguous band of subcarriers with
similar fading characteristics as a group, instead of assigning
each individual subcarrier. In this paper, we will not focus
on how the subcarrier allocation information is transmitted
Instead, we will focus on how— and by how muchthis
new strategy can reduce the required transmit power; or how
and by how much this new scheme can improve the bit
error rate (BER) for a fixed transmit power. Alternately, we
also consider how and by how much this new scheme can
increase the area of coverage for a given transmit power and
target BER
While the bit allocation algorithm can be viewed as a
practical implementation of the water-pouring interpretation
for achieving the Shannon capacity of an ISI channel [13], the
multiuser subcarrier and bit allocation algorithm presented in
this paper is the counterpart of the multiuser waterpouring
solution given in [14]. In information theoretic studies, the
usual approach is to maximize the capacity (or information
rate) under the power constraint. In this study, we focus
on deriving practical algorithms that can support realtime
multimedia data whose bit rates are generally fixed by the
compression algorithms. Hence, we assume a given set of user
data rates and attempt to minimize the total transmit power
under a fixed performance requirement
The organization of this paper is as follows. In Section II
we will first give the system model and formulate the minimum
overall transmit power problem. The optimization problem
seeks to minimize the overall transmit power using combined
subcarrier, bit, and power allocation schemes for multiuser
OFDM systems. The bit and power allocation algorithm for
a single-user system is studied in Section III. In Section IV
we derive a lower bound to the minimum overall transmit
1 Note that the power level used does not need to be transmitted to the
receiver in such a TDD system. As the subcarrier gain is known to the
transmitter, it can adjust the transmit power level to achieve a predetermined
receiver power level based on the number of bits allocated to that subcarrier
However, in FDD systems, the transmit power levels determined by the
receiver have to be sent back to the transmitter. In such systems, the additional
performance gain achieved by power allocation may not justify the cost of
sending the transmit power level information to the transmitter
power by relaxing some of the constraints in the origi
nal problem. We also derive a suboptimal subcarrier al
location algorithm. In Section V, we compare the perfor
mance between our proposed method and other static ap
proaches via Monte Carlo simulations. Finally, we conclude in
Section VI
II. SYSTEM MODEL
The configuration of our multiuser adaptive OFDM system
is shown in Fig. 1. We assume that the system has users
and the th user has a data rate equal to bit per OFDM
symbol. In the transmitter, the serial data from the users
are fed into the subcarrier and bit allocation block which
allocates bits from different users to different subcarriers. We
assume that each subcarrier has a bandwidth that is much
smaller than the coherence bandwidth of the channel and that
the instantaneous channel gains on all the subcarriers of all
the users are known to the transmitter. Using the channel
information, the transmitter applies the combined subcarrier
bit, and power allocation algorithm to assign different sub
carriers to different users and the number of bitsOFDM
symbol to be transmitted on each subcarrier. Depending on
the number of bits assigned to a subcarrier, the adaptive
modulator will use a corresponding modulation scheme, and
the transmit power level will be adjusted according to the
combined subcarrier, bit, and power allocation algorithm. We
define to be the number of bits of the th user that are
assigned to the th subcarrier. As we do not allow more than
one user to share a subcarrier, it follows that for each , if
, for all . We also assume that
the adaptive modulator allows to take values in the set
where is the maximum number
of information bits/OFDM symbol that can be transmitted by
each subcarrier
The complex symbols at the output of the modulators
are transformed into the time domain samples by inverse
fast Fourier transform (IFFT). Cyclic extension of the time
domain samples, known as the guard interval, is then added
to ensure orthogonality between the subcarriers, provided that
the maximum time dispersion is less than the guard interval
The transmit signal is then passed through different frequency
selective fading channels to different users
We assume that the subcarrier and bit allocation information
is sent to the receivers via a separate control channel. At
the receiver, the guard interval is removed to eliminate the
ISI, and the time samples of the th user are transformed
by the FFT block into modulated symbols. The bit allo
cation information is used to configure the demodulators
while the subcarrier allocation information is used to extract
the demodulated bits from the subcarriers assigned to the
th user
In the frequency selective fading channel, different subcar
riers will experience different channel gains. We denote by
the magnitude of the channel gain (assuming coherent
reception) of the th subcarrier as seen by the th user
We assume that the single-sided noise power spectral density
(PSD) level is equal to unity (i.e., ), for all
WONG et al.: MULTIUSER OFDM
Fig. 1. Block diagram of a multiuser OFDM system with subcarrier, bit, and power allocation
subcarriers and is the same for all users. Furthermore, we
denote by the required received power (in energy per
symbol) in a subcarrier for reliable reception of information
bits/symbol when the channel gain is equal to unity. Note that
the function depends on , and this allows different users
to have different quality-of-service (QoS) requirements andor
different coding and modulation schemes. In order to maintain
the required QoS at the receiver, the transmit power, allocated
to the th subcarrier by the th user must equal

Using these transmit power levels, the receiver can demodulate
the modulated symbols at the output of the FFT processor and
achieve the desired QoS’s of all users
The goal of the combined subcarrier, bit, and power al
location algorithm is then to find the best assignment of
so that the overall transmit power, the sum of
over all subcarriers and all users, is minimized for given
transmission rates of the users and given QoS requirements
specified through , . In order to make the
problem tractable, we further require that is a convex and
increasing function with . This condition essentially
means that no power is needed when no bit is transmitted and
that the required additional power to transmit an additional
bit increases with [i.e., is increasing in
]. Almost all popular coding and modulation schemes satisfy
this condition
It is important to note that even though the problem is
formulated to minimize the overall transmit power for given
QoS requirements, the same solution can be applied to improve
the QoS’s of the users for a given overall transmit power
The latter can simply be achieved by increasing the power
proportionally for all the subcarriers, while using the same set
of
Mathematically, we can formulate the problem as

and the minimization is subjected to the constraints
For all
and
For all
if there exists with then

Note that constraint (3) is the data rate requirement and
constraint (4) ensures that each subcarrier can only be used by
one user. Moreover, is the set of all
possible values for , and means that the th user
does not use the th subcarrier to transmit any information
III. BIT ALLOCATION ALGORITHM
FOR SINGLE USER CHANNEL
Before we try to solve the multiuser allocation problem, we
will first derive the bit allocation algorithm for the singleuser
environment. The single-user problem not only gives better
understanding of the issues involved, but also provides a bit
allocation algorithm that we will use in our multiuser solution
We can rewrite the optimization problem in (2) for the
single-user case as

and the minimization is under the constraint

1750 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER
Note that we have dropped the subscript , which denotes the
user in all notations
As the power needed to transmit a certain number of bits in
a subcarrier is independent of the numbers of bits allocated to
other subcarriers, it turns out that a greedy approach is optimal
A greedy algorithm assigns bits to the subcarriers one bit at a
time, and in each assignment, the subcarrier that requires the
least additional power is selected. The bit allocation process
will be completed when all bits are assigned. Several papers
(e.g., [15] and [16]) have provided various algorithms for this
problem, and the basic structure of most algorithms are similar
and can be described as follows
Initialization
For all , let and
Bit Assignment Iterations
Repeat the following times



End
Finish
is the final bit allocation solution
The initialization stage computes, for each subcarrier, the
additional power needed to transmit an additional bit. For
each bit assignment iteration, the subcarrier that needs the
minimum additional power is assigned one more bit, and the
new additional power for that subcarrier is updated. After
iterations, the final bit assignment gives the optimal bit
allocation for each subcarrier. It is important to note that the
bit allocation is optimal only for the given function
which depends on the selected modulation scheme. Different
modulation schemes will lead to different , different bit
allocation, and possibly lower transmit power
The concept of this algorithm is fairly simple, and many
similar algorithms based on the same principle have been
obtained before. In particular, there exist faster and less
complex algorithms which can speed up the bit allocation
process significantly (e.g., [15] and [16]). In our simulations
we use the algorithm given in
IV. MULTIUSER SUBCARRIER AND BIT ALLOCATION
We have observed that, in the single-user case, a greedy
approach which assigns one bit at a time to the subcarrier
that requires the least additional power gives the optimal
allocation in the sense of minimizing the overall transmit
power. Unfortunately, the problem becomes more difficult in
the multiuser environment. As users cannot share the same
subcarrier, allocating bits to a subcarrier essentially prevents
other users from using that subcarrier. This dependency makes
any greedy algorithm a nonoptimal solution. It turns out that
the optimal solution may not assign any of a user’s bits to the
best subcarrier seen by that user. This may happen when the
best subcarrier of a user is also the best subcarrier of another
user who happens to have no other good subcarriers. Hence
the multiuser subcarrier and bit allocation problem is much
more complicated to solve than that of the single-user case
It turns out that the optimization problem in (2) is a
combinatorial optimization problem. To make the problem
tractable, we consider a different but similar optimization
problem. We relax the requirement to allow to
be a real number within the interval . Moreover, in order
to deal with constraint (4), variables,
with values within the interval [0, 1], are introduced to the
cost function as sharing factors of the th subcarrier. The new
optimization problem becomes

where and have to satisfy
for all
and
for all
For any valid set of satisfying the constraints
and (4) in the original optimization problem, we can let
if
if .
Then, it is easy to show that the same set of and the
corresponding defined in (10) satisfy the constraints
and (9) in the new optimization problem. Moreover, with
defined in (10), the new cost function in (7) is equal to the
cost function in (2). Hence, the minimization problem in
is the same as the original optimization problem, except that
the minimization is done over a larger set. Consequently, the
minimum power obtained in (7) is a lower bound to the
minimum power obtained in (2),
Another way to interpret the optimization in (7) is to
consider as the time-sharing factor for the th user of
the th subcarrier. For example, in every OFDM symbol
being a very large number), user uses the th subcarrier
in symbols. Clearly, the average (over symbols
information data rate and the average transmit power has to
be scaled by the same factor . Hence, we can consider
(7) as the optimization problem when the users are allowed
to time-share each subcarrier over a large number of OFDM
symbols. However, most wireless communication channels are
time varying, and the channels may not stay unchanged long
enough for timesharing to be feasible. Hence, in this paper
we will continue to consider the original problem in (2) and
use the optimization problem in (7) as a lower bound, even
though it has its own physical interpretation
The modified optimization problem in (7) is more tractable
However, even though the function is convex in
the terms in the cost function have the form , and
as a function of , is not convex in . To
proceed further, we let and rewrite the cost
function in terms of and . The constraint on
WONG et al.: MULTIUSER OFDM
becomes , and it can be easily shown that
is convex in within the triangular
region specified by and . In particular
the Hessian evaluated at any point within this region is a
positive semidefinite matrix. Hence, we can reformulate the
optimization problem in (7) as a convex minimization problem
over a convex set. That is

where and have to satisfy
for all
and
for all
Using standard optimization techniques in [17], we obtain the
Lagrangian

where and are the Lagrangian multipliers for the
constraints (12) and (13), respectively
After differentiating with respect to and , re
spectively, we obtain the necessary conditions for the optimal
solution, and . Specifically, if , we have
if
if
if

and
if
if .
On the other hand, if , then , and we have
for all and

These necessary conditions can be interpreted by the fact
that if the minimum occurs within the constrained region
1) for and (0, ) for ], then the derivative
evaluated at the minimum point must be zero. On the other
hand, if the optimal solution occurs at a boundary point, then
the derivative must be positive along all directions pointing
toward the interior of the constraint set. Then, (17) follows
from considering the boundary point at
From (15) and (17), we can conclude that

where
if
if
if
Moreover, from (16) and (17), it follows that
if
if

where

Since constraint (13) must be satisfied, we find from
that for each , if for are all
different, then only the user with the smallest can
use that subcarrier. In other words, for the th subcarrier, if
are different for all , then
for all
where

Hence, it follows that for a fixed set of Lagrange multipliers
, , we can use them to determine for each
using (22). The and obtained will then form an
optimal solution for the optimization problem; however, the
individual rate constraint (12) may not be satisfied
In order to find the set of such that the individual
rate constraints are satisfied, we have obtained an iterative
searching algorithm. Starting with some small values for all
, this iterative procedure increases one of the until the
data rate constraint (12) for user is satisfied. Then, we
switch to another user and go through the users one at a
time. This process repeats for all users until the data rate
constraint for all users are satisfied. This algorithm converges
because for a given , as increases, for all
decreases, and more in (19) become one while in
(18) increases for those where . Hence
increases. During this process, some of the other may
change from one to zero and consequently decrease the total
data rate for other users. However, as all the increase
increases accordingly. As long as the total data rate is
less than bits/symbol, which is the total number of bits
possibly transmitted within an OFDM symbol, the algorithm
1752 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER
will converge to a solution that satisfies all the constraints
Since the optimization problem is a convex optimization
problem over a convex set, the set of necessary conditions is
also sufficient, and the solution that satisfies all the necessary
conditions is the unique optimal solution
In the process of adjusting for , the
situation where, for a fixed , more than one has
the same values cannot be ignored. In that case, has to
take values within the interval (0, 1). This solution suggests
that the subcarrier should be shared by multiple users. In
practice, this can be done by having these users with
time share the th subcarrier, and the ratio of the symbols used
by different users are set proportionally to . The detailed
flow chart of the algorithm is given in the Appendix
Now, we have an algorithm to obtain the optimal values of
and
if
otherwise

This solution, when substituted in (7), gives a lower bound to
the minimum overall transmit power. However, we cannot use
these results immediately in (2). One problem is that may
not be in , and the other is that some may be within
(0, 1), indicating a time-sharing solution. Furthermore, simply
quantizing and will not satisfy the individual rate
constraints in
To solve this problem, we propose a multiuser adaptive
OFDM (MAO) scheme where the subcarrier allocation follows
essentially the solution to the lower bound in (7), and then
the single-user bit allocation algorithm given in Section III is
applied to each user on the allocated subcarriers. Specifically
we modify for the optimization problem in (7) by letting
for each where , and
for . Then, we apply the single-user bit allocation
algorithm on each user using the assigned subcarriers. We
denote the total transmit power (in energy/symbol) obtained
using this MAO scheme by . It is easy to see that
, where is the minimum power in the original
problem, and is the minimum power for the modified
problem with the relaxed constraints. More specifically, the
difference between and the minimum gives an upper
bound to how far away our MAO scheme is from the solution
of our original optimization problem
V. PERFORMANCE COMPARISON
In this section, we obtain and compare the performance
of the MAO scheme with other static subcarrier allocation
schemes. We consider a system that employs M-ary quadra
ture amplitude modulation (MQAM) with
Square signal constellations (4-QAM, 16-QAM, and QAM
are used to carry two, four, or six bits/symbol. The biterror
probability is upper bounded by the symbol error probability
which is tightly approximated by [12, p
281], where is the minimum distance between the points
in the signal constellation. Since the average energy of a M
QAM symbol is equal to , it follows that the
required power for supporting bits/symbol at a given BER
is
where we recall that
It is easy to see that is convex and increasing in and
that
To evaluate the performance of our scheme, we have
simulated 1000 sets of five-path frequency selective Rayleigh
fading channels with an exponential power delay profile. Each
set of channels consists of independent channels, one for
each user. We use an OFDM system with 128 subcarriers over
a 5 MHz band along with a total (over all users) transmission
rate equal to 512 bits/symbol (or equivalently, an average
of four bits/subcarrier). Recall that the single-sided power
spectral density level is equal to unity, and we assume
that the average subcarrier channel gain is equal to
unity for all and
For comparison purposes, we have also considered three
other static multiuser subcarrier allocation methods. Two of
them are based on the multiple access methods described in
[7]. The methods are presented as follows
• OFDM-TDMA: each user is assigned a predetermined
TDMA time slot and can use all the subcarriers within
that time slot exclusively
• OFDM-FDMA: each user is assigned a predetermined
band of subcarriers and can only use those subcarriers
exclusively in every OFDM symbol
In a frequency selective fading channel, there is a
high correlation between the channel gains of adjacent
subcarriers. In order to avoid the situation where all
subcarriers of a user are in deep fade, we propose an
enhanced version of OFDM-FDMA, which we shall refer
to as OFDM InterleavedFDMA
• OFDM Interleaved-FDMA: this is the same as OFDM
FDMA except that subcarriers assigned to a user are
interlaced with other users’ subcarriers in the frequency
domain
The time and subcarrier assignment of these three multiuser
OFDM schemes are illustrated in Fig. 2. Note that these static
schemes have predetermined subcarrier allocations which are
independent of the channel gains of the users. The main
difference between the proposed MAO scheme and these static
schemes is that MAO assigns subcarriers adaptively based on
the instantaneous channel gains. To ensure a fair comparison
we use the optimal single-user bit allocation (OBA) for each
user on the assigned subcarriers. For comparison purposes
we also show the results when equal bit allocation (EBA) is
employed on the assigned subcarriers for these three OFDM
schemes. Notice that when using EBA, all three schemes will
have the same performance in an uncoded system. This is
because the average bit signal-to-noise ration (SNR) needed
is a function of only the marginal probability density function
of each subcarrier gain
WONG et al.: MULTIUSER OFDM
Fig. 2. Subcarrier and time-slot allocations of OFDM-TDMA, OFDM-FDMA, and OFDM interleaved-FDMA schemes
Fig. 3. Average bit signal-to-noise ration (SNR) required by different schemes in various root mean square (RMS) delay spreads in a five-user system
with Pe =
Fig. 3 shows the average bit SNR needed to achieve a BER
at for a five-user system versus the root mean
square (RMS) delay spread (for definition, see for example
[18, p. 160]) for different multiuser OFDM schemes. The
average required transmit power (in energy per bit) is defined
as the ratio of the overall transmit energy per OFDM symbol
(including all subcarriers and all users) to the total number of
bits transmitted per OFDM symbol. Moreover, we define the
average bit SNR as the ratio of the average transmit power to
the noise PSD level . As we assume that the data rate is
fixed and that is just a constant, the overall transmit power
is proportional to the average bit SNR. For ease of comparison
we have used the average bit SNR for comparison. We find
in Fig. 3 that the MAO scheme is never more than 0.6 dB
from the lower bound. Since the bit SNR of the optimal
combined subcarrier, bit, and power allocation algorithm must
lie between the bit SNR’s achieved by the lower bound and the
MAO scheme, we find that the MAO scheme is never more
than 0.6 dB away from the optimal solution. On the other
hand, we observe that our proposed MAO scheme is 3–5 dB
better than the static subcarrier allocation schemes with OBA
which are in turn 5–10 dB better than that with EBA. We also
find that when OBA is used, the OFDM interleavedFDMA
scheme and the OFDM-TDMA scheme have very similar
performance, and both of them outperform the OFDMFDMA
scheme.2 A closer observation of Fig. 3 also indicates that the
gains achieved by optimal bit allocation and optimal multiuser
subcarrier allocation increase with the RMS delay spread. This
is mainly because the larger the RMS delay spread, the more
the fading variation and hence higher gains can be obtained
when the allocation is performed adaptively
Fig. 4 shows the average bit SNR (in dB) needed to achieve
the same BER versus the number of users when the RMS delay
spread is 100 ns. We find that the savings in the required bit
SNR achieved by MAO when compared to other schemes are
roughly the same, independent of the number of users in the
system
While these two figures show the improvement in the
required bit SNR, the results can perhaps be more easily
understood using the more familiar BER versus bit SNR
curves. For each BER requirement, we compute for all
and then use our algorithm to calculate the subcarrier
2 OFDM-FDMA refers only to the specific FDMA scheme that assigns to
each user a contiguous band of subcarriers as shown in Fig. 2, but not the
general FDMA schemes. In fact, both OFDM interleaved-FDMA and MAO
can be considered as different forms of FDMA and they are not outperformed
by the OFDM-TDMA scheme
1754 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER
Fig. 4. Average bit SNR required by different schemes versus the number of users in a multiuser OFDM system with 100 ns RMS delay spread
and Pe =
Fig. 5. BER versus average bit SNR for various subcarrier allocation schemes
allocation for the MAO case. For all other static subcarrier
allocation schemes, the allocations are independent of the
BER. Once the subcarrier allocation is fixed, we apply the
optimal bit and power allocation algorithm to every user
The final average power per bit divided by the noise power
spectral density level gives the average bit SNR. We repeat
this procedure for different BER values, and the results are
plotted in Fig. 5 for a five-user system with an RMS delay
spread equal to 100 ns. We find that our proposed MAO has
at least 3–4 dB advantage over all other schemes
Another way to illustrate the impact of the bit and subcarrier
allocation is to consider the area of coverage for a given outage
probability, assuming that the BS has a maximum transmit
power. We consider a circular cell with five users, indepen
WONG et al.: MULTIUSER OFDM
Fig. 6. Cell for analyzing the outage probability
Fig. 7. Outage probability at 17 dB fading margin
dently and uniformly distributed within the cell. A typical
scenario is shown in Fig. 6, where the triangles represent the
five users. In addition to frequency selective fading, path loss
and log-normal shadowing are also included in simulating the
actual channel gains seen by the users. Using these channel
gains, subcarriers and bits assigned to each user are determined
by the various multiple access schemes and the total required
transmit power is calculated. If the total power for all five users
1756 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER
Fig. 8. Flow chart of the multiuser subcarrier allocation algorithm
exceeds the maximum power of the BS, the user requiring the
largest transmit power (in this case, the black one) is dropped
and counted as one outage event occurring at a distance equal
to the distance between the BS and the dropped user. This
process continues until the transmit power is smaller than the
maximum power of the BS. In this example, the maximum
transmit power is set to the transmit power required for all
five users assuming that they are all located at the boundary
of the cell, taking into account the path loss effect and a
dB fading margin for shadowing
The cumulative outage probabilities at various normalized
distances, normalized to the cell radius, are plotted in Fig. 7. A
cumulative outage probability of 5% at a normalized distance
of 0.8 means that there is a 5% chance of outage for a mobile
located more than 0.8 away from the BS where is the
radius of the cell. We observe that MAO outperforms others
with a large reduction in the outage probability at all distances
Alternatively, if the same outage probability is maintained, say
at 1%, the coverage are provided by MAO is 36% larger than
the best of all other schemes
VI. CONCLUSION
In this paper, we considered OFDM transmission in a
multiuser environment and formulated the problem of min
WONG et al.: MULTIUSER OFDM
imizing the overall transmit power by adaptively assigning
subcarriers to the users along with the number of bits and
power level to each subcarrier. In particular, we derived a
multiuser adaptive subcarrier and bit allocation algorithm
Given the instantaneous channel information, the algorithm
obtains a suboptimal subcarrier allocation, and then singleuser
bit allocation is applied on the allocated subcarriers. Using this
scheme, the overall required transmit power can be reduced by
about 5–10 dB from the conventional OFDM without adaptive
modulation. Likewise, the transmit power can be reduced by
about 3–5 dB from the conventional OFDM with adaptive
modulation and adaptive bit allocation, but without adaptive
subcarrier allocation. The reduction in transmit power can also
be translated to a significant reduction in the required bit SNR
for a given BER. Moreover, the same improvement can also
be translated to a reduction in the outage probability or to an
increase in the area of coverage
The results in this paper assume perfect channel estimation
and we have not considered issues related to imperfect im
plementation, such as imperfect synchronization. As channel
estimation in wireless fading channels is in general not very
accurate, the effect of nonideal channel information on the
performance of our proposed MAO scheme is a very important
issue. We have started looking at this issue, and our prelimi
nary results have indicated that the MAO scheme is not very
sensitive to channel estimation errors. Nevertheless, detailed
sensitivity studies will be needed before the algorithm can be
applied to practical systems
APPENDIX
A flow chart providing the detailed description of the
multiuser subcarrier allocation algorithm is shown in Fig.
ACKNOWLEDGMENT
The authors would like to thank the editor and the reviewers
for their suggestions and comments which had helped to
improve the quality of the paper
REFERENCES
[1] Y. Chen, K. B. Letaief, and J. C.-I. Chuang, “Soft-output equalization
and TCM for wireless personal communication systems,” IEEE J. Select
Areas Commun., vol. 16, pp. 1679–1690, Dec.
[2] W. C. Lo and K. B. Letaief, “Adaptive equalization and interference can
cellation for wireless communications systems,” IEEE Trans. Commun
vol. 47, pp. 538–545, Apr.
[3] C. L. Ng, K. B. Letaief and R. D. Murch, “Antenna diversity combining
and finite-tap decision feedback equalization for high-speed data trans
mission,” IEEE J. Select. Areas Commun., vol. 16, pp. 1367–1375, Oct

[4] L. J. Cimini, Jr. and N. R. Sollenberger, “OFDM with diversity and
coding for high-bit-rate mobile data applications,” Mobile Multimedia
Commun., vol. 1, pp. 247–254,
[5] H. Rohling and R. Grunheid, “Performance of an OFDM-TDMA mobile
communication system,” in Proc. IEEE Vehicular Technology Conf
(VTC’96), Atlanta, GA, pp.
[6] A. Czylwik, “Adaptive OFDM for wideband radio channels,” in Proc
IEEE Global Telecommunications Conf. (GLOBECOM’96), London
U.K., Nov. 1996, pp.
[7] H. Rohling and R. Grunheid, “Performance comparison of different
multiple access schemes for the downlink of an OFDM communication
system,” in Proc. IEEE Vehicular Technology Conf. (VTC’97), Phoenix
AZ, pp.
[8] W. T. Webb and R. Steele, “Variable rate QAM for mobile radio,” IEEE
Trans. Commun., vol. 43, pp. 2223–2230, July
[9] S. G. Chua and A. Goldsmith,“Adaptive coded modulation for fading
channels,” in Proc. IEEE Int. Conf. Communications (ICC’97), Montreal
P.Q., Canada, pp.
[10] B. S. Krongold, K. Ramchandran, and D. L. Jones, Computationally
efficient optimal power allocation algorithm for multicarrier commu
nication systems,” in Proc. IEEE Int. Conf. Communications ICC
Atlanta, GA, pp.
[11] Q. Chen, E. S. Sousa, and S. Pasupathy, “Multicarrier CDMA with
adaptive frequency hopping for mobile radio systems,” IEEE J. Select
Areas Commun., vol. 14, pp. 1852–1858, Dec.
[12] J. G. Proakis, Digital Communications, 3rd ed. New York: McGraw
Hill,
[13] R. E. Blahut, Principles and Practice of Information Theory. Reading
MA: Addison-Wesley,
[14] R. S. Cheng and S. Verdú, “Gaussian multiaccess channels with ISI
Capacity regions and multiuser water-filling,” IEEE Trans. Inform
Theory, vol. 39, pp. 773–785, May
[15] D. Hughes-Hartogs, “Ensemble modem structure for imperfect transmis
sion media,” U.S. Patents Nos. 4 679 227, July 1987; 4 731 816, Mar
1988; and 4 833 796, May
[16] S. K. Lai, R. S. Cheng, K. Ben Letaief, and R. D. Murch, Adaptive
trellis coded MQAM and power optimization for OFDM transmission
in Proc. IEEE Vehicular Technology Conf. (VTC’99), Houston, TX, May

[17] D. G. Luenberger, Optimization by Vector Space Methods. New York
Wiley,
[18] T. S. Rappaport, Wireless Communications Principles and Practice
Englewood Cliffs, NJ: Prentice-Hall,
Cheong Yui Wong was born in Hong Kong, in
1975. He received the B.Eng. degree in electronic
engineering from the Hong Kong University of Sci
ence and Technology (HKUST), Clear Water Bay
Hong Kong in 1997. He is currently pursuing the
M.Phil. degree at HKUST and expects to graduate
in
During his master studies, he joined a project
that aims at achieving wireless multimedia commu
nication using OFDM. His research interests include
adaptive modulation, OFDM, and optimization
Roger S. Cheng (S’85–M’91) received the BS
degree from Drexel University, Philadelphia, PA, in
1987, and both the M.A. and Ph.D. degrees from
Princeton University, Princeton, NJ, in 1988 and
1991, respectively, all in electrical engineering
From 1987 to 1991, he was a Research Assis
tant in the Department of Electrical Engineering
Princeton University. From 1991 to 1995, he was an
Assistant Professor in the Electrical and Computer
Engineering Department of University of Colorado
Boulder. In June 1995, he joined the Faculty of
Hong Kong University of Science and Technology, Clear Water Bay, Hong
Kong, where he is currently an Assistant Professor in the Department of
Electrical and Electronic Engineering. He has also held visiting positions
with Qualcomm, San Diego, in the summer of 1995 and with Institute for
Telecommunication Sciences, NTIA, Boulder, CO, in the summers of
and 1994. His current research interests include wireless communications
multiuser communications, spread spectrum CDMA, digital implementation
of communication systems, wireless multimedia communications, information
theory, and coding
Dr. Cheng was the recipient of the Meitec Junior Fellowship Award from
the Meitec Corporation in Japan, the George Van Ness Lothrop Fellowship
from the School of Engineering and Applied Science in Princeton University
and the Research Initiation Award from the National Science Foundation. He
was a member of the Technical Program Committees of GLOBECOM’98 and
IEEE Wireless Communications and Networking Conference (WCNC’99). He
has served as Guest Editor of the special issue on Multimedia Network Radios
in the IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, as Associate
Editor of the IEEE TRANSACTIONS ON SIGNAL PROCESSING, and as Membership
Chair for of the IEEE Information Theory Society
1758 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS, VOL. 17, NO. 10, OCTOBER
Khaled Ben Letaief (S’85–M’86–SM’97) received
the B.S. degree (with distinction), the M.S. degree
and the Ph.D. degrees in electrical engineering from
Purdue University, West Lafayette, IN, in
1986, and 1990, respectively
In 1985, he was a Graduate Instructor in the
School of Electrical Engineering at Purdue Uni
versity and he taught courses in communications
and electronics. From 1990 to 1993, he was on the
Academic Staff at the Department of Electrical and
Electronic Engineering, University of Melbourne
Australia, where he was also a Member of the Center for Sensor Signal
and Information Systems. Since 1993, he has been with the Department of
Electrical and Electronic Engineering, Hong Kong University of Science and
Technology (HKUST), Clear Water Bay, Hong Kong, where is currently
an Associate Professor. During several semesters from 1995 to 1998, he
served as the Departmental Director of the Undergraduate Studies program
His research interests include wireless personal and mobile communications
spread spectrum systems, optical fiber networks, multiuser detection, wireless
multimedia communications, and CDMA systems. He is an Editor of the
Wireless Personal Communications Journal and is also a Guest Editor of the
1999 Wireless Personal Communications Journal’s Special Issue on Intelligent
Multimedia Systems, Terminals, and Components
Dr. Letaief has been an active member of various professional societies and
has published papers in several journals and conference proceedings. In
he was awarded the Mangoon Teaching Award at Purdue University. From
1995 to 1997, he was awarded the Teaching Excellence Appreciation Award
by the School of Engineering, HKUST. He was also the 1998 University
Recipient of the Michael G. Gale Medal for Distinguished Teaching the
highest teaching award at the university). He is the Editor for Wireless
Systems of the IEEE TRANSACTIONS ON COMMUNICATIONS and a Technical
Editor of the IEEE Communications Magazine. He has been a Guest Editor
of the 1997 IEEE JOURNAL ON SELECTED AREAS IN COMMUNICATIONS’ Special
Issue on Computer-Aided Modeling, Analysis, and Design of Communications
Links. In addition, he served as the Technical Program Chair of the
IEEE Mini-Conference on Communications Theory (CTMC’98) which was
held in Sydney, Australia. He is currently serving as an Officer in the IEEE
Communications Society Technical Committee on Personal Communications
Ross D. Murch (S’85–M’87–SM’98) received
the Ph.D. degree in electrical and electronic
engineering from the University of Canterbury in
1990 for research involving electromagnetic inverse
scattering
From 1990 to 1992, he was a Post Doctoral
Fellow at the Department of Mathematics and
Computer Science, Dundee University, Scotland
where he worked on approximate approaches to
electromagnetic scattering from threedimensional
objects. Currently he is an Associate Professor
in the Department of Electrical and Electronic Engineering at the Hong
Kong University of Science and Technology, Clear Water Bay, Hong Kong
He is also the founding Director of the Center for Wireless Information
Technology, which began in August 1997. From August to December
he was on sabbatical leave at Allgon Mobile Communications, Sweden
and AT&T Research Labs, NJ. He also acts as a Consultant for various
industrial projects on wireless communications and has two U.S. patents
related to wireless communication. His most recent research activities center
around the application of electromagnetics and signal processing to wireless
communications. Research interests include: antenna design for mobile
telephone handsets, smart antenna algorithms and propagation prediction
for wireless communications
Dr. Murch is an Editor of IEEE JOURNAL ON SELECTED AREAS IN
COMMUNICATIONS, Wireless Series, and he has been involved in the
organization of several international conferences. He is a Chartered Engineer
a Member of the Institute of Electrical Engineers, and also an URSI
correspondent. He won an URSI Young Scientist Award in 1993 and an
Engineering Teaching Excellence Appreciation award in

