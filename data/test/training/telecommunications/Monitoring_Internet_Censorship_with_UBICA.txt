Monitoring Internet Censorship with UBICAGiuseppe Aceto1 , Alessio Botta1, Antonio Pescap1  , Nick Feamster2,M. Faheem Awan3, Tahir Ahmad3, and Saad Qaisar31 University of Napoli Federico II Italy,giuseppe.aceto, a.botta, pescapeunina.it2 Georgia Institute of Technology GA, USA, feamstercc.gatech.edu3 NUST SEECS Pakistan,10mscsemawan,11msccstahmad,saad.qaisarseecs.edu.pkAbstract. Censorship is becoming increasingly pervasive on the Internet, with the Open Net Initiative reporting nearly 50 countries practicing some form of censorship. Previous work has reported the existence ofmany forms of Internet censorship e.g., DNS tampering, packet filtering,connection reset, content filtering, each of which may be composed tobuild a more comprehensive censorship system. Automated monitoringof censorship represents an important and challenging research problem,due to the continually evolving nature of the content that is censoredand the means by which censorship is implemented. UBICA, UserbasedInternet Censorship Analysis, is a platform we implemented to solve thistask leveraging crowdsourced data collection. By adopting an integratedand multistep analysis, UBICA provides simple but effective means ofrevealing censorship events over time. UBICA has revealed the effectof several censorship techniques including DNS tampering and contentfiltering. Using UBICA, we demonstrate evidence of censorship in several selected countries Italy, Pakistan, and South Korea, for which weobtained help from local users and manually validated the automatedanalysis.1 IntroductionAkin to network monitoring for faults, attacks, and performance variations, Internet censorship monitoring is a relatively new field of research with methodologies, tools and practices still in course of definition. We consider Internetcensorship detection as the process that, analyzing network data, reveals impairments in the access to content and services caused by a third party neitherthe client system nor the server hosting the resource or service and not justifiable as an outage. In turn, Internet censorship monitoring is the automated andcontinuous process of detecting Internet censorship over time, with the aim of revealing status changes in terms of the affected targets or the adopted censoringtechniques. Regardless of the ethical and political positions regarding censorship, the interference with Internet protocols standard and intended behavior This work has been carried out thanks to a Google Faculty Research Award for theproject UBICA UserBased Internet Censorship Analysis.has practical implications. Moreover significant aspects of censorship, such asits enforceability, its transparency, and the accountability of the censors to theaffected population, strongly depend on the technical details of the censorshiptechnique adopted and thus evolve with both the technology and its applicationin practice. Collection of the appropriate network measurements for monitoringcensorship is thus a fundamental part of understanding the existence, prevalenceand evolution of censorship 3,12, and to tell it from unintentional network outages or performance issues. Although tools for monitoring censorship abound,most of them do not base their analysis or conclusions on widespread, scalable,continuous network measurement. One wellknown censorship monitoring toolis Herdict 1, a crowdsourced platform. Its main interface is a website allowingusers to report about accessibilityof URLs from within their browser this waythe platform leverages crowdsourcing both for the collection of targets of interestfor the users, and by having the users to perform an applicationlevel censorshiptest. A browser plugin also allows users to submit reports without accessing theweb interface. Another tool called CensMon is specifically designed for censorship monitoring 16. It is designed for continuous and automatic functioning,and addresses the needle in a haystack problem of selecting targets worthchecking by feeding the system with URLs automatically harvested from a variety of online sources. The most complete and wideranging tool for censorshipdetection is provided by the OONI project 10. It is a Free Software project, partof the wider Tor project with which it is tightly integrated. The main componentis a Python script offering a list of censorship detection tests to be performedusing Tor. In addition to platforms or tools for censorship detection and monitoring, previous work has performed many studies of various censoring systemsand techniques 8,18, often focused on the Great Chinese Firewall 5,15,19, orinvestigate outagelike censorship events 7,2.In this paper we discuss results obtained by means of a platform for censorship monitoring called UBICA, standing for Userbased Internet CensorshipAnalysis. Due to space constraints, we focus on the results and on the analysesallowed by the platform, and describe the platform at a functional level, referring to future works for a more indepth discussion. UBICA adopts an integratedand multistep analysis and provides a simple but effective dashboard thanks towhich censorship events are easily spotted and described also in their temporal evolution. UBICA integrates an algorithm for detecting censorship based onInternet measurements if the test finds evidence of blocking, additional tests attempt to identify possible mechanisms, including DNS blocking, IP blocking, NoHTTP Reply, RST TCPlevel tampering, Infinite HTTP Redirect, and Blockpage. Using UBICA for several months on selected targets, we found evidenceof several censorship techniques, such as DNS tampering and content filtering.We validated the accuracy of UBICA with the help of users in selected countriesand also show evidence of censorship in several countries Italy, Pakistan, andSouth Korea.Control ProtocolMeasurement    DBUBICAdaemonPossibleCensorshiptargetsUBICAHelper Server UniNAGlobally distributedUBICA clientsInternetUBICAManagement Server UniNAa Architecture diagram. b Report interface detail global map.Fig. 1 The UBICA platform.2 UBICAThe main objective of UBICA is to provide users with a censorship monitoringsystem that presents both a report on worldwide Internet censorship status anda quick view of censorship from users perspectives. To gather data, the platform leverages a distributed deployment of probes belonging to different kindsrouterbased, headless client, GUIclient that are orchestrated by a centralmanagement server. The platform provides i dynamically updated censorshiptests ii dynamically updated targets to be verified iii support for different types of probing clients iv automatic censorship detection and censorshiptechnique identification. Fig. 1a shows the UBICA architecture. An example ofmonitoring report is shown in fig. 1b.Monitoring control flow. The collection of evidences of censorship is performed through active measurements from the probes, that periodically retrievefrom the Management Server a list of test requirements eventually updatingthe necessary targets lists and code. The target lists are build from uptodatereports from Herdict 1, a list of worldwide top accessed websites, and lists suggested from incountry volunteers they are distributed to probes based on thecountry the probe is located at. After the evidence collection each probe packsall the results in a report file and uploads it back to the Management Server.Such server asynchronously parses the reports and inserts the relevant information into an SQL Database. The Analysis Engine periodically processes datain the database, performing the censorship detection analyses described in theExperimental results section. The different types of measurements performed aredescribed in the following.DNS resolution. To collect clues about this phase, a name resolution iselicited given a fully qualified domain name, a DNS request of type A is issuedfrom the probe towards its default resolver. The tool used to issue the request isnslookup. To distinguish among different DNS tampering techniques, the samerequest is issued also towards a list of open resolvers, used as control resolversfrom inside the censored network. The list of open resolvers is the same as theone used in 14.TCP reachability. To check for filtering triggered by IPport, this test triesto establish a TCP connection, starting a threeway handshake with a giventimeout. The tests takes as parameters targetIPport and a timeout value inseconds, that has been set by default to 15s.HTTP reachability. This test issues an HTTP GET request the response orlack of it from the server is collected, along with application level values. TheHTTP header field UserAgent is chosen randomly from a list of the most common user agent strings, according to 9. The tool used to issue the request andcollect application level information is curl.The report from this test includesseveral values, such as content type, HTTP response code, number of redirects,etc., not reported for the sake of brevity.3 Experimental ResultsWith the help of professional and personal contacts, a number of software probeshave been deployed in different countries worldwide, plus more than a dozen BISmark routers 17 from an experimental deployment in Pakistan, one in Italy andanother one in USA. The distributed platform PlanetLab 4 has also been employed, deploying UBICA probes in the most diverse set of countries availableat the time of the experiments. The measurement campaigns have been conducted using more than 200 probes, constituted by 47 clients with GUI runby volunteers both in Italy and abroad 188 headless clients of which 19 runby volunteers worldwide and 169 in PlanetLab nodes and 16 BISmark homerouters run by volunteers mostly in Pakistan. The target lists for each countryincluded Herdict reports for the country, a list of worldwide top accessed websites, and URLs suggested by local volunteers. Measurements have been madefrom 31 different countries, testing more than 16K different targets about 15Kdifferent hostnames on a timespan of 4 months.The application of the UBICA detection algorithm to data collected in thisexperimental campaign and the time analysis of the related outcomes have testedthe functionalities of the platform. In the following we report an extract of themost interesting results, concentrating on those for which we had a ground truth.3.1 Censorship in PakistanIn ONI country profiles, Pakistan PK is classified as applying selective filtering, showing a consistent level of censorship and tight control on Internet communications across the national border. The government body Pakistan Telecommunication Authority PTA is in charge of the management of the PakistanInternet Exchange, the exchange point connecting the country to the rest of theInternet, and maintains a blacklist of URLs to be censored 14. According to thelast report from The OpenNet Initiative, blocked resources belong to the classesreligion, sex, and politics.A general view. Our experimental campaigns performed through UBICAprobes in Pakistan evidenced that many resources were actually censored inthis country. The censorship detection algorithm reported that the techniquesused were mainly two DNS injection and HTTP tampering. To understand whathappened and to confirm these results we analyzed the intermediate data, comprising the results of the different tests performed by UBICA. We describe theoverall results and the details about the intermediate ones in the following.As for DNS, 68 of the resources are identically resolved from inside PKand USA USA has been used for comparison purposes. Thus the algorithmfor censorship detection excluded the occurrence of DNSbased censorship forthe related resources. Therefore, for the remaining resources, the analysis hasexploited information about the size of the resource the content size tests.Similar analysis based on content size has been recently published in 11, but itleverages the availability of a ground truth, i.e., a copy of the content known tobe uncensored, to compare with. Our algorithm, described hereafter, does notneed such knowledge.Considering the size of the resource webpage that has been retrieved, andaveraging on all measurements from within a country, we expect to find a significant difference between different countries if one of the two is censoring thecontent by means of a blocking page. For each URL u, the average resourcesize per country su,P K uinP KsizeuP K is calculated and divided by the corresponding size averaged on all the other countries as an example, we show theratio with USA in this case, but in the following reports the more general setupis adopted. Considering the empirical CDF of such ratio Fig. 2a, we can seethat while most of URLs show a comparable average size, there is an interestingfraction of them whose size is much smaller in Pakistan than in USA. The empirical probability mass function distribution reported in Fig. 2b clearly showstwo modes one centered in 1 and a smaller one close to 0. The variability around1 can be considered as due to differences in parts of the HTML code that areupdated in the dynamic generation of the resource. The relatively big variationsthat lead to the mode close to zero hint to a different phenomenon, on whichwe will focus to find evidence of censorship. To differentiate between the twomodes, we choose a threshold of 0.3, which is halfway between the two modesminus a guard interval of 0.2 to account for variability across multiple countriesand coherently with the design principles of the detection algorithm. An excerptof some URLs whose size ratio falls below this threshold in total 56, of which 28are youtube videos are reported in Tab. 1. We took one of the URLs selectedthrough the average content size ratio test, namely ninjaproxy.com accountingfor 343Bytes in Pakistan and 14753Bytes from USA and looked at the HTMLcode received by the client in Pakistan. The inspection confirmed that the pageis completely different from the one retrieved from outside Pakistan not shownfor space constraints. Indeed censorship has been enacted providing a webpagewith iframe redirection to a blocking page. These results are consistent with 14,and the analysis in the report by The Citizen Lab on this country. More detailsURL size PK size USA Ratiobarenakedislam.wordpress.com 453.0 49095.63 0.01ninjaproxy.com 342.45 14085.42 0.02NinjaProxy.com 342.39 13154.06 0.03www.similarsites.com 375.33 13701.44 0.03www.youtube.com 4183.91 144177.2 0.03www.freefacebookproxies.com 9041.17 241485.33 0.04friendlyatheist.com 7881.34 205294.23 0.04www.loonwatch.com 2661.73 65075.19 0.04www.sodahead.com 3575.67 73969.7 0.05www.hotspotshield.com 731.8 10789.91 0.07faceofmuhammed.blogspot.com 6208.7 85342.93 0.07www.foxnews.com 4705.53 63425.26 0.07www.buzzfeed.com 22097.93 287001.77 0.08www.freefacebookproxies.com 18245.93 233254.73 0.08www.hotspotshield.com 870.1 10632.97 0.08www.cagle.comnewsmuhammad 3594.5 40974.12 0.09www.smugbox.comfacebook... 1883.93 21455.95 0.09www.faithfreedom.orgGallery... 1438.93 15423.32 0.09www.turbohide.com 896.91 8744.12 0.1www.unblockbook.net 812.48 6348.47 0.13www.thesecretninjaproxy.info 469.79 3416.17 0.14www.kproxy.com. 647.47 4694.55 0.14www.kproxy.com 666.39 4618.71 0.14www.unblockfacebook.net 840.26 5783.3 0.15www.blockedsiteaccess.com 1271.46 7780.19 0.16Table 1 Selection of URLs whose content size ratio size PK divided by sizeUSA is smaller than 0.3 URL path is truncated for presentation constraints.10.80.60.40.2010.5 1.5 2 2.5 3 3.50size ratioCDFa Empirical CDF10.5 1.5 2 2.5 3 3.50size ratio0.40.30.20.10PDF0.5b Empirical PDFFig. 2 Distribution of content size ratios size PK divided by size USA for eachURL, tested URLs are from 14 468 URLs.on reports generated by UBICA are described in the following for specific targetsthat better expose the detection algorithm inner working.The case of YouTube. One of the final results of the UBICA detection algorithm is the summary of the censorship techniques detected for a given targetas accessed from different ISPs. This report shows an evaluation of censorshipconditions and technologies in the considered country for the specified resource.An example of blocked URL showing interesting differences among ISPs is thestreaming video platform  with content and comment sharing from users YouTube www.youtube.com, integrated with the social network google plus andthe search engine google. The report that UBICA generated for the URL of aresource on YouTube, as tested from different ISPs in Pakistan, is shown in formof a bar chart in Fig. 3a. The lack of bars in the second aggregate with labelContent plausible means that this resource is never reachable, even thoughfor all but one ISP, a resource is returned when performing an HTTP requestfirst aggregate of bars, labeled Content available. We recall that Contentplausible is the percentage of URLs that passed the size ratio censorship test,and thus present a content size comparable to the average on all countries. Theoutcome of this test is represented in Fig. 3c as a CDF of the ratio of the sizeof the downloaded content in one sample over the global average of such size.The CDF generated for Pakistan is shown in green along with other countries 0 20 40 60 80 100Content availableContent plausibleTCP reachableDefault DNS plausibleControl DNS plausibleoccurrences Micronet Broadband Pvt Ltd.National WiMAXIMS environmentPakistan Telecom Company LimitedTransworld Associates Pvt. Ltd.WITRIBE PAKISTAN LIMITEDa Comparison of results for differentcensorship techniques. 0 20 40 60 80 100Default DNS errorsControl DNS errorsDefault DNS failing IPsControl DNS failing IPsDefault DNS blocking IPsControl DNS blocking IPsDefault DNS error pagesControl DNS error pagesoccurrences Micronet Broadband Pvt Ltd.National WiMAXIMS environmentPakistan Telecom Company LimitedTransworld Associates Pvt. Ltd.WITRIBE PAKISTAN LIMITEDb Detail of DNS analysis.00.20.40.60.810 1 2 3 4 5 6 7 8 9 10CDFsize ratiothresholdITALYPAKISTANUNITED STATESc Empirical CDF of content size ratioFig. 3 Censorship in Pakistan the case of YouTube.for comparison Italy cyan and U.S.A. in dark blue the aggregation level iscountry, thus considering samples for the whole nations regardless of the ISP.The graph shows clearly that the size ratios in Pakistan are close to 0 i.e. thecontent size is very small compared with the global average with relative frequency 1 always, while for both the other countries the occurrences fall close to1 thus same content size as the global average with relative frequency greaterthan 0.9 for U.S.A. 0.91 for a size 1.23 times the average, for Italy 0.95 for a size1.11 times the average. Comparing with the size ratio threshold set to 0.3 wenotice that the test has correctly separated results in Pakistan from the ones inthe other countries. Moreover as the detected condition is above the coherencethreshold, the reported results are consistent over each country dataset.TCPlevel tests Fig.3a, third aggregate, label TCP reachable show almost 100 reachability for all the ISPs, thus either no censorship is enactedat this layer, or DNS tampering precedes it. By considering the default DNSresults for two ISPs Micronet Broadband Pvt Ltd. and Witribe PakistanLtd. no result yields a plausible IP address i.e. neither a known block page ora failing IP, nor a DNS error, similarly for Pakistan Telecom Company Ltd.only 11.7 is plausible. These ISPs clearly block the resource with DNS tampering. The DNS overall results show equal values for the default and the controlresolvers, thus the inferred technique is DNS injection. The ISPs TransworldAssociates cyan in Fig. 3b and National WiMaxIMS dark blue do notperform DNS tampering on the resource under analysis yet for both the contentsize ratio analysis has detected censorship an HTTP tampering technique hasbeen applied. To gather information regarding the symptom the user gets in thecensored networks, we leverage the detailed DNS analysis, shown in Fig. 3b. Itcan be noted that, while two ISPs namely, Micronet Broadband Pvt Ltd.and Witribe Pakistan Ltd. both use DNS tampering to provide the user withan explicit block page, the ISP Pakistan Telecom Company Ltd. provides an address that will likely cause an error either at TCPlevel or an HTTP404, thusconfounding the customer without providing explicit notification of censorship.From the comparison between the summarized view Fig. 3a and the DNSanalysis details Fig. 3b the behavior of one ISP Pakistan Telecom CompanyLtd., in magenta seems inconsistent with the expected symptom, as the detected technique DNS injection  failing IP should have elicited an error,and not the high percentages found both in TCP reachable and Content available bars 3a. By inspecting the collected evidence data it resulted that theIP address returned by the ISP under analysis is 127.0.0.1, corresponding tolocalhost, i.e. for each machine is the address of the machine itself networklevel loopback. While other specialized network address ranges 6 are unlikely to be assigned to active hosts in the same LAN of the probe, localhostfor sure is, and the outcome of a TCP connection to the port 80 and possiblyan HTTP request depend on the presence of a service listening on that port,and the response the service will return, if present. The inspection confirms theverdict of the platform, that detected censorship and the actual technique DNSinjection regardless of the misleading symptoms no errors at any level of thestack  DNS, TCP, HTTP.3.2 Censorship in KoreaThe access to online content in South Korea is regulated by a government body,Korea Communications Standards Commission KCSC nominated by the president and in charge of the Ethics of Internet communications. The nation isreported by ONI as applying selective filtering for Social topics and pervasive filtering for the ConflictSecurity category.Adult websites. A category of websites that is forbidden per order of theEthical authority is the one showing adult content classified among obscenityand perversion. The detection algorithm has signaled censorship for URLssuch as hardsextube.com, pornhub.com and redtube.com, coherently with theexpectations. We will consider the case of hardsextube.com in detail, as theother presents analogous results.Considering the summarized view for the different tested techniques aggregated by country Fig. 4a, it becomes evident the peculiar response in Koreawith respect to the other tested countries. More specifically, the content plausible percentage of tests, result of the analysis based on the size ratio of thedownloaded resource, is near 0 while other countries show near 100, thuslimiting to Korea only the issue in accessing the original content. Also no othercensorship detection technique has been matched, thus excluding DNS Tampering and TCPlevel filtering. 0 10 20 30 40 50 60 70 80 90 100Content availableContent plausibleTCP reachableDefault DNS plausibleControl DNS plausibleoccurrences BRAZILITALYKOREARep. ofUNITED KINGDOMUNITED STATESa Comparison of censorship evidencesresults across countries.00.20.40.60.810 0.2 0.4 0.6 0.8 1 1.2CDFsize ratiothresholdUNITED KINGDOMITALYKOREARep. ofUNITED STATESBRAZILb Empirical CDF of the content size ratio.Fig. 4 Censorship in Korea porn websites.To inspect in more detail the test that has detected censorship we refer toFig. 4b, where the Empirical Cumulative Distribution Function is drawn of theratio of each sample content size over the global average. It can be seen that onlyresults for Korea in dark blue, close to the top border of the graph are almostcompletely 0.98 below the detection threshold empirically set to 0.3 as forthe preceding analyses. All other countries have the almost totality of samplesbeyond 1.1, with the exception for U.K., U.S.A., and Brazil, with small fractionless than 0.16 falling just short of the threshold.These results have not raised a censorship verdict due to the small relativeoccurrence prefiltering data cleansing ignores cases that represent less than70 of the results. We have manually checked the content and found thatcorresponds to mobile versions of the requested website. The detection algorithmbased on the size ratio has proved robust to content adaptation 13 in thisscenario, but further research should be pursued in order to generalize this result.To validate the censorship verdict, we have manually inspected the returnedresource.We have seen that the returned webpage, result of the HTTP tamperingtechnique, consists of a single JavaScript section whose effect when interpretedby the browser is to redirect to the address httpwarning.or.kr, the officialblock page of the Korean authority for Internet censorship.3.3 Censorship in ItalyInternet censorship in Italy is enforced mainly against websites proposing onlinegaming, betting and copyright infringement. Another significant motivation forcensorship is the block of child pornography, but due to ethical issues in potentially involving volunteers in police investigations the latter has not been tested.Thanks to UBICA we could see that no centralized censoring infrastructure ispresent, as censoring is detected for different ISPs starting and ending at differ217.175.53.72888poker.net213.52.252.134888holdingsplc.com31.25.184.250127.0.0.1www.thepiratebay.org194.71.107.502sportgewin.com80.92.117.4227casino.com66.147.240.150365sbpoker.com178.237.172.17621grandcasino.com200.124.144.252888bet.com213.52.252.42888.info213.52.252.6777kpweb.euNXDOMAIN365planetwin.com 81.2.199.1357carte.com72.251.240.149Fig. 5 DNS hijacking in Italy DNS resolution graph for betting websites. Ellipsescontain host names, rectangles contain IP addresses, arrow lines are resolutionsrequested by probes to their default resolver for dashed lines probes are insideItaly, while for solid lines the probe is in USA.ent times, and censoring techniques are sometimes different in the vast majorityDNS hijacking, and casespecific TCP blocking.The Italian Agency for State Monopolies AAMS 4 provides an official listof domains5 that have been blocked because of infringement of the Italian lawson online gaming and betting both require a state license. Another but nonofficial  source is provided by an independent researcher in his observatory oncensorship website6 where a list of censored domains together with the authoritythat issued the censoring order and the date it was issued are reported.In the case of blocks of websites proposing online gaming and betting theblock is explicit by means of a blockpage, while for websites related to filesharing the block is not motivated, resulting in a network error or a websitedescribing a generic error. The censoring technique used most across all thetested ISPs is DNS hijacking, whose effect is graphically shown in Fig. 5 andin which DNS resolution requested to the probe default resolver is comparedbetween probes from inside Italy red lines and USA blue lines.A few specific examples are described in the following.Betting and gaming. The website httpbet365.com will be used as a representative of the betting and gaming website class. The results of censorshipanalysis algorithms for the resource bet365.com is reported in Fig. 6a. We can4 Amministrazione Autonoma dei Monopoli di Stato, httpeee.aams.gov.it5 httpwww.aams.gov.itsitesaams2008filesdocumentioldprivatedownloadsdocumentazionescommesseElencositiinibitielencositiinibiti.rtf6 httpcensura.bofh.itelenchi.html 0 10 20 30 40 50 60 70 80 90 100Content availableContent plausibleTCP reachableDefault DNS plausibleControl DNS plausibleoccurrences C.Re.A.T.E.NGI SpaTelecom Italia S.p.a.Wind Telecomunicazioni spaa Comparison of censorship techniquesper different ISPs. 0 10 20 30 40 50 60 70 80 90 100Default DNS errorsControl DNS errorsDefault DNS failing IPsControl DNS failing IPsDefault DNS blocking IPsControl DNS blocking IPsDefault DNS error pagesControl DNS error pagesoccurrences C.Re.A.T.E.NGI SpaTelecom Italia S.p.a.Wind Telecomunicazioni spab Detail of DNS analysis.unreachreach20131005201310192013110220131116201311302013121420131228DEF127.0.1.1DEF127.0.0.18.8.8.88.26.56.26209.244.0.3208.67.222.222198.153.192.40c DNS temporal analysis.Fig. 6 Censorship in Italy gaming and betting websites, the case of bet365.com.see that for the ISP NGI the percentage of DNS resolutions performed bythe probe default resolver is as little as 4.5. This is reflected by an analogouspercentage of content of plausible size. From the same graph it can be seenthat also for Wind Telecomunicazioni and Telecom Italia providers thereare low percentages of plausible DNS resolution 31.2 and 46.1 respectivelyand similar percentages of plausible content size 23.8 and 46.1 respectively.Only for the Center for REsearch And Telecommunication ExperimentationISP, serviced by the GARR 7 , both the DNS resolutions and the downloadedcontent size are always plausible, showing no censorship on this network for theconsidered resource.The verdict for the other ISPs is of censorship by means of DNS hijackingtowards an explicit blockpage, in fact by comparing the result between the defaultDNS resolver and the control ones it can be noted that no control DNS is affected.The reason for the specific kind of DNS hijacking blockpage is evident wheninspecting the results of the DNS analysis, reported as a bar chart in Fig. 6b. Herewe can see that for all the three ISPs implementing censorship, the resulting DNSresponse belongs to the list of known blockpages. Thus the adopted censoringtechnique has the effect of presenting the user with a block webpage explicitlytelling himher of the censorship. From the Fig. 6b it can also be noted that7 The GARR is the Italian Academic and Research telecommunication network.with the exception of NGI Spa, with 95.4, no ISP gives percentages close tothe totality. The possible causes of this behavior can be i a variability of thecensor behavior in the analysis time interval beginning or ending of censorshipii heterogeneity of the probe environment at a granularity smaller than the ISPlevel. The temporal evolution of the case under description is shown in Fig. 6c.It can be seen that the oscillating results between reachability upper line andunreachability is limited to the default resolvers the first two entries in the key,prepended with DEF, while the control resolvers always report the domainas uncensored. It can be noted that the default DNS server address  as reportedin the DNS reply  corresponds to localhost a local caching application suchas dnsmasq8 is in function on the probe system, preventing the collection of thelocal default resolver.Streaming and File Sharing. The second class of websites censored in Italy isconstituted by repositories and index directories for file sharing and multimediastreaming. For this class of websites UBICA has reported a much more diversescenario across the different ISPs we will describe it in the following taking asan example the index directory httpthepiratebay.sx. The overall behaviorof censorship techniques used by different Italian ISPs is summarized in Fig. 7a.Besides the low percentages of plausible DNS responses for the default resolver,low percentages are present also for control DNS servers. Moreover, differentlyfrom the case of betting websites, also the ISP connected through the Academicand Research network GARR presents low percentages less than 50 for bothdefault and control resolvers, and close to 40 of content availability. Anothernotable difference is in the result for TCP reachability while for the onlinebetting website this measure scored close to 100 reachability for 3 out of 4ISP and more than 75 for the remaining one, in the case of the file sharingwebsite 2 ISPs show less than 50 reachability at the TCP level. A more indepth inspection of the results of DNS tests, reported in Fig. 7b, shows a morediverse condition with respect to the case of betting websites Fig. 6b.All the ISPs show different DNS errors, both for default and control DNSservers. One ISP Wind Telecomunicazioni shows a 65.5 responses returning a failing IP 127.0.0.1 for the default resolver, and 7.7 of NXDOMAIN orTIMEOUT DNS errors. Different percentages of errors are shown by the other ISPs,each characterized by the presence of multiple symptoms of DNS unreachabilityin strong discordance with the case of betting websites each ISP concentratedin one kind of DNS unreachability symptom. The temporal analysis of the DNSmeasures, represented in the time series of Fig. 7c, helps explaining such combination of results for the Wind ISP. In fact, similarly to the case of bettingwebsites Fig. 6c, there is an oscillation between reachability and unreachability for the default resolvers, spanned over the first half of the timeline, againexplainable with the lack of control over the default DNS set for the probe.8 dnsmasq is an open source DNS cache and forwarder, installed by default on severaldistribution of Linux, including OpenWrt and Ubuntu, main OSes for the UBICAprobes. Website httpwww.thekelleys.org.ukdnsmasqdoc.html 0 10 20 30 40 50 60 70 80 90 100Content availableContent plausibleTCP reachableDefault DNS plausibleControl DNS plausibleoccurrences C.Re.A.T.E.NGI SpaTelecom Italia S.p.a.Wind Telecomunicazioni spaa Comparison of results of differenttechniques. 0 10 20 30 40 50 60 70 80 90 100Default DNS errorsControl DNS errorsDefault DNS failing IPsControl DNS failing IPsDefault DNS blocking IPsControl DNS blocking IPsDefault DNS error pagesControl DNS error pagesoccurrences C.Re.A.T.E.NGI SpaTelecom Italia S.p.a.Wind Telecomunicazioni spab Detail of DNS analysis.unreachreach20131005201310192013110220131116201311302013121420131228DEF127.0.1.1DEF127.0.0.18.8.8.88.26.56.26209.244.0.3208.67.222.222198.153.192.40c DNS temporal analysis for the WindISP.Fig. 7 Censorship in Italy file sharing websites, the case of thepiratebay.sx.In this case, however, all the resolvers, no matter if default or control, reportunreachability. The unreachability of thepiratebay.sx starting from December 10th 2013 is verified by the probes in all the countries, signaling that aserverside event has occurred. From manual check of external information thenews section of the same website, freshly moved to another Top Level Domainhttpthepiratebay.seblog234 we can validate the finding of the UBICAplatform the old hostname has been dismissed on December 10th.4 ConclusionsIn this paper we have presented results obtained by means of UBICA UserbasedInternet Censorship Analysis, a crowdsourced platform for Internet censorshipmonitoring. We have ran UBICA for several months on selected targets and wehave found evidences of several censorship techniques, such as DNS tamperingand content filtering. In this paper we have shown practical results from thefollowing countries Italy, Pakistan, and South Korea. In these countries we obtained help from local users and we really thank them and we validated ouranalysis using a ground truth built by manual inspection of evidences. We haveshown how the UBICA architecture and its main features are able to run anintegrated and multistep analysis to provide a simple but effective dashboardthanks to which censorship events are easily spotted and described also in theirtemporal evolution. Being based on crowdsourced data and on repeated measurements, the completeness and accuracy of the monitoring depend on userparticipation to foster community participation we have provided a lightweightUBICA client for linux platforms and the online access to client reports, bothavailable at httpubica.comics.unina.it.References1. Herdict Project. httpwww.herdict.org2. Anderson, C. Dimming the internet Detecting throttling as a mechanism of censorship in iran. arXiv preprint arXiv1306.4361 20133. Chaabane, A., Chen, T., Cunche, M., Decristofaro, E., Friedman, A., Kaafar, M.A.,et al. Censorship in the wild Analyzing internet filtering in syria. In ACM SIGCOMM IMC 20144. Chun, B., Culler, D., Roscoe, T., Bavier, A., Peterson, L., Wawrzoniak, M., Bowman, M. Planetlab an overlay testbed for broadcoverage services. ACM SIGCOMM Computer Communication Review 333, 312 20035. Clayton, R., Murdoch, S., Watson, R. Ignoring the great firewall of china. InPrivacy Enhancing Technologies, 20066. Cotton, M., Vegoda, L., Bonica, R., Haberman, B. SpecialPurpose IP AddressRegistries. RFC 6890 Best Current Practice Apr 20137. Dainotti, A., Squarcella, C., Aben, E., Claffy, K.C., Chiesa, M., Russo, M., Pescap,A. Analysis of countrywide internet outages caused by censorship. In SIGCOMM.pp. 118. ACM 20118. Dornseif, M. Government mandated blocking of foreign web content 2003, httparxiv.orgabscs04040059. Eckersley, P. How unique is your web browser In Privacy Enhancing Technologies, 201010. Filast, A., Appelbaum, J. Ooni Open observatory of network interference. InUSENIX FOCI 201211. Jones, B., Lee, T.W., Feamster, N., Gill, P. Automated detection and fingerprinting of censorship block pages. In ACM SIGCOMM IMC 201412. Khattak, S., Javed, M., Khayam, S.A., Uzmi, Z.A., Paxson, V. A look at theconsequences of internet censorship through an ISP lens. In ACM SIGCOMMIMC 201413. Md Fudzee, M.F., Abawajy, J. A classification for content adaptation system. IniiWAS. pp. 426429. ACM 200814. Nabi, Z. The anatomy of web censorship in pakistan. In USENIX FOCI 201315. Park, J.C., Crandall, J.R. Empirical study of a nationalscale distributed intrusiondetection system Backbonelevel filtering of HTML responses in China. In ICDCS.pp. 315326. IEEE 201016. Sfakianakis, A., Athanasopoulos, E., Ioannidis, S. Censmon A web censorshipmonitor. In USENIX FOCI 201117. Sundaresan, S., De Donato, W., Feamster, N., Teixeira, R., Crawford, S., Pescap,A. Measuring home broadband performance. CACM 5511, 100109 201218. Verkamp, J.P., Gupta, M. Inferring Mechanics of Web Censorship Around theWorld. In FOCI. USENIX 201219. Xu, X., Mao, Z.M., Halderman, J.A. Internet censorship in china Where does thefiltering occur In Passive and Active Measurement. pp. 133142. Springer 2011
