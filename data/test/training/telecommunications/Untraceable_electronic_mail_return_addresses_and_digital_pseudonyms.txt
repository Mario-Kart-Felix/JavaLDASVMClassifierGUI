Untraceable Electronic Mail, Return Addresses, and Digital PseudonymsBy David ChaumCommunications of the ACMFebruary 1981Volume 24Number 2Permission to copy without fee all or part of this material is grantedprovided that the copies are not made or distributed for directcommercial advantage, the ACM copyright notice and the title of thepublication and its date appear, and notice is given that copying isby permission of the Association for Computing Machinery.  To copyotherwise, or to republish, requires a fee andor specific permission.This work was partially supported by the National Science Foundationunder Grant MCS 7523739 and by teh Air Force Office of ScientificResearch under Contract F496209CO173.Authors present address Computer Science Division, ElectricalEngineering and Computer Sciences Department, University ofCalifornia, Berkeley, California 94720.  415421024.Copyright C 1981 ACM 00010828102000084 00.75.Technical NoteProgramming Techniques and Data StructuresR. Rivest, EditorUntraceable Electronic Mail, Return addresses, and Digital PseudonymsDavid L. ChaumUniversity of California, BerkeleyAbstractA technique based on public key cryptography is presented that allowsan electronic mail system to hide who a participant communicates withas well as the content of the communication  in spite of an unsecuredunderlying telecommunication system.  The technique does not require auniversally trusted authority.  One correspondent can remain anonymousto a second, while allowing the second to respond via an untraceablereturn address.The technique can also be used to form rosters of untraceable digitalpseudonyms from selected applications.  Applicants retain theexclusive ability to form digital signatures corresponding to theirpseudonyms.  Elections in which any interested party can verify thatthe ballots have been properly counted are possible if anonymouslymailed ballots are signed with pseudonyms from a roster of registeredvoters.  Another use allows an individual to correspond witharecordkeeping organization under a unique pseudonym which appears ina roster of acceptable clients.Key Words and Phrases electronic mail, public key cryptosystems,digital signatures, traffic analysis, security, privacyCR Categories 2.12, 3.81IntroductionCryptology is the science of secret communication.  Cryptographictechniques have been providing secrecy of message content forthousands of years 3.  Recently some new solutions to the keydistribution problem the problem of providing each communicant witha secret key have been suggested 2,4, under the name of public keycryptography.  Another cryptographic problem, the traffic analysisproblem the problem of keeping confidential who converses with whom,and when they converse, will become increasingly important with thegrowth of electronic mail.  This paper presents a solution to thetraffic analysis problem that is based on public key cryptography.Baran has solved the traffic analysis problem for networks 1, butrequires each participant to trust a common authority.  In contrast,systems based on the solution advanced here can be compromised only bysubversion or conspiracy of all of a set of authorities.  Ideally,each participant is an authority.The following two sections introduce the notation and assumptions.Then the basic concepts are introduced for some special casesinvolving a series of one or more authorities.  The final sectioncovers general purpose mail networks.NotationSomeone becomes a user of a public key cryptosystem like that ofRivest, Shamir, and Adleman 5 by creating a pair of keys K andInvK from a suitable randomly generated seed.  The public keyK is made known to the other users or anyone else who cares to knowit the private key InvK is never divulged.  The encryption ofX with key K will be denoted K X , and is just the image of X underthe mapping implemented by the cryptographic algorithm using key K.The increased utility of these algorithms over conventional algorithmsresults because the two keys are inverses of each other, in the sensethat InvK K X    K InvK X    X.A message X is sealed with a public key K so that only theholder of the private key InvK can discover its content.  IfX is simply encrypted with K, then anyone could verify a guessthat Y  X by checking whether K Y   K X .  This threat can beeliminated by attaching a large string of random bits R to Xbefore encrypting.  The sealing of X with K is then denotedK R, X .  A user signs some material X by prepending a largeconstant C all zeros, for example and then encrypting with itsprivate key, denoted InvK C, X   Y.  Anyone can verify thatY has been signed by the holder of InvK and determine thesigned matter X, by forming K Y   C, X and checking for C.AssumptionsThe approach taken here is based on two important assumptions1 No one can determine anything about the correspondences between aset of sealed items and the corresponding set of unsealed items, orcreate forgeries without the appropriate random string or private key.2 Anyone may learn the origin, destinations, and representation ofall messages in the underlying telecommunication system and anyone mayinject, remove, or modify messages.Mail SystemThe users of the cryptosystem will include not only the correspondentsbut a computer called a mix that will process each item of mailbefore it is delivered.  A participant prepares a message M fordelivery to a participant at address A by sealing it with theaddressees public key Ka, appending the address A, and thensealing the result with the mixs public key K1.  The lefthandside of the following expression denotes this item which is input tothe mixK1 R1, Ka R0, M , A   Ka R0, M , A.The  denotes the transformation of the input by the mix into theoutput shown on the righthand side.  The mix decrypts its input withits private key, throws away the random string R1, and outputs theremainder.  One might imagine a mechanism that forwards the sealedmessages Ka R0, M  of the output to the addressees who then decryptthem with their own private keys.The purpose of a mix is to hide the correspondences between the itemsin its input and those in its output.  The order of arrival is hiddenby outputting the uniformly sized items in lexicographically orderedbatches.  By assumption 1 above, there need be no concern about acryptanalytic attack yielding the correspondence between the sealeditems of a mixs input and its unsealed output  if items are notrepeated.  However, if just one item is repeated in the input andallowed to be repeated in the output, then the correspondence isrevealed for that item.Thus, an important function of a mix is to ensure that no item isprocessed more than once.  This function can be readily achieved by amix for a particular batch by removing redundant copies beforeoutputting the batch.  If a single mix is used for multiple batches,then one way that repeats across batches can be detected is for themix to maintain a record of items used in previous batches.  Recordscan be discarded once a mix changes its public key by, for example,announcing the new key in a statement signed with its old privatekey.  A mix need not retain previous batches if part of each randomstring R1 constains something  such as a timestamp  that is onlyvalid for a particular batch.If a participant gets signed receipts for messages it submits to amix, then the participant can provide substantial evidence that themix failed to output an item properly.  Only a wronged participant cansupply the receipt Y  InvK1 C, K1 R1, Ka R0, M , A , themissing output X  Ka R0, M , A , and the retained string R1, suchthat K1 Y   C, K1 R1, X .  Becasue a mix will sign each outputbatch as a whole, the absence of an item X from a batch can besubstantiated by a copy of the signed batch.The use of a cascade, or series of mixes, offers the advantage thatany single constituent mix is able to provide the secrecy of thecorrespondence between the inputs and the outputs of the entirecascade.  Incrimination of a particular mix of a cascade that failedto properly process an item is accomplished as with a single mix, butonly requires a receipt from the first mix of the cascade, since a mixcan use the signed output of its predecessor to show the absence of anitem from its own input.  An item is prepared for a cascade of n mixesthe same as for a single mix.  It is then successively sealed for eachsucceeding mixKn Rn, Kn1 Rn1, ... , K2 R2, K1 R1, Ka R0, M , A ... .The fist mix yields a lexicographically ordered batch of items, eachof the formKn1 Rn1, ... , K2 R2, K1 R1, Ka R0, M , A ... .The items in the final output batch of a cascade are of the formKa R0, M , A, the same as those of a single mix.Return AddressesThe techniques just described allow participant x to send anonymousmessages to participant y.  What is needed now is a way for y torespond to x while still keeping the identity of x secret from y.  Asolution is for x to form an untraceable return addressK1 R1, Ax, Kx, where Ax is its own real address, Kx is a public keychosen for the occasion, and R1 is a key that will also act as arandom string for purposes of sealing.  Then, x can send this returnaddress to y as part of a message sent by the techniques alreadydescribed.  In general, two participants can exchange returnaddresses through a chain of other participants, where at least onemember of each adjacent pair knows the identity of the other member ofthe pair.  The following indicates how y uses this untraceable returnaddress to form a response to x, via a new kind of mixK1 R1, Ax , Kx R0, M   Ax, R1 Kx R0, M .This mix uses the string of bits R1 that it finds after decrypting theaddress part K1 R1, Ax  as a key to reencrypt the message partKx R0, M .  Only the addressee x can decrypt the resulting outputbecause x created both R1 and Kx.  The mix must not allow addressparts to be repeated  for the same reason that items of regular mailmust not be repeated.  This means that x must supply y with a returnaddress for each item of mail x wishes to receive.  Also notice thatconventional as opposed to public key cryptography could be used forboth encryptions of M.With a cascade of mixes, the message part is prepared the same as fora single mix, and the address part is as showin in the followinginputK1 R1, K2 R2, ..., Kn1 Rn1, Kn Rn, Ax ..., Kx R0, M  .The result of the first mix isK2 R2, ..., Kn1 Rn1, Kn Rn, Ax ..., R1 Kx R0, M  ,and the final result of the remaining n1 mixes isAx, Rn Rn1 ... R2 R1 Kx R0, M ....Untraceable return addresses allow the possiblity of certified mailThey can provide the sender of an anonymous letter with a receiptattesting to the fact that the letter appeared intact in the finaloutput batch.  The address A that is incorporated into a certifiedletter is expanded to include not only the usual address of therecipient, but also an untraceable return address for the sender.When this return address appears inthe output batch of the final mix,it is used to mail the sender a signed receipt which inlucdes themessage as well as the address to which it was delivered.  The receiptmight be signed by each mix.Digital PseudonymsA digital pseudonym is a public key used to verify signatures madeby the anonymous holder of the corresponding private key.  A roster,or list of pseudonyms, is created by an authority that decides whichapplications for pseudonyms to accept, but is unable to trace thepseudonyms in the completed roster.  The applications may be sent tothe authority anonymously, by untraceable mail, for example, or theymay be provided in some other way.Each application received by the authority contains all theinformation required for the acceptance decision and a specialunaddressed digital letter whose messages is the public key K, theapplicants proposed pseudonym.  In the case of a single mix, theseletters are of the form K1 R1, K .  For a cascade of n mixes, theyare of the form Kn Rn, ..., K2 R2, K1 R1, K ....  The authoritywill form an input batch containing only those unaddressed lettersfrom the applications it accepts.  This input batch will be suppliedto a special cascade whose final output batch will be publicallyavailable.  Since each entry in the final output batch of the cascadeis a public key K from an accepted applicant, the signed output of thefinal mix is a roster of digital pseudonyms.Notification of applicants can be accomplished by also forming aroster for unaccepted applications and then using the technique ofcertified mail to return a single batch of receipts to both sets ofapplicants.  Of course, repeats must not be allowed within or acrossbatches.If only registered voters are accepted for a particular roster, thenit can be used to carry out an election.  For a single mix, each votersubmits a ballot of the form K1 R1, K, InvK C, V , where K isthe voters pseudonym and V is the actual vote.  For a cascade ofmixes, ballots are of the formKn Rn, ..., K2 R2, K1 R1, K, InvK C, V ....  The ballotsmust be processed as a single batch, as were the letters used to formrosters.  Items in the final lexicographically ordered output batchare of the form K, InvK C, V .  Since the roster of registeredvoters is also ordered on K, it is easy for anyone to count the votesby making a single pass through both batches at once.  Each ballot iscounted only after checking that the pseudonym K which forms itsprefix, is also contained in the roster and that the pseudonymproperly decrypts the signed vote V.An individual might be known to an organization only by a pseudonymthat appears in a roster of acceptable clients.  Clients cancorrespond with the organization via untraceable mail and theorganization can correspond with the clients using untraceable returnaddresses.  If applicants identify themselves in their applications,or if they sign applications with pseudonyms that appear in a rosterissued by an authority that requires identification, then theorganization is assured that the same client cannot come to it underdifferent pseudonyms.  Under special circumstances, such as default ofpayment, a particular pseudonym could be shown to correspond to aparticular application without revealing any other correspondencesif each mix in turn supplied the appropriate Rn.General Purpose Mail SystemsOne way to construct a general purpose, untraceable mail system is torequire that every message pass through a cascade.  Of course, mixescan operate continuously or periodically, and long messages will beencrypted first and then split into multiple items.  In order to hidethe number of messages sent, each participant supplies the same numberof messages to each batch some of which might be randomly addresseddummies.  In order to hide the number of messages received, eachparticipant privately searches the entire output for messages directedto it.Such a system may prove too costly for some participants.  One way toreduce the cost is to allow mail to be addressed to subsets ofparticipants, such as a local net.  Participants that take advantageof such arrangements need search only the mail addressed to aparticular subset.  Another way to economize is for a participant tosend for each batch only the number of dummy messages suggested by arandom value chosen from some suitable distribution, as opposed toalways sending the maximal number of messages.  This can substantiallyreduce message traffic and consequently, the size of output batches.While these techniques may open the door to some kinds of statisticalattack, the system size that necessitated them may reduce theeffectiveness of such attacks.In a large, general purpose mail system with many mixes, it may beimpractical for every message to pass through every mix.  In such acase, a sequence of mixes will be selected for each message, perhaps onthe basis of network topology or trust.  Notice that if a participantcan choose mixes it trusts with its traffic volume data as earlymembers of its sequences, then these mixes can discard dummies theyreceive from the participant and deliver small, fixedsized batchespadded with dummies directly to the participant.A new kind of mix will be presented here that allows a sequence ofmixes to be selected for each message.  It also a hides the numberand identity of the mixes a message must pass through, b allowsincrimination of a mix that does not properly forward items, and cmakes no distinction between regular mail and mail sent by untraceablereturn address.  It is based on the idea that every item of mail iscomposed of the same number of fixedsized blocks.The operations performed by this new kind of mix are always the same.First it removes the first block and adds a random block J of junk tothe end, to maintain the items length of l blocks.  Then, using itsprivate key, the mix decrypts the block removed during the first step.This yields a key R, which the mix uses to encrypt each of the lblocks of the item using either publickey or conventionalcryptography.  It also yields the address A either of a recipient orof another mix to which the item will be forwarded.The lefthand side of the following shows how an item is prepared topass through a single mixK2 R2, ..., Kn1 Rn1, Kn Rn, Ax ..., R1 Kx R0, M  ,A1 KA1 RA1, A , InvRA1 M1 , InvRA1 M2 , ...    InvRA1 Ml1   A M1,...Ml1, RA1 JA1 .where square brackets show the extent of each block, and the sealedmessage Ka R0, M  is divided into pieces Mi, such thatKa R0, M   M1, M2, ..., Mln.  The A1 indicates that thelefthand side is delivered to mix A1, while the A means that therighthand side is delivered to address A.  Items with the same firstblock should be regarded as repeats.A message prepared to be passed through mixes A1 through An has theformA1 KA1 RA1, A2 , InvRA1 KA2 RA2, A3 , ...,    InvRA1 InvRA2 ... InvRAn1 KAn RAn, A  ... ,    InvRA1 InvRA2 ... InvRAn M1 ..., ...,    InvRA1 InvRA2 ... InvRAn Mln ...  .The result leaving A1 isA2 KA2 RA2, A3 , InvRA2 KA3 RA3, A4 , ...,    InvRA2 InvRA3 ... InvRAn1 KAn RAn, A  ... ,    InvRA2 InvRA3 ... InvRAn M1 ..., ...,    InvRA2 InvRA3 ... InvRAn Mln ...,    RA1 JA1  ,and the final result leaving An isA  M1, M2, ..., Mln,    RAn RAn1 ... RA1 JA1 ..., ..., RAn JAn .An intermediate mix always knows which mix it received its input from by assumption 2  but if a mix broadcasts copies of its fixedsizeoutput batches, then only individual recipient mixes need be able torecognize their own input in a broadcast batch.The untraceable return address x sends to y contains the key Kx that yuses to encrypt the message part.  It also includes, in the case of asingle mix, what y will use as the first block of the item it submitsto the mixA1 KA1 RA1, Ax , M1, ..., Ml1  Ax RA1 M1 , ..., RA1 Ml1 , RA1 JA1 ,where Kx R0, M   M1, M2, ..., Mln.  Only x can decrypt the itemit receives since it created RA1 and Kx.  When a message is to passthrough n mixes, the untraceable return address contains the first nblocksA1 KA1 RA1, A2 , InvRA1 KA2 RA2, A3 , ...,    InvRA1 InvRA2 ... InvRAn1 KAn RAn, Ax ...,    M1, M2, ..., Mln  .After being operated on by mix A1 it will have the formA2 KA2 RA2, A3 , ...,    InvRA2 InvRA3 ... InvRAn1 KAn RAn, Ax ...,    RA1 M1 , RA1 M2 , ..., RA1 Mln ,    RA1 JA1  ,and the final result leaving An isAx RAn RAn1 ... RA1 M1 ..., ...,    RAn RAn1 ... RA1 Mln ...,    RAn RAn1 ... RA1 JA1 ..., ..., RAn JAn .Summary and ConclusionA solution to the traffic analysis problem has been presented thatallows any single intermediary to provide security for those messagespassing through it.  In addition, the solution allows messages to besent or received pseudonymously.  Through the notion of a roster ofpseudonyms, it also provides some new and interesting kinds of limitedanonymity.Acknowledgements.  I owe a great deal to R. Fabrys outstanding andmultifaceted support.  Special thanks are due C. Sequin, who has readmy work with great care and provided many stimulating discussions.  Iwould also like to thank D. Gusfield, B. MontReynaud, A. Moose, andS. Wecker for their comments and encouragement.  The referees havebeen very helpful.Received 279 accepted 480 revised 1080References1. Baran, P.  On distributed communications IX security secrecy andtamperfree considerations.  Memo RM3765PR, Rand Corp., SantaMonica, CA, Aug. 1964.2. Diffie, W. and Hellman, M.E.  New directions in cryptography.  IEEETrans. Information Theory IT22, 6 Nov. 1976, 644654.3. Kahn, D.  The Code Breakers, The Story of Secret Writing.Macmillan, New York, 1967.4. Merkle, R.C.  Secure communications over insecure channels.  Comm.ACM 21, 4 Apr. 1978, 294299.5. Rivest, R.L., Shamir, A., and Adleman, L.  A method for obtainingdigital signatures and publickey cryptosystems.  Comm. ACM 21, 2 Feb.1977, 120126.
